(()=>{var exports={};exports.id=931,exports.ids=[931],exports.modules={7849:T=>{"use strict";T.exports=require("next/dist/client/components/action-async-storage.external")},5403:T=>{"use strict";T.exports=require("next/dist/client/components/request-async-storage.external")},4749:T=>{"use strict";T.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:T=>{"use strict";T.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:T=>{"use strict";T.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:T=>{"use strict";T.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:T=>{"use strict";T.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9523:T=>{"use strict";T.exports=require("dns")},2361:T=>{"use strict";T.exports=require("events")},7147:T=>{"use strict";T.exports=require("fs")},3685:T=>{"use strict";T.exports=require("http")},5158:T=>{"use strict";T.exports=require("http2")},1808:T=>{"use strict";T.exports=require("net")},2037:T=>{"use strict";T.exports=require("os")},1017:T=>{"use strict";T.exports=require("path")},7282:T=>{"use strict";T.exports=require("process")},2781:T=>{"use strict";T.exports=require("stream")},4404:T=>{"use strict";T.exports=require("tls")},7310:T=>{"use strict";T.exports=require("url")},3837:T=>{"use strict";T.exports=require("util")},9796:T=>{"use strict";T.exports=require("zlib")},8655:(T,S,N)=>{"use strict";N.r(S),N.d(S,{GlobalError:()=>M.a,__next_app__:()=>K,originalPathname:()=>W,pages:()=>$,routeModule:()=>Q,tree:()=>U});var R=N(482),O=N(9108),P=N(2563),M=N.n(P),L=N(8300),V={};for(let T in L)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(T)&&(V[T]=()=>L[T]);N.d(S,V);let U=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(N.bind(N,1136)),"C:\\Users\\singh\\Keshwala\\src\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(N.bind(N,1342)),"C:\\Users\\singh\\Keshwala\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(N.t.bind(N,9361,23)),"next/dist/client/components/not-found-error"]}],$=["C:\\Users\\singh\\Keshwala\\src\\app\\page.tsx"],W="/page",K={require:N,loadChunk:()=>Promise.resolve()},Q=new R.AppPageRouteModule({definition:{kind:O.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:U}})},7914:(T,S,N)=>{Promise.resolve().then(N.t.bind(N,2583,23)),Promise.resolve().then(N.t.bind(N,6840,23)),Promise.resolve().then(N.t.bind(N,8771,23)),Promise.resolve().then(N.t.bind(N,3225,23)),Promise.resolve().then(N.t.bind(N,9295,23)),Promise.resolve().then(N.t.bind(N,3982,23))},1844:()=>{},614:(T,S,N)=>{Promise.resolve().then(N.bind(N,7958))},9601:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.addAdminServicesToServer=S.registerAdminService=void 0;let N=[];function R(T,S){N.push({getServiceDefinition:T,getHandlers:S})}function O(T){for(let{getServiceDefinition:S,getHandlers:R}of N)T.addService(S(),R())}S.registerAdminService=R,S.addAdminServicesToServer=O},4934:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BackoffTimeout=void 0;let N=1e3,R=1.6,O=12e4,P=.2;function M(T,S){return Math.random()*(S-T)+T}class L{constructor(T,S){this.callback=T,this.initialDelay=N,this.multiplier=R,this.maxDelay=O,this.jitter=P,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,S&&(S.initialDelay&&(this.initialDelay=S.initialDelay),S.multiplier&&(this.multiplier=S.multiplier),S.jitter&&(this.jitter=S.jitter),S.maxDelay&&(this.maxDelay=S.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(T){var S,N;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},T),this.hasRef||null===(N=(S=this.timerId).unref)||void 0===N||N.call(S)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let T=Math.min(this.nextDelay*this.multiplier,this.maxDelay),S=T*this.jitter;this.nextDelay=T+M(-S,S)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let T=new Date,S=this.startTime;S.setMilliseconds(S.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),T<S?this.runTimer(S.getTime()-T.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var T,S;this.hasRef=!0,null===(S=(T=this.timerId).ref)||void 0===S||S.call(T)}unref(){var T,S;this.hasRef=!1,null===(S=(T=this.timerId).unref)||void 0===S||S.call(T)}getEndTime(){return this.endTime}}S.BackoffTimeout=L},8931:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.CallCredentials=void 0;let R=N(2252);function O(T){return"getRequestHeaders"in T&&"function"==typeof T.getRequestHeaders}class P{static createFromMetadataGenerator(T){return new L(T)}static createFromGoogleCredential(T){return P.createFromMetadataGenerator((S,N)=>{let P;(P=O(T)?T.getRequestHeaders(S.service_url):new Promise((N,R)=>{T.getRequestMetadata(S.service_url,(T,S)=>{if(T){R(T);return}if(!S){R(Error("Headers not set by metadata plugin"));return}N(S)})})).then(T=>{let S=new R.Metadata;for(let N of Object.keys(T))S.add(N,T[N]);N(null,S)},T=>{N(T)})})}static createEmpty(){return new V}}S.CallCredentials=P;class M extends P{constructor(T){super(),this.creds=T}async generateMetadata(T){let S=new R.Metadata;for(let N of(await Promise.all(this.creds.map(S=>S.generateMetadata(T)))))S.merge(N);return S}compose(T){return new M(this.creds.concat([T]))}_equals(T){return this===T||T instanceof M&&this.creds.every((S,N)=>S._equals(T.creds[N]))}}class L extends P{constructor(T){super(),this.metadataGenerator=T}generateMetadata(T){return new Promise((S,N)=>{this.metadataGenerator(T,(T,R)=>{void 0!==R?S(R):N(T)})})}compose(T){return new M([this,T])}_equals(T){return this===T||T instanceof L&&this.metadataGenerator===T.metadataGenerator}}class V extends P{generateMetadata(T){return Promise.resolve(new R.Metadata)}compose(T){return T}_equals(T){return T instanceof V}}},6749:(T,S)=>{"use strict";function N(T){return void 0!==T.onReceiveMetadata&&1===T.onReceiveMetadata.length}Object.defineProperty(S,"__esModule",{value:!0}),S.InterceptingListenerImpl=S.isInterceptingListener=void 0,S.isInterceptingListener=N;class R{constructor(T,S){this.listener=T,this.nextListener=S,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(T){this.processingMetadata=!0,this.listener.onReceiveMetadata(T,T=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(T),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(T){this.processingMessage=!0,this.listener.onReceiveMessage(T,T=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=T,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(T),this.processPendingStatus())})}onReceiveStatus(T){this.listener.onReceiveStatus(T,T=>{this.processingMetadata||this.processingMessage?this.pendingStatus=T:this.nextListener.onReceiveStatus(T)})}}S.InterceptingListenerImpl=R},8445:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getNextCallNumber=void 0;let N=0;function R(){return N++}S.getNextCallNumber=R},8439:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ClientDuplexStreamImpl=S.ClientWritableStreamImpl=S.ClientReadableStreamImpl=S.ClientUnaryCallImpl=S.callErrorFromStatus=void 0;let R=N(2361),O=N(2781),P=N(2678);function M(T,S){let N=`${T.code} ${P.Status[T.code]}: ${T.details}`,R=Error(N),O=`${R.stack}
for call at
${S}`;return Object.assign(Error(N),T,{stack:O})}S.callErrorFromStatus=M;class L extends R.EventEmitter{constructor(){super()}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}}S.ClientUnaryCallImpl=L;class V extends O.Readable{constructor(T){super({objectMode:!0}),this.deserialize=T}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_read(T){var S;null===(S=this.call)||void 0===S||S.startRead()}}S.ClientReadableStreamImpl=V;class U extends O.Writable{constructor(T){super({objectMode:!0}),this.serialize=T}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_write(T,S,N){var R;let O={callback:N},P=Number(S);Number.isNaN(P)||(O.flags=P),null===(R=this.call)||void 0===R||R.sendMessageWithContext(O,T)}_final(T){var S;null===(S=this.call)||void 0===S||S.halfClose(),T()}}S.ClientWritableStreamImpl=U;class $ extends O.Duplex{constructor(T,S){super({objectMode:!0}),this.serialize=T,this.deserialize=S}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_read(T){var S;null===(S=this.call)||void 0===S||S.startRead()}_write(T,S,N){var R;let O={callback:N},P=Number(S);Number.isNaN(P)||(O.flags=P),null===(R=this.call)||void 0===R||R.sendMessageWithContext(O,T)}_final(T){var S;null===(S=this.call)||void 0===S||S.halfClose(),T()}}S.ClientDuplexStreamImpl=$},2528:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChannelCredentials=void 0;let R=N(4404),O=N(8931),P=N(3009);function M(T,S){if(T&&!(T instanceof Buffer))throw TypeError(`${S}, if provided, must be a Buffer.`)}class L{constructor(T){this.callCredentials=T||O.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(T,S,N,O){var L;if(M(T,"Root certificate"),M(S,"Private key"),M(N,"Certificate chain"),S&&!N)throw Error("Private key must be given with accompanying certificate chain");if(!S&&N)throw Error("Certificate chain must be given with accompanying private key");return new U((0,R.createSecureContext)({ca:null!==(L=null!=T?T:(0,P.getDefaultRootsData)())&&void 0!==L?L:void 0,key:null!=S?S:void 0,cert:null!=N?N:void 0,ciphers:P.CIPHER_SUITES}),null!=O?O:{})}static createFromSecureContext(T,S){return new U(T,null!=S?S:{})}static createInsecure(){return new V}}S.ChannelCredentials=L;class V extends L{constructor(T){super(T)}compose(T){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(T){return T instanceof V}}class U extends L{constructor(T,S){super(),this.secureContext=T,this.verifyOptions=S,this.connectionOptions={secureContext:T},(null==S?void 0:S.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=S.checkServerIdentity)}compose(T){return new $(this,this.callCredentials.compose(T))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(T){return this===T||T instanceof U&&this.secureContext===T.secureContext&&this.verifyOptions.checkServerIdentity===T.verifyOptions.checkServerIdentity}}class $ extends L{constructor(T,S){super(S),this.channelCredentials=T}compose(T){let S=this.callCredentials.compose(T);return new $(this.channelCredentials,S)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(T){return this===T||T instanceof $&&this.channelCredentials._equals(T.channelCredentials)&&this.callCredentials._equals(T.callCredentials)}}},9387:(T,S)=>{"use strict";function N(T,S){let N=Object.keys(T).sort(),R=Object.keys(S).sort();if(N.length!==R.length)return!1;for(let O=0;O<N.length;O+=1)if(N[O]!==R[O]||T[N[O]]!==S[R[O]])return!1;return!0}Object.defineProperty(S,"__esModule",{value:!0}),S.channelOptionsEqual=S.recognizedOptions=void 0,S.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},S.channelOptionsEqual=N},6261:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChannelImplementation=void 0;let R=N(2528),O=N(1118);class P{constructor(T,S,N){if("string"!=typeof T)throw TypeError("Channel target must be a string");if(!(S instanceof R.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(N&&"object"!=typeof N)throw TypeError("Channel options must be an object");this.internalChannel=new O.InternalChannel(T,S,N)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(T){return this.internalChannel.getConnectivityState(T)}watchConnectivityState(T,S,N){this.internalChannel.watchConnectivityState(T,S,N)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(T,S,N,R,O){if("string"!=typeof T)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof S||S instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(T,S,N,R,O)}}S.ChannelImplementation=P},5993:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.getChannelzServiceDefinition=S.getChannelzHandlers=S.unregisterChannelzRef=S.registerChannelzSocket=S.registerChannelzServer=S.registerChannelzSubchannel=S.registerChannelzChannel=S.ChannelzCallTracker=S.ChannelzChildrenTracker=S.ChannelzTrace=void 0;let R=N(1808),O=N(3955),P=N(2678),M=N(3906),L=N(9601),V=N(5085);function U(T){return{channel_id:T.id,name:T.name}}function $(T){return{subchannel_id:T.id,name:T.name}}function W(T){return{server_id:T.id}}function K(T){return{socket_id:T.id,name:T.name}}let Q=32;class Y{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(T,S,N){let R=new Date;this.events.push({description:S,severity:T,timestamp:R,childChannel:(null==N?void 0:N.kind)==="channel"?N:void 0,childSubchannel:(null==N?void 0:N.kind)==="subchannel"?N:void 0}),this.events.length>=2*Q&&(this.events=this.events.slice(Q)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:ey(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(T=>({description:T.description,severity:T.severity,timestamp:ey(T.timestamp),channel_ref:T.childChannel?U(T.childChannel):null,subchannel_ref:T.childSubchannel?$(T.childSubchannel):null}))}}}S.ChannelzTrace=Y;class Z{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(T){var S,N,R;switch(T.kind){case"channel":{let N=null!==(S=this.channelChildren.get(T.id))&&void 0!==S?S:{ref:T,count:0};N.count+=1,this.channelChildren.set(T.id,N);break}case"subchannel":{let S=null!==(N=this.subchannelChildren.get(T.id))&&void 0!==N?N:{ref:T,count:0};S.count+=1,this.subchannelChildren.set(T.id,S);break}case"socket":{let S=null!==(R=this.socketChildren.get(T.id))&&void 0!==R?R:{ref:T,count:0};S.count+=1,this.socketChildren.set(T.id,S)}}}unrefChild(T){switch(T.kind){case"channel":{let S=this.channelChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.channelChildren.delete(T.id):this.channelChildren.set(T.id,S));break}case"subchannel":{let S=this.subchannelChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.subchannelChildren.delete(T.id):this.subchannelChildren.set(T.id,S));break}case"socket":{let S=this.socketChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.socketChildren.delete(T.id):this.socketChildren.set(T.id,S))}}}getChildLists(){let T=[];for(let{ref:S}of this.channelChildren.values())T.push(S);let S=[];for(let{ref:T}of this.subchannelChildren.values())S.push(T);let N=[];for(let{ref:T}of this.socketChildren.values())N.push(T);return{channels:T,subchannels:S,sockets:N}}}S.ChannelzChildrenTracker=Z;class ee{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}S.ChannelzCallTracker=ee;let et=1;function er(){return et++}let ei=[],en=[],es=[],ea=[];function eo(T,S,N){let R=er(),O={id:R,name:T,kind:"channel"};return N&&(ei[R]={ref:O,getInfo:S}),O}function eu(T,S,N){let R=er(),O={id:R,name:T,kind:"subchannel"};return N&&(en[R]={ref:O,getInfo:S}),O}function ec(T,S){let N=er(),R={id:N,kind:"server"};return S&&(es[N]={ref:R,getInfo:T}),R}function ed(T,S,N){let R=er(),O={id:R,name:T,kind:"socket"};return N&&(ea[R]={ref:O,getInfo:S}),O}function eh(T){switch(T.kind){case"channel":delete ei[T.id];return;case"subchannel":delete en[T.id];return;case"server":delete es[T.id];return;case"socket":delete ea[T.id];return}}function ep(T){let S=Number.parseInt(T,16);return[S/256|0,S%256]}function ef(T){return""===T?[]:[].concat(...T.split(":").map(T=>ep(T)))}function em(T){if((0,R.isIPv4)(T))return Buffer.from(Uint8Array.from(T.split(".").map(T=>Number.parseInt(T))));if(!(0,R.isIPv6)(T))return null;{let S,N;let R=T.indexOf("::");-1===R?(S=T,N=""):(S=T.substring(0,R),N=T.substring(R+2));let O=Buffer.from(ef(S)),P=Buffer.from(ef(N)),M=Buffer.alloc(16-O.length-P.length,0);return Buffer.concat([O,M,P])}}function eg(T){switch(T){case O.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case O.ConnectivityState.IDLE:return{state:"IDLE"};case O.ConnectivityState.READY:return{state:"READY"};case O.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case O.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function ey(T){if(!T)return null;let S=T.getTime();return{seconds:S/1e3|0,nanos:S%1e3*1e6}}function ev(T){let S=T.getInfo();return{ref:U(T.ref),data:{target:S.target,state:eg(S.state),calls_started:S.callTracker.callsStarted,calls_succeeded:S.callTracker.callsSucceeded,calls_failed:S.callTracker.callsFailed,last_call_started_timestamp:ey(S.callTracker.lastCallStartedTimestamp),trace:S.trace.getTraceMessage()},channel_ref:S.children.channels.map(T=>U(T)),subchannel_ref:S.children.subchannels.map(T=>$(T))}}function eb(T,S){let N=Number.parseInt(T.request.channel_id),R=ei[N];if(void 0===R){S({code:P.Status.NOT_FOUND,details:"No channel data found for id "+N});return}S(null,{channel:ev(R)})}function ew(T,S){let N=Number.parseInt(T.request.max_results),R=[],O=Number.parseInt(T.request.start_channel_id);for(;O<ei.length;O++){let T=ei[O];if(void 0!==T&&(R.push(ev(T)),R.length>=N))break}S(null,{channel:R,end:O>=es.length})}function eT(T){let S=T.getInfo();return{ref:W(T.ref),data:{calls_started:S.callTracker.callsStarted,calls_succeeded:S.callTracker.callsSucceeded,calls_failed:S.callTracker.callsFailed,last_call_started_timestamp:ey(S.callTracker.lastCallStartedTimestamp),trace:S.trace.getTraceMessage()},listen_socket:S.listenerChildren.sockets.map(T=>K(T))}}function eS(T,S){let N=Number.parseInt(T.request.server_id),R=es[N];if(void 0===R){S({code:P.Status.NOT_FOUND,details:"No server data found for id "+N});return}S(null,{server:eT(R)})}function ex(T,S){let N=Number.parseInt(T.request.max_results),R=[],O=Number.parseInt(T.request.start_server_id);for(;O<es.length;O++){let T=es[O];if(void 0!==T&&(R.push(eT(T)),R.length>=N))break}S(null,{server:R,end:O>=es.length})}function eE(T,S){let N=Number.parseInt(T.request.subchannel_id),R=en[N];if(void 0===R){S({code:P.Status.NOT_FOUND,details:"No subchannel data found for id "+N});return}let O=R.getInfo();S(null,{subchannel:{ref:$(R.ref),data:{target:O.target,state:eg(O.state),calls_started:O.callTracker.callsStarted,calls_succeeded:O.callTracker.callsSucceeded,calls_failed:O.callTracker.callsFailed,last_call_started_timestamp:ey(O.callTracker.lastCallStartedTimestamp),trace:O.trace.getTraceMessage()},socket_ref:O.children.sockets.map(T=>K(T))}})}function eC(T){var S;return(0,M.isTcpSubchannelAddress)(T)?{address:"tcpip_address",tcpip_address:{ip_address:null!==(S=em(T.host))&&void 0!==S?S:void 0,port:T.port}}:{address:"uds_address",uds_address:{filename:T.path}}}function e_(T,S){var N,R,O,M,L;let V=Number.parseInt(T.request.socket_id),U=ea[V];if(void 0===U){S({code:P.Status.NOT_FOUND,details:"No socket data found for id "+V});return}let $=U.getInfo(),W=$.security?{model:"tls",tls:{cipher_suite:$.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!==(N=$.security.cipherSuiteStandardName)&&void 0!==N?N:void 0,other_name:null!==(R=$.security.cipherSuiteOtherName)&&void 0!==R?R:void 0,local_certificate:null!==(O=$.security.localCertificate)&&void 0!==O?O:void 0,remote_certificate:null!==(M=$.security.remoteCertificate)&&void 0!==M?M:void 0}}:null;S(null,{socket:{ref:K(U.ref),local:$.localAddress?eC($.localAddress):null,remote:$.remoteAddress?eC($.remoteAddress):null,remote_name:null!==(L=$.remoteName)&&void 0!==L?L:void 0,security:W,data:{keep_alives_sent:$.keepAlivesSent,streams_started:$.streamsStarted,streams_succeeded:$.streamsSucceeded,streams_failed:$.streamsFailed,last_local_stream_created_timestamp:ey($.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:ey($.lastRemoteStreamCreatedTimestamp),messages_received:$.messagesReceived,messages_sent:$.messagesSent,last_message_received_timestamp:ey($.lastMessageReceivedTimestamp),last_message_sent_timestamp:ey($.lastMessageSentTimestamp),local_flow_control_window:$.localFlowControlWindow?{value:$.localFlowControlWindow}:null,remote_flow_control_window:$.remoteFlowControlWindow?{value:$.remoteFlowControlWindow}:null}}})}function eI(T,S){let N=Number.parseInt(T.request.server_id),R=es[N];if(void 0===R){S({code:P.Status.NOT_FOUND,details:"No server data found for id "+N});return}let O=Number.parseInt(T.request.start_socket_id),M=Number.parseInt(T.request.max_results),L=R.getInfo().sessionChildren.sockets.sort((T,S)=>T.id-S.id),V=[],U=0;for(;U<L.length&&(!(L[U].id>=O)||(V.push(K(L[U])),!(V.length>=M)));U++);S(null,{socket_ref:V,end:U>=L.length})}function ek(){return{GetChannel:eb,GetTopChannels:ew,GetServer:eS,GetServers:ex,GetSubchannel:eE,GetSocket:e_,GetServerSockets:eI}}S.registerChannelzChannel=eo,S.registerChannelzSubchannel=eu,S.registerChannelzServer=ec,S.registerChannelzSocket=ed,S.unregisterChannelzRef=eh,S.getChannelzHandlers=ek;let eN=null;function eA(){if(eN)return eN;let T=(0,N(8715).J_)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return eN=(0,V.loadPackageDefinition)(T).grpc.channelz.v1.Channelz.service}function eR(){(0,L.registerAdminService)(eA,ek)}S.getChannelzServiceDefinition=eA,S.setup=eR},8601:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getInterceptingCall=S.InterceptingCall=S.RequesterBuilder=S.ListenerBuilder=S.InterceptorConfigurationError=void 0;let R=N(2252),O=N(6749),P=N(2678),M=N(5437);class L extends Error{constructor(T){super(T),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,L)}}S.InterceptorConfigurationError=L;class V{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(T){return this.metadata=T,this}withOnReceiveMessage(T){return this.message=T,this}withOnReceiveStatus(T){return this.status=T,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}S.ListenerBuilder=V;class U{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(T){return this.start=T,this}withSendMessage(T){return this.message=T,this}withHalfClose(T){return this.halfClose=T,this}withCancel(T){return this.cancel=T,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}S.RequesterBuilder=U;let $={onReceiveMetadata:(T,S)=>{S(T)},onReceiveMessage:(T,S)=>{S(T)},onReceiveStatus:(T,S)=>{S(T)}},W={start:(T,S,N)=>{N(T,S)},sendMessage:(T,S)=>{S(T)},halfClose:T=>{T()},cancel:T=>{T()}};class K{constructor(T,S){var N,R,O,P;this.nextCall=T,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,S?this.requester={start:null!==(N=S.start)&&void 0!==N?N:W.start,sendMessage:null!==(R=S.sendMessage)&&void 0!==R?R:W.sendMessage,halfClose:null!==(O=S.halfClose)&&void 0!==O?O:W.halfClose,cancel:null!==(P=S.cancel)&&void 0!==P?P:W.cancel}:this.requester=W}cancelWithStatus(T,S){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(T,S)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(T,S){var N,R,P,M,L,V;let U={onReceiveMetadata:null!==(R=null===(N=null==S?void 0:S.onReceiveMetadata)||void 0===N?void 0:N.bind(S))&&void 0!==R?R:T=>{},onReceiveMessage:null!==(M=null===(P=null==S?void 0:S.onReceiveMessage)||void 0===P?void 0:P.bind(S))&&void 0!==M?M:T=>{},onReceiveStatus:null!==(V=null===(L=null==S?void 0:S.onReceiveStatus)||void 0===L?void 0:L.bind(S))&&void 0!==V?V:T=>{}};this.processingMetadata=!0,this.requester.start(T,U,(T,S)=>{var N,R,P;let M;if(this.processingMetadata=!1,(0,O.isInterceptingListener)(S))M=S;else{let T={onReceiveMetadata:null!==(N=S.onReceiveMetadata)&&void 0!==N?N:$.onReceiveMetadata,onReceiveMessage:null!==(R=S.onReceiveMessage)&&void 0!==R?R:$.onReceiveMessage,onReceiveStatus:null!==(P=S.onReceiveStatus)&&void 0!==P?P:$.onReceiveStatus};M=new O.InterceptingListenerImpl(T,U)}this.nextCall.start(T,M),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(T,S){this.processingMessage=!0,this.requester.sendMessage(S,N=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=T,this.pendingMessage=S):(this.nextCall.sendMessageWithContext(T,N),this.processPendingHalfClose())})}sendMessage(T){this.sendMessageWithContext({},T)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function Q(T,S,N){var R,O;let P=null!==(R=N.deadline)&&void 0!==R?R:1/0,M=N.host,L=null!==(O=N.parent)&&void 0!==O?O:null,V=N.propagate_flags,U=N.credentials,$=T.createCall(S,P,M,L,V);return U&&$.setCredentials(U),$}S.InterceptingCall=K;class Y{constructor(T,S){this.call=T,this.methodDefinition=S}cancelWithStatus(T,S){this.call.cancelWithStatus(T,S)}getPeer(){return this.call.getPeer()}sendMessageWithContext(T,S){let N;try{N=this.methodDefinition.requestSerialize(S)}catch(T){this.call.cancelWithStatus(P.Status.INTERNAL,`Request message serialization failure: ${(0,M.getErrorMessage)(T)}`);return}this.call.sendMessageWithContext(T,N)}sendMessage(T){this.sendMessageWithContext({},T)}start(T,S){let N=null;this.call.start(T,{onReceiveMetadata:T=>{var N;null===(N=null==S?void 0:S.onReceiveMetadata)||void 0===N||N.call(S,T)},onReceiveMessage:T=>{var O;let L;try{L=this.methodDefinition.responseDeserialize(T)}catch(T){N={code:P.Status.INTERNAL,details:`Response message parsing error: ${(0,M.getErrorMessage)(T)}`,metadata:new R.Metadata},this.call.cancelWithStatus(N.code,N.details);return}null===(O=null==S?void 0:S.onReceiveMessage)||void 0===O||O.call(S,L)},onReceiveStatus:T=>{var R,O;N?null===(R=null==S?void 0:S.onReceiveStatus)||void 0===R||R.call(S,N):null===(O=null==S?void 0:S.onReceiveStatus)||void 0===O||O.call(S,T)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class Z extends Y{constructor(T,S){super(T,S)}start(T,S){var N,R;let O=!1,P={onReceiveMetadata:null!==(R=null===(N=null==S?void 0:S.onReceiveMetadata)||void 0===N?void 0:N.bind(S))&&void 0!==R?R:T=>{},onReceiveMessage:T=>{var N;O=!0,null===(N=null==S?void 0:S.onReceiveMessage)||void 0===N||N.call(S,T)},onReceiveStatus:T=>{var N,R;O||null===(N=null==S?void 0:S.onReceiveMessage)||void 0===N||N.call(S,null),null===(R=null==S?void 0:S.onReceiveStatus)||void 0===R||R.call(S,T)}};super.start(T,P),this.call.startRead()}}class ee extends Y{}function et(T,S,N){let R=Q(T,N.path,S);return N.responseStream?new ee(R,N):new Z(R,N)}function er(T,S,N,R){if(T.clientInterceptors.length>0&&T.clientInterceptorProviders.length>0)throw new L("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(T.callInterceptors.length>0&&T.callInterceptorProviders.length>0)throw new L("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let O=[];O=T.callInterceptors.length>0||T.callInterceptorProviders.length>0?[].concat(T.callInterceptors,T.callInterceptorProviders.map(T=>T(S))).filter(T=>T):[].concat(T.clientInterceptors,T.clientInterceptorProviders.map(T=>T(S))).filter(T=>T);let P=Object.assign({},N,{method_definition:S});return O.reduceRight((T,S)=>N=>S(N,T),T=>et(R,T,S))(P)}S.getInterceptingCall=er},9800:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Client=void 0;let R=N(8439),O=N(6261),P=N(3955),M=N(2678),L=N(2252),V=N(8601),U=Symbol(),$=Symbol(),W=Symbol(),K=Symbol();function Q(T){return"function"==typeof T}function Y(T){return T.stack.split("\n").slice(1).join("\n")}class Z{constructor(T,S,N={}){var R,P;if(N=Object.assign({},N),this[$]=null!==(R=N.interceptors)&&void 0!==R?R:[],delete N.interceptors,this[W]=null!==(P=N.interceptor_providers)&&void 0!==P?P:[],delete N.interceptor_providers,this[$].length>0&&this[W].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[K]=N.callInvocationTransformer,delete N.callInvocationTransformer,N.channelOverride)this[U]=N.channelOverride;else if(N.channelFactoryOverride){let R=N.channelFactoryOverride;delete N.channelFactoryOverride,this[U]=R(T,S,N)}else this[U]=new O.ChannelImplementation(T,S,N)}close(){this[U].close()}getChannel(){return this[U]}waitForReady(T,S){let N=R=>{let O;if(R){S(Error("Failed to connect before the deadline"));return}try{O=this[U].getConnectivityState(!0)}catch(T){S(Error("The channel has been closed"));return}if(O===P.ConnectivityState.READY)S();else try{this[U].watchConnectivityState(O,T,N)}catch(T){S(Error("The channel has been closed"))}};setImmediate(N)}checkOptionalUnaryResponseArguments(T,S,N){if(Q(T))return{metadata:new L.Metadata,options:{},callback:T};if(Q(S))return T instanceof L.Metadata?{metadata:T,options:{},callback:S}:{metadata:new L.Metadata,options:T,callback:S};if(!(T instanceof L.Metadata&&S instanceof Object&&Q(N)))throw Error("Incorrect arguments passed");return{metadata:T,options:S,callback:N}}makeUnaryRequest(T,S,N,O,P,L,Q){var Z,ee;let et=this.checkOptionalUnaryResponseArguments(P,L,Q),er={path:T,requestStream:!1,responseStream:!1,requestSerialize:S,responseDeserialize:N},ei={argument:O,metadata:et.metadata,call:new R.ClientUnaryCallImpl,channel:this[U],methodDefinition:er,callOptions:et.options,callback:et.callback};this[K]&&(ei=this[K](ei));let en=ei.call,es={clientInterceptors:this[$],clientInterceptorProviders:this[W],callInterceptors:null!==(Z=ei.callOptions.interceptors)&&void 0!==Z?Z:[],callInterceptorProviders:null!==(ee=ei.callOptions.interceptor_providers)&&void 0!==ee?ee:[]},ea=(0,V.getInterceptingCall)(es,ei.methodDefinition,ei.callOptions,ei.channel);en.call=ea;let eo=null,eu=!1,ec=Error();return ea.start(ei.metadata,{onReceiveMetadata:T=>{en.emit("metadata",T)},onReceiveMessage(T){null!==eo&&ea.cancelWithStatus(M.Status.INTERNAL,"Too many responses received"),eo=T},onReceiveStatus(T){if(!eu){if(eu=!0,T.code===M.Status.OK){if(null===eo){let S=Y(ec);ei.callback((0,R.callErrorFromStatus)({code:M.Status.INTERNAL,details:"No message received",metadata:T.metadata},S))}else ei.callback(null,eo)}else{let S=Y(ec);ei.callback((0,R.callErrorFromStatus)(T,S))}ec=null,en.emit("status",T)}}}),ea.sendMessage(O),ea.halfClose(),en}makeClientStreamRequest(T,S,N,O,P,L){var Q,Z;let ee=this.checkOptionalUnaryResponseArguments(O,P,L),et={path:T,requestStream:!0,responseStream:!1,requestSerialize:S,responseDeserialize:N},er={metadata:ee.metadata,call:new R.ClientWritableStreamImpl(S),channel:this[U],methodDefinition:et,callOptions:ee.options,callback:ee.callback};this[K]&&(er=this[K](er));let ei=er.call,en={clientInterceptors:this[$],clientInterceptorProviders:this[W],callInterceptors:null!==(Q=er.callOptions.interceptors)&&void 0!==Q?Q:[],callInterceptorProviders:null!==(Z=er.callOptions.interceptor_providers)&&void 0!==Z?Z:[]},es=(0,V.getInterceptingCall)(en,er.methodDefinition,er.callOptions,er.channel);ei.call=es;let ea=null,eo=!1,eu=Error();return es.start(er.metadata,{onReceiveMetadata:T=>{ei.emit("metadata",T)},onReceiveMessage(T){null!==ea&&es.cancelWithStatus(M.Status.INTERNAL,"Too many responses received"),ea=T},onReceiveStatus(T){if(!eo){if(eo=!0,T.code===M.Status.OK){if(null===ea){let S=Y(eu);er.callback((0,R.callErrorFromStatus)({code:M.Status.INTERNAL,details:"No message received",metadata:T.metadata},S))}else er.callback(null,ea)}else{let S=Y(eu);er.callback((0,R.callErrorFromStatus)(T,S))}eu=null,ei.emit("status",T)}}}),ei}checkMetadataAndOptions(T,S){let N,R;return T instanceof L.Metadata?(N=T,R=S||{}):(R=T||{},N=new L.Metadata),{metadata:N,options:R}}makeServerStreamRequest(T,S,N,O,P,L){var Q,Z;let ee=this.checkMetadataAndOptions(P,L),et={path:T,requestStream:!1,responseStream:!0,requestSerialize:S,responseDeserialize:N},er={argument:O,metadata:ee.metadata,call:new R.ClientReadableStreamImpl(N),channel:this[U],methodDefinition:et,callOptions:ee.options};this[K]&&(er=this[K](er));let ei=er.call,en={clientInterceptors:this[$],clientInterceptorProviders:this[W],callInterceptors:null!==(Q=er.callOptions.interceptors)&&void 0!==Q?Q:[],callInterceptorProviders:null!==(Z=er.callOptions.interceptor_providers)&&void 0!==Z?Z:[]},es=(0,V.getInterceptingCall)(en,er.methodDefinition,er.callOptions,er.channel);ei.call=es;let ea=!1,eo=Error();return es.start(er.metadata,{onReceiveMetadata(T){ei.emit("metadata",T)},onReceiveMessage(T){ei.push(T)},onReceiveStatus(T){if(!ea){if(ea=!0,ei.push(null),T.code!==M.Status.OK){let S=Y(eo);ei.emit("error",(0,R.callErrorFromStatus)(T,S))}eo=null,ei.emit("status",T)}}}),es.sendMessage(O),es.halfClose(),ei}makeBidiStreamRequest(T,S,N,O,P){var L,Q;let Z=this.checkMetadataAndOptions(O,P),ee={path:T,requestStream:!0,responseStream:!0,requestSerialize:S,responseDeserialize:N},et={metadata:Z.metadata,call:new R.ClientDuplexStreamImpl(S,N),channel:this[U],methodDefinition:ee,callOptions:Z.options};this[K]&&(et=this[K](et));let er=et.call,ei={clientInterceptors:this[$],clientInterceptorProviders:this[W],callInterceptors:null!==(L=et.callOptions.interceptors)&&void 0!==L?L:[],callInterceptorProviders:null!==(Q=et.callOptions.interceptor_providers)&&void 0!==Q?Q:[]},en=(0,V.getInterceptingCall)(ei,et.methodDefinition,et.callOptions,et.channel);er.call=en;let es=!1,ea=Error();return en.start(et.metadata,{onReceiveMetadata(T){er.emit("metadata",T)},onReceiveMessage(T){er.push(T)},onReceiveStatus(T){if(!es){if(es=!0,er.push(null),T.code!==M.Status.OK){let S=Y(ea);er.emit("error",(0,R.callErrorFromStatus)(T,S))}ea=null,er.emit("status",T)}}}),er}}S.Client=Z},9286:(T,S)=>{"use strict";var N;Object.defineProperty(S,"__esModule",{value:!0}),S.CompressionAlgorithms=void 0,function(T){T[T.identity=0]="identity",T[T.deflate=1]="deflate",T[T.gzip=2]="gzip"}(N||(S.CompressionAlgorithms=N={}))},4299:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.CompressionFilterFactory=S.CompressionFilter=void 0;let R=N(9796),O=N(9286),P=N(2678),M=N(8152),L=N(7504),V=T=>"number"==typeof T&&"string"==typeof O.CompressionAlgorithms[T];class U{async writeMessage(T,S){let N=T;S&&(N=await this.compressMessage(N));let R=Buffer.allocUnsafe(N.length+5);return R.writeUInt8(S?1:0,0),R.writeUInt32BE(N.length,1),N.copy(R,5),R}async readMessage(T){let S=1===T.readUInt8(0),N=T.slice(5);return S&&(N=await this.decompressMessage(N)),N}}class $ extends U{async compressMessage(T){return T}async writeMessage(T,S){let N=Buffer.allocUnsafe(T.length+5);return N.writeUInt8(0,0),N.writeUInt32BE(T.length,1),T.copy(N,5),N}decompressMessage(T){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class W extends U{constructor(T){super(),this.maxRecvMessageLength=T}compressMessage(T){return new Promise((S,N)=>{R.deflate(T,(T,R)=>{T?N(T):S(R)})})}decompressMessage(T){return new Promise((S,N)=>{let O=0,M=[],L=R.createInflate();L.on("data",T=>{M.push(T),O+=T.byteLength,-1!==this.maxRecvMessageLength&&O>this.maxRecvMessageLength&&(L.destroy(),N({code:P.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),L.on("end",()=>{S(Buffer.concat(M))}),L.write(T),L.end()})}}class K extends U{constructor(T){super(),this.maxRecvMessageLength=T}compressMessage(T){return new Promise((S,N)=>{R.gzip(T,(T,R)=>{T?N(T):S(R)})})}decompressMessage(T){return new Promise((S,N)=>{let O=0,M=[],L=R.createGunzip();L.on("data",T=>{M.push(T),O+=T.byteLength,-1!==this.maxRecvMessageLength&&O>this.maxRecvMessageLength&&(L.destroy(),N({code:P.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),L.on("end",()=>{S(Buffer.concat(M))}),L.write(T),L.end()})}}class Q extends U{constructor(T){super(),this.compressionName=T}compressMessage(T){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(T){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function Y(T,S){switch(T){case"identity":return new $;case"deflate":return new W(S);case"gzip":return new K(S);default:return new Q(T)}}class Z extends M.BaseFilter{constructor(T,S){var N,R;super(),this.sharedFilterConfig=S,this.sendCompression=new $,this.receiveCompression=new $,this.currentCompressionAlgorithm="identity";let M=T["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!==(N=T["grpc.max_receive_message_length"])&&void 0!==N?N:P.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==M){if(V(M)){let T=O.CompressionAlgorithms[M],N=null===(R=S.serverSupportedEncodingHeader)||void 0===R?void 0:R.split(",");(!N||N.includes(T))&&(this.currentCompressionAlgorithm=T,this.sendCompression=Y(this.currentCompressionAlgorithm,-1))}else L.log(P.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${M}`)}}async sendMetadata(T){let S=await T;return S.set("grpc-accept-encoding","identity,deflate,gzip"),S.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?S.remove("grpc-encoding"):S.set("grpc-encoding",this.currentCompressionAlgorithm),S}receiveMetadata(T){let S=T.get("grpc-encoding");if(S.length>0){let T=S[0];"string"==typeof T&&(this.receiveCompression=Y(T,this.maxReceiveMessageLength))}T.remove("grpc-encoding");let N=T.get("grpc-accept-encoding")[0];return N&&(this.sharedFilterConfig.serverSupportedEncodingHeader=N,N.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new $,this.currentCompressionAlgorithm="identity")),T.remove("grpc-accept-encoding"),T}async sendMessage(T){var S;let N;let R=await T;return N=!(this.sendCompression instanceof $)&&((null!==(S=R.flags)&&void 0!==S?S:0)&2)==0,{message:await this.sendCompression.writeMessage(R.message,N),flags:R.flags}}async receiveMessage(T){return this.receiveCompression.readMessage(await T)}}S.CompressionFilter=Z;class ee{constructor(T,S){this.options=S,this.sharedFilterConfig={}}createFilter(){return new Z(this.options,this.sharedFilterConfig)}}S.CompressionFilterFactory=ee},3955:(T,S)=>{"use strict";var N;Object.defineProperty(S,"__esModule",{value:!0}),S.ConnectivityState=void 0,function(T){T[T.IDLE=0]="IDLE",T[T.CONNECTING=1]="CONNECTING",T[T.READY=2]="READY",T[T.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",T[T.SHUTDOWN=4]="SHUTDOWN"}(N||(S.ConnectivityState=N={}))},2678:(T,S)=>{"use strict";var N,R,O;Object.defineProperty(S,"__esModule",{value:!0}),S.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=S.DEFAULT_MAX_SEND_MESSAGE_LENGTH=S.Propagate=S.LogVerbosity=S.Status=void 0,function(T){T[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(N||(S.Status=N={})),function(T){T[T.DEBUG=0]="DEBUG",T[T.INFO=1]="INFO",T[T.ERROR=2]="ERROR",T[T.NONE=3]="NONE"}(R||(S.LogVerbosity=R={})),function(T){T[T.DEADLINE=1]="DEADLINE",T[T.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",T[T.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",T[T.CANCELLATION=8]="CANCELLATION",T[T.DEFAULTS=65535]="DEFAULTS"}(O||(S.Propagate=O={})),S.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,S.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},2155:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.restrictControlPlaneStatusCode=void 0;let R=N(2678),O=[R.Status.OK,R.Status.INVALID_ARGUMENT,R.Status.NOT_FOUND,R.Status.ALREADY_EXISTS,R.Status.FAILED_PRECONDITION,R.Status.ABORTED,R.Status.OUT_OF_RANGE,R.Status.DATA_LOSS];function P(T,S){return O.includes(T)?{code:R.Status.INTERNAL,details:`Invalid status from control plane: ${T} ${R.Status[T]} ${S}`}:{code:T,details:S}}S.restrictControlPlaneStatusCode=P},7931:(T,S)=>{"use strict";function N(...T){let S=1/0;for(let N of T){let T=N instanceof Date?N.getTime():N;T<S&&(S=T)}return S}Object.defineProperty(S,"__esModule",{value:!0}),S.deadlineToString=S.getRelativeTimeout=S.getDeadlineTimeoutString=S.minDeadline=void 0,S.minDeadline=N;let R=[["m",1],["S",1e3],["M",6e4],["H",36e5]];function O(T){let S=new Date().getTime();T instanceof Date&&(T=T.getTime());let N=Math.max(T-S,0);for(let[T,S]of R){let R=N/S;if(R<1e8)return String(Math.ceil(R))+T}throw Error("Deadline is too far in the future")}S.getDeadlineTimeoutString=O;let P=2147483647;function M(T){let S=(T instanceof Date?T.getTime():T)-new Date().getTime();return S<0?0:S>P?1/0:S}function L(T){if(T instanceof Date)return T.toISOString();{let S=new Date(T);return Number.isNaN(S.getTime())?""+T:S.toISOString()}}S.getRelativeTimeout=M,S.deadlineToString=L},5330:(T,S)=>{"use strict";function N(T){return{seconds:T/1e3|0,nanos:T%1e3*1e6|0}}function R(T){return 1e3*T.seconds+T.nanos/1e6|0}function O(T){return"number"==typeof T.seconds&&"number"==typeof T.nanos}Object.defineProperty(S,"__esModule",{value:!0}),S.isDuration=S.durationToMs=S.msToDuration=void 0,S.msToDuration=N,S.durationToMs=R,S.isDuration=O},5437:(T,S)=>{"use strict";function N(T){return T instanceof Error?T.message:String(T)}function R(T){return"object"==typeof T&&null!==T&&"code"in T&&"number"==typeof T.code?T.code:null}Object.defineProperty(S,"__esModule",{value:!0}),S.getErrorCode=S.getErrorMessage=void 0,S.getErrorMessage=N,S.getErrorCode=R},345:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.OutlierDetectionLoadBalancingConfig=S.BaseSubchannelWrapper=S.registerAdminService=S.FilterStackFactory=S.BaseFilter=S.PickResultType=S.QueuePicker=S.UnavailablePicker=S.ChildLoadBalancerHandler=S.subchannelAddressToString=S.validateLoadBalancingConfig=S.getFirstUsableConfig=S.registerLoadBalancerType=S.createChildChannelControlHelper=S.BackoffTimeout=S.durationToMs=S.uriToString=S.createResolver=S.registerResolver=S.log=S.trace=void 0;var R=N(7504);Object.defineProperty(S,"trace",{enumerable:!0,get:function(){return R.trace}}),Object.defineProperty(S,"log",{enumerable:!0,get:function(){return R.log}});var O=N(492);Object.defineProperty(S,"registerResolver",{enumerable:!0,get:function(){return O.registerResolver}}),Object.defineProperty(S,"createResolver",{enumerable:!0,get:function(){return O.createResolver}});var P=N(8429);Object.defineProperty(S,"uriToString",{enumerable:!0,get:function(){return P.uriToString}});var M=N(5330);Object.defineProperty(S,"durationToMs",{enumerable:!0,get:function(){return M.durationToMs}});var L=N(4934);Object.defineProperty(S,"BackoffTimeout",{enumerable:!0,get:function(){return L.BackoffTimeout}});var V=N(7176);Object.defineProperty(S,"createChildChannelControlHelper",{enumerable:!0,get:function(){return V.createChildChannelControlHelper}}),Object.defineProperty(S,"registerLoadBalancerType",{enumerable:!0,get:function(){return V.registerLoadBalancerType}}),Object.defineProperty(S,"getFirstUsableConfig",{enumerable:!0,get:function(){return V.getFirstUsableConfig}}),Object.defineProperty(S,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return V.validateLoadBalancingConfig}});var U=N(3906);Object.defineProperty(S,"subchannelAddressToString",{enumerable:!0,get:function(){return U.subchannelAddressToString}});var $=N(982);Object.defineProperty(S,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return $.ChildLoadBalancerHandler}});var W=N(7064);Object.defineProperty(S,"UnavailablePicker",{enumerable:!0,get:function(){return W.UnavailablePicker}}),Object.defineProperty(S,"QueuePicker",{enumerable:!0,get:function(){return W.QueuePicker}}),Object.defineProperty(S,"PickResultType",{enumerable:!0,get:function(){return W.PickResultType}});var K=N(8152);Object.defineProperty(S,"BaseFilter",{enumerable:!0,get:function(){return K.BaseFilter}});var Q=N(2472);Object.defineProperty(S,"FilterStackFactory",{enumerable:!0,get:function(){return Q.FilterStackFactory}});var Y=N(9601);Object.defineProperty(S,"registerAdminService",{enumerable:!0,get:function(){return Y.registerAdminService}});var Z=N(1407);Object.defineProperty(S,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return Z.BaseSubchannelWrapper}});var ee=N(1433);Object.defineProperty(S,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return ee.OutlierDetectionLoadBalancingConfig}})},2472:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.FilterStackFactory=S.FilterStack=void 0;class N{constructor(T){this.filters=T}sendMetadata(T){let S=T;for(let T=0;T<this.filters.length;T++)S=this.filters[T].sendMetadata(S);return S}receiveMetadata(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveMetadata(S);return S}sendMessage(T){let S=T;for(let T=0;T<this.filters.length;T++)S=this.filters[T].sendMessage(S);return S}receiveMessage(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveMessage(S);return S}receiveTrailers(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveTrailers(S);return S}push(T){this.filters.unshift(...T)}getFilters(){return this.filters}}S.FilterStack=N;class R{constructor(T){this.factories=T}push(T){this.factories.unshift(...T)}clone(){return new R([...this.factories])}createFilter(){return new N(this.factories.map(T=>T.createFilter()))}}S.FilterStackFactory=R},8152:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BaseFilter=void 0;class N{async sendMetadata(T){return T}receiveMetadata(T){return T}async sendMessage(T){return T}async receiveMessage(T){return T}receiveTrailers(T){return T}}S.BaseFilter=N},2039:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getProxiedConnection=S.mapProxyName=void 0;let R=N(7504),O=N(2678),P=N(492),M=N(3685),L=N(4404),V=N(7504),U=N(3906),$=N(8429),W=N(7310),K=N(4605),Q="proxy";function Y(T){V.trace(O.LogVerbosity.DEBUG,Q,T)}function Z(){let T,S="",N="";if(process.env.grpc_proxy)N="grpc_proxy",S=process.env.grpc_proxy;else if(process.env.https_proxy)N="https_proxy",S=process.env.https_proxy;else{if(!process.env.http_proxy)return{};N="http_proxy",S=process.env.http_proxy}try{T=new W.URL(S)}catch(T){return(0,R.log)(O.LogVerbosity.ERROR,`cannot parse value of "${N}" env var`),{}}if("http:"!==T.protocol)return(0,R.log)(O.LogVerbosity.ERROR,`"${T.protocol}" scheme not supported in proxy URI`),{};let P=null;T.username&&(T.password?((0,R.log)(O.LogVerbosity.INFO,"userinfo found in proxy URI"),P=`${T.username}:${T.password}`):P=T.username);let M=T.hostname,L=T.port;""===L&&(L="80");let V={address:`${M}:${L}`};return P&&(V.creds=P),Y("Proxy server "+V.address+" set by environment variable "+N),V}function ee(){let T=process.env.no_grpc_proxy,S="no_grpc_proxy";return(T||(T=process.env.no_proxy,S="no_proxy"),T)?(Y("No proxy server list set by environment variable "+S),T.split(",")):[]}function et(T,S){var N;let R={target:T,extraOptions:{}};if((null!==(N=S["grpc.enable_http_proxy"])&&void 0!==N?N:1)===0||"unix"===T.scheme)return R;let O=Z();if(!O.address)return R;let P=(0,$.splitHostPort)(T.path);if(!P)return R;let M=P.host;for(let S of ee())if(S===M)return Y("Not using proxy for target in no_proxy list: "+(0,$.uriToString)(T)),R;let L={"grpc.http_connect_target":(0,$.uriToString)(T)};return O.creds&&(L["grpc.http_connect_creds"]=O.creds),{target:{scheme:"dns",path:O.address},extraOptions:L}}function er(T,S,N){var V;if(!("grpc.http_connect_target"in S))return Promise.resolve({});let W=S["grpc.http_connect_target"],Q=(0,$.parseUri)(W);if(null===Q)return Promise.resolve({});let Z=(0,$.splitHostPort)(Q.path);if(null===Z)return Promise.resolve({});let ee=`${Z.host}:${null!==(V=Z.port)&&void 0!==V?V:K.DEFAULT_PORT}`,et={method:"CONNECT",path:ee},er={Host:ee};(0,U.isTcpSubchannelAddress)(T)?(et.host=T.host,et.port=T.port):et.socketPath=T.path,"grpc.http_connect_creds"in S&&(er["Proxy-Authorization"]="Basic "+Buffer.from(S["grpc.http_connect_creds"]).toString("base64")),et.headers=er;let ei=(0,U.subchannelAddressToString)(T);return Y("Using proxy "+ei+" to connect to "+et.path),new Promise((T,S)=>{let V=M.request(et);V.once("connect",(M,U,W)=>{var K;if(V.removeAllListeners(),U.removeAllListeners(),200===M.statusCode){if(Y("Successfully connected to "+et.path+" through proxy "+ei),"secureContext"in N){let R=(0,P.getDefaultAuthority)(Q),O=(0,$.splitHostPort)(R),M=null!==(K=null==O?void 0:O.host)&&void 0!==K?K:R,V=L.connect(Object.assign({host:M,servername:M,socket:U},N),()=>{Y("Successfully established a TLS connection to "+et.path+" through proxy "+ei),T({socket:V,realTarget:Q})});V.on("error",T=>{Y("Failed to establish a TLS connection to "+et.path+" through proxy "+ei+" with error "+T.message),S()})}else Y("Successfully established a plaintext connection to "+et.path+" through proxy "+ei),T({socket:U,realTarget:Q})}else(0,R.log)(O.LogVerbosity.ERROR,"Failed to connect to "+et.path+" through proxy "+ei+" with status "+M.statusCode),S()}),V.once("error",T=>{V.removeAllListeners(),(0,R.log)(O.LogVerbosity.ERROR,"Failed to connect to proxy "+ei+" with error "+T.message),S()}),V.end()})}S.mapProxyName=et,S.getProxiedConnection=er},2165:(T,S,N)=>{"use strict";ee={value:!0},ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=ee=S.Rz=ee=ee=ee=ee=ee=ee=S.SF=S.K9=void 0;let R=N(8931);ee={enumerable:!0,get:function(){return R.CallCredentials}};let O=N(6261);ee={enumerable:!0,get:function(){return O.ChannelImplementation}};let P=N(9286);ee={enumerable:!0,get:function(){return P.CompressionAlgorithms}};let M=N(3955);ee={enumerable:!0,get:function(){return M.ConnectivityState}};let L=N(2528);ee={enumerable:!0,get:function(){return L.ChannelCredentials}};let V=N(9800);ee={enumerable:!0,get:function(){return V.Client}};let U=N(2678);ee={enumerable:!0,get:function(){return U.LogVerbosity}},ee={enumerable:!0,get:function(){return U.Status}},ee={enumerable:!0,get:function(){return U.Propagate}};let $=N(7504),W=N(5085);Object.defineProperty(S,"Rz",{enumerable:!0,get:function(){return W.loadPackageDefinition}}),ee={enumerable:!0,get:function(){return W.makeClientConstructor}},ee={enumerable:!0,get:function(){return W.makeClientConstructor}};let K=N(2252);Object.defineProperty(S,"SF",{enumerable:!0,get:function(){return K.Metadata}});let Q=N(7691);ee={enumerable:!0,get:function(){return Q.Server}};let Y=N(4181);ee={enumerable:!0,get:function(){return Y.ServerCredentials}};let Z=N(9932);ee={enumerable:!0,get:function(){return Z.StatusBuilder}},S.K9={combineChannelCredentials:(T,...S)=>S.reduce((T,S)=>T.compose(S),T),combineCallCredentials:(T,...S)=>S.reduce((T,S)=>T.compose(S),T),createInsecure:L.ChannelCredentials.createInsecure,createSsl:L.ChannelCredentials.createSsl,createFromSecureContext:L.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:R.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:R.CallCredentials.createFromGoogleCredential,createEmpty:R.CallCredentials.createEmpty},ee=T=>T.close(),ee=(T,S,N)=>T.waitForReady(S,N),ee=(T,S)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},ee=(T,S,N)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},ee=T=>{$.setLogger(T)},ee=T=>{$.setLoggerVerbosity(T)},ee=T=>V.Client.prototype.getChannel.call(T);var ee,et=N(8601);ee={enumerable:!0,get:function(){return et.ListenerBuilder}},ee={enumerable:!0,get:function(){return et.RequesterBuilder}},ee={enumerable:!0,get:function(){return et.InterceptingCall}},ee={enumerable:!0,get:function(){return et.InterceptorConfigurationError}};var er=N(5993);ee={enumerable:!0,get:function(){return er.getChannelzServiceDefinition}},ee={enumerable:!0,get:function(){return er.getChannelzHandlers}};var ei=N(9601);ee={enumerable:!0,get:function(){return ei.addAdminServicesToServer}},ee=N(345);let en=N(4605),es=N(5862),ea=N(3562),eo=N(6170),eu=N(2255),ec=N(1433),ed=N(5993);(()=>{en.setup(),es.setup(),ea.setup(),eo.setup(),eu.setup(),ec.setup(),ed.setup()})()},1118:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.InternalChannel=void 0;let R=N(2528),O=N(2380),P=N(2328),M=N(7064),L=N(2678),V=N(2472),U=N(4299),$=N(492),W=N(7504),K=N(2039),Q=N(8429),Y=N(3955),Z=N(5993),ee=N(980),et=N(7931),er=N(3003),ei=N(8445),en=N(2155),es=N(4398),ea=N(1407),eo=2147483647,eu=1e3,ec=18e5,ed=new Map,eh=16777216,ep=1048576;class ef extends ea.BaseSubchannelWrapper{constructor(T,S){super(T),this.channel=S,this.refCount=0,this.subchannelStateListener=(T,N,R,O)=>{S.throttleKeepalive(O)},T.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class em{constructor(T,S,N){var ee,et,er,ei,ea,em,eg,ey;if(this.credentials=S,this.options=N,this.connectivityState=Y.ConnectivityState.IDLE,this.currentPicker=new M.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new Z.ChannelzCallTracker,this.childrenTracker=new Z.ChannelzChildrenTracker,"string"!=typeof T)throw TypeError("Channel target must be a string");if(!(S instanceof R.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(N&&"object"!=typeof N)throw TypeError("Channel options must be an object");this.originalTarget=T;let ev=(0,Q.parseUri)(T);if(null===ev)throw Error(`Could not parse target name "${T}"`);let eb=(0,$.mapUriDefaultScheme)(ev);if(null===eb)throw Error(`Could not find a default scheme for target name "${T}"`);this.callRefTimer=setInterval(()=>{},eo),null===(et=(ee=this.callRefTimer).unref)||void 0===et||et.call(ee),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new Z.ChannelzTrace,this.channelzRef=(0,Z.registerChannelzChannel)(T,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,$.getDefaultAuthority)(eb);let ew=(0,K.mapProxyName)(eb,N);this.target=ew.target,this.options=Object.assign({},this.options,ew.extraOptions),this.subchannelPool=(0,P.getSubchannelPool)((null!==(er=N["grpc.use_local_subchannel_pool"])&&void 0!==er?er:0)===0),this.retryBufferTracker=new es.MessageBufferTracker(null!==(ei=N["grpc.retry_buffer_size"])&&void 0!==ei?ei:eh,null!==(ea=N["grpc.per_rpc_retry_buffer_size"])&&void 0!==ea?ea:ep),this.keepaliveTime=null!==(em=N["grpc.keepalive_time_ms"])&&void 0!==em?em:-1,this.idleTimeoutMs=Math.max(null!==(eg=N["grpc.client_idle_timeout_ms"])&&void 0!==eg?eg:ec,eu);let eT={createSubchannel:(T,S)=>{let N=this.subchannelPool.getOrCreateSubchannel(this.target,T,Object.assign({},this.options,S),this.credentials);N.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",N.getChannelzRef());let R=new ef(N,this);return this.wrappedSubchannels.add(R),R},updateState:(T,S)=>{this.currentPicker=S;let N=this.pickQueue.slice();for(let T of(this.pickQueue=[],N.length>0&&this.callRefTimerUnref(),N))T.doPick();this.updateState(T)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:T=>{this.channelzEnabled&&this.childrenTracker.refChild(T)},removeChannelzChild:T=>{this.channelzEnabled&&this.childrenTracker.unrefChild(T)}};this.resolvingLoadBalancer=new O.ResolvingLoadBalancer(this.target,eT,N,(T,S)=>{T.retryThrottling?ed.set(this.getTarget(),new es.RetryThrottler(T.retryThrottling.maxTokens,T.retryThrottling.tokenRatio,ed.get(this.getTarget()))):ed.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=S,this.currentResolutionError=null,process.nextTick(()=>{let T=this.configSelectionQueue;for(let S of(this.configSelectionQueue=[],T.length>0&&this.callRefTimerUnref(),T))S.getConfig()})},T=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+T.code+' and details "'+T.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,en.restrictControlPlaneStatusCode)(T.code,T.details)),{metadata:T.metadata}));let S=this.configSelectionQueue;for(let N of(this.configSelectionQueue=[],S.length>0&&this.callRefTimerUnref(),S))N.reportResolverError(T)}),this.filterStackFactory=new V.FilterStackFactory([new U.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(N,void 0,2));let eS=Error();(0,W.trace)(L.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null===(ey=eS.stack)||void 0===ey?void 0:ey.substring(eS.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(T,S){(0,W.trace)(null!=S?S:L.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Q.uriToString)(this.target)+" "+T)}callRefTimerRef(){var T,S,N,R;(null===(S=(T=this.callRefTimer).hasRef)||void 0===S?void 0:S.call(T))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(R=(N=this.callRefTimer).ref)||void 0===R||R.call(N))}callRefTimerUnref(){var T,S;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(S=(T=this.callRefTimer).unref)||void 0===S||S.call(T))}removeConnectivityStateWatcher(T){let S=this.connectivityStateWatchers.findIndex(S=>S===T);S>=0&&this.connectivityStateWatchers.splice(S,1)}updateState(T){for(let S of((0,W.trace)(L.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Q.uriToString)(this.target)+" "+Y.ConnectivityState[this.connectivityState]+" -> "+Y.ConnectivityState[T]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Y.ConnectivityState[T]),this.connectivityState=T,this.connectivityStateWatchers.slice()))T!==S.currentState&&(S.timer&&clearTimeout(S.timer),this.removeConnectivityStateWatcher(S),S.callback());T!==Y.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(T){if(T>this.keepaliveTime)for(let S of(this.keepaliveTime=T,this.wrappedSubchannels))S.throttleKeepalive(T)}removeWrappedSubchannel(T){this.wrappedSubchannels.delete(T)}doPick(T,S){return this.currentPicker.pick({metadata:T,extraPickInfo:S})}queueCallForPick(T){this.pickQueue.push(T),this.callRefTimerRef()}getConfig(T,S){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(T,S)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(T){this.configSelectionQueue.push(T),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Y.ConnectivityState.IDLE),this.currentPicker=new M.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(T){var S,N;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let T=new Date().valueOf()-this.lastActivityTimestamp.valueOf();T>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-T)},T),null===(N=(S=this.idleTimer).unref)||void 0===N||N.call(S)}maybeStartIdleTimer(){this.connectivityState===Y.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(T){this.channelzEnabled&&(T.code===L.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(T,S,N,R,O){let P=(0,ei.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+P+'] method="'+S+'"'),new ee.LoadBalancingCall(this,T,S,N,R,O,P)}createRetryingCall(T,S,N,R,O){let P=(0,ei.getNextCallNumber)();return this.trace("createRetryingCall ["+P+'] method="'+S+'"'),new es.RetryingCall(this,T,S,N,R,O,P,this.retryBufferTracker,ed.get(this.getTarget()))}createInnerCall(T,S,N,R,O){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(T,S,N,R,O):this.createRetryingCall(T,S,N,R,O)}createResolvingCall(T,S,N,R,O){let P=(0,ei.getNextCallNumber)();this.trace("createResolvingCall ["+P+'] method="'+T+'", deadline='+(0,et.deadlineToString)(S));let M={deadline:S,flags:null!=O?O:L.Propagate.DEFAULTS,host:null!=N?N:this.defaultAuthority,parentCall:R},V=new er.ResolvingCall(this,T,M,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),P);return this.onCallStart(),V.addStatusWatcher(T=>{this.onCallEnd(T)}),V}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Y.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,Z.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Q.uriToString)(this.target)}getConnectivityState(T){let S=this.connectivityState;return T&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),S}watchConnectivityState(T,S,N){if(this.connectivityState===Y.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let R=null;if(S!==1/0){let T=S instanceof Date?S:new Date(S),P=new Date;if(S===-1/0||T<=P){process.nextTick(N,Error("Deadline passed without connectivity state change"));return}R=setTimeout(()=>{this.removeConnectivityStateWatcher(O),N(Error("Deadline passed without connectivity state change"))},T.getTime()-P.getTime())}let O={currentState:T,callback:N,timer:R};this.connectivityStateWatchers.push(O)}getChannelzRef(){return this.channelzRef}createCall(T,S,N,R,O){if("string"!=typeof T)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof S||S instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Y.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(T,S,N,R,O)}}S.InternalChannel=em},982:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChildLoadBalancerHandler=void 0;let R=N(7176),O=N(3955),P="child_load_balancer_helper";class M{constructor(T){this.channelControlHelper=T,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(T){this.parent=T,this.child=null}createSubchannel(T,S){return this.parent.channelControlHelper.createSubchannel(T,S)}updateState(T,S){var N;if(this.calledByPendingChild()){if(T===O.ConnectivityState.CONNECTING)return;null===(N=this.parent.currentChild)||void 0===N||N.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(T,S)}requestReresolution(){var T;let S=null!==(T=this.parent.pendingChild)&&void 0!==T?T:this.parent.currentChild;this.child===S&&this.parent.channelControlHelper.requestReresolution()}setChild(T){this.child=T}addChannelzChild(T){this.parent.channelControlHelper.addChannelzChild(T)}removeChannelzChild(T){this.parent.channelControlHelper.removeChannelzChild(T)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(T,S){return T.getLoadBalancerName()!==S.getLoadBalancerName()}updateAddressList(T,S,N){let O;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,S)){let T=new this.ChildPolicyHelper(this),N=(0,R.createLoadBalancer)(S,T);T.setChild(N),null===this.currentChild?(this.currentChild=N,O=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=N,O=this.pendingChild)}else O=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=S,O.updateAddressList(T,S,N)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return P}}S.ChildLoadBalancerHandler=M},1433:(T,S,N)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.OutlierDetectionLoadBalancer=S.OutlierDetectionLoadBalancingConfig=void 0;let O=N(3955),P=N(2678),M=N(5330),L=N(345),V=N(7176),U=N(982),$=N(7064),W=N(3906),K=N(1407),Q=N(7504),Y="outlier_detection";function Z(T){Q.trace(P.LogVerbosity.DEBUG,Y,T)}let ee="outlier_detection",et=(null!==(R=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)&&void 0!==R?R:"true")==="true",er={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},ei={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function en(T,S,N,R){if(S in T&&typeof T[S]!==N){let O=R?`${R}.${S}`:S;throw Error(`outlier detection config ${O} parse error: expected ${N}, got ${typeof T[S]}`)}}function es(T,S,N){let R=N?`${N}.${S}`:S;if(S in T){if(!(0,M.isDuration)(T[S]))throw Error(`outlier detection config ${R} parse error: expected Duration, got ${typeof T[S]}`);if(!(T[S].seconds>=0&&T[S].seconds<=315576e6&&T[S].nanos>=0&&T[S].nanos<=999999999))throw Error(`outlier detection config ${R} parse error: values out of range for non-negative Duaration`)}}function ea(T,S,N){let R=N?`${N}.${S}`:S;if(en(T,S,"number",N),S in T&&!(T[S]>=0&&T[S]<=100))throw Error(`outlier detection config ${R} parse error: value out of range for percentage (0-100)`)}class eo{constructor(T,S,N,R,O,P,M){if(this.childPolicy=M,M.length>0&&"pick_first"===M[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=T?T:1e4,this.baseEjectionTimeMs=null!=S?S:3e4,this.maxEjectionTimeMs=null!=N?N:3e5,this.maxEjectionPercent=null!=R?R:10,this.successRateEjection=O?Object.assign(Object.assign({},er),O):null,this.failurePercentageEjection=P?Object.assign(Object.assign({},ei),P):null}getLoadBalancerName(){return ee}toJsonObject(){return{interval:(0,M.msToDuration)(this.intervalMs),base_ejection_time:(0,M.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,M.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(T=>T.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(T){return new eo(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,T)}static createFromJson(T){var S;if(es(T,"interval"),es(T,"base_ejection_time"),es(T,"max_ejection_time"),ea(T,"max_ejection_percent"),"success_rate_ejection"in T){if("object"!=typeof T.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");en(T.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),ea(T.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),en(T.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),en(T.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in T){if("object"!=typeof T.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");ea(T.failure_percentage_ejection,"threshold","failure_percentage_ejection"),ea(T.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),en(T.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),en(T.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new eo(T.interval?(0,M.durationToMs)(T.interval):null,T.base_ejection_time?(0,M.durationToMs)(T.base_ejection_time):null,T.max_ejection_time?(0,M.durationToMs)(T.max_ejection_time):null,null!==(S=T.max_ejection_percent)&&void 0!==S?S:null,T.success_rate_ejection,T.failure_percentage_ejection,T.child_policy.map(V.validateLoadBalancingConfig))}}S.OutlierDetectionLoadBalancingConfig=eo;class eu extends K.BaseSubchannelWrapper{constructor(T,S){super(T),this.mapEntry=S,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=T.getConnectivityState(),T.addConnectivityStateListener((T,S,N,R)=>{if(this.childSubchannelState=N,!this.ejected)for(let T of this.stateListeners)T(this,S,N,R)})}getConnectivityState(){return this.ejected?O.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(T){this.stateListeners.push(T)}removeConnectivityStateListener(T){let S=this.stateListeners.indexOf(T);S>-1&&this.stateListeners.splice(S,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let T=this.mapEntry.subchannelWrappers.indexOf(this);T>=0&&this.mapEntry.subchannelWrappers.splice(T,1)}}eject(){for(let T of(this.ejected=!0,this.stateListeners))T(this,this.childSubchannelState,O.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let T of(this.ejected=!1,this.stateListeners))T(this,O.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function ec(){return{success:0,failure:0}}class ed{constructor(){this.activeBucket=ec(),this.inactiveBucket=ec()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=ec()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class eh{constructor(T,S){this.wrappedPicker=T,this.countCalls=S}pick(T){let S=this.wrappedPicker.pick(T);if(S.pickResultType!==$.PickResultType.COMPLETE)return S;{let T=S.subchannel,N=T.getMapEntry();if(!N)return Object.assign(Object.assign({},S),{subchannel:T.getWrappedSubchannel()});{let R=S.onCallEnded;return this.countCalls&&(R=T=>{var R;T===P.Status.OK?N.counter.addSuccess():N.counter.addFailure(),null===(R=S.onCallEnded)||void 0===R||R.call(S,T)}),Object.assign(Object.assign({},S),{subchannel:T.getWrappedSubchannel(),onCallEnded:R})}}}}class ep{constructor(T){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new U.ChildLoadBalancerHandler((0,L.createChildChannelControlHelper)(T,{createSubchannel:(S,N)=>{let R=T.createSubchannel(S,N),O=this.addressMap.get((0,W.subchannelAddressToString)(S)),P=new eu(R,O);return(null==O?void 0:O.currentEjectionTimestamp)!==null&&P.eject(),null==O||O.subchannelWrappers.push(P),P},updateState:(S,N)=>{S===O.ConnectivityState.READY?T.updateState(S,new eh(N,this.isCountingEnabled())):T.updateState(S,N)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let T=0;for(let S of this.addressMap.values())null!==S.currentEjectionTimestamp&&(T+=1);return 100*T/this.addressMap.size}runSuccessRateCheck(T){if(!this.latestConfig)return;let S=this.latestConfig.getSuccessRateEjectionConfig();if(!S)return;Z("Running success rate check");let N=S.request_volume,R=0,O=[];for(let[T,S]of this.addressMap){let P=S.counter.getLastSuccesses(),M=S.counter.getLastFailures();Z("Stats for "+T+": successes="+P+" failures="+M+" targetRequestVolume="+N),P+M>=N&&(R+=1,O.push(P/(P+M)))}if(Z("Found "+R+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+O+"]"),R<S.minimum_hosts)return;let P=O.reduce((T,S)=>T+S)/O.length,M=0;for(let T of O){let S=T-P;M+=S*S}let L=Math.sqrt(M/O.length),V=P-S.stdev_factor/1e3*L;for(let[R,O]of(Z("stdev="+L+" ejectionThreshold="+V),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let P=O.counter.getLastSuccesses(),M=O.counter.getLastFailures();if(P+M<N)continue;let L=P/(P+M);if(Z("Checking candidate "+R+" successRate="+L),L<V){let N=100*Math.random();Z("Candidate "+R+" randomNumber="+N+" enforcement_percentage="+S.enforcement_percentage),N<S.enforcement_percentage&&(Z("Ejecting candidate "+R),this.eject(O,T))}}}runFailurePercentageCheck(T){if(!this.latestConfig)return;let S=this.latestConfig.getFailurePercentageEjectionConfig();if(!S)return;Z("Running failure percentage check. threshold="+S.threshold+" request volume threshold="+S.request_volume);let N=0;for(let T of this.addressMap.values())T.counter.getLastSuccesses()+T.counter.getLastFailures()>=S.request_volume&&(N+=1);if(!(N<S.minimum_hosts))for(let[N,R]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let O=R.counter.getLastSuccesses(),P=R.counter.getLastFailures();if(Z("Candidate successes="+O+" failures="+P),!(O+P<S.request_volume)&&100*P/(P+O)>S.threshold){let O=100*Math.random();Z("Candidate "+N+" randomNumber="+O+" enforcement_percentage="+S.enforcement_percentage),O<S.enforcement_percentage&&(Z("Ejecting candidate "+N),this.eject(R,T))}}}eject(T,S){for(let S of(T.currentEjectionTimestamp=new Date,T.ejectionTimeMultiplier+=1,T.subchannelWrappers))S.eject()}uneject(T){for(let S of(T.currentEjectionTimestamp=null,T.subchannelWrappers))S.uneject()}switchAllBuckets(){for(let T of this.addressMap.values())T.counter.switchBuckets()}startTimer(T){var S,N;this.ejectionTimer=setTimeout(()=>this.runChecks(),T),null===(N=(S=this.ejectionTimer).unref)||void 0===N||N.call(S)}runChecks(){let T=new Date;if(Z("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[S,N]of(this.timerStartTime=T,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(T),this.runFailurePercentageCheck(T),this.addressMap.entries()))if(null===N.currentEjectionTimestamp)N.ejectionTimeMultiplier>0&&(N.ejectionTimeMultiplier-=1);else{let T=this.latestConfig.getBaseEjectionTimeMs(),R=this.latestConfig.getMaxEjectionTimeMs(),O=new Date(N.currentEjectionTimestamp.getTime());O.setMilliseconds(O.getMilliseconds()+Math.min(T*N.ejectionTimeMultiplier,Math.max(T,R))),O<new Date&&(Z("Unejecting "+S),this.uneject(N))}}updateAddressList(T,S,N){if(!(S instanceof eo))return;let R=new Set;for(let S of T)R.add((0,W.subchannelAddressToString)(S));for(let T of R)this.addressMap.has(T)||(Z("Adding map entry for "+T),this.addressMap.set(T,{counter:new ed,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let T of this.addressMap.keys())R.has(T)||(Z("Removing map entry for "+T),this.addressMap.delete(T));let O=(0,V.getFirstUsableConfig)(S.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(T,O,N),S.getSuccessRateEjectionConfig()||S.getFailurePercentageEjectionConfig()){if(this.timerStartTime){Z("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let T=S.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(T)}else Z("Starting new timer"),this.timerStartTime=new Date,this.startTimer(S.getIntervalMs()),this.switchAllBuckets()}else for(let T of(Z("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(T),T.ejectionTimeMultiplier=0;this.latestConfig=S}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return ee}}function ef(){et&&(0,L.registerLoadBalancerType)(ee,ep,eo)}S.OutlierDetectionLoadBalancer=ep,S.setup=ef},6170:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.PickFirstLoadBalancer=S.shuffled=S.PickFirstLoadBalancingConfig=void 0;let R=N(7176),O=N(3955),P=N(7064),M=N(7504),L=N(2678),V="pick_first";function U(T){M.trace(L.LogVerbosity.DEBUG,V,T)}let $="pick_first",W=250;class K{constructor(T){this.shuffleAddressList=T}getLoadBalancerName(){return $}toJsonObject(){return{[$]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(T){if("shuffleAddressList"in T&&"boolean"!=typeof T.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new K(!0===T.shuffleAddressList)}}S.PickFirstLoadBalancingConfig=K;class Q{constructor(T){this.subchannel=T}pick(T){return{pickResultType:P.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function Y(T){let S=T.slice();for(let T=S.length-1;T>1;T--){let N=Math.floor(Math.random()*(T+1)),R=S[T];S[T]=S[N],S[N]=R}return S}S.shuffled=Y;class Z{constructor(T){this.channelControlHelper=T,this.children=[],this.currentState=O.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(T,S,N,R,O)=>{this.onSubchannelStateUpdate(T,S,N,O)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(T=>T.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(O.ConnectivityState.READY,new Q(this.currentPick)):0===this.children.length?this.updateState(O.ConnectivityState.IDLE,new P.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(O.ConnectivityState.TRANSIENT_FAILURE,new P.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(O.ConnectivityState.CONNECTING,new P.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:T}of(this.stickyTransientFailureMode=!0,this.children))T.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let T=this.currentPick;this.currentPick=null,T.unref(),T.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(T.getChannelzRef())}}onSubchannelStateUpdate(T,S,N,R){var P;if(null===(P=this.currentPick)||void 0===P?void 0:P.realSubchannelEquals(T)){N!==O.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[S,P]of this.children.entries())if(T.realSubchannelEquals(P.subchannel)){N===O.ConnectivityState.READY&&this.pickSubchannel(P.subchannel),N===O.ConnectivityState.TRANSIENT_FAILURE&&(P.hasReportedTransientFailure=!0,R&&(this.lastError=R),this.maybeEnterStickyTransientFailureMode(),S===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(S+1)),P.subchannel.startConnecting();return}}startNextSubchannelConnecting(T){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[S,N]of this.children.entries())if(S>=T){let T=N.subchannel.getConnectivityState();if(T===O.ConnectivityState.IDLE||T===O.ConnectivityState.CONNECTING){this.startConnecting(S);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(T){var S,N;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=T,this.children[T].subchannel.getConnectivityState()===O.ConnectivityState.IDLE&&(U("Start connecting to subchannel with address "+this.children[T].subchannel.getAddress()),process.nextTick(()=>{var S;null===(S=this.children[T])||void 0===S||S.subchannel.startConnecting()})),this.connectionDelayTimeout=null===(N=(S=setTimeout(()=>{this.startNextSubchannelConnecting(T+1)},W)).unref)||void 0===N?void 0:N.call(S)}pickSubchannel(T){this.currentPick&&T.realSubchannelEquals(this.currentPick)||(U("Pick subchannel with address "+T.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=T,T.ref(),this.channelControlHelper.addChannelzChild(T.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(T,S){U(O.ConnectivityState[this.currentState]+" -> "+O.ConnectivityState[T]),this.currentState=T,this.channelControlHelper.updateState(T,S)}resetSubchannelList(){for(let T of this.children)this.currentPick&&T.subchannel.realSubchannelEquals(this.currentPick)||T.subchannel.removeConnectivityStateListener(this.subchannelStateListener),T.subchannel.unref(),this.channelControlHelper.removeChannelzChild(T.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(T){let S=T.map(T=>({subchannel:this.channelControlHelper.createSubchannel(T,{}),hasReportedTransientFailure:!1}));for(let{subchannel:T}of S)T.ref(),this.channelControlHelper.addChannelzChild(T.getChannelzRef());for(let{subchannel:T}of(this.resetSubchannelList(),this.children=S,this.children))if(T.addConnectivityStateListener(this.subchannelStateListener),T.getConnectivityState()===O.ConnectivityState.READY){this.pickSubchannel(T);return}for(let T of this.children)T.subchannel.getConnectivityState()===O.ConnectivityState.TRANSIENT_FAILURE&&(T.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(T,S){S instanceof K&&(S.getShuffleAddressList()&&(T=Y(T)),this.latestAddressList=T,this.connectToAddressList(T))}exitIdle(){this.currentState===O.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return $}}function ee(){(0,R.registerLoadBalancerType)($,Z,K),(0,R.registerDefaultLoadBalancerType)($)}S.PickFirstLoadBalancer=Z,S.setup=ee},2255:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.RoundRobinLoadBalancer=void 0;let R=N(7176),O=N(3955),P=N(7064),M=N(3906),L=N(7504),V=N(2678),U="round_robin";function $(T){L.trace(V.LogVerbosity.DEBUG,U,T)}let W="round_robin";class K{getLoadBalancerName(){return W}constructor(){}toJsonObject(){return{[W]:{}}}static createFromJson(T){return new K}}class Q{constructor(T,S=0){this.subchannelList=T,this.nextIndex=S}pick(T){let S=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:P.PickResultType.COMPLETE,subchannel:S,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class Y{constructor(T){this.channelControlHelper=T,this.subchannels=[],this.currentState=O.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(T,S,N,R,P)=>{this.calculateAndUpdateState(),(N===O.ConnectivityState.TRANSIENT_FAILURE||N===O.ConnectivityState.IDLE)&&(P&&(this.lastError=P),this.channelControlHelper.requestReresolution(),T.startConnecting())}}countSubchannelsWithState(T){return this.subchannels.filter(S=>S.getConnectivityState()===T).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(O.ConnectivityState.READY)>0){let T=this.subchannels.filter(T=>T.getConnectivityState()===O.ConnectivityState.READY),S=0;null!==this.currentReadyPicker&&(S=T.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(S=0),this.updateState(O.ConnectivityState.READY,new Q(T,S))}else this.countSubchannelsWithState(O.ConnectivityState.CONNECTING)>0?this.updateState(O.ConnectivityState.CONNECTING,new P.QueuePicker(this)):this.countSubchannelsWithState(O.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(O.ConnectivityState.TRANSIENT_FAILURE,new P.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(O.ConnectivityState.IDLE,new P.QueuePicker(this))}updateState(T,S){$(O.ConnectivityState[this.currentState]+" -> "+O.ConnectivityState[T]),T===O.ConnectivityState.READY?this.currentReadyPicker=S:this.currentReadyPicker=null,this.currentState=T,this.channelControlHelper.updateState(T,S)}resetSubchannelList(){for(let T of this.subchannels)T.removeConnectivityStateListener(this.subchannelStateListener),T.unref(),this.channelControlHelper.removeChannelzChild(T.getChannelzRef());this.subchannels=[]}updateAddressList(T,S){for(let S of(this.resetSubchannelList(),$("Connect to address list "+T.map(T=>(0,M.subchannelAddressToString)(T))),this.subchannels=T.map(T=>this.channelControlHelper.createSubchannel(T,{})),this.subchannels)){S.ref(),S.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(S.getChannelzRef());let T=S.getConnectivityState();(T===O.ConnectivityState.IDLE||T===O.ConnectivityState.TRANSIENT_FAILURE)&&S.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let T of this.subchannels)T.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return W}}function Z(){(0,R.registerLoadBalancerType)(W,Y,K)}S.RoundRobinLoadBalancer=Y,S.setup=Z},7176:(T,S)=>{"use strict";function N(T,S){var N,R,O,P,M,L,V,U,$,W;return{createSubchannel:null!==(R=null===(N=S.createSubchannel)||void 0===N?void 0:N.bind(S))&&void 0!==R?R:T.createSubchannel.bind(T),updateState:null!==(P=null===(O=S.updateState)||void 0===O?void 0:O.bind(S))&&void 0!==P?P:T.updateState.bind(T),requestReresolution:null!==(L=null===(M=S.requestReresolution)||void 0===M?void 0:M.bind(S))&&void 0!==L?L:T.requestReresolution.bind(T),addChannelzChild:null!==(U=null===(V=S.addChannelzChild)||void 0===V?void 0:V.bind(S))&&void 0!==U?U:T.addChannelzChild.bind(T),removeChannelzChild:null!==(W=null===($=S.removeChannelzChild)||void 0===$?void 0:$.bind(S))&&void 0!==W?W:T.removeChannelzChild.bind(T)}}Object.defineProperty(S,"__esModule",{value:!0}),S.validateLoadBalancingConfig=S.getFirstUsableConfig=S.isLoadBalancerNameRegistered=S.createLoadBalancer=S.registerDefaultLoadBalancerType=S.registerLoadBalancerType=S.createChildChannelControlHelper=void 0,S.createChildChannelControlHelper=N;let R={},O=null;function P(T,S,N){R[T]={LoadBalancer:S,LoadBalancingConfig:N}}function M(T){O=T}function L(T,S){let N=T.getLoadBalancerName();return N in R?new R[N].LoadBalancer(S):null}function V(T){return T in R}function U(T,S=!1){for(let S of T)if(S.getLoadBalancerName() in R)return S;return S&&O?new R[O].LoadBalancingConfig:null}function $(T){if(!(null!==T&&"object"==typeof T))throw Error("Load balancing config must be an object");let S=Object.keys(T);if(1!==S.length)throw Error("Provided load balancing config has multiple conflicting entries");let N=S[0];if(N in R)return R[N].LoadBalancingConfig.createFromJson(T[N]);throw Error(`Unrecognized load balancing config name ${N}`)}S.registerLoadBalancerType=P,S.registerDefaultLoadBalancerType=M,S.createLoadBalancer=L,S.isLoadBalancerNameRegistered=V,S.getFirstUsableConfig=U,S.validateLoadBalancingConfig=$},980:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.LoadBalancingCall=void 0;let R=N(3955),O=N(2678),P=N(7931),M=N(2252),L=N(7064),V=N(8429),U=N(7504),$=N(2155),W=N(5158),K="load_balancing_call";class Q{constructor(T,S,N,R,O,P,M){var L,U;this.channel=T,this.callConfig=S,this.methodName=N,this.host=R,this.credentials=O,this.deadline=P,this.callNumber=M,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let $=this.methodName.split("/"),W="";$.length>=2&&(W=$[1]);let K=null!==(U=null===(L=(0,V.splitHostPort)(this.host))||void 0===L?void 0:L.host)&&void 0!==U?U:"localhost";this.serviceUrl=`https://${K}/${W}`}trace(T){U.trace(O.LogVerbosity.DEBUG,K,"["+this.callNumber+"] "+T)}outputStatus(T,S){var N,R;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+T.code+' details="'+T.details+'"');let O=Object.assign(Object.assign({},T),{progress:S});null===(N=this.listener)||void 0===N||N.onReceiveStatus(O),null===(R=this.onCallEnded)||void 0===R||R.call(this,O.code)}}doPick(){var T,S;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let N=this.channel.doPick(this.metadata,this.callConfig.pickInformation),V=N.subchannel?"("+N.subchannel.getChannelzRef().id+") "+N.subchannel.getAddress():""+N.subchannel;switch(this.trace("Pick result: "+L.PickResultType[N.pickResultType]+" subchannel: "+V+" status: "+(null===(T=N.status)||void 0===T?void 0:T.code)+" "+(null===(S=N.status)||void 0===S?void 0:S.details)),N.pickResultType){case L.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(T=>{var S,L,U;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let $=this.metadata.clone();if($.merge(T),$.get("authorization").length>1&&this.outputStatus({code:O.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new M.Metadata},"PROCESSED"),N.subchannel.getConnectivityState()!==R.ConnectivityState.READY){this.trace("Picked subchannel "+V+" has state "+R.ConnectivityState[N.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&$.set("grpc-timeout",(0,P.getDeadlineTimeoutString)(this.deadline));try{this.child=N.subchannel.getRealSubchannel().createCall($,this.host,this.methodName,{onReceiveMetadata:T=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(T)},onReceiveMessage:T=>{this.trace("Received message"),this.listener.onReceiveMessage(T)},onReceiveStatus:T=>{this.trace("Received status"),T.rstCode===W.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(T,"REFUSED"):this.outputStatus(T,"PROCESSED")}})}catch(T){this.trace("Failed to start call on picked subchannel "+V+" with error "+T.message),this.outputStatus({code:O.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+T.message,metadata:new M.Metadata},"NOT_STARTED");return}null===(L=(S=this.callConfig).onCommitted)||void 0===L||L.call(S),null===(U=N.onCallStarted)||void 0===U||U.call(N),this.onCallEnded=N.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},T=>{let{code:S,details:N}=(0,$.restrictControlPlaneStatusCode)("number"==typeof T.code?T.code:O.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${T.message}`);this.outputStatus({code:S,details:N,metadata:new M.Metadata},"PROCESSED")});break;case L.PickResultType.DROP:let{code:U,details:K}=(0,$.restrictControlPlaneStatusCode)(N.status.code,N.status.details);setImmediate(()=>{this.outputStatus({code:U,details:K,metadata:N.status.metadata},"DROP")});break;case L.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:T,details:S}=(0,$.restrictControlPlaneStatusCode)(N.status.code,N.status.details);setImmediate(()=>{this.outputStatus({code:T,details:S,metadata:N.status.metadata},"PROCESSED")})}break;case L.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(T,S){var N;this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),null===(N=this.child)||void 0===N||N.cancelWithStatus(T,S),this.outputStatus({code:T,details:S,metadata:new M.Metadata},"PROCESSED")}getPeer(){var T,S;return null!==(S=null===(T=this.child)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:this.channel.getTarget()}start(T,S){this.trace("start called"),this.listener=S,this.metadata=T,this.doPick()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length),this.child?this.child.sendMessageWithContext(T,S):this.pendingMessage={context:T,message:S}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(T){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}S.LoadBalancingCall=Q},7504:(T,S,N)=>{"use strict";var R,O,P,M;Object.defineProperty(S,"__esModule",{value:!0}),S.isTracerEnabled=S.trace=S.log=S.setLoggerVerbosity=S.setLogger=S.getLogger=void 0;let L=N(2678),V=N(7282),U=N(1513).i8,$={error:(T,...S)=>{console.error("E "+T,...S)},info:(T,...S)=>{console.error("I "+T,...S)},debug:(T,...S)=>{console.error("D "+T,...S)}},W=L.LogVerbosity.ERROR;switch((null!==(O=null!==(R=process.env.GRPC_NODE_VERBOSITY)&&void 0!==R?R:process.env.GRPC_VERBOSITY)&&void 0!==O?O:"").toUpperCase()){case"DEBUG":W=L.LogVerbosity.DEBUG;break;case"INFO":W=L.LogVerbosity.INFO;break;case"ERROR":W=L.LogVerbosity.ERROR;break;case"NONE":W=L.LogVerbosity.NONE}let K=()=>$;S.getLogger=K;let Q=T=>{$=T};S.setLogger=Q;let Y=T=>{W=T};S.setLoggerVerbosity=Y;let Z=(T,...S)=>{let N;if(T>=W){switch(T){case L.LogVerbosity.DEBUG:N=$.debug;break;case L.LogVerbosity.INFO:N=$.info;break;case L.LogVerbosity.ERROR:N=$.error}N||(N=$.error),N&&N.bind($)(...S)}};S.log=Z;let ee=null!==(M=null!==(P=process.env.GRPC_NODE_TRACE)&&void 0!==P?P:process.env.GRPC_TRACE)&&void 0!==M?M:"",et=new Set,er=new Set;for(let T of ee.split(","))T.startsWith("-")?er.add(T.substring(1)):et.add(T);let ei=et.has("all");function en(T,N,R){es(N)&&(0,S.log)(T,new Date().toISOString()+" | v"+U+" "+V.pid+" | "+N+" | "+R)}function es(T){return!er.has(T)&&(ei||et.has(T))}S.trace=en,S.isTracerEnabled=es},5085:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.loadPackageDefinition=S.makeClientConstructor=void 0;let R=N(9800),O={unary:R.Client.prototype.makeUnaryRequest,server_stream:R.Client.prototype.makeServerStreamRequest,client_stream:R.Client.prototype.makeClientStreamRequest,bidi:R.Client.prototype.makeBidiStreamRequest};function P(T){return["__proto__","prototype","constructor"].includes(T)}function M(T,S,N){N||(N={});class M extends R.Client{}return Object.keys(T).forEach(S=>{let N;if(P(S))return;let R=T[S];if("string"==typeof S&&"$"===S.charAt(0))throw Error("Method names cannot start with $");N=R.requestStream?R.responseStream?"bidi":"client_stream":R.responseStream?"server_stream":"unary";let V=R.requestSerialize,U=R.responseDeserialize,$=L(O[N],R.path,V,U);M.prototype[S]=$,Object.assign(M.prototype[S],R),R.originalName&&!P(R.originalName)&&(M.prototype[R.originalName]=M.prototype[S])}),M.service=T,M.serviceName=S,M}function L(T,S,N,R){return function(...O){return T.call(this,S,N,R,...O)}}function V(T){return"format"in T}function U(T){let S={};for(let N in T)if(Object.prototype.hasOwnProperty.call(T,N)){let R=T[N],O=N.split(".");if(O.some(T=>P(T)))continue;let L=O[O.length-1],U=S;for(let T of O.slice(0,-1))U[T]||(U[T]={}),U=U[T];V(R)?U[L]=R:U[L]=M(R,L,{})}return S}S.makeClientConstructor=M,S.loadPackageDefinition=U},2252:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Metadata=void 0;let R=N(7504),O=N(2678),P=N(5437),M=/^[0-9a-z_.-]+$/,L=/^[ -~]*$/;function V(T){return M.test(T)}function U(T){return L.test(T)}function $(T){return T.endsWith("-bin")}function W(T){return!T.startsWith("grpc-")}function K(T){return T.toLowerCase()}function Q(T,S){if(!V(T))throw Error('Metadata key "'+T+'" contains illegal characters');if(null!=S){if($(T)){if(!Buffer.isBuffer(S))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(S))throw Error("keys that don't end with '-bin' must have String values");if(!U(S))throw Error('Metadata string value "'+S+'" contains illegal characters')}}}class Y{constructor(T={}){this.internalRepr=new Map,this.options=T}set(T,S){Q(T=K(T),S),this.internalRepr.set(T,[S])}add(T,S){Q(T=K(T),S);let N=this.internalRepr.get(T);void 0===N?this.internalRepr.set(T,[S]):N.push(S)}remove(T){T=K(T),this.internalRepr.delete(T)}get(T){return T=K(T),this.internalRepr.get(T)||[]}getMap(){let T={};for(let[S,N]of this.internalRepr)if(N.length>0){let R=N[0];T[S]=Buffer.isBuffer(R)?Buffer.from(R):R}return T}clone(){let T=new Y(this.options),S=T.internalRepr;for(let[T,N]of this.internalRepr){let R=N.map(T=>Buffer.isBuffer(T)?Buffer.from(T):T);S.set(T,R)}return T}merge(T){for(let[S,N]of T.internalRepr){let T=(this.internalRepr.get(S)||[]).concat(N);this.internalRepr.set(S,T)}}setOptions(T){this.options=T}getOptions(){return this.options}toHttp2Headers(){let T={};for(let[S,N]of this.internalRepr)T[S]=N.map(Z);return T}toJSON(){let T={};for(let[S,N]of this.internalRepr)T[S]=N;return T}static fromHttp2Headers(T){let S=new Y;for(let N of Object.keys(T)){if(":"===N.charAt(0))continue;let M=T[N];try{$(N)?Array.isArray(M)?M.forEach(T=>{S.add(N,Buffer.from(T,"base64"))}):void 0!==M&&(W(N)?M.split(",").forEach(T=>{S.add(N,Buffer.from(T.trim(),"base64"))}):S.add(N,Buffer.from(M,"base64"))):Array.isArray(M)?M.forEach(T=>{S.add(N,T)}):void 0!==M&&S.add(N,M)}catch(S){let T=`Failed to add metadata entry ${N}: ${M}. ${(0,P.getErrorMessage)(S)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,R.log)(O.LogVerbosity.ERROR,T)}}return S}}S.Metadata=Y;let Z=T=>Buffer.isBuffer(T)?T.toString("base64"):T},7064:(T,S,N)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.QueuePicker=S.UnavailablePicker=S.PickResultType=void 0;let O=N(2252),P=N(2678);!function(T){T[T.COMPLETE=0]="COMPLETE",T[T.QUEUE=1]="QUEUE",T[T.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",T[T.DROP=3]="DROP"}(R||(S.PickResultType=R={}));class M{constructor(T){this.status=Object.assign({code:P.Status.UNAVAILABLE,details:"No connection established",metadata:new O.Metadata},T)}pick(T){return{pickResultType:R.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}S.UnavailablePicker=M;class L{constructor(T){this.loadBalancer=T,this.calledExitIdle=!1}pick(T){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:R.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}S.QueuePicker=L},4605:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.DEFAULT_PORT=void 0;let R=N(492),O=N(9523),P=N(3837),M=N(6262),L=N(2678),V=N(2252),U=N(7504),$=N(2678),W=N(8429),K=N(1808),Q=N(4934),Y="dns_resolver";function Z(T){U.trace($.LogVerbosity.DEBUG,Y,T)}S.DEFAULT_PORT=443;let ee=3e4,et=P.promisify(O.resolveTxt),er=P.promisify(O.lookup);function ei(...T){let S=[];for(let N=0;N<Math.max.apply(null,T.map(T=>T.length));N++)for(let R of T)N<R.length&&S.push(R[N]);return S}class en{constructor(T,N,R){var O,P,M;this.target=T,this.listener=N,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,Z("Resolver constructed for target "+(0,W.uriToString)(T));let U=(0,W.splitHostPort)(T.path);null===U?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,K.isIPv4)(U.host)||(0,K.isIPv6)(U.host)?(this.ipResult=[{host:U.host,port:null!==(O=U.port)&&void 0!==O?O:S.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=U.host,this.port=null!==(P=U.port)&&void 0!==P?P:S.DEFAULT_PORT),this.percentage=100*Math.random(),1===R["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:L.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,W.uriToString)(this.target)}`,metadata:new V.Metadata};let $={initialDelay:R["grpc.initial_reconnect_backoff_ms"],maxDelay:R["grpc.max_reconnect_backoff_ms"]};this.backoff=new Q.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},$),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!==(M=R["grpc.dns_min_time_between_resolutions_ms"])&&void 0!==M?M:ee,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(Z("Returning IP address for target "+(0,W.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)Z("Failed to parse DNS address "+(0,W.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:L.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,W.uriToString)(this.target)}`,metadata:new V.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;Z("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let T=this.dnsHostname;this.pendingLookupPromise=er(T,{all:!0}),this.pendingLookupPromise.then(T=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let S=T.filter(T=>4===T.family),N=T.filter(T=>6===T.family);this.latestLookupResult=ei(N,S).map(T=>({host:T.address,port:+this.port}));let R="["+this.latestLookupResult.map(T=>T.host+":"+T.port).join(",")+"]";if(Z("Resolved addresses for target "+(0,W.uriToString)(this.target)+": "+R),0===this.latestLookupResult.length){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},T=>{null!==this.pendingLookupPromise&&(Z("Resolution error for target "+(0,W.uriToString)(this.target)+": "+T.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=et(T),this.pendingTxtPromise.then(T=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,M.extractAndSelectServiceConfig)(T,this.percentage)}catch(T){this.latestServiceConfigError={code:L.Status.UNAVAILABLE,details:`Parsing service config failed with error ${T.message}`,metadata:new V.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},T=>{}))}}startNextResolutionTimer(){var T,S;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null===(S=(T=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)||void 0===S?void 0:S.call(T),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?Z('resolution update delayed by "min time between resolutions" rate limit'):Z("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(T){return T.path}}function es(){(0,R.registerResolver)("dns",en),(0,R.registerDefaultScheme)("dns")}S.setup=es},3562:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=void 0;let R=N(1808),O=N(2678),P=N(2252),M=N(492),L=N(8429),V=N(7504),U="ip_resolver";function $(T){V.trace(O.LogVerbosity.DEBUG,U,T)}let W="ipv4",K="ipv6",Q=443;class Y{constructor(T,S,N){var M;this.listener=S,this.addresses=[],this.error=null,this.hasReturnedResult=!1,$("Resolver constructed for target "+(0,L.uriToString)(T));let V=[];if(!(T.scheme===W||T.scheme===K)){this.error={code:O.Status.UNAVAILABLE,details:`Unrecognized scheme ${T.scheme} in IP resolver`,metadata:new P.Metadata};return}for(let S of T.path.split(",")){let N=(0,L.splitHostPort)(S);if(null===N||T.scheme===W&&!(0,R.isIPv4)(N.host)||T.scheme===K&&!(0,R.isIPv6)(N.host)){this.error={code:O.Status.UNAVAILABLE,details:`Failed to parse ${T.scheme} address ${S}`,metadata:new P.Metadata};return}V.push({host:N.host,port:null!==(M=N.port)&&void 0!==M?M:Q})}this.addresses=V,$("Parsed "+T.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(T){return T.path.split(",")[0]}}function Z(){(0,M.registerResolver)(W,Y),(0,M.registerResolver)(K,Y)}S.setup=Z},5862:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=void 0;let R=N(492);class O{constructor(T,S,N){let R;this.listener=S,this.addresses=[],this.hasReturnedResult=!1,R=""===T.authority?"/"+T.path:T.path,this.addresses=[{path:R}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(T){return"localhost"}}function P(){(0,R.registerResolver)("unix",O)}S.setup=P},492:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.mapUriDefaultScheme=S.getDefaultAuthority=S.createResolver=S.registerDefaultScheme=S.registerResolver=void 0;let R=N(8429),O={},P=null;function M(T,S){O[T]=S}function L(T){P=T}function V(T,S,N){if(void 0!==T.scheme&&T.scheme in O)return new O[T.scheme](T,S,N);throw Error(`No resolver could be created for target ${(0,R.uriToString)(T)}`)}function U(T){if(void 0!==T.scheme&&T.scheme in O)return O[T.scheme].getDefaultAuthority(T);throw Error(`Invalid target ${(0,R.uriToString)(T)}`)}function $(T){return void 0!==T.scheme&&T.scheme in O?T:null!==P?{scheme:P,authority:void 0,path:(0,R.uriToString)(T)}:null}S.registerResolver=M,S.registerDefaultScheme=L,S.createResolver=V,S.getDefaultAuthority=U,S.mapUriDefaultScheme=$},3003:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ResolvingCall=void 0;let R=N(2678),O=N(7931),P=N(2252),M=N(7504),L=N(2155),V="resolving_call";class U{constructor(T,S,N,P,M,L){this.channel=T,this.method=S,this.filterStackFactory=P,this.credentials=M,this.callNumber=L,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=N.deadline,this.host=N.host,N.parentCall&&(N.flags&R.Propagate.CANCELLATION&&N.parentCall.on("cancelled",()=>{this.cancelWithStatus(R.Status.CANCELLED,"Cancelled by parent call")}),N.flags&R.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+N.parentCall.getDeadline()),this.deadline=(0,O.minDeadline)(this.deadline,N.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(T){M.trace(R.LogVerbosity.DEBUG,V,"["+this.callNumber+"] "+T)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,O.deadlineToString)(this.deadline));let T=(0,O.getRelativeTimeout)(this.deadline);if(T!==1/0){this.trace("Deadline will be reached in "+T+"ms");let S=()=>{this.cancelWithStatus(R.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};T<=0?process.nextTick(S):this.deadlineTimer=setTimeout(S,T)}}outputStatus(T){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let S=this.filterStack.receiveTrailers(T);this.trace("ended with status: code="+S.code+' details="'+S.details+'"'),this.statusWatchers.forEach(T=>T(S)),process.nextTick(()=>{var T;null===(T=this.listener)||void 0===T||T.onReceiveStatus(S)})}}sendMessageOnChild(T,S){if(!this.child)throw Error("sendMessageonChild called with child not populated");let N=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:S,flags:T.flags})).then(S=>{this.writeFilterPending=!1,N.sendMessageWithContext(T,S.message),this.pendingHalfClose&&N.halfClose()},T=>{this.cancelWithStatus(T.code,T.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let T=this.channel.getConfig(this.method,this.metadata);if("NONE"===T.type){this.channel.queueCallForConfig(this);return}if("ERROR"===T.type){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(T.error);return}let S=T.config;if(S.status!==R.Status.OK){let{code:T,details:N}=(0,L.restrictControlPlaneStatusCode)(S.status,"Failed to route call to method "+this.method);this.outputStatus({code:T,details:N,metadata:new P.Metadata});return}if(S.methodConfig.timeout){let T=new Date;T.setSeconds(T.getSeconds()+S.methodConfig.timeout.seconds),T.setMilliseconds(T.getMilliseconds()+S.methodConfig.timeout.nanos/1e6),this.deadline=(0,O.minDeadline)(this.deadline,T),this.runDeadlineTimer()}this.filterStackFactory.push(S.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(T=>{this.child=this.channel.createInnerCall(S,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(T,{onReceiveMetadata:T=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(T))},onReceiveMessage:T=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(T).then(T=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(T),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},T=>{this.cancelWithStatus(T.code,T.details)})},onReceiveStatus:T=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=T:this.outputStatus(T)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},T=>{this.outputStatus(T)})}reportResolverError(T){var S;(null===(S=this.metadata)||void 0===S?void 0:S.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(T)}cancelWithStatus(T,S){var N;this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),null===(N=this.child)||void 0===N||N.cancelWithStatus(T,S),this.outputStatus({code:T,details:S,metadata:new P.Metadata})}getPeer(){var T,S;return null!==(S=null===(T=this.child)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:this.channel.getTarget()}start(T,S){this.trace("start called"),this.metadata=T.clone(),this.listener=S,this.getConfig()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length),this.child?this.sendMessageOnChild(T,S):this.pendingMessage={context:T,message:S}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(T){this.credentials=this.credentials.compose(T)}addStatusWatcher(T){this.statusWatchers.push(T)}getCallNumber(){return this.callNumber}}S.ResolvingCall=U},2380:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ResolvingLoadBalancer=void 0;let R=N(7176),O=N(6262),P=N(3955),M=N(492),L=N(7064),V=N(4934),U=N(2678),$=N(2252),W=N(7504),K=N(2678),Q=N(8429),Y=N(982),Z="resolving_load_balancer";function ee(T){W.trace(K.LogVerbosity.DEBUG,Z,T)}let et=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function er(T,S,N,R){for(let O of N.name)switch(R){case"EMPTY":if(!O.service&&!O.method)return!0;break;case"SERVICE":if(O.service===T&&!O.method)return!0;break;case"SERVICE_AND_METHOD":if(O.service===T&&O.method===S)return!0}return!1}function ei(T,S,N,R){for(let O of N)if(er(T,S,O,R))return O;return null}function en(T){return function(S,N){var R,O;let P=S.split("/").filter(T=>T.length>0),M=null!==(R=P[0])&&void 0!==R?R:"",L=null!==(O=P[1])&&void 0!==O?O:"";if(T&&T.methodConfig)for(let S of et){let N=ei(M,L,T.methodConfig,S);if(N)return{methodConfig:N,pickInformation:{},status:U.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:U.Status.OK,dynamicFilterFactories:[]}}}class es{constructor(T,S,N,W,K){this.target=T,this.channelControlHelper=S,this.onSuccessfulResolution=W,this.onFailedResolution=K,this.latestChildState=P.ConnectivityState.IDLE,this.latestChildPicker=new L.QueuePicker(this),this.currentState=P.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,N["grpc.service_config"]?this.defaultServiceConfig=(0,O.validateServiceConfig)(JSON.parse(N["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(P.ConnectivityState.IDLE,new L.QueuePicker(this)),this.childLoadBalancer=new Y.ChildLoadBalancerHandler({createSubchannel:S.createSubchannel.bind(S),requestReresolution:()=>{this.backoffTimeout.isRunning()?(ee("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(T,S)=>{this.latestChildState=T,this.latestChildPicker=S,this.updateState(T,S)},addChannelzChild:S.addChannelzChild.bind(S),removeChannelzChild:S.removeChannelzChild.bind(S)}),this.innerResolver=(0,M.createResolver)(T,{onSuccessfulResolution:(T,S,N,O,P)=>{var M;this.backoffTimeout.stop(),this.backoffTimeout.reset();let L=null;null===S?null===N?(this.previousServiceConfig=null,L=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(N):L=this.previousServiceConfig:(L=S,this.previousServiceConfig=S);let V=null!==(M=null==L?void 0:L.loadBalancingConfig)&&void 0!==M?M:[],W=(0,R.getFirstUsableConfig)(V,!0);if(null===W){this.handleResolutionFailure({code:U.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new $.Metadata});return}this.childLoadBalancer.updateAddressList(T,W,P);let K=null!=L?L:this.defaultServiceConfig;this.onSuccessfulResolution(K,null!=O?O:en(K))},onError:T=>{this.handleResolutionFailure(T)}},N);let Q={initialDelay:N["grpc.initial_reconnect_backoff_ms"],maxDelay:N["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new V.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},Q),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===P.ConnectivityState.IDLE&&this.updateState(P.ConnectivityState.CONNECTING,new L.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(T,S){ee((0,Q.uriToString)(this.target)+" "+P.ConnectivityState[this.currentState]+" -> "+P.ConnectivityState[T]),T===P.ConnectivityState.IDLE&&(S=new L.QueuePicker(this)),this.currentState=T,this.channelControlHelper.updateState(T,S)}handleResolutionFailure(T){this.latestChildState===P.ConnectivityState.IDLE&&(this.updateState(P.ConnectivityState.TRANSIENT_FAILURE,new L.UnavailablePicker(T)),this.onFailedResolution(T))}exitIdle(){(this.currentState===P.ConnectivityState.IDLE||this.currentState===P.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(T,S){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=P.ConnectivityState.IDLE,this.latestChildPicker=new L.QueuePicker(this),this.currentState=P.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}S.ResolvingLoadBalancer=es},4398:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.RetryingCall=S.MessageBufferTracker=S.RetryThrottler=void 0;let R=N(2678),O=N(2252),P=N(7504),M="retrying_call";class L{constructor(T,S,N){this.maxTokens=T,this.tokenRatio=S,N?this.tokens=N.tokens*(T/N.maxTokens):this.tokens=T}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}S.RetryThrottler=L;class V{constructor(T,S){this.totalLimit=T,this.limitPerCall=S,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(T,S){var N;let R=null!==(N=this.allocatedPerCall.get(S))&&void 0!==N?N:0;return!(this.limitPerCall-R<T)&&!(this.totalLimit-this.totalAllocated<T)&&(this.allocatedPerCall.set(S,R+T),this.totalAllocated+=T,!0)}free(T,S){var N;if(this.totalAllocated<T)throw Error(`Invalid buffer allocation state: call ${S} freed ${T} > total allocated ${this.totalAllocated}`);this.totalAllocated-=T;let R=null!==(N=this.allocatedPerCall.get(S))&&void 0!==N?N:0;if(R<T)throw Error(`Invalid buffer allocation state: call ${S} freed ${T} > allocated for call ${R}`);this.allocatedPerCall.set(S,R-T)}freeAll(T){var S;let N=null!==(S=this.allocatedPerCall.get(T))&&void 0!==S?S:0;if(this.totalAllocated<N)throw Error(`Invalid buffer allocation state: call ${T} allocated ${N} > total allocated ${this.totalAllocated}`);this.totalAllocated-=N,this.allocatedPerCall.delete(T)}}S.MessageBufferTracker=V;let U="grpc-previous-rpc-attempts";class ${constructor(T,S,N,R,O,P,M,L,V){if(this.channel=T,this.callConfig=S,this.methodName=N,this.host=R,this.credentials=O,this.deadline=P,this.callNumber=M,this.bufferTracker=L,this.retryThrottler=V,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,S.methodConfig.retryPolicy){this.state="RETRY";let T=S.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(T.initialBackoff.substring(0,T.initialBackoff.length-1))}else S.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(T){P.trace(R.LogVerbosity.DEBUG,M,"["+this.callNumber+"] "+T)}reportStatus(T){this.trace("ended with status: code="+T.code+' details="'+T.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var S;null===(S=this.listener)||void 0===S||S.onReceiveStatus({code:T.code,details:T.details,metadata:T.metadata})})}cancelWithStatus(T,S){for(let{call:N}of(this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),this.reportStatus({code:T,details:S,metadata:new O.Metadata}),this.underlyingCalls))N.cancelWithStatus(T,S)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(T){var S;return null!==(S=this.writeBuffer[T-this.writeBufferOffset])&&void 0!==S?S:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let T=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let S=this.writeBufferOffset;S<T;S++){let T=this.getBufferEntry(S);T.allocated&&this.bufferTracker.free(T.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(T-this.writeBufferOffset),this.writeBufferOffset=T}commitCall(T){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[T].state){this.trace("Committing call ["+this.underlyingCalls[T].call.getCallNumber()+"] at index "+T),this.state="COMMITTED",this.committedCallIndex=T;for(let S=0;S<this.underlyingCalls.length;S++)S!==T&&"COMPLETED"!==this.underlyingCalls[S].state&&(this.underlyingCalls[S].state="COMPLETED",this.underlyingCalls[S].call.cancelWithStatus(R.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let T=-1,S=-1;for(let[N,R]of this.underlyingCalls.entries())"ACTIVE"===R.state&&R.nextMessageToSend>T&&(T=R.nextMessageToSend,S=N);-1===S?this.state="TRANSPARENT_ONLY":this.commitCall(S)}isStatusCodeInList(T,S){return T.some(T=>T===S||T.toString().toLowerCase()===R.Status[S].toLowerCase())}getNextRetryBackoffMs(){var T;let S=null===(T=this.callConfig)||void 0===T?void 0:T.methodConfig.retryPolicy;if(!S)return 0;let N=Math.random()*this.nextRetryBackoffSec*1e3,R=Number(S.maxBackoff.substring(0,S.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*S.backoffMultiplier,R),N}maybeRetryCall(T,S){let N;if("RETRY"!==this.state){S(!1);return}let R=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(R.maxAttempts,5)){S(!1);return}if(null===T)N=this.getNextRetryBackoffMs();else if(T<0){this.state="TRANSPARENT_ONLY",S(!1);return}else N=T,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var T,N;if("RETRY"!==this.state){S(!1);return}(null===(N=null===(T=this.retryThrottler)||void 0===T?void 0:T.canRetryCall())||void 0===N||N)&&(S(!0),this.attempts+=1,this.startNewAttempt())},N)}countActiveCalls(){let T=0;for(let S of this.underlyingCalls)(null==S?void 0:S.state)==="ACTIVE"&&(T+=1);return T}handleProcessedStatus(T,S,N){var R,O,P;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(S),this.reportStatus(T);break;case"HEDGING":if(this.isStatusCodeInList(null!==(R=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)&&void 0!==R?R:[],T.code)){let R;if(null===(O=this.retryThrottler)||void 0===O||O.addCallFailed(),null===N)R=0;else if(N<0){this.state="TRANSPARENT_ONLY",this.commitCall(S),this.reportStatus(T);return}else R=N;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(S),this.reportStatus(T))},R)}else this.commitCall(S),this.reportStatus(T);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,T.code)?(null===(P=this.retryThrottler)||void 0===P||P.addCallFailed(),this.maybeRetryCall(N,N=>{N||(this.commitCall(S),this.reportStatus(T))})):(this.commitCall(S),this.reportStatus(T))}}getPushback(T){let S=T.get("grpc-retry-pushback-ms");if(0===S.length)return null;try{return parseInt(S[0])}catch(T){return -1}}handleChildStatus(T,S){var N;if("COMPLETED"===this.underlyingCalls[S].state)return;if(this.trace("state="+this.state+" handling status with progress "+T.progress+" from child ["+this.underlyingCalls[S].call.getCallNumber()+"] in state "+this.underlyingCalls[S].state),this.underlyingCalls[S].state="COMPLETED",T.code===R.Status.OK){null===(N=this.retryThrottler)||void 0===N||N.addCallSucceeded(),this.commitCall(S),this.reportStatus(T);return}if("COMMITTED"===this.state){this.reportStatus(T);return}let O=this.getPushback(T.metadata);switch(T.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(T,S,O):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(S),this.reportStatus(T);break;case"PROCESSED":this.handleProcessedStatus(T,S,O)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let T=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(T.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var T,S,N;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let R=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(R.maxAttempts,5))return;let O=null!==(T=R.hedgingDelay)&&void 0!==T?T:"0s",P=Number(O.substring(0,O.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*P),null===(N=(S=this.hedgingTimer).unref)||void 0===N||N.call(S)}startNewAttempt(){let T=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+T.getCallNumber()+"] for attempt "+this.attempts);let S=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:T,nextMessageToSend:0});let N=this.attempts-1,R=this.initialMetadata.clone();N>0&&R.set(U,`${N}`);let O=!1;T.start(R,{onReceiveMetadata:R=>{this.trace("Received metadata from child ["+T.getCallNumber()+"]"),this.commitCall(S),O=!0,N>0&&R.set(U,`${N}`),"ACTIVE"===this.underlyingCalls[S].state&&this.listener.onReceiveMetadata(R)},onReceiveMessage:N=>{this.trace("Received message from child ["+T.getCallNumber()+"]"),this.commitCall(S),"ACTIVE"===this.underlyingCalls[S].state&&this.listener.onReceiveMessage(N)},onReceiveStatus:R=>{this.trace("Received status from child ["+T.getCallNumber()+"]"),!O&&N>0&&R.metadata.set(U,`${N}`),this.handleChildStatus(R,S)}}),this.sendNextChildMessage(S),this.readStarted&&T.startRead()}start(T,S){this.trace("start called"),this.listener=S,this.initialMetadata=T,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(T){var S,N;let R=this.underlyingCalls[T],O=R.nextMessageToSend;null===(N=(S=this.getBufferEntry(O)).callback)||void 0===N||N.call(S),this.clearSentMessages(),R.nextMessageToSend+=1,this.sendNextChildMessage(T)}sendNextChildMessage(T){let S=this.underlyingCalls[T];if("COMPLETED"!==S.state&&this.getBufferEntry(S.nextMessageToSend)){let N=this.getBufferEntry(S.nextMessageToSend);switch(N.entryType){case"MESSAGE":S.call.sendMessageWithContext({callback:S=>{this.handleChildWriteCompleted(T)}},N.message.message);break;case"HALF_CLOSE":S.nextMessageToSend+=1,S.call.halfClose()}}}sendMessageWithContext(T,S){var N;this.trace("write() called with message of length "+S.length);let R={message:S,flags:T.flags},O=this.getNextBufferIndex(),P={entryType:"MESSAGE",message:R,allocated:this.bufferTracker.allocate(S.length,this.callNumber)};if(this.writeBuffer.push(P),P.allocated)for(let[R,P]of(null===(N=T.callback)||void 0===N||N.call(T),this.underlyingCalls.entries()))"ACTIVE"===P.state&&P.nextMessageToSend===O&&P.call.sendMessageWithContext({callback:T=>{this.handleChildWriteCompleted(R)}},S);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let N=this.underlyingCalls[this.committedCallIndex];P.callback=T.callback,"ACTIVE"===N.state&&N.nextMessageToSend===O&&N.call.sendMessageWithContext({callback:T=>{this.handleChildWriteCompleted(this.committedCallIndex)}},S)}}startRead(){for(let T of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==T?void 0:T.state)==="ACTIVE"&&T.call.startRead()}halfClose(){this.trace("halfClose called");let T=this.getNextBufferIndex();for(let S of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==S?void 0:S.state)==="ACTIVE"&&S.nextMessageToSend===T&&(S.nextMessageToSend+=1,S.call.halfClose())}setCredentials(T){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}S.RetryingCall=$},7061:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2ServerCallStream=S.ServerDuplexStreamImpl=S.ServerWritableStreamImpl=S.ServerReadableStreamImpl=S.ServerUnaryCallImpl=void 0;let R=N(2361),O=N(5158),P=N(2781),M=N(9796),L=N(2678),V=N(2252),U=N(8326),$=N(7504),W=N(5437),K="server_call";function Q(T){$.trace(L.LogVerbosity.DEBUG,K,T)}let Y="grpc-message",Z="grpc-status",ee="grpc-timeout",et=/(\d{1,8})\s*([HMSmun])/,er={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},ei={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},en={[O.constants.HTTP2_HEADER_STATUS]:O.constants.HTTP_STATUS_OK,[O.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},es={waitForTrailers:!0};class ea extends R.EventEmitter{constructor(T,S,N){super(),this.call=T,this.metadata=S,this.request=N,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}S.ServerUnaryCallImpl=ea;class eo extends P.Readable{constructor(T,S,N,R){super({objectMode:!0}),this.call=T,this.metadata=S,this.deserialize=N,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,R)}_read(T){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}S.ServerReadableStreamImpl=eo;class eu extends P.Writable{constructor(T,S,N,R){super({objectMode:!0}),this.call=T,this.metadata=S,this.serialize=N,this.request=R,this.cancelled=!1,this.trailingMetadata=new V.Metadata,this.call.setupSurfaceCall(this),this.on("error",T=>{this.call.sendError(T),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(T,S,N){try{let S=this.call.serializeMessage(T);if(!this.call.write(S)){this.call.once("drain",N);return}}catch(T){this.emit("error",{details:(0,W.getErrorMessage)(T),code:L.Status.INTERNAL})}N()}_final(T){this.call.sendStatus({code:L.Status.OK,details:"OK",metadata:this.trailingMetadata}),T(null)}end(T){return T&&(this.trailingMetadata=T),super.end()}}S.ServerWritableStreamImpl=eu;class ec extends P.Duplex{constructor(T,S,N,R,O){super({objectMode:!0}),this.call=T,this.metadata=S,this.serialize=N,this.deserialize=R,this.cancelled=!1,this.trailingMetadata=new V.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,O),this.on("error",T=>{this.call.sendError(T),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(T){return T&&(this.trailingMetadata=T),super.end()}}S.ServerDuplexStreamImpl=ec,ec.prototype._read=eo.prototype._read,ec.prototype._write=eu.prototype._write,ec.prototype._final=eu.prototype._final;class ed extends R.EventEmitter{constructor(T,S,N){super(),this.stream=T,this.handler=S,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=L.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=L.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",T=>{}),this.stream.once("close",()=>{var T;Q("Request to method "+(null===(T=this.handler)||void 0===T?void 0:T.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:L.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in N&&(this.maxSendMessageSize=N["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in N&&(this.maxReceiveMessageSize=N["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(T,S){let N=T.subarray(5);if("identity"===S)return N;if("deflate"!==S&&"gzip"!==S)return Promise.reject({code:L.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${S}"`});{let T;return T="deflate"===S?M.createInflate():M.createGunzip(),new Promise((S,R)=>{let O=0,P=[];T.on("data",S=>{P.push(S),O+=S.byteLength,-1!==this.maxReceiveMessageSize&&O>this.maxReceiveMessageSize&&(T.destroy(),R({code:L.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),T.on("end",()=>{S(Buffer.concat(P))}),T.write(N),T.end()})}}sendMetadata(T){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let S=T?T.toHttp2Headers():null,N=Object.assign(Object.assign(Object.assign({},en),ei),S);this.stream.respond(N,es)}receiveMetadata(T){let S=V.Metadata.fromHttp2Headers(T);$.isTracerEnabled(K)&&Q("Request to "+this.handler.path+" received headers "+JSON.stringify(S.toJSON()));let N=S.get(ee);if(N.length>0){let T=N[0].toString().match(et);if(null===T){let T=Error("Invalid deadline");return T.code=L.Status.OUT_OF_RANGE,this.sendError(T),S}let R=+T[1]*er[T[2]]|0,O=new Date;this.deadline=O.setMilliseconds(O.getMilliseconds()+R),this.deadlineTimer=setTimeout(eh,R,this),S.remove(ee)}return S.remove(O.constants.HTTP2_HEADER_ACCEPT_ENCODING),S.remove(O.constants.HTTP2_HEADER_TE),S.remove(O.constants.HTTP2_HEADER_CONTENT_TYPE),S.remove("grpc-accept-encoding"),S}receiveUnaryMessage(T){return new Promise((S,N)=>{let{stream:R}=this,O=0,P=this,M=[],V=this.maxReceiveMessageSize;function U(T){if(O+=T.byteLength,-1!==V&&O>V){R.removeListener("data",U),R.removeListener("end",$),R.removeListener("error",$),N({code:L.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${O} vs. ${V})`});return}M.push(T)}function $(V){if(R.removeListener("data",U),R.removeListener("end",$),R.removeListener("error",$),void 0!==V){N({code:L.Status.INTERNAL,details:V.message});return}if(0===O){N({code:L.Status.INTERNAL,details:"received empty unary message"});return}P.emit("receiveMessage");let W=Buffer.concat(M,O),K=1===W.readUInt8(0)?T:"identity",Q=P.getDecompressedMessage(W,K);if(Buffer.isBuffer(Q)){S(P.deserializeMessageWithInternalError(Q));return}Q.then(T=>S(P.deserializeMessageWithInternalError(T)),S=>N(S.code?S:{code:L.Status.INTERNAL,details:`Received "grpc-encoding" header "${T}" but ${T} decompression failed`}))}this.stream.on("data",U),this.stream.on("end",$),this.stream.on("error",$)})}async deserializeMessageWithInternalError(T){try{return this.deserializeMessage(T)}catch(T){throw{details:(0,W.getErrorMessage)(T),code:L.Status.INTERNAL}}}serializeMessage(T){let S=this.handler.serialize(T),N=S.byteLength,R=Buffer.allocUnsafe(N+5);return R.writeUInt8(0,0),R.writeUInt32BE(N,1),S.copy(R,5),R}deserializeMessage(T){return this.handler.deserialize(T)}async sendUnaryMessage(T,S,N,R){if(!this.checkCancelled()){if(void 0===N&&(N=null),T){!Object.prototype.hasOwnProperty.call(T,"metadata")&&N&&(T.metadata=N),this.sendError(T);return}try{let T=this.serializeMessage(S);this.write(T),this.sendStatus({code:L.Status.OK,details:"OK",metadata:N})}catch(T){this.sendError({details:(0,W.getErrorMessage)(T),code:L.Status.INTERNAL})}}}sendStatus(T){var S,N;if(this.emit("callEnd",T.code),this.emit("streamEnd",T.code===L.Status.OK),!this.checkCancelled()){if(Q("Request to method "+(null===(S=this.handler)||void 0===S?void 0:S.path)+" ended with status code: "+L.Status[T.code]+" details: "+T.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var S;let N=Object.assign({[Z]:T.code,[Y]:encodeURI(T.details)},null===(S=T.metadata)||void 0===S?void 0:S.toHttp2Headers());this.stream.sendTrailers(N),this.statusSent=!0}),this.stream.end());else{let S=Object.assign(Object.assign({[Z]:T.code,[Y]:encodeURI(T.details)},en),null===(N=T.metadata)||void 0===N?void 0:N.toHttp2Headers());this.stream.respond(S,{endStream:!0}),this.statusSent=!0}}}sendError(T){let S={code:L.Status.UNKNOWN,details:"message"in T?T.message:"Unknown Error",metadata:"metadata"in T&&void 0!==T.metadata?T.metadata:null};"code"in T&&"number"==typeof T.code&&Number.isInteger(T.code)&&(S.code=T.code,"details"in T&&"string"==typeof T.details&&(S.details=T.details)),this.sendStatus(S)}write(T){if(!this.checkCancelled()){if(-1!==this.maxSendMessageSize&&T.length>this.maxSendMessageSize){this.sendError({code:L.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${T.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(T)}}resume(){this.stream.resume()}setupSurfaceCall(T){this.once("cancelled",S=>{T.cancelled=!0,T.emit("cancelled",S)}),this.once("callEnd",S=>T.emit("callEnd",S))}setupReadable(T,S){let N=new U.StreamDecoder(this.maxReceiveMessageSize),R=!1,O=!1,P=!1,M=async()=>{P||!R||O||(P=!0,await this.pushOrBufferMessage(T,null))};this.stream.on("data",async R=>{let P;try{P=N.write(R)}catch(T){this.sendError({code:L.Status.RESOURCE_EXHAUSTED,details:T.message});return}for(let N of(O=!0,this.stream.pause(),P)){let R;this.emit("receiveMessage");let O=1===N.readUInt8(0)?S:"identity";try{R=await this.getDecompressedMessage(N,O)}catch(T){this.sendError(T);return}if(!R)return;await this.pushOrBufferMessage(T,R)}O=!1,this.stream.resume(),await M()}),this.stream.once("end",async()=>{R=!0,await M()})}consumeUnpushedMessages(T){for(this.canPush=!0;this.messagesToPush.length>0;){let S=this.messagesToPush.shift(),N=T.push(S);if(null===S||!1===N){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(T,S){this.isPushPending?this.bufferedMessages.push(S):await this.pushMessage(T,S)}async pushMessage(T,S){if(null===S){Q("Received end of stream"),this.canPush?T.push(null):this.messagesToPush.push(null);return}Q("Received message of length "+S.length),this.isPushPending=!0;try{let N=await this.deserializeMessage(S);this.canPush?T.push(N)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(N)}catch(N){this.bufferedMessages.length=0;let S=(0,W.getErrorCode)(N);(null===S||S<L.Status.OK||S>L.Status.UNAUTHENTICATED)&&(S=L.Status.INTERNAL),T.emit("error",{details:(0,W.getErrorMessage)(N),code:S})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(T,this.bufferedMessages.shift())}getPeer(){var T;let S=null===(T=this.stream.session)||void 0===T?void 0:T.socket;return null!=S&&S.remoteAddress?S.remotePort?`${S.remoteAddress}:${S.remotePort}`:S.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function eh(T){let S=Error("Deadline exceeded");S.code=L.Status.DEADLINE_EXCEEDED,T.sendError(S),T.cancelled=!0,T.emit("cancelled","deadline")}S.Http2ServerCallStream=ed},4181:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ServerCredentials=void 0;let R=N(3009);class O{static createInsecure(){return new P}static createSsl(T,S,N=!1){if(null!==T&&!Buffer.isBuffer(T))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(S))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof N)throw TypeError("checkClientCertificate must be a boolean");let O=[],P=[];for(let T=0;T<S.length;T++){let N=S[T];if(null===N||"object"!=typeof N)throw TypeError(`keyCertPair[${T}] must be an object`);if(!Buffer.isBuffer(N.private_key))throw TypeError(`keyCertPair[${T}].private_key must be a Buffer`);if(!Buffer.isBuffer(N.cert_chain))throw TypeError(`keyCertPair[${T}].cert_chain must be a Buffer`);O.push(N.cert_chain),P.push(N.private_key)}return new M({ca:T||(0,R.getDefaultRootsData)()||void 0,cert:O,key:P,requestCert:N,ciphers:R.CIPHER_SUITES})}}S.ServerCredentials=O;class P extends O{_isSecure(){return!1}_getSettings(){return null}}class M extends O{constructor(T){super(),this.options=T}_isSecure(){return!0}_getSettings(){return this.options}}},7691:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Server=void 0;let R=N(5158),O=N(2678),P=N(7061),M=N(4181),L=N(492),V=N(7504),U=N(3906),$=N(8429),W=N(5993),K=2147483647,Q=2147483647,Y=2e4,{HTTP2_HEADER_PATH:Z}=R.constants,ee="server";function et(){}function er(T){return{code:O.Status.UNIMPLEMENTED,details:`The server does not implement the method ${T}`}}function ei(T,S){let N=er(S);switch(T){case"unary":return(T,S)=>{S(N,null)};case"clientStream":return(T,S)=>{S(N,null)};case"serverStream":return T=>{T.emit("error",N)};case"bidi":return T=>{T.emit("error",N)};default:throw Error(`Invalid handlerType ${T}`)}}class en{constructor(T){var S,N,R,O;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new W.ChannelzTrace,this.callTracker=new W.ChannelzCallTracker,this.listenerChildrenTracker=new W.ChannelzChildrenTracker,this.sessionChildrenTracker=new W.ChannelzChildrenTracker,this.options=null!=T?T:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,W.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!==(S=this.options["grpc.max_connection_age_ms"])&&void 0!==S?S:K,this.maxConnectionAgeGraceMs=null!==(N=this.options["grpc.max_connection_age_grace_ms"])&&void 0!==N?N:K,this.keepaliveTimeMs=null!==(R=this.options["grpc.keepalive_time_ms"])&&void 0!==R?R:Q,this.keepaliveTimeoutMs=null!==(O=this.options["grpc.keepalive_timeout_ms"])&&void 0!==O?O:Y,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(T){return()=>{var S,N,R;let O;let P=this.sessions.get(T),M=T.socket,L=M.remoteAddress?(0,U.stringToSubchannelAddress)(M.remoteAddress,M.remotePort):null,V=M.localAddress?(0,U.stringToSubchannelAddress)(M.localAddress,M.localPort):null;if(T.encrypted){let T=M,N=T.getCipher(),R=T.getCertificate(),P=T.getPeerCertificate();O={cipherSuiteStandardName:null!==(S=N.standardName)&&void 0!==S?S:null,cipherSuiteOtherName:N.standardName?null:N.name,localCertificate:R&&"raw"in R?R.raw:null,remoteCertificate:P&&"raw"in P?P.raw:null}}else O=null;return{remoteAddress:L,localAddress:V,security:O,remoteName:null,streamsStarted:P.streamTracker.callsStarted,streamsSucceeded:P.streamTracker.callsSucceeded,streamsFailed:P.streamTracker.callsFailed,messagesSent:P.messagesSent,messagesReceived:P.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:P.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:P.lastMessageSentTimestamp,lastMessageReceivedTimestamp:P.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(N=T.state.localWindowSize)&&void 0!==N?N:null,remoteFlowControlWindow:null!==(R=T.state.remoteWindowSize)&&void 0!==R?R:null}}}trace(T){V.trace(O.LogVerbosity.DEBUG,ee,"("+this.channelzRef.id+") "+T)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(T,S){if(null===T||"object"!=typeof T||null===S||"object"!=typeof S)throw Error("addService() requires two objects as arguments");let N=Object.keys(T);if(0===N.length)throw Error("Cannot add an empty service to a server");N.forEach(N=>{let R,O;let P=T[N];R=P.requestStream?P.responseStream?"bidi":"clientStream":P.responseStream?"serverStream":"unary";let M=S[N];if(void 0===M&&"string"==typeof P.originalName&&(M=S[P.originalName]),O=void 0!==M?M.bind(S):ei(R,N),!1===this.register(P.path,O,P.responseSerialize,P.requestDeserialize,R))throw Error(`Method handler for ${P.path} already provided.`)})}removeService(T){if(null===T||"object"!=typeof T)throw Error("removeService() requires object as argument");Object.keys(T).forEach(S=>{let N=T[S];this.unregister(N.path)})}bind(T,S){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(T,S,N){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof T)throw TypeError("port must be a string");if(null===S||!(S instanceof M.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof N)throw TypeError("callback must be a function");let P=(0,$.parseUri)(T);if(null===P)throw Error(`Could not parse port "${T}"`);let K=(0,L.mapUriDefaultScheme)(P);if(null===K)throw Error(`Could not get a default scheme for port "${T}"`);let Q={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?Q.maxSessionMemory=this.options["grpc-node.max_session_memory"]:Q.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(Q.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let Y=(T,S)=>{process.nextTick(()=>N(T,S))},Z=()=>{let T;if(S._isSecure()){let N=Object.assign(Q,S._getSettings());N.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(T=R.createSecureServer(N)).on("secureConnection",T=>{T.on("error",T=>{this.trace("An incoming TLS connection closed with error: "+T.message)})})}else T=R.createServer(Q);return T.setTimeout(0,et),this._setupHandlers(T),T},ee=(T,S,N)=>0===T.length?Promise.resolve({port:S,count:N}):Promise.all(T.map(T=>{let N;this.trace("Attempting to bind "+(0,U.subchannelAddressToString)(T)),N=(0,U.isTcpSubchannelAddress)(T)?{host:T.host,port:S}:T;let R=Z();return new Promise((O,P)=>{let M=S=>{this.trace("Failed to bind "+(0,U.subchannelAddressToString)(T)+" with error "+S.message),O(S)};R.once("error",M),R.listen(N,()=>{let T;if(this.shutdown){R.close(),O(Error("bindAsync failed because server is shutdown"));return}let N=R.address();T="string"==typeof N?{path:N}:{host:N.address,port:N.port};let P=(0,W.registerChannelzSocket)((0,U.subchannelAddressToString)(T),()=>({localAddress:T,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(P),this.http2ServerList.push({server:R,channelzRef:P}),this.trace("Successfully bound "+(0,U.subchannelAddressToString)(T)),O("port"in T?T.port:S),R.removeListener("error",M)})})})).then(T=>{let R=0;for(let N of T)if("number"==typeof N&&(R+=1,N!==S))throw Error("Invalid state: multiple port numbers added from single address");return{port:S,count:R+N}}),er=T=>{if(0===T.length)return Promise.resolve({port:0,count:0});let S=T[0],N=Z();return new Promise((R,O)=>{let P=N=>{this.trace("Failed to bind "+(0,U.subchannelAddressToString)(S)+" with error "+N.message),R(er(T.slice(1)))};N.once("error",P),N.listen(S,()=>{if(this.shutdown){N.close(),R({port:0,count:0});return}let S=N.address(),O={host:S.address,port:S.port},M=(0,W.registerChannelzSocket)((0,U.subchannelAddressToString)(O),()=>({localAddress:O,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(M),this.http2ServerList.push({server:N,channelzRef:M}),this.trace("Successfully bound "+(0,U.subchannelAddressToString)(O)),R(ee(T.slice(1),S.port,1)),N.removeListener("error",P)})})},ei={onSuccessfulResolution:(S,N,R)=>{let P;if(ei.onSuccessfulResolution=()=>{},this.shutdown&&Y(Error("bindAsync failed because server is shutdown"),0),0===S.length){Y(Error(`No addresses resolved for port ${T}`),0);return}(P=(0,U.isTcpSubchannelAddress)(S[0])?0===S[0].port?er(S):ee(S,S[0].port,0):ee(S,1,0)).then(T=>{if(0===T.count){let T=`No address added out of total ${S.length} resolved`;V.log(O.LogVerbosity.ERROR,T),Y(Error(T),0)}else T.count<S.length&&V.log(O.LogVerbosity.INFO,`WARNING Only ${T.count} addresses added out of total ${S.length} resolved`),Y(null,T.port)},T=>{let N=`No address added out of total ${S.length} resolved`;V.log(O.LogVerbosity.ERROR,N),Y(Error(N),0)})},onError:T=>{Y(Error(T.details),0)}};(0,L.createResolver)(K,ei,this.options).updateResolution()}forceShutdown(){for(let{server:T,channelzRef:S}of this.http2ServerList)T.listening&&T.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(S),(0,W.unregisterChannelzRef)(S))});this.started=!1,this.shutdown=!0,this.sessions.forEach((T,S)=>{S.destroy(R.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,W.unregisterChannelzRef)(this.channelzRef)}register(T,S,N,R,O){return!this.handlers.has(T)&&(this.handlers.set(T,{func:S,serialize:N,deserialize:R,type:O,path:T}),!0)}unregister(T){return this.handlers.delete(T)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:T})=>!0!==T.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(T){let S=S=>{this.channelzEnabled&&(0,W.unregisterChannelzRef)(this.channelzRef),T(S)},N=0;function R(){0==--N&&S()}for(let{server:T,channelzRef:S}of(this.started=!1,this.shutdown=!0,this.http2ServerList))T.listening&&(N++,T.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(S),(0,W.unregisterChannelzRef)(S)),R()}));this.sessions.forEach((T,S)=>{S.closed||(N+=1,S.close(R))}),0===N&&S()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(T,S){let N=S[R.constants.HTTP2_HEADER_CONTENT_TYPE];return!!("string"==typeof N&&N.startsWith("application/grpc"))||(T.respond({[R.constants.HTTP2_HEADER_STATUS]:R.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(T){this.trace("Received call to method "+T+" at address "+this.serverAddressString);let S=this.handlers.get(T);return void 0===S?(this.trace("No handler registered for method "+T+". Sending UNIMPLEMENTED status."),null):S}_respondWithError(T,S,N=null){let R=new P.Http2ServerCallStream(S,null,this.options);void 0===T.code&&(T.code=O.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==N||N.streamTracker.addCallFailed()),R.sendError(T)}_channelzHandler(T,S){let N=this.sessions.get(T.session);if(this.callTracker.addCallStarted(),null==N||N.streamTracker.addCallStarted(),!this._verifyContentType(T,S)){this.callTracker.addCallFailed(),null==N||N.streamTracker.addCallFailed();return}let R=S[Z],M=this._retrieveHandler(R);if(!M){this._respondWithError(er(R),T,N);return}let L=new P.Http2ServerCallStream(T,M,this.options);L.once("callEnd",T=>{T===O.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),N&&(L.once("streamEnd",T=>{T?N.streamTracker.addCallSucceeded():N.streamTracker.addCallFailed()}),L.on("sendMessage",()=>{N.messagesSent+=1,N.lastMessageSentTimestamp=new Date}),L.on("receiveMessage",()=>{N.messagesReceived+=1,N.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(L,M,S)||(this.callTracker.addCallFailed(),null==N||N.streamTracker.addCallFailed(),L.sendError({code:O.Status.INTERNAL,details:`Unknown handler type: ${M.type}`}))}_streamHandler(T,S){if(!0!==this._verifyContentType(T,S))return;let N=S[Z],R=this._retrieveHandler(N);if(!R){this._respondWithError(er(N),T,null);return}let M=new P.Http2ServerCallStream(T,R,this.options);this._runHandlerForCall(M,R,S)||M.sendError({code:O.Status.INTERNAL,details:`Unknown handler type: ${R.type}`})}_runHandlerForCall(T,S,N){var R;let O=T.receiveMetadata(N),P=null!==(R=O.get("grpc-encoding")[0])&&void 0!==R?R:"identity";O.remove("grpc-encoding");let{type:M}=S;if("unary"===M)es(T,S,O,P);else if("clientStream"===M)ea(T,S,O,P);else if("serverStream"===M)eo(T,S,O,P);else{if("bidi"!==M)return!1;eu(T,S,O,P)}return!0}_setupHandlers(T){if(null===T)return;let S=T.address(),N="null";S&&(N="string"==typeof S?S:S.address+":"+S.port),this.serverAddressString=N;let O=this.channelzEnabled?this._channelzHandler:this._streamHandler;T.on("stream",O.bind(this)),T.on("session",T=>{var S,N,O,P,M;if(!this.started){T.destroy();return}let L=(0,W.registerChannelzSocket)(null!==(S=T.socket.remoteAddress)&&void 0!==S?S:"unknown",this.getChannelzSessionInfoGetter(T),this.channelzEnabled),V={ref:L,streamTracker:new W.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(T,V);let U=T.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+U),this.sessionChildrenTracker.refChild(L));let $=null,Q=null,Y=!1;if(this.maxConnectionAgeMs!==K){let S=this.maxConnectionAgeMs/10,P=Math.random()*S*2-S;$=null===(O=(N=setTimeout(()=>{var S,N;Y=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+U);try{T.goaway(R.constants.NGHTTP2_NO_ERROR,2147483647,Buffer.from("max_age"))}catch(S){T.destroy();return}T.close(),this.maxConnectionAgeGraceMs!==K&&(Q=null===(N=(S=setTimeout(()=>{T.destroy()},this.maxConnectionAgeGraceMs)).unref)||void 0===N?void 0:N.call(S))},this.maxConnectionAgeMs+P)).unref)||void 0===O?void 0:O.call(N)}let Z=null===(M=(P=setInterval(()=>{var S,N;let R=null===(N=(S=setTimeout(()=>{Y=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+U),T.close()},this.keepaliveTimeoutMs)).unref)||void 0===N?void 0:N.call(S);try{T.ping((T,S,N)=>{clearTimeout(R)})}catch(S){T.destroy()}},this.keepaliveTimeMs)).unref)||void 0===M?void 0:M.call(P);T.on("close",()=>{this.channelzEnabled&&(Y||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+U),this.sessionChildrenTracker.unrefChild(L),(0,W.unregisterChannelzRef)(L)),$&&clearTimeout($),Q&&clearTimeout(Q),Z&&clearTimeout(Z),this.sessions.delete(T)})})}}async function es(T,S,N,R){try{let O=await T.receiveUnaryMessage(R);if(void 0===O||T.cancelled)return;let M=new P.ServerUnaryCallImpl(T,N,O);S.func(M,(S,N,R,O)=>{T.sendUnaryMessage(S,N,R,O)})}catch(S){T.sendError(S)}}function ea(T,S,N,R){let O=new P.ServerReadableStreamImpl(T,N,S.deserialize,R);function M(S,N,R,P){O.destroy(),T.sendUnaryMessage(S,N,R,P)}T.cancelled||(O.on("error",M),S.func(O,M))}async function eo(T,S,N,R){try{let O=await T.receiveUnaryMessage(R);if(void 0===O||T.cancelled)return;let M=new P.ServerWritableStreamImpl(T,N,S.serialize,O);S.func(M)}catch(S){T.sendError(S)}}function eu(T,S,N,R){let O=new P.ServerDuplexStreamImpl(T,N,S.serialize,S.deserialize,R);T.cancelled||S.func(O)}S.Server=en},6262:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.extractAndSelectServiceConfig=S.validateServiceConfig=S.validateRetryThrottling=void 0;let R=N(2037),O=N(2678),P=N(7176),M=/^\d+(\.\d{1,9})?s$/,L="node";function V(T){if("service"in T&&""!==T.service){if("string"!=typeof T.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof T.service}`);if(!("method"in T)||""===T.method)return{service:T.service};if("string"!=typeof T.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof T.service}`);return{service:T.service,method:T.method}}if("method"in T&&void 0!==T.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function U(T){if(!("maxAttempts"in T)||!Number.isInteger(T.maxAttempts)||T.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in T)||"string"!=typeof T.initialBackoff||!M.test(T.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in T)||"string"!=typeof T.maxBackoff||!M.test(T.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in T)||"number"!=typeof T.backoffMultiplier||T.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in T&&Array.isArray(T.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===T.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let S of T.retryableStatusCodes)if("number"==typeof S){if(!Object.values(O.Status).includes(S))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof S){if(!Object.values(O.Status).includes(S.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:T.maxAttempts,initialBackoff:T.initialBackoff,maxBackoff:T.maxBackoff,backoffMultiplier:T.backoffMultiplier,retryableStatusCodes:T.retryableStatusCodes}}function $(T){if(!("maxAttempts"in T)||!Number.isInteger(T.maxAttempts)||T.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in T&&("string"!=typeof T.hedgingDelay||!M.test(T.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in T&&Array.isArray(T.nonFatalStatusCodes))for(let S of T.nonFatalStatusCodes)if("number"==typeof S){if(!Object.values(O.Status).includes(S))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof S){if(!Object.values(O.Status).includes(S.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let S={maxAttempts:T.maxAttempts};return T.hedgingDelay&&(S.hedgingDelay=T.hedgingDelay),T.nonFatalStatusCodes&&(S.nonFatalStatusCodes=T.nonFatalStatusCodes),S}function W(T){var S;let N={name:[]};if(!("name"in T)||!Array.isArray(T.name))throw Error("Invalid method config: invalid name array");for(let S of T.name)N.name.push(V(S));if("waitForReady"in T){if("boolean"!=typeof T.waitForReady)throw Error("Invalid method config: invalid waitForReady");N.waitForReady=T.waitForReady}if("timeout"in T){if("object"==typeof T.timeout){if(!("seconds"in T.timeout)||"number"!=typeof T.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in T.timeout)||"number"!=typeof T.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");N.timeout=T.timeout}else if("string"==typeof T.timeout&&M.test(T.timeout)){let R=T.timeout.substring(0,T.timeout.length-1).split(".");N.timeout={seconds:0|R[0],nanos:(null!==(S=R[1])&&void 0!==S?S:0)|0}}else throw Error("Invalid method config: invalid timeout")}if("maxRequestBytes"in T){if("number"!=typeof T.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");N.maxRequestBytes=T.maxRequestBytes}if("maxResponseBytes"in T){if("number"!=typeof T.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");N.maxResponseBytes=T.maxResponseBytes}if("retryPolicy"in T){if("hedgingPolicy"in T)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");N.retryPolicy=U(T.retryPolicy)}else"hedgingPolicy"in T&&(N.hedgingPolicy=$(T.hedgingPolicy));return N}function K(T){if(!("maxTokens"in T)||"number"!=typeof T.maxTokens||T.maxTokens<=0||T.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in T)||"number"!=typeof T.tokenRatio||T.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+T.maxTokens.toFixed(3),tokenRatio:+T.tokenRatio.toFixed(3)}}function Q(T){let S={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in T){if("string"==typeof T.loadBalancingPolicy)S.loadBalancingPolicy=T.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy")}if("loadBalancingConfig"in T){if(Array.isArray(T.loadBalancingConfig))for(let N of T.loadBalancingConfig)S.loadBalancingConfig.push((0,P.validateLoadBalancingConfig)(N));else throw Error("Invalid service config: invalid loadBalancingConfig")}if("methodConfig"in T&&Array.isArray(T.methodConfig))for(let N of T.methodConfig)S.methodConfig.push(W(N));"retryThrottling"in T&&(S.retryThrottling=K(T.retryThrottling));let N=[];for(let T of S.methodConfig)for(let S of T.name){for(let T of N)if(S.service===T.service&&S.method===T.method)throw Error(`Invalid service config: duplicate name ${S.service}/${S.method}`);N.push(S)}return S}function Y(T){if(!("serviceConfig"in T))throw Error("Invalid service config choice: missing service config");let S={serviceConfig:Q(T.serviceConfig)};if("clientLanguage"in T){if(Array.isArray(T.clientLanguage))for(let N of(S.clientLanguage=[],T.clientLanguage))if("string"==typeof N)S.clientLanguage.push(N);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage")}if("clientHostname"in T){if(Array.isArray(T.clientHostname))for(let N of(S.clientHostname=[],T.clientHostname))if("string"==typeof N)S.clientHostname.push(N);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname")}if("percentage"in T){if("number"==typeof T.percentage&&0<=T.percentage&&T.percentage<=100)S.percentage=T.percentage;else throw Error("Invalid service config choice: invalid percentage")}let N=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let S in T)if(!N.includes(S))throw Error(`Invalid service config choice: unexpected field ${S}`);return S}function Z(T,S){if(!Array.isArray(T))throw Error("Invalid service config list");for(let N of T){let T=Y(N);if("number"!=typeof T.percentage||!(S>T.percentage)){if(Array.isArray(T.clientHostname)){let S=!1;for(let N of T.clientHostname)N===R.hostname()&&(S=!0);if(!S)continue}if(Array.isArray(T.clientLanguage)){let S=!1;for(let N of T.clientLanguage)N===L&&(S=!0);if(!S)continue}return T.serviceConfig}}throw Error("No matching service config found")}function ee(T,S){for(let N of T)if(N.length>0&&N[0].startsWith("grpc_config="))return Z(JSON.parse(N.join("").substring(12)),S);return null}S.validateRetryThrottling=K,S.validateServiceConfig=Q,S.extractAndSelectServiceConfig=ee},9932:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.StatusBuilder=void 0;class N{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(T){return this.code=T,this}withDetails(T){return this.details=T,this}withMetadata(T){return this.metadata=T,this}build(){let T={};return null!==this.code&&(T.code=this.code),null!==this.details&&(T.details=this.details),null!==this.metadata&&(T.metadata=this.metadata),T}}S.StatusBuilder=N},8326:(T,S)=>{"use strict";var N;Object.defineProperty(S,"__esModule",{value:!0}),S.StreamDecoder=void 0,function(T){T[T.NO_DATA=0]="NO_DATA",T[T.READING_SIZE=1]="READING_SIZE",T[T.READING_MESSAGE=2]="READING_MESSAGE"}(N||(N={}));class R{constructor(T){this.maxReadMessageLength=T,this.readState=N.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(T){let S,R=0,O=[];for(;R<T.length;)switch(this.readState){case N.NO_DATA:this.readCompressFlag=T.slice(R,R+1),R+=1,this.readState=N.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case N.READING_SIZE:if(S=Math.min(T.length-R,this.readSizeRemaining),T.copy(this.readPartialSize,4-this.readSizeRemaining,R,R+S),this.readSizeRemaining-=S,R+=S,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=N.READING_MESSAGE;else{let T=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=N.NO_DATA,O.push(T)}}break;case N.READING_MESSAGE:if(S=Math.min(T.length-R,this.readMessageRemaining),this.readPartialMessage.push(T.slice(R,R+S)),this.readMessageRemaining-=S,R+=S,0===this.readMessageRemaining){let T=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),S=Buffer.concat(T,this.readMessageSize+5);this.readState=N.NO_DATA,O.push(S)}break;default:throw Error("Unexpected read state")}return O}}S.StreamDecoder=R},3906:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.stringToSubchannelAddress=S.subchannelAddressToString=S.subchannelAddressEqual=S.isTcpSubchannelAddress=void 0;let R=N(1808);function O(T){return"port"in T}function P(T,S){return!T&&!S||!!T&&!!S&&(O(T)?O(S)&&T.host===S.host&&T.port===S.port:!O(S)&&T.path===S.path)}function M(T){return O(T)?T.host+":"+T.port:T.path}S.isTcpSubchannelAddress=O,S.subchannelAddressEqual=P,S.subchannelAddressToString=M;let L=443;function V(T,S){return(0,R.isIP)(T)?{host:T,port:null!=S?S:L}:{path:T}}S.stringToSubchannelAddress=V},7060:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2SubchannelCall=void 0;let R=N(5158),O=N(2037),P=N(2678),M=N(2252),L=N(8326),V=N(7504),U=N(2678),$="subchannel_call";function W(T){for(let[S,N]of Object.entries(O.constants.errno))if(N===T)return S;return"Unknown system error "+T}class K{constructor(T,S,N,O,V){var U;this.http2Stream=T,this.callEventTracker=S,this.listener=N,this.transport=O,this.callId=V,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=P.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let $=null!==(U=O.getOptions()["grpc.max_receive_message_length"])&&void 0!==U?U:P.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new L.StreamDecoder($),T.on("response",(T,S)=>{let N="";for(let S of Object.keys(T))N+="		"+S+": "+T[S]+"\n";switch(this.trace("Received server headers:\n"+N),T[":status"]){case 400:this.mappedStatusCode=P.Status.INTERNAL;break;case 401:this.mappedStatusCode=P.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=P.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=P.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=P.Status.UNAVAILABLE;break;default:this.mappedStatusCode=P.Status.UNKNOWN}if(S&R.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(T);else{let S;try{S=M.Metadata.fromHttp2Headers(T)}catch(T){this.endCall({code:P.Status.UNKNOWN,details:T.message,metadata:new M.Metadata});return}this.listener.onReceiveMetadata(S)}}),T.on("trailers",T=>{this.handleTrailers(T)}),T.on("data",T=>{let S;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+T.length);try{S=this.decoder.write(T)}catch(T){this.cancelWithStatus(P.Status.RESOURCE_EXHAUSTED,T.message);return}for(let T of S)this.trace("parsed message of length "+T.length),this.callEventTracker.addMessageReceived(),this.tryPush(T)}}),T.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),T.on("close",()=>{process.nextTick(()=>{var S;let N;if(this.trace("HTTP/2 stream closed with code "+T.rstCode),(null===(S=this.finalStatus)||void 0===S?void 0:S.code)===P.Status.OK)return;let O="";switch(T.rstCode){case R.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;N=P.Status.INTERNAL,O=`Received RST_STREAM with code ${T.rstCode}`;break;case R.constants.NGHTTP2_REFUSED_STREAM:N=P.Status.UNAVAILABLE,O="Stream refused by server";break;case R.constants.NGHTTP2_CANCEL:N=P.Status.CANCELLED,O="Call cancelled";break;case R.constants.NGHTTP2_ENHANCE_YOUR_CALM:N=P.Status.RESOURCE_EXHAUSTED,O="Bandwidth exhausted or memory limit exceeded";break;case R.constants.NGHTTP2_INADEQUATE_SECURITY:N=P.Status.PERMISSION_DENIED,O="Protocol not secure enough";break;case R.constants.NGHTTP2_INTERNAL_ERROR:N=P.Status.INTERNAL,null===this.internalError?O=`Received RST_STREAM with code ${T.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(N=P.Status.UNAVAILABLE,O=this.internalError.message):O=`Received RST_STREAM with code ${T.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:N=P.Status.INTERNAL,O=`Received RST_STREAM with code ${T.rstCode}`}this.endCall({code:N,details:O,metadata:new M.Metadata,rstCode:T.rstCode})})}),T.on("error",T=>{"ERR_HTTP2_STREAM_ERROR"!==T.code&&(this.trace("Node error event: message="+T.message+" code="+T.code+" errno="+W(T.errno)+" syscall="+T.syscall),this.internalError=T),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:P.Status.UNAVAILABLE,details:"Connection dropped",metadata:new M.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(T){V.trace(U.LogVerbosity.DEBUG,$,"["+this.callId+"] "+T)}endCall(T){(null===this.finalStatus||this.finalStatus.code===P.Status.OK)&&(this.finalStatus=T,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===P.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(T){this.trace("pushing to reader message of length "+(T instanceof Buffer?T.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(T),this.maybeOutputStatus())})}tryPush(T){this.canPush?(this.http2Stream.pause(),this.push(T)):(this.trace("unpushedReadMessages.push message of length "+T.length),this.unpushedReadMessages.push(T))}handleTrailers(T){let S;this.callEventTracker.onStreamEnd(!0);let N="";for(let S of Object.keys(T))N+="		"+S+": "+T[S]+"\n";this.trace("Received server trailers:\n"+N);try{S=M.Metadata.fromHttp2Headers(T)}catch(T){S=new M.Metadata}let R=S.getMap(),O=this.mappedStatusCode;if(O===P.Status.UNKNOWN&&"string"==typeof R["grpc-status"]){let T=Number(R["grpc-status"]);T in P.Status&&(O=T,this.trace("received status code "+T+" from server")),S.remove("grpc-status")}let L="";if("string"==typeof R["grpc-message"]){try{L=decodeURI(R["grpc-message"])}catch(T){L=R["grpc-message"]}S.remove("grpc-message"),this.trace('received status details string "'+L+'" from server')}let V={code:O,details:L,metadata:S};this.endCall(V)}destroyHttp2Stream(){var T;if(!this.http2Stream.destroyed){let S;S=(null===(T=this.finalStatus)||void 0===T?void 0:T.code)===P.Status.OK?R.constants.NGHTTP2_NO_ERROR:R.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+S),this.http2Stream.close(S)}}cancelWithStatus(T,S){this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),this.endCall({code:T,details:S,metadata:new M.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==P.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let T=this.unpushedReadMessages.shift();this.push(T);return}this.http2Stream.resume()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length);let N=S=>{process.nextTick(()=>{var N;let R=P.Status.UNAVAILABLE;(null==S?void 0:S.code)==="ERR_STREAM_WRITE_AFTER_END"&&(R=P.Status.INTERNAL),S&&this.cancelWithStatus(R,`Write error: ${S.message}`),null===(N=T.callback)||void 0===N||N.call(T)})};this.trace("sending data chunk of length "+S.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(S,N)}catch(T){this.endCall({code:P.Status.UNAVAILABLE,details:`Write failed with error ${T.message}`,metadata:new M.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}S.Http2SubchannelCall=K},1407:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BaseSubchannelWrapper=void 0;class N{constructor(T){this.child=T}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(T){this.child.addConnectivityStateListener(T)}removeConnectivityStateListener(T){this.child.removeConnectivityStateListener(T)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(T){this.child.throttleKeepalive(T)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(T){return this.getRealSubchannel()===T.getRealSubchannel()}}S.BaseSubchannelWrapper=N},2328:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getSubchannelPool=S.SubchannelPool=void 0;let R=N(9387),O=N(1727),P=N(3906),M=N(8429),L=N(2869),V=1e4;class U{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let T=!0;for(let S in this.pool){let N=this.pool[S].filter(T=>!T.subchannel.unrefIfOneRef());N.length>0&&(T=!1),this.pool[S]=N}T&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var T,S;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},V),null===(S=(T=this.cleanupTimer).unref)||void 0===S||S.call(T))}getOrCreateSubchannel(T,S,N,V){this.ensureCleanupTask();let U=(0,M.uriToString)(T);if(U in this.pool){for(let T of this.pool[U])if((0,P.subchannelAddressEqual)(S,T.subchannelAddress)&&(0,R.channelOptionsEqual)(N,T.channelArguments)&&V._equals(T.channelCredentials))return T.subchannel}let $=new O.Subchannel(T,S,N,V,new L.Http2SubchannelConnector(T));return U in this.pool||(this.pool[U]=[]),this.pool[U].push({subchannelAddress:S,channelArguments:N,channelCredentials:V,subchannel:$}),$.ref(),$}}S.SubchannelPool=U;let $=new U;function W(T){return T?$:new U}S.getSubchannelPool=W},1727:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Subchannel=void 0;let R=N(3955),O=N(4934),P=N(7504),M=N(2678),L=N(8429),V=N(3906),U=N(5993),$="subchannel",W=2147483647;class K{constructor(T,S,N,P,M){var L;this.channelTarget=T,this.subchannelAddress=S,this.options=N,this.credentials=P,this.connector=M,this.connectivityState=R.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new U.ChannelzCallTracker,this.childrenTracker=new U.ChannelzChildrenTracker,this.streamTracker=new U.ChannelzCallTracker;let $={initialDelay:N["grpc.initial_reconnect_backoff_ms"],maxDelay:N["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new O.BackoffTimeout(()=>{this.handleBackoffTimer()},$),this.backoffTimeout.unref(),this.subchannelAddressString=(0,V.subchannelAddressToString)(S),this.keepaliveTime=null!==(L=N["grpc.keepalive_time_ms"])&&void 0!==L?L:-1,0===N["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new U.ChannelzTrace,this.channelzRef=(0,U.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(N,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(T){P.trace(M.LogVerbosity.DEBUG,$,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}refTrace(T){P.trace(M.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([R.ConnectivityState.TRANSIENT_FAILURE],R.ConnectivityState.CONNECTING):this.transitionToState([R.ConnectivityState.TRANSIENT_FAILURE],R.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let T=this.options;if(T["grpc.keepalive_time_ms"]){let S=Math.min(this.keepaliveTime,W);T=Object.assign(Object.assign({},T),{"grpc.keepalive_time_ms":S})}this.connector.connect(this.subchannelAddress,this.credentials,T).then(T=>{this.transitionToState([R.ConnectivityState.CONNECTING],R.ConnectivityState.READY)?(this.transport=T,this.channelzEnabled&&this.childrenTracker.refChild(T.getChannelzRef()),T.addDisconnectListener(T=>{this.transitionToState([R.ConnectivityState.READY],R.ConnectivityState.IDLE),T&&this.keepaliveTime>0&&(this.keepaliveTime*=2,P.log(M.LogVerbosity.ERROR,`Connection to ${(0,L.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):T.shutdown()},T=>{this.transitionToState([R.ConnectivityState.CONNECTING],R.ConnectivityState.TRANSIENT_FAILURE,`${T}`)})}transitionToState(T,S,N){var O,P;if(-1===T.indexOf(this.connectivityState))return!1;this.trace(R.ConnectivityState[this.connectivityState]+" -> "+R.ConnectivityState[S]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+R.ConnectivityState[S]);let M=this.connectivityState;switch(this.connectivityState=S,S){case R.ConnectivityState.READY:this.stopBackoff();break;case R.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case R.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(O=this.transport)||void 0===O||O.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case R.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(P=this.transport)||void 0===P||P.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${S}`)}for(let T of this.stateListeners)T(this,M,S,this.keepaliveTime,N);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,U.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([R.ConnectivityState.CONNECTING,R.ConnectivityState.READY],R.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(T,S,N,R){let O;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),O={onCallEnd:T=>{T.code===M.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):O={},this.transport.createCall(T,S,N,R,O)}startConnecting(){process.nextTick(()=>{this.transitionToState([R.ConnectivityState.IDLE],R.ConnectivityState.CONNECTING)||this.connectivityState!==R.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(T){this.stateListeners.add(T)}removeConnectivityStateListener(T){this.stateListeners.delete(T)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([R.ConnectivityState.TRANSIENT_FAILURE],R.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(T){return T.getRealSubchannel()===this}throttleKeepalive(T){T>this.keepaliveTime&&(this.keepaliveTime=T)}}S.Subchannel=K},3009:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getDefaultRootsData=S.CIPHER_SUITES=void 0;let R=N(7147);S.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let O=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,P=null;function M(){return O?(null===P&&(P=R.readFileSync(O)),P):null}S.getDefaultRootsData=M},2869:(T,S,N)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2SubchannelConnector=void 0;let R=N(5158),O=N(4404),P=N(5993),M=N(2678),L=N(2039),V=N(7504),U=N(492),$=N(3906),W=N(8429),K=N(1808),Q=N(7060),Y=N(8445),Z="transport",ee="transport_flowctrl",et=N(1513).i8,{HTTP2_HEADER_AUTHORITY:er,HTTP2_HEADER_CONTENT_TYPE:ei,HTTP2_HEADER_METHOD:en,HTTP2_HEADER_PATH:es,HTTP2_HEADER_TE:ea,HTTP2_HEADER_USER_AGENT:eo}=R.constants,eu=2e4,ec=Buffer.from("too_many_pings","ascii");class ed{constructor(T,S,N,O){this.session=T,this.options=N,this.remoteName=O,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=eu,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new P.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,$.subchannelAddressToString)(S),0===N["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,P.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[N["grpc.primary_user_agent"],`grpc-node-js/${et}`,N["grpc.secondary_user_agent"]].filter(T=>T).join(" "),"grpc.keepalive_time_ms"in N&&(this.keepaliveTimeMs=N["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in N&&(this.keepaliveTimeoutMs=N["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in N?this.keepaliveWithoutCalls=1===N["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,T.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),T.once("goaway",(T,S,N)=>{let O=!1;T===R.constants.NGHTTP2_ENHANCE_YOUR_CALM&&N&&N.equals(ec)&&(O=!0),this.trace("connection closed by GOAWAY with code "+T+" and data "+(null==N?void 0:N.toString())),this.reportDisconnectToOwner(O)}),T.once("error",T=>{this.trace("connection closed with error "+T.message)}),V.isTracerEnabled(Z)&&(T.on("remoteSettings",S=>{this.trace("new settings received"+(this.session!==T?" on the old connection":"")+": "+JSON.stringify(S))}),T.on("localSettings",S=>{this.trace("local settings acknowledged by remote"+(this.session!==T?" on the old connection":"")+": "+JSON.stringify(S))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var T,S,N;let R;let O=this.session.socket,P=O.remoteAddress?(0,$.stringToSubchannelAddress)(O.remoteAddress,O.remotePort):null,M=O.localAddress?(0,$.stringToSubchannelAddress)(O.localAddress,O.localPort):null;if(this.session.encrypted){let S=O,N=S.getCipher(),P=S.getCertificate(),M=S.getPeerCertificate();R={cipherSuiteStandardName:null!==(T=N.standardName)&&void 0!==T?T:null,cipherSuiteOtherName:N.standardName?null:N.name,localCertificate:P&&"raw"in P?P.raw:null,remoteCertificate:M&&"raw"in M?M.raw:null}}else R=null;return{remoteAddress:P,localAddress:M,security:R,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(S=this.session.state.localWindowSize)&&void 0!==S?S:null,remoteFlowControlWindow:null!==(N=this.session.state.remoteWindowSize)&&void 0!==N?N:null}}trace(T){V.trace(M.LogVerbosity.DEBUG,Z,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}keepaliveTrace(T){V.trace(M.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}flowControlTrace(T){V.trace(M.LogVerbosity.DEBUG,ee,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}internalsTrace(T){V.trace(M.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}reportDisconnectToOwner(T){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(S=>S(T)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let T of this.activeCalls)T.onDisconnect()})}addDisconnectListener(T){this.disconnectListeners.push(T)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var T,S;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null===(S=(T=this.keepaliveTimeoutId).unref)||void 0===S||S.call(T));try{this.session.ping((T,S,N)=>{T&&(this.keepaliveTrace("Ping failed with error "+T.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(T){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var T,S;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null===(S=(T=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)||void 0===S?void 0:S.call(T)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(T){this.activeCalls.delete(T),0===this.activeCalls.size&&this.session.unref()}addActiveCall(T){this.activeCalls.add(T),1!==this.activeCalls.size||(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(T,S,N,R,O){let P,M,L;let V=T.toHttp2Headers();V[er]=S,V[eo]=this.userAgent,V[ei]="application/grpc",V[en]="POST",V[es]=N,V[ea]="trailers";try{P=this.session.request(V)}catch(T){throw this.handleDisconnect(),T}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),M={addMessageSent:()=>{var T;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null===(T=O.addMessageSent)||void 0===T||T.call(O)},addMessageReceived:()=>{var T;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null===(T=O.addMessageReceived)||void 0===T||T.call(O)},onCallEnd:T=>{var S;null===(S=O.onCallEnd)||void 0===S||S.call(O,T),this.removeActiveCall(L)},onStreamEnd:T=>{var S;T?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null===(S=O.onStreamEnd)||void 0===S||S.call(O,T)}}):M={addMessageSent:()=>{var T;null===(T=O.addMessageSent)||void 0===T||T.call(O)},addMessageReceived:()=>{var T;null===(T=O.addMessageReceived)||void 0===T||T.call(O)},onCallEnd:T=>{var S;null===(S=O.onCallEnd)||void 0===S||S.call(O,T),this.removeActiveCall(L)},onStreamEnd:T=>{var S;null===(S=O.onStreamEnd)||void 0===S||S.call(O,T)}},L=new Q.Http2SubchannelCall(P,M,R,this,(0,Y.getNextCallNumber)()),this.addActiveCall(L),L}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,P.unregisterChannelzRef)(this.channelzRef)}}class eh{constructor(T){this.channelTarget=T,this.session=null,this.isShutdown=!1}trace(T){V.trace(M.LogVerbosity.DEBUG,Z,(0,W.uriToString)(this.channelTarget)+" "+T)}createSession(T,S,N,P){return this.isShutdown?Promise.reject():new Promise((M,L)=>{var V,Q,Y;let Z;P.realTarget?(Z=(0,W.uriToString)(P.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,W.uriToString)(P.realTarget))):(Z=null,this.trace("creating HTTP/2 session to "+(0,$.subchannelAddressToString)(T)));let ee=(0,U.getDefaultAuthority)(null!==(V=P.realTarget)&&void 0!==V?V:this.channelTarget),et=S._getConnectionOptions()||{};et.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in N?et.maxSessionMemory=N["grpc-node.max_session_memory"]:et.maxSessionMemory=Number.MAX_SAFE_INTEGER;let er="http://";if("secureContext"in et){if(er="https://",N["grpc.ssl_target_name_override"]){let T=N["grpc.ssl_target_name_override"];et.checkServerIdentity=(S,N)=>(0,O.checkServerIdentity)(T,N),et.servername=T}else{let T=null!==(Y=null===(Q=(0,W.splitHostPort)(ee))||void 0===Q?void 0:Q.host)&&void 0!==Y?Y:"localhost";et.servername=T}P.socket&&(et.createConnection=(T,S)=>P.socket)}else et.createConnection=(S,N)=>P.socket?P.socket:K.connect(T);et=Object.assign(Object.assign(Object.assign({},et),T),{enableTrace:1===N["grpc-node.tls_enable_trace"]});let ei=R.connect(er+ee,et);this.session=ei;let en="Failed to connect";ei.unref(),ei.once("connect",()=>{ei.removeAllListeners(),M(new ed(ei,T,N,Z)),this.session=null}),ei.once("close",()=>{this.session=null,setImmediate(()=>{L(`${en} (${new Date().toISOString()})`)})}),ei.once("error",T=>{en=T.message,this.trace("connection failed with error "+en)})})}connect(T,S,N){var R,P;if(this.isShutdown)return Promise.reject();let M=S._getConnectionOptions()||{};if("secureContext"in M){if(M.ALPNProtocols=["h2"],N["grpc.ssl_target_name_override"]){let T=N["grpc.ssl_target_name_override"];M.checkServerIdentity=(S,N)=>(0,O.checkServerIdentity)(T,N),M.servername=T}else if("grpc.http_connect_target"in N){let T=(0,U.getDefaultAuthority)(null!==(R=(0,W.parseUri)(N["grpc.http_connect_target"]))&&void 0!==R?R:{path:"localhost"}),S=(0,W.splitHostPort)(T);M.servername=null!==(P=null==S?void 0:S.host)&&void 0!==P?P:T}N["grpc-node.tls_enable_trace"]&&(M.enableTrace=!0)}return(0,L.getProxiedConnection)(T,N,M).then(R=>this.createSession(T,S,N,R))}shutdown(){var T;this.isShutdown=!0,null===(T=this.session)||void 0===T||T.close(),this.session=null}}S.Http2SubchannelConnector=eh},8429:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.uriToString=S.splitHostPort=S.parseUri=void 0;let N=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function R(T){let S=N.exec(T);return null===S?null:{scheme:S[1],authority:S[2],path:S[3]}}S.parseUri=R;let O=/^\d+$/;function P(T){if(T.startsWith("[")){let S=T.indexOf("]");if(-1===S)return null;let N=T.substring(1,S);if(-1===N.indexOf(":"))return null;if(!(T.length>S+1))return{host:N};if(":"!==T[S+1])return null;{let R=T.substring(S+2);return O.test(R)?{host:N,port:+R}:null}}{let S=T.split(":");return 2!==S.length?{host:T}:O.test(S[1])?{host:S[0],port:+S[1]}:null}}function M(T){let S="";return void 0!==T.scheme&&(S+=T.scheme+":"),void 0!==T.authority&&(S+="//"+T.authority+"/"),S+=T.path}S.splitHostPort=P,S.uriToString=M},8715:(T,S,N)=>{"use strict";var R,O;/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */R={value:!0},R=R=S.im=S.J_=R=S.Cp=R=R=void 0;let P=N(1382),M=N(5269),L=N(1725),V=N(2916);R=N(1468),R=function(T){return"@type"in T&&"string"==typeof T["@type"]},function(T){T.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",T.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",T.IDEMPOTENT="IDEMPOTENT"}(O=S.Cp||(S.Cp={}));let U={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function $(T,S){return""===T?S:T+"."+S}function W(T){return T instanceof M.Service||T instanceof M.Type||T instanceof M.Enum}function K(T){return T instanceof M.Namespace||T instanceof M.Root}function Q(T,S){let N=$(S,T.name);return W(T)?[[N,T]]:K(T)&&void 0!==T.nested?Object.keys(T.nested).map(S=>Q(T.nested[S],N)).reduce((T,S)=>T.concat(S),[]):[]}function Y(T,S){return function(N){return T.toObject(T.decode(N),S)}}function Z(T){return function(S){if(Array.isArray(S))throw Error(`Failed to serialize message: expected object with ${T.name} structure, got array instead`);let N=T.fromObject(S);return T.encode(N).finish()}}function ee(T){return(T||[]).reduce((T,S)=>{for(let[N,R]of Object.entries(S))"uninterpreted_option"===N?T.uninterpreted_option.push(S.uninterpreted_option):T[N]=R;return T},{deprecated:!1,idempotency_level:O.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function et(T,S,N,R){let O=T.resolvedRequestType,M=T.resolvedResponseType;return{path:"/"+S+"/"+T.name,requestStream:!!T.requestStream,responseStream:!!T.responseStream,requestSerialize:Z(O),requestDeserialize:Y(O,N),responseSerialize:Z(M),responseDeserialize:Y(M,N),originalName:P(T.name),requestType:ei(O,R),responseType:ei(M,R),options:ee(T.parsedOptions)}}function er(T,S,N,R){let O={};for(let P of T.methodsArray)O[P.name]=et(P,S,N,R);return O}function ei(T,S){let N=T.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:N.$type.toObject(N,U),fileDescriptorProtos:S}}function en(T,S){let N=T.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:N.$type.toObject(N,U),fileDescriptorProtos:S}}function es(T,S,N,R){if(T instanceof M.Service)return er(T,S,N,R);if(T instanceof M.Type)return ei(T,R);if(T instanceof M.Enum)return en(T,R);throw Error("Type mismatch in reflection object handling")}function ea(T,S){let N={};T.resolveAll();let R=T.toDescriptor("proto3").file.map(T=>Buffer.from(L.FileDescriptorProto.encode(T).finish()));for(let[O,P]of Q(T,""))N[O]=es(P,O,S,R);return N}function eo(T,S){S=S||{};let N=M.Root.fromDescriptor(T);return N.resolveAll(),ea(N,S)}function eu(T,S){return ea((0,V.loadProtosWithOptionsSync)(T,S),S)}function ec(T,S){S=S||{};let N=M.Root.fromJSON(T);return N.resolveAll(),ea(N,S)}R=function(T,S){return(0,V.loadProtosWithOptions)(T,S).then(T=>ea(T,S))},S.J_=eu,S.im=ec,R=function(T,S){return eo(L.FileDescriptorSet.decode(T),S)},R=function(T,S){return eo(L.FileDescriptorSet.fromObject(T),S)},(0,V.addCommonProtos)()},2916:(T,S,N)=>{"use strict";/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */Object.defineProperty(S,"__esModule",{value:!0}),S.addCommonProtos=S.loadProtosWithOptionsSync=S.loadProtosWithOptions=void 0;let R=N(7147),O=N(1017),P=N(5269);function M(T,S){let N=T.resolvePath;T.resolvePath=(T,P)=>{if(O.isAbsolute(P))return P;for(let T of S){let S=O.join(T,P);try{return R.accessSync(S,R.constants.R_OK),S}catch(T){continue}}return process.emitWarning(`${P} not found in any of the include paths ${S}`),N(T,P)}}async function L(T,S){let N=new P.Root;if((S=S||{}).includeDirs){if(!Array.isArray(S.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));M(N,S.includeDirs)}let R=await N.load(T,S);return R.resolveAll(),R}function V(T,S){let N=new P.Root;if((S=S||{}).includeDirs){if(!Array.isArray(S.includeDirs))throw Error("The includeDirs option must be an array");M(N,S.includeDirs)}let R=N.loadSync(T,S);return R.resolveAll(),R}function U(){let T=N(6541),S=N(9987),R=N(7674),O=N(3795);P.common("api",T.nested.google.nested.protobuf.nested),P.common("descriptor",S.nested.google.nested.protobuf.nested),P.common("source_context",R.nested.google.nested.protobuf.nested),P.common("type",O.nested.google.nested.protobuf.nested)}S.loadProtosWithOptions=L,S.loadProtosWithOptionsSync=V,S.addCommonProtos=U},799:T=>{"use strict";function S(T,S){for(var N=Array(arguments.length-1),R=0,O=2,P=!0;O<arguments.length;)N[R++]=arguments[O++];return new Promise(function(O,M){N[R]=function(T){if(P){if(P=!1,T)M(T);else{for(var S=Array(arguments.length-1),N=0;N<S.length;)S[N++]=arguments[N];O.apply(null,S)}}};try{T.apply(S||null,N)}catch(T){P&&(P=!1,M(T))}})}T.exports=S},2130:(T,S)=>{"use strict";var N=S;N.length=function(T){var S=T.length;if(!S)return 0;for(var N=0;--S%4>1&&"="===T.charAt(S);)++N;return Math.ceil(3*T.length)/4-N};for(var R=Array(64),O=Array(123),P=0;P<64;)O[R[P]=P<26?P+65:P<52?P+71:P<62?P-4:P-59|43]=P++;N.encode=function(T,S,N){for(var O,P=null,M=[],L=0,V=0;S<N;){var U=T[S++];switch(V){case 0:M[L++]=R[U>>2],O=(3&U)<<4,V=1;break;case 1:M[L++]=R[O|U>>4],O=(15&U)<<2,V=2;break;case 2:M[L++]=R[O|U>>6],M[L++]=R[63&U],V=0}L>8191&&((P||(P=[])).push(String.fromCharCode.apply(String,M)),L=0)}return(V&&(M[L++]=R[O],M[L++]=61,1===V&&(M[L++]=61)),P)?(L&&P.push(String.fromCharCode.apply(String,M.slice(0,L))),P.join("")):String.fromCharCode.apply(String,M.slice(0,L))};var M="invalid encoding";N.decode=function(T,S,N){for(var R,P=N,L=0,V=0;V<T.length;){var U=T.charCodeAt(V++);if(61===U&&L>1)break;if(void 0===(U=O[U]))throw Error(M);switch(L){case 0:R=U,L=1;break;case 1:S[N++]=R<<2|(48&U)>>4,R=U,L=2;break;case 2:S[N++]=(15&R)<<4|(60&U)>>2,R=U,L=3;break;case 3:S[N++]=(3&R)<<6|U,L=0}}if(1===L)throw Error(M);return N-P},N.test=function(T){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(T)}},2012:T=>{"use strict";function S(T,N){"string"==typeof T&&(N=T,T=void 0);var R=[];function O(T){if("string"!=typeof T){var N=P();if(S.verbose&&console.log("codegen: "+N),N="return "+N,T){for(var M=Object.keys(T),L=Array(M.length+1),V=Array(M.length),U=0;U<M.length;)L[U]=M[U],V[U]=T[M[U++]];return L[U]=N,Function.apply(null,L).apply(null,V)}return Function(N)()}for(var $=Array(arguments.length-1),W=0;W<$.length;)$[W]=arguments[++W];if(W=0,T=T.replace(/%([%dfijs])/g,function(T,S){var N=$[W++];switch(S){case"d":case"f":return String(Number(N));case"i":return String(Math.floor(N));case"j":return JSON.stringify(N);case"s":return String(N)}return"%"}),W!==$.length)throw Error("parameter count mismatch");return R.push(T),O}function P(S){return"function "+(S||N||"")+"("+(T&&T.join(",")||"")+"){\n  "+R.join("\n  ")+"\n}"}return O.toString=P,O}T.exports=S,S.verbose=!1},854:T=>{"use strict";function S(){this._listeners={}}T.exports=S,S.prototype.on=function(T,S,N){return(this._listeners[T]||(this._listeners[T]=[])).push({fn:S,ctx:N||this}),this},S.prototype.off=function(T,S){if(void 0===T)this._listeners={};else if(void 0===S)this._listeners[T]=[];else for(var N=this._listeners[T],R=0;R<N.length;)N[R].fn===S?N.splice(R,1):++R;return this},S.prototype.emit=function(T){var S=this._listeners[T];if(S){for(var N=[],R=1;R<arguments.length;)N.push(arguments[R++]);for(R=0;R<S.length;)S[R].fn.apply(S[R++].ctx,N)}return this}},3035:(T,S,N)=>{"use strict";T.exports=P;var R=N(799),O=N(449)("fs");function P(T,S,N){return("function"==typeof S?(N=S,S={}):S||(S={}),N)?!S.xhr&&O&&O.readFile?O.readFile(T,function(R,O){return R&&"undefined"!=typeof XMLHttpRequest?P.xhr(T,S,N):R?N(R):N(null,S.binary?O:O.toString("utf8"))}):P.xhr(T,S,N):R(P,this,T,S)}P.xhr=function(T,S,N){var R=new XMLHttpRequest;R.onreadystatechange=function(){if(4===R.readyState){if(0!==R.status&&200!==R.status)return N(Error("status "+R.status));if(S.binary){var T=R.response;if(!T){T=[];for(var O=0;O<R.responseText.length;++O)T.push(255&R.responseText.charCodeAt(O))}return N(null,"undefined"!=typeof Uint8Array?new Uint8Array(T):T)}return N(null,R.responseText)}},S.binary&&("overrideMimeType"in R&&R.overrideMimeType("text/plain; charset=x-user-defined"),R.responseType="arraybuffer"),R.open("GET",T),R.send()}},4324:T=>{"use strict";function S(T){return"undefined"!=typeof Float32Array?function(){var S=new Float32Array([-0]),N=new Uint8Array(S.buffer),R=128===N[3];function O(T,R,O){S[0]=T,R[O]=N[0],R[O+1]=N[1],R[O+2]=N[2],R[O+3]=N[3]}function P(T,R,O){S[0]=T,R[O]=N[3],R[O+1]=N[2],R[O+2]=N[1],R[O+3]=N[0]}function M(T,R){return N[0]=T[R],N[1]=T[R+1],N[2]=T[R+2],N[3]=T[R+3],S[0]}function L(T,R){return N[3]=T[R],N[2]=T[R+1],N[1]=T[R+2],N[0]=T[R+3],S[0]}T.writeFloatLE=R?O:P,T.writeFloatBE=R?P:O,T.readFloatLE=R?M:L,T.readFloatBE=R?L:M}():function(){function S(T,S,N,R){var O=S<0?1:0;if(O&&(S=-S),0===S)T(1/S>0?0:2147483648,N,R);else if(isNaN(S))T(2143289344,N,R);else if(S>34028234663852886e22)T((O<<31|2139095040)>>>0,N,R);else if(S<11754943508222875e-54)T((O<<31|Math.round(S/1401298464324817e-60))>>>0,N,R);else{var P=Math.floor(Math.log(S)/Math.LN2),M=8388607&Math.round(S*Math.pow(2,-P)*8388608);T((O<<31|P+127<<23|M)>>>0,N,R)}}function M(T,S,N){var R=T(S,N),O=(R>>31)*2+1,P=R>>>23&255,M=8388607&R;return 255===P?M?NaN:1/0*O:0===P?1401298464324817e-60*O*M:O*Math.pow(2,P-150)*(M+8388608)}T.writeFloatLE=S.bind(null,N),T.writeFloatBE=S.bind(null,R),T.readFloatLE=M.bind(null,O),T.readFloatBE=M.bind(null,P)}(),"undefined"!=typeof Float64Array?function(){var S=new Float64Array([-0]),N=new Uint8Array(S.buffer),R=128===N[7];function O(T,R,O){S[0]=T,R[O]=N[0],R[O+1]=N[1],R[O+2]=N[2],R[O+3]=N[3],R[O+4]=N[4],R[O+5]=N[5],R[O+6]=N[6],R[O+7]=N[7]}function P(T,R,O){S[0]=T,R[O]=N[7],R[O+1]=N[6],R[O+2]=N[5],R[O+3]=N[4],R[O+4]=N[3],R[O+5]=N[2],R[O+6]=N[1],R[O+7]=N[0]}function M(T,R){return N[0]=T[R],N[1]=T[R+1],N[2]=T[R+2],N[3]=T[R+3],N[4]=T[R+4],N[5]=T[R+5],N[6]=T[R+6],N[7]=T[R+7],S[0]}function L(T,R){return N[7]=T[R],N[6]=T[R+1],N[5]=T[R+2],N[4]=T[R+3],N[3]=T[R+4],N[2]=T[R+5],N[1]=T[R+6],N[0]=T[R+7],S[0]}T.writeDoubleLE=R?O:P,T.writeDoubleBE=R?P:O,T.readDoubleLE=R?M:L,T.readDoubleBE=R?L:M}():function(){function S(T,S,N,R,O,P){var M,L=R<0?1:0;if(L&&(R=-R),0===R)T(0,O,P+S),T(1/R>0?0:2147483648,O,P+N);else if(isNaN(R))T(0,O,P+S),T(2146959360,O,P+N);else if(R>17976931348623157e292)T(0,O,P+S),T((L<<31|2146435072)>>>0,O,P+N);else if(R<22250738585072014e-324)T((M=R/5e-324)>>>0,O,P+S),T((L<<31|M/4294967296)>>>0,O,P+N);else{var V=Math.floor(Math.log(R)/Math.LN2);1024===V&&(V=1023),T(4503599627370496*(M=R*Math.pow(2,-V))>>>0,O,P+S),T((L<<31|V+1023<<20|1048576*M&1048575)>>>0,O,P+N)}}function M(T,S,N,R,O){var P=T(R,O+S),M=T(R,O+N),L=(M>>31)*2+1,V=M>>>20&2047,U=4294967296*(1048575&M)+P;return 2047===V?U?NaN:1/0*L:0===V?5e-324*L*U:L*Math.pow(2,V-1075)*(U+4503599627370496)}T.writeDoubleLE=S.bind(null,N,0,4),T.writeDoubleBE=S.bind(null,R,4,0),T.readDoubleLE=M.bind(null,O,0,4),T.readDoubleBE=M.bind(null,P,4,0)}(),T}function N(T,S,N){S[N]=255&T,S[N+1]=T>>>8&255,S[N+2]=T>>>16&255,S[N+3]=T>>>24}function R(T,S,N){S[N]=T>>>24,S[N+1]=T>>>16&255,S[N+2]=T>>>8&255,S[N+3]=255&T}function O(T,S){return(T[S]|T[S+1]<<8|T[S+2]<<16|T[S+3]<<24)>>>0}function P(T,S){return(T[S]<<24|T[S+1]<<16|T[S+2]<<8|T[S+3])>>>0}T.exports=S(S)},449:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},9986:(T,S)=>{"use strict";var N=S,R=N.isAbsolute=function(T){return/^(?:\/|\w+:)/.test(T)},O=N.normalize=function(T){var S=(T=T.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),N=R(T),O="";N&&(O=S.shift()+"/");for(var P=0;P<S.length;)".."===S[P]?P>0&&".."!==S[P-1]?S.splice(--P,2):N?S.splice(P,1):++P:"."===S[P]?S.splice(P,1):++P;return O+S.join("/")};N.resolve=function(T,S,N){return(N||(S=O(S)),R(S))?S:(N||(T=O(T)),(T=T.replace(/(?:\/|^)[^/]+$/,"")).length?O(T+"/"+S):S)}},6035:T=>{"use strict";function S(T,S,N){var R=N||8192,O=R>>>1,P=null,M=R;return function(N){if(N<1||N>O)return T(N);M+N>R&&(P=T(R),M=0);var L=S.call(P,M,M+=N);return 7&M&&(M=(7|M)+1),L}}T.exports=S},8131:(T,S)=>{"use strict";var N=S;N.length=function(T){for(var S=0,N=0,R=0;R<T.length;++R)(N=T.charCodeAt(R))<128?S+=1:N<2048?S+=2:(64512&N)==55296&&(64512&T.charCodeAt(R+1))==56320?(++R,S+=4):S+=3;return S},N.read=function(T,S,N){if(N-S<1)return"";for(var R,O=null,P=[],M=0;S<N;)(R=T[S++])<128?P[M++]=R:R>191&&R<224?P[M++]=(31&R)<<6|63&T[S++]:R>239&&R<365?(R=((7&R)<<18|(63&T[S++])<<12|(63&T[S++])<<6|63&T[S++])-65536,P[M++]=55296+(R>>10),P[M++]=56320+(1023&R)):P[M++]=(15&R)<<12|(63&T[S++])<<6|63&T[S++],M>8191&&((O||(O=[])).push(String.fromCharCode.apply(String,P)),M=0);return O?(M&&O.push(String.fromCharCode.apply(String,P.slice(0,M))),O.join("")):String.fromCharCode.apply(String,P.slice(0,M))},N.write=function(T,S,N){for(var R,O,P=N,M=0;M<T.length;++M)(R=T.charCodeAt(M))<128?S[N++]=R:(R<2048?S[N++]=R>>6|192:((64512&R)==55296&&(64512&(O=T.charCodeAt(M+1)))==56320?(R=65536+((1023&R)<<10)+(1023&O),++M,S[N++]=R>>18|240,S[N++]=R>>12&63|128):S[N++]=R>>12|224,S[N++]=R>>6&63|128),S[N++]=63&R|128);return N-P}},1382:T=>{var S=1/0,N="[object Symbol]",R=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,O=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,P="\ud800-\udfff",M="\\u0300-\\u036f\\ufe20-\\ufe23",L="\\u20d0-\\u20f0",V="\\u2700-\\u27bf",U="a-z\\xdf-\\xf6\\xf8-\\xff",$="A-Z\\xc0-\\xd6\\xd8-\\xde",W="\\ufe0e\\ufe0f",K="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Q="['’]",Y="["+P+"]",Z="["+K+"]",ee="["+M+L+"]",et="\\d+",er="["+V+"]",ei="["+U+"]",en="[^"+P+K+et+V+U+$+"]",es="\ud83c[\udffb-\udfff]",ea="[^"+P+"]",eo="(?:\ud83c[\udde6-\uddff]){2}",eu="[\ud800-\udbff][\udc00-\udfff]",ec="["+$+"]",ed="\\u200d",eh="(?:"+ei+"|"+en+")",ep="(?:"+ec+"|"+en+")",ef="(?:"+Q+"(?:d|ll|m|re|s|t|ve))?",em="(?:"+Q+"(?:D|LL|M|RE|S|T|VE))?",eg="(?:"+ee+"|"+es+")?",ey="["+W+"]?",ev="(?:"+ed+"(?:"+[ea,eo,eu].join("|")+")"+ey+eg+")*",eb=ey+eg+ev,ew="(?:"+[er,eo,eu].join("|")+")"+eb,eT="(?:"+[ea+ee+"?",ee,eo,eu,Y].join("|")+")",eS=RegExp(Q,"g"),ex=RegExp(ee,"g"),eE=RegExp(es+"(?="+es+")|"+eT+eb,"g"),eC=RegExp([ec+"?"+ei+"+"+ef+"(?="+[Z,ec,"$"].join("|")+")",ep+"+"+em+"(?="+[Z,ec+eh,"$"].join("|")+")",ec+"?"+eh+"+"+ef,ec+"+"+em,et,ew].join("|"),"g"),e_=RegExp("["+ed+P+M+L+W+"]"),eI=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ek={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"ss"},eN="object"==typeof global&&global&&global.Object===Object&&global,eA="object"==typeof self&&self&&self.Object===Object&&self,eR=eN||eA||Function("return this")();function eD(T,S,N,R){var O=-1,P=T?T.length:0;for(R&&P&&(N=T[++O]);++O<P;)N=S(N,T[O],O,T);return N}function eO(T){return T.split("")}function eP(T){return T.match(R)||[]}var eM=function(T){return function(S){return null==T?void 0:T[S]}}(ek);function eL(T){return e_.test(T)}function ej(T){return eI.test(T)}function eF(T){return eL(T)?eB(T):eO(T)}function eB(T){return T.match(eE)||[]}function eV(T){return T.match(eC)||[]}var eU=Object.prototype.toString,ez=eR.Symbol,eq=ez?ez.prototype:void 0,e$=eq?eq.toString:void 0;function eH(T,S,N){var R=-1,O=T.length;S<0&&(S=-S>O?0:O+S),(N=N>O?O:N)<0&&(N+=O),O=S>N?0:N-S>>>0,S>>>=0;for(var P=Array(O);++R<O;)P[R]=T[R+S];return P}function eG(T){if("string"==typeof T)return T;if(eY(T))return e$?e$.call(T):"";var N=T+"";return"0"==N&&1/T==-S?"-0":N}function eW(T,S,N){var R=T.length;return N=void 0===N?R:N,!S&&N>=R?T:eH(T,S,N)}function eK(T){return function(S){var N=eL(S=eJ(S))?eF(S):void 0,R=N?N[0]:S.charAt(0),O=N?eW(N,1).join(""):S.slice(1);return R[T]()+O}}function eQ(T){return!!T&&"object"==typeof T}function eY(T){return"symbol"==typeof T||eQ(T)&&eU.call(T)==N}function eJ(T){return null==T?"":eG(T)}var eX=function(T){return function(S){return eD(e2(e0(S).replace(eS,"")),T,"")}}(function(T,S,N){return S=S.toLowerCase(),T+(N?eZ(S):S)});function eZ(T){return e1(eJ(T).toLowerCase())}function e0(T){return(T=eJ(T))&&T.replace(O,eM).replace(ex,"")}var e1=eK("toUpperCase");function e2(T,S,N){return(T=eJ(T),void 0===(S=N?void 0:S))?ej(T)?eV(T):eP(T):T.match(S)||[]}T.exports=eX},2295:(T,S,N)=>{"use strict";T.exports=N(6372).vendored["react-ssr"].ReactJsxRuntime},681:T=>{"use strict";function S(T){this._maxSize=T,this.clear()}S.prototype.clear=function(){this._size=0,this._values=Object.create(null)},S.prototype.get=function(T){return this._values[T]},S.prototype.set=function(T,S){return this._size>=this._maxSize&&this.clear(),!(T in this._values)&&this._size++,this._values[T]=S};var N=/[^.^\]^[]+|(?=\[\]|\.\.)/g,R=/^\d+$/,O=/^\d/,P=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,M=/^\s*(['"]?)(.*?)(\1)\s*$/,L=512,V=new S(512),U=new S(L),$=new S(L);function W(T){return V.get(T)||V.set(T,K(T).map(function(T){return T.replace(M,"$2")}))}function K(T){return T.match(N)||[""]}function Q(T,S,N){var R,O,P,M,L=T.length;for(O=0;O<L;O++)(R=T[O])&&(et(R)&&(R='"'+R+'"'),P=!(M=Y(R))&&/^\d+$/.test(R),S.call(N,R,M,P,O,T))}function Y(T){return"string"==typeof T&&T&&-1!==["'",'"'].indexOf(T.charAt(0))}function Z(T){return T.match(O)&&!T.match(R)}function ee(T){return P.test(T)}function et(T){return!Y(T)&&(Z(T)||ee(T))}T.exports={Cache:S,split:K,normalizePath:W,setter:function(T){var S=W(T);return U.get(T)||U.set(T,function(T,N){for(var R=0,O=S.length,P=T;R<O-1;){var M=S[R];if("__proto__"===M||"constructor"===M||"prototype"===M)return T;P=P[S[R++]]}P[S[R]]=N})},getter:function(T,S){var N=W(T);return $.get(T)||$.set(T,function(T){for(var R=0,O=N.length;R<O;){if(null==T&&S)return;T=T[N[R++]]}return T})},join:function(T){return T.reduce(function(T,S){return T+(Y(S)||R.test(S)?"["+S+"]":(T?".":"")+S)},"")},forEach:function(T,S,N){Q(Array.isArray(T)?T:K(T),S,N)}}},1725:(T,S,N)=>{"use strict";var R=N(5269);T.exports=S=R.descriptor=R.Root.fromJSON(N(9987)).lookup(".google.protobuf");var O=R.Namespace,P=R.Root,M=R.Enum,L=R.Type,V=R.Field,U=R.MapField,$=R.OneOf,W=R.Service,K=R.Method;function Q(T,N,R){var U=S.FileDescriptorProto.create({name:T.filename||(T.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});em(R,U),T instanceof P||(U.package=T.fullName.substring(1));for(var $,K=0;K<T.nestedArray.length;++K)($=T._nestedArray[K])instanceof L?U.messageType.push($.toDescriptor(R)):$ instanceof M?U.enumType.push($.toDescriptor()):$ instanceof V?U.extension.push($.toDescriptor(R)):$ instanceof W?U.service.push($.toDescriptor()):$ instanceof O&&Q($,N,R);U.options=ed(T.options,S.FileOptions),U.messageType.length+U.enumType.length+U.extension.length+U.service.length&&N.push(U)}P.fromDescriptor=function(T){"number"==typeof T.length&&(T=S.FileDescriptorSet.decode(T));var N=new P;if(T.file)for(var R,O,U,$=0;$<T.file.length;++$){O=N,(R=T.file[$]).package&&R.package.length&&(O=N.define(R.package));var K=ef(R);if(R.name&&R.name.length&&N.files.push(O.filename=R.name),R.messageType)for(U=0;U<R.messageType.length;++U)O.add(L.fromDescriptor(R.messageType[U],K));if(R.enumType)for(U=0;U<R.enumType.length;++U)O.add(M.fromDescriptor(R.enumType[U],K));if(R.extension)for(U=0;U<R.extension.length;++U)O.add(V.fromDescriptor(R.extension[U],K));if(R.service)for(U=0;U<R.service.length;++U)O.add(W.fromDescriptor(R.service[U],K));var Q=eu(R.options,S.FileOptions);if(Q){var Y=Object.keys(Q);for(U=0;U<Y.length;++U)O.setOption(Y[U],Q[Y[U]])}}return N.resolveAll()},P.prototype.toDescriptor=function(T){var N=S.FileDescriptorSet.create();return Q(this,N.file,T),N};var Y=0;L.fromDescriptor=function(T,N,R){"number"==typeof T.length&&(T=S.DescriptorProto.decode(T));var O,P=new L(T.name.length?T.name:"Type"+Y++,eu(T.options,S.MessageOptions));if(R||(P._edition=N),T.oneofDecl)for(O=0;O<T.oneofDecl.length;++O)P.add($.fromDescriptor(T.oneofDecl[O]));if(T.field)for(O=0;O<T.field.length;++O){var U=V.fromDescriptor(T.field[O],N,!0);P.add(U),T.field[O].hasOwnProperty("oneofIndex")&&P.oneofsArray[T.field[O].oneofIndex].add(U)}if(T.extension)for(O=0;O<T.extension.length;++O)P.add(V.fromDescriptor(T.extension[O],N,!0));if(T.nestedType)for(O=0;O<T.nestedType.length;++O)P.add(L.fromDescriptor(T.nestedType[O],N,!0)),T.nestedType[O].options&&T.nestedType[O].options.mapEntry&&P.setOption("map_entry",!0);if(T.enumType)for(O=0;O<T.enumType.length;++O)P.add(M.fromDescriptor(T.enumType[O],N,!0));if(T.extensionRange&&T.extensionRange.length)for(O=0,P.extensions=[];O<T.extensionRange.length;++O)P.extensions.push([T.extensionRange[O].start,T.extensionRange[O].end]);if(T.reservedRange&&T.reservedRange.length||T.reservedName&&T.reservedName.length){if(P.reserved=[],T.reservedRange)for(O=0;O<T.reservedRange.length;++O)P.reserved.push([T.reservedRange[O].start,T.reservedRange[O].end]);if(T.reservedName)for(O=0;O<T.reservedName.length;++O)P.reserved.push(T.reservedName[O])}return P},L.prototype.toDescriptor=function(T){var N,R,O=S.DescriptorProto.create({name:this.name});for(R=0;R<this.fieldsArray.length;++R)if(O.field.push(N=this._fieldsArray[R].toDescriptor(T)),this._fieldsArray[R]instanceof U){var P=ea(this._fieldsArray[R].keyType,this._fieldsArray[R].resolvedKeyType,!1),$=ea(this._fieldsArray[R].type,this._fieldsArray[R].resolvedType,!1),W=11===$||14===$?this._fieldsArray[R].resolvedType&&eh(this.parent,this._fieldsArray[R].resolvedType)||this._fieldsArray[R].type:void 0;O.nestedType.push(S.DescriptorProto.create({name:N.typeName,field:[S.FieldDescriptorProto.create({name:"key",number:1,label:1,type:P}),S.FieldDescriptorProto.create({name:"value",number:2,label:1,type:$,typeName:W})],options:S.MessageOptions.create({mapEntry:!0})}))}for(R=0;R<this.oneofsArray.length;++R)O.oneofDecl.push(this._oneofsArray[R].toDescriptor());for(R=0;R<this.nestedArray.length;++R)this._nestedArray[R]instanceof V?O.field.push(this._nestedArray[R].toDescriptor(T)):this._nestedArray[R]instanceof L?O.nestedType.push(this._nestedArray[R].toDescriptor(T)):this._nestedArray[R]instanceof M&&O.enumType.push(this._nestedArray[R].toDescriptor());if(this.extensions)for(R=0;R<this.extensions.length;++R)O.extensionRange.push(S.DescriptorProto.ExtensionRange.create({start:this.extensions[R][0],end:this.extensions[R][1]}));if(this.reserved)for(R=0;R<this.reserved.length;++R)"string"==typeof this.reserved[R]?O.reservedName.push(this.reserved[R]):O.reservedRange.push(S.DescriptorProto.ReservedRange.create({start:this.reserved[R][0],end:this.reserved[R][1]}));return O.options=ed(this.options,S.MessageOptions),O};var Z=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;V.fromDescriptor=function(T,N,R){if("number"==typeof T.length&&(T=S.DescriptorProto.decode(T)),"number"!=typeof T.number)throw Error("missing field id");switch(O=T.typeName&&T.typeName.length?T.typeName:en(T.type),T.label){case 1:P=void 0;break;case 2:P="required";break;case 3:P="repeated";break;default:throw Error("illegal label: "+T.label)}var O,P,M=T.extendee;void 0!==T.extendee&&(M=M.length?M:void 0);var L=new V(T.name.length?T.name:"field"+T.number,T.number,O,P,M);if(R||(L._edition=N),L.options=eu(T.options,S.FieldOptions),T.proto3_optional&&(L.options.proto3_optional=!0),T.defaultValue&&T.defaultValue.length){var U=T.defaultValue;switch(U){case"true":case"TRUE":U=!0;break;case"false":case"FALSE":U=!1;break;default:Z.exec(U)&&(U=parseInt(U))}L.setOption("default",U)}return es(T.type)&&("proto3"===N?T.options&&!T.options.packed&&L.setOption("packed",!1):(!N||"proto2"===N)&&T.options&&T.options.packed&&L.setOption("packed",!0)),L},V.prototype.toDescriptor=function(T){var N=S.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)N.type=11,N.typeName=R.util.ucFirst(this.name),N.label=3;else{switch(N.type=ea(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:N.typeName=this.resolvedType?eh(this.parent,this.resolvedType):this.type}"repeated"===this.rule?N.label=3:this.required&&"proto2"===T?N.label=2:N.label=1}if(N.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(N.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(N.options=ed(this.options,S.FieldOptions),null!=this.options.default&&(N.defaultValue=String(this.options.default)),this.options.proto3_optional&&(N.proto3_optional=!0)),"proto3"===T?this.packed||((N.options||(N.options=S.FieldOptions.create())).packed=!1):(!T||"proto2"===T)&&this.packed&&((N.options||(N.options=S.FieldOptions.create())).packed=!0),N};var ee=0;M.fromDescriptor=function(T,N,R){"number"==typeof T.length&&(T=S.EnumDescriptorProto.decode(T));var O={};if(T.value)for(var P=0;P<T.value.length;++P){var L=T.value[P].name,V=T.value[P].number||0;O[L&&L.length?L:"NAME"+V]=V}var U=new M(T.name&&T.name.length?T.name:"Enum"+ee++,O,eu(T.options,S.EnumOptions));return R||(U._edition=N),U},M.prototype.toDescriptor=function(){for(var T=[],N=0,R=Object.keys(this.values);N<R.length;++N)T.push(S.EnumValueDescriptorProto.create({name:R[N],number:this.values[R[N]]}));return S.EnumDescriptorProto.create({name:this.name,value:T,options:ed(this.options,S.EnumOptions)})};var et=0;$.fromDescriptor=function(T){return"number"==typeof T.length&&(T=S.OneofDescriptorProto.decode(T)),new $(T.name&&T.name.length?T.name:"oneof"+et++)},$.prototype.toDescriptor=function(){return S.OneofDescriptorProto.create({name:this.name})};var er=0;W.fromDescriptor=function(T,N,R){"number"==typeof T.length&&(T=S.ServiceDescriptorProto.decode(T));var O=new W(T.name&&T.name.length?T.name:"Service"+er++,eu(T.options,S.ServiceOptions));if(R||(O._edition=N),T.method)for(var P=0;P<T.method.length;++P)O.add(K.fromDescriptor(T.method[P]));return O},W.prototype.toDescriptor=function(){for(var T=[],N=0;N<this.methodsArray.length;++N)T.push(this._methodsArray[N].toDescriptor());return S.ServiceDescriptorProto.create({name:this.name,method:T,options:ed(this.options,S.ServiceOptions)})};var ei=0;function en(T){switch(T){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+T)}function es(T){switch(T){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function ea(T,S,N){switch(T){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(S instanceof M)return 14;if(S instanceof L)return N?10:11;throw Error("illegal type: "+T)}function eo(T,S){for(var N,R,O={},P=0;P<S.fieldsArray.length;++P)if("uninterpretedOption"!==(R=(N=S._fieldsArray[P]).name)&&Object.prototype.hasOwnProperty.call(T,R)){var V=ep(R);N.resolvedType instanceof L?O[V]=eo(T[R],N.resolvedType):N.resolvedType instanceof M?O[V]=N.resolvedType.valuesById[T[R]]:O[V]=T[R]}return O}function eu(T,S){if(T)return eo(S.toObject(T),S)}function ec(T,S){for(var N={},O=Object.keys(T),P=0;P<O.length;++P){var M=O[P],V=R.util.camelCase(M);if(Object.prototype.hasOwnProperty.call(S.fields,V)){var U=S.fields[V];U.resolvedType instanceof L?N[V]=ec(T[M],U.resolvedType):N[V]=T[M],U.repeated&&!Array.isArray(N[V])&&(N[V]=[N[V]])}}return N}function ed(T,S){if(T)return S.fromObject(ec(T,S))}function eh(T,S){var N=T.fullName.split("."),R=S.fullName.split("."),M=0,L=0,V=R.length-1;if(!(T instanceof P)&&S instanceof O)for(;M<N.length&&L<V&&N[M]===R[L];){var U=S.lookup(N[M++],!0);if(null!==U&&U!==S)break;++L}else for(;M<N.length&&L<V&&N[M]===R[L];++M,++L);return R.slice(L).join(".")}function ep(T){return T.substring(0,1)+T.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(T,S){return"_"+S.toLowerCase()})}function ef(T){if("editions"===T.syntax){if(T.edition===S.Edition.EDITION_2023)return"2023";throw Error("Unsupported edition "+T.edition)}return"proto3"===T.syntax?"proto3":"proto2"}function em(T,N){if(T){if("proto2"===T||"proto3"===T)N.syntax=T;else if(N.syntax="editions","2023"===T)N.edition=S.Edition.EDITION_2023;else throw Error("Unsupported edition "+T)}}K.fromDescriptor=function(T){return"number"==typeof T.length&&(T=S.MethodDescriptorProto.decode(T)),new K(T.name&&T.name.length?T.name:"Method"+ei++,"rpc",T.inputType,T.outputType,!!T.clientStreaming,!!T.serverStreaming,eu(T.options,S.MethodOptions))},K.prototype.toDescriptor=function(){return S.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:ed(this.options,S.MethodOptions)})}},5269:(T,S,N)=>{"use strict";T.exports=N(7954)},2516:T=>{"use strict";T.exports=R;var S,N=/\/|\./;function R(T,S){N.test(T)||(T="google/protobuf/"+T+".proto",S={nested:{google:{nested:{protobuf:{nested:S}}}}}),R[T]=S}R("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),R("duration",{Duration:S={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),R("timestamp",{Timestamp:S}),R("empty",{Empty:{fields:{}}}),R("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),R("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),R("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),R.get=function(T){return R[T]||null}},5944:(T,S,N)=>{"use strict";var R=S,O=N(5519),P=N(8289);function M(T,S,N,R){var P=!1;if(S.resolvedType){if(S.resolvedType instanceof O){T("switch(d%s){",R);for(var M=S.resolvedType.values,L=Object.keys(M),V=0;V<L.length;++V)M[L[V]]!==S.typeDefault||P||(T("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',R,R,R),S.repeated||T("break"),P=!0),T("case%j:",L[V])("case %i:",M[L[V]])("m%s=%j",R,M[L[V]])("break");T("}")}else T('if(typeof d%s!=="object")',R)("throw TypeError(%j)",S.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",R,N,R)}else{var U=!1;switch(S.type){case"double":case"float":T("m%s=Number(d%s)",R,R);break;case"uint32":case"fixed32":T("m%s=d%s>>>0",R,R);break;case"int32":case"sint32":case"sfixed32":T("m%s=d%s|0",R,R);break;case"uint64":U=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":T("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",R,R,U)('else if(typeof d%s==="string")',R)("m%s=parseInt(d%s,10)",R,R)('else if(typeof d%s==="number")',R)("m%s=d%s",R,R)('else if(typeof d%s==="object")',R)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",R,R,R,U?"true":"");break;case"bytes":T('if(typeof d%s==="string")',R)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",R,R,R)("else if(d%s.length >= 0)",R)("m%s=d%s",R,R);break;case"string":T("m%s=String(d%s)",R,R);break;case"bool":T("m%s=Boolean(d%s)",R,R)}}return T}function L(T,S,N,R){if(S.resolvedType)S.resolvedType instanceof O?T("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",R,N,R,R,N,R,R):T("d%s=types[%i].toObject(m%s,o)",R,N,R);else{var P=!1;switch(S.type){case"double":case"float":T("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",R,R,R,R);break;case"uint64":P=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":T('if(typeof m%s==="number")',R)("d%s=o.longs===String?String(m%s):m%s",R,R,R)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",R,R,R,R,P?"true":"",R);break;case"bytes":T("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",R,R,R,R,R);break;default:T("d%s=m%s",R,R)}}return T}R.fromObject=function(T){var S=T.fieldsArray,N=P.codegen(["d"],T.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!S.length)return N("return new this.ctor");N("var m=new this.ctor");for(var R=0;R<S.length;++R){var L=S[R].resolve(),V=P.safeProp(L.name);L.map?(N("if(d%s){",V)('if(typeof d%s!=="object")',V)("throw TypeError(%j)",L.fullName+": object expected")("m%s={}",V)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",V),M(N,L,R,V+"[ks[i]]")("}")("}")):L.repeated?(N("if(d%s){",V)("if(!Array.isArray(d%s))",V)("throw TypeError(%j)",L.fullName+": array expected")("m%s=[]",V)("for(var i=0;i<d%s.length;++i){",V),M(N,L,R,V+"[i]")("}")("}")):(L.resolvedType instanceof O||N("if(d%s!=null){",V),M(N,L,R,V),L.resolvedType instanceof O||N("}"))}return N("return m")},R.toObject=function(T){var S=T.fieldsArray.slice().sort(P.compareFieldsById);if(!S.length)return P.codegen()("return {}");for(var N=P.codegen(["m","o"],T.name+"$toObject")("if(!o)")("o={}")("var d={}"),R=[],M=[],V=[],U=0;U<S.length;++U)S[U].partOf||(S[U].resolve().repeated?R:S[U].map?M:V).push(S[U]);if(R.length){for(N("if(o.arrays||o.defaults){"),U=0;U<R.length;++U)N("d%s=[]",P.safeProp(R[U].name));N("}")}if(M.length){for(N("if(o.objects||o.defaults){"),U=0;U<M.length;++U)N("d%s={}",P.safeProp(M[U].name));N("}")}if(V.length){for(N("if(o.defaults){"),U=0;U<V.length;++U){var $=V[U],W=P.safeProp($.name);if($.resolvedType instanceof O)N("d%s=o.enums===String?%j:%j",W,$.resolvedType.valuesById[$.typeDefault],$.typeDefault);else if($.long)N("if(util.Long){")("var n=new util.Long(%i,%i,%j)",$.typeDefault.low,$.typeDefault.high,$.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",W)("}else")("d%s=o.longs===String?%j:%i",W,$.typeDefault.toString(),$.typeDefault.toNumber());else if($.bytes){var K="["+Array.prototype.slice.call($.typeDefault).join(",")+"]";N("if(o.bytes===String)d%s=%j",W,String.fromCharCode.apply(String,$.typeDefault))("else{")("d%s=%s",W,K)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",W,W)("}")}else N("d%s=%j",W,$.typeDefault)}N("}")}var Q=!1;for(U=0;U<S.length;++U){var $=S[U],Y=T._fieldsArray.indexOf($),W=P.safeProp($.name);$.map?(Q||(Q=!0,N("var ks2")),N("if(m%s&&(ks2=Object.keys(m%s)).length){",W,W)("d%s={}",W)("for(var j=0;j<ks2.length;++j){"),L(N,$,Y,W+"[ks2[j]]")("}")):$.repeated?(N("if(m%s&&m%s.length){",W,W)("d%s=[]",W)("for(var j=0;j<m%s.length;++j){",W),L(N,$,Y,W+"[j]")("}")):(N("if(m%s!=null&&m.hasOwnProperty(%j)){",W,$.name),L(N,$,Y,W),$.partOf&&N("if(o.oneofs)")("d%s=%j",P.safeProp($.partOf.name),$.name)),N("}")}return N("return d")}},8983:(T,S,N)=>{"use strict";T.exports=L;var R=N(5519),O=N(1627),P=N(8289);function M(T){return"missing required '"+T.name+"'"}function L(T){for(var S=P.codegen(["r","l","e"],T.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(T.fieldsArray.filter(function(T){return T.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),N=0;N<T.fieldsArray.length;++N){var L=T._fieldsArray[N].resolve(),V=L.resolvedType instanceof R?"int32":L.type,U="m"+P.safeProp(L.name);S("case %i: {",L.id),L.map?(S("if(%s===util.emptyObject)",U)("%s={}",U)("var c2 = r.uint32()+r.pos"),void 0!==O.defaults[L.keyType]?S("k=%j",O.defaults[L.keyType]):S("k=null"),void 0!==O.defaults[V]?S("value=%j",O.defaults[V]):S("value=null"),S("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",L.keyType)("case 2:"),void 0===O.basic[V]?S("value=types[%i].decode(r,r.uint32())",N):S("value=r.%s()",V),S("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),S(void 0!==O.long[L.keyType]?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",U)):L.repeated?(S("if(!(%s&&%s.length))",U,U)("%s=[]",U),void 0!==O.packed[V]&&S("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",U,V)("}else"),void 0===O.basic[V]?S(L.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",U,N):S("%s.push(r.%s())",U,V)):void 0===O.basic[V]?S(L.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",U,N):S("%s=r.%s()",U,V),S("break")("}")}for(S("default:")("r.skipType(t&7)")("break")("}")("}"),N=0;N<T._fieldsArray.length;++N){var $=T._fieldsArray[N];$.required&&S("if(!m.hasOwnProperty(%j))",$.name)("throw util.ProtocolError(%j,{instance:m})",M($))}return S("return m")}},7337:(T,S,N)=>{"use strict";T.exports=L;var R=N(5519),O=N(1627),P=N(8289);function M(T,S,N,R){return S.delimited?T("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",N,R,(S.id<<3|3)>>>0,(S.id<<3|4)>>>0):T("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",N,R,(S.id<<3|2)>>>0)}function L(T){for(var S,N,L=P.codegen(["m","w"],T.name+"$encode")("if(!w)")("w=Writer.create()"),V=T.fieldsArray.slice().sort(P.compareFieldsById),S=0;S<V.length;++S){var U=V[S].resolve(),$=T._fieldsArray.indexOf(U),W=U.resolvedType instanceof R?"int32":U.type,K=O.basic[W];N="m"+P.safeProp(U.name),U.map?(L("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",N,U.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",N)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(U.id<<3|2)>>>0,8|O.mapKey[U.keyType],U.keyType),void 0===K?L("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",$,N):L(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|K,W,N),L("}")("}")):U.repeated?(L("if(%s!=null&&%s.length){",N,N),U.packed&&void 0!==O.packed[W]?L("w.uint32(%i).fork()",(U.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",N)("w.%s(%s[i])",W,N)("w.ldelim()"):(L("for(var i=0;i<%s.length;++i)",N),void 0===K?M(L,U,$,N+"[i]"):L("w.uint32(%i).%s(%s[i])",(U.id<<3|K)>>>0,W,N)),L("}")):(U.optional&&L("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",N,U.name),void 0===K?M(L,U,$,N):L("w.uint32(%i).%s(%s)",(U.id<<3|K)>>>0,W,N))}return L("return w")}},5519:(T,S,N)=>{"use strict";T.exports=M;var R=N(8831);((M.prototype=Object.create(R.prototype)).constructor=M).className="Enum";var O=N(4622),P=N(8289);function M(T,S,N,O,P,M){if(R.call(this,T,N),S&&"object"!=typeof S)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=O,this.comments=P||{},this.valuesOptions=M,this._valuesFeatures={},this.reserved=void 0,S)for(var L=Object.keys(S),V=0;V<L.length;++V)"number"==typeof S[L[V]]&&(this.valuesById[this.values[L[V]]=S[L[V]]]=L[V])}M.prototype._resolveFeatures=function(T){return T=this._edition||T,R.prototype._resolveFeatures.call(this,T),Object.keys(this.values).forEach(T=>{var S=Object.assign({},this._features);this._valuesFeatures[T]=Object.assign(S,this.valuesOptions&&this.valuesOptions[T]&&this.valuesOptions[T].features)}),this},M.fromJSON=function(T,S){var N=new M(T,S.values,S.options,S.comment,S.comments);return N.reserved=S.reserved,S.edition&&(N._edition=S.edition),N._defaultEdition="proto3",N},M.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return P.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",S?this.comment:void 0,"comments",S?this.comments:void 0])},M.prototype.add=function(T,S,N,R){if(!P.isString(T))throw TypeError("name must be a string");if(!P.isInteger(S))throw TypeError("id must be an integer");if(void 0!==this.values[T])throw Error("duplicate name '"+T+"' in "+this);if(this.isReservedId(S))throw Error("id "+S+" is reserved in "+this);if(this.isReservedName(T))throw Error("name '"+T+"' is reserved in "+this);if(void 0!==this.valuesById[S]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+S+" in "+this);this.values[T]=S}else this.valuesById[this.values[T]=S]=T;return R&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[T]=R||null),this.comments[T]=N||null,this},M.prototype.remove=function(T){if(!P.isString(T))throw TypeError("name must be a string");var S=this.values[T];if(null==S)throw Error("name '"+T+"' does not exist in "+this);return delete this.valuesById[S],delete this.values[T],delete this.comments[T],this.valuesOptions&&delete this.valuesOptions[T],this},M.prototype.isReservedId=function(T){return O.isReservedId(this.reserved,T)},M.prototype.isReservedName=function(T){return O.isReservedName(this.reserved,T)}},2548:(T,S,N)=>{"use strict";T.exports=U;var R,O=N(8831);((U.prototype=Object.create(O.prototype)).constructor=U).className="Field";var P=N(5519),M=N(1627),L=N(8289),V=/^required|optional|repeated$/;function U(T,S,N,R,P,U,$){if(L.isObject(R)?($=P,U=R,R=P=void 0):L.isObject(P)&&($=U,U=P,P=void 0),O.call(this,T,U),!L.isInteger(S)||S<0)throw TypeError("id must be a non-negative integer");if(!L.isString(N))throw TypeError("type must be a string");if(void 0!==R&&!V.test(R=R.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==P&&!L.isString(P))throw TypeError("extend must be a string");"proto3_optional"===R&&(R="optional"),this.rule=R&&"optional"!==R?R:void 0,this.type=N,this.id=S,this.extend=P||void 0,this.repeated="repeated"===R,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!L.Long&&void 0!==M.long[N],this.bytes="bytes"===N,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=$}U.fromJSON=function(T,S){var N=new U(T,S.id,S.type,S.rule,S.extend,S.options,S.comment);return S.edition&&(N._edition=S.edition),N._defaultEdition="proto3",N},Object.defineProperty(U.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(U.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(U.prototype,"delimited",{get:function(){return this.resolvedType instanceof R&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(U.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(U.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),U.prototype.setOption=function(T,S,N){return O.prototype.setOption.call(this,T,S,N)},U.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return L.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",S?this.comment:void 0])},U.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=M.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof R?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof P&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof P||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=L.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var T;L.base64.test(this.typeDefault)?L.base64.decode(this.typeDefault,T=L.newBuffer(L.base64.length(this.typeDefault)),0):L.utf8.write(this.typeDefault,T=L.newBuffer(L.utf8.length(this.typeDefault)),0),this.typeDefault=T}return this.map?this.defaultValue=L.emptyObject:this.repeated?this.defaultValue=L.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof R&&(this.parent.ctor.prototype[this.name]=this.defaultValue),O.prototype.resolve.call(this)},U.prototype._inferLegacyProtoFeatures=function(T){if("proto2"!==T&&"proto3"!==T)return{};var S={};if("required"===this.rule&&(S.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===M.defaults[this.type]){var N=this.parent.get(this.type.split(".").pop());N&&N instanceof R&&N.group&&(S.message_encoding="DELIMITED")}return!0===this.getOption("packed")?S.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(S.repeated_field_encoding="EXPANDED"),S},U.prototype._resolveFeatures=function(T){return O.prototype._resolveFeatures.call(this,this._edition||T)},U.d=function(T,S,N,R){return"function"==typeof S?S=L.decorateType(S).name:S&&"object"==typeof S&&(S=L.decorateEnum(S).name),function(O,P){L.decorateType(O.constructor).add(new U(P,T,S,N,{default:R}))}},U._configure=function(T){R=T}},2822:(T,S,N)=>{"use strict";var R=T.exports=N(5748);function O(T,S,N){return"function"==typeof S?(N=S,S=new R.Root):S||(S=new R.Root),S.load(T,N)}function P(T,S){return S||(S=new R.Root),S.loadSync(T)}R.build="light",R.load=O,R.loadSync=P,R.encoder=N(7337),R.decoder=N(8983),R.verifier=N(1181),R.converter=N(5944),R.ReflectionObject=N(8831),R.Namespace=N(4622),R.Root=N(4955),R.Enum=N(5519),R.Type=N(9396),R.Field=N(2548),R.OneOf=N(5677),R.MapField=N(372),R.Service=N(6962),R.Method=N(3055),R.Message=N(5326),R.wrappers=N(2969),R.types=N(1627),R.util=N(8289),R.ReflectionObject._configure(R.Root),R.Namespace._configure(R.Type,R.Service,R.Enum),R.Root._configure(R.Type),R.Field._configure(R.Type)},5748:(T,S,N)=>{"use strict";var R=S;function O(){R.util._configure(),R.Writer._configure(R.BufferWriter),R.Reader._configure(R.BufferReader)}R.build="minimal",R.Writer=N(7474),R.BufferWriter=N(6985),R.Reader=N(8645),R.BufferReader=N(2126),R.util=N(6416),R.rpc=N(4415),R.roots=N(3675),R.configure=O,O()},7954:(T,S,N)=>{"use strict";var R=T.exports=N(2822);R.build="full",R.tokenize=N(9468),R.parse=N(580),R.common=N(2516),R.Root._configure(R.Type,R.parse,R.common)},372:(T,S,N)=>{"use strict";T.exports=M;var R=N(2548);((M.prototype=Object.create(R.prototype)).constructor=M).className="MapField";var O=N(1627),P=N(8289);function M(T,S,N,O,M,L){if(R.call(this,T,S,O,void 0,void 0,M,L),!P.isString(N))throw TypeError("keyType must be a string");this.keyType=N,this.resolvedKeyType=null,this.map=!0}M.fromJSON=function(T,S){return new M(T,S.id,S.keyType,S.type,S.options,S.comment)},M.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return P.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",S?this.comment:void 0])},M.prototype.resolve=function(){if(this.resolved)return this;if(void 0===O.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return R.prototype.resolve.call(this)},M.d=function(T,S,N){return"function"==typeof N?N=P.decorateType(N).name:N&&"object"==typeof N&&(N=P.decorateEnum(N).name),function(R,O){P.decorateType(R.constructor).add(new M(O,T,S,N))}}},5326:(T,S,N)=>{"use strict";T.exports=O;var R=N(6416);function O(T){if(T)for(var S=Object.keys(T),N=0;N<S.length;++N)this[S[N]]=T[S[N]]}O.create=function(T){return this.$type.create(T)},O.encode=function(T,S){return this.$type.encode(T,S)},O.encodeDelimited=function(T,S){return this.$type.encodeDelimited(T,S)},O.decode=function(T){return this.$type.decode(T)},O.decodeDelimited=function(T){return this.$type.decodeDelimited(T)},O.verify=function(T){return this.$type.verify(T)},O.fromObject=function(T){return this.$type.fromObject(T)},O.toObject=function(T,S){return this.$type.toObject(T,S)},O.prototype.toJSON=function(){return this.$type.toObject(this,R.toJSONOptions)}},3055:(T,S,N)=>{"use strict";T.exports=P;var R=N(8831);((P.prototype=Object.create(R.prototype)).constructor=P).className="Method";var O=N(8289);function P(T,S,N,P,M,L,V,U,$){if(O.isObject(M)?(V=M,M=L=void 0):O.isObject(L)&&(V=L,L=void 0),!(void 0===S||O.isString(S)))throw TypeError("type must be a string");if(!O.isString(N))throw TypeError("requestType must be a string");if(!O.isString(P))throw TypeError("responseType must be a string");R.call(this,T,V),this.type=S||"rpc",this.requestType=N,this.requestStream=!!M||void 0,this.responseType=P,this.responseStream=!!L||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=U,this.parsedOptions=$}P.fromJSON=function(T,S){return new P(T,S.type,S.requestType,S.responseType,S.requestStream,S.responseStream,S.options,S.comment,S.parsedOptions)},P.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return O.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",S?this.comment:void 0,"parsedOptions",this.parsedOptions])},P.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),R.prototype.resolve.call(this))}},4622:(T,S,N)=>{"use strict";T.exports=W;var R,O,P,M=N(8831);((W.prototype=Object.create(M.prototype)).constructor=W).className="Namespace";var L=N(2548),V=N(8289),U=N(5677);function $(T,S){if(T&&T.length){for(var N={},R=0;R<T.length;++R)N[T[R].name]=T[R].toJSON(S);return N}}function W(T,S){M.call(this,T,S),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function K(T){T._nestedArray=null,T._lookupCache={};for(var S=T;S=S.parent;)S._lookupCache={};return T}W.fromJSON=function(T,S){return new W(T,S.options).addJSON(S.nested)},W.arrayToJSON=$,W.isReservedId=function(T,S){if(T){for(var N=0;N<T.length;++N)if("string"!=typeof T[N]&&T[N][0]<=S&&T[N][1]>S)return!0}return!1},W.isReservedName=function(T,S){if(T){for(var N=0;N<T.length;++N)if(T[N]===S)return!0}return!1},Object.defineProperty(W.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=V.toArray(this.nested))}}),W.prototype.toJSON=function(T){return V.toObject(["options",this.options,"nested",$(this.nestedArray,T)])},W.prototype.addJSON=function(T){var S=this;if(T)for(var N,M=Object.keys(T),V=0;V<M.length;++V)N=T[M[V]],S.add((void 0!==N.fields?R.fromJSON:void 0!==N.values?P.fromJSON:void 0!==N.methods?O.fromJSON:void 0!==N.id?L.fromJSON:W.fromJSON)(M[V],N));return this},W.prototype.get=function(T){return this.nested&&this.nested[T]||null},W.prototype.getEnum=function(T){if(this.nested&&this.nested[T]instanceof P)return this.nested[T].values;throw Error("no such enum: "+T)},W.prototype.add=function(T){if(!(T instanceof L&&void 0!==T.extend||T instanceof R||T instanceof U||T instanceof P||T instanceof O||T instanceof W))throw TypeError("object must be a valid nested object");if(this.nested){var S=this.get(T.name);if(S){if(S instanceof W&&T instanceof W&&!(S instanceof R||S instanceof O)){for(var N=S.nestedArray,M=0;M<N.length;++M)T.add(N[M]);this.remove(S),this.nested||(this.nested={}),T.setOptions(S.options,!0)}else throw Error("duplicate name '"+T.name+"' in "+this)}}else this.nested={};this.nested[T.name]=T,this instanceof R||this instanceof O||this instanceof P||this instanceof L||T._edition||(T._edition=T._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var V=this;V=V.parent;)V._needsRecursiveFeatureResolution=!0,V._needsRecursiveResolve=!0;return T.onAdd(this),K(this)},W.prototype.remove=function(T){if(!(T instanceof M))throw TypeError("object must be a ReflectionObject");if(T.parent!==this)throw Error(T+" is not a member of "+this);return delete this.nested[T.name],Object.keys(this.nested).length||(this.nested=void 0),T.onRemove(this),K(this)},W.prototype.define=function(T,S){if(V.isString(T))T=T.split(".");else if(!Array.isArray(T))throw TypeError("illegal path");if(T&&T.length&&""===T[0])throw Error("path must be relative");for(var N=this;T.length>0;){var R=T.shift();if(N.nested&&N.nested[R]){if(!((N=N.nested[R])instanceof W))throw Error("path conflicts with non-namespace objects")}else N.add(N=new W(R))}return S&&N.addJSON(S),N},W.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var T=this.nestedArray,S=0;for(this.resolve();S<T.length;)T[S]instanceof W?T[S++].resolveAll():T[S++].resolve();return this._needsRecursiveResolve=!1,this},W.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(this._needsRecursiveFeatureResolution=!1,T=this._edition||T,M.prototype._resolveFeaturesRecursive.call(this,T),this.nestedArray.forEach(S=>{S._resolveFeaturesRecursive(T)})),this},W.prototype.lookup=function(T,S,N){if("boolean"==typeof S?(N=S,S=void 0):S&&!Array.isArray(S)&&(S=[S]),V.isString(T)&&T.length){if("."===T)return this.root;T=T.split(".")}else if(!T.length)return this;var R=T.join(".");if(""===T[0])return this.root.lookup(T.slice(1),S);var O=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+R];if(O&&(!S||S.indexOf(O.constructor)>-1)||(O=this._lookupImpl(T,R))&&(!S||S.indexOf(O.constructor)>-1))return O;if(N)return null;for(var P=this;P.parent;){if((O=P.parent._lookupImpl(T,R))&&(!S||S.indexOf(O.constructor)>-1))return O;P=P.parent}return null},W.prototype._lookupImpl=function(T,S){if(Object.prototype.hasOwnProperty.call(this._lookupCache,S))return this._lookupCache[S];var N=this.get(T[0]),R=null;if(N)1===T.length?R=N:N instanceof W&&(T=T.slice(1),R=N._lookupImpl(T,T.join(".")));else for(var O=0;O<this.nestedArray.length;++O)this._nestedArray[O]instanceof W&&(N=this._nestedArray[O]._lookupImpl(T,S))&&(R=N);return this._lookupCache[S]=R,R},W.prototype.lookupType=function(T){var S=this.lookup(T,[R]);if(!S)throw Error("no such type: "+T);return S},W.prototype.lookupEnum=function(T){var S=this.lookup(T,[P]);if(!S)throw Error("no such Enum '"+T+"' in "+this);return S},W.prototype.lookupTypeOrEnum=function(T){var S=this.lookup(T,[R,P]);if(!S)throw Error("no such Type or Enum '"+T+"' in "+this);return S},W.prototype.lookupService=function(T){var S=this.lookup(T,[O]);if(!S)throw Error("no such Service '"+T+"' in "+this);return S},W._configure=function(T,S,N){R=T,O=S,P=N}},8831:(T,S,N)=>{"use strict";T.exports=U,U.className="ReflectionObject";let R=N(5677);var O,P=N(8289),M={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},L={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},V={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function U(T,S){if(!P.isString(T))throw TypeError("name must be a string");if(S&&!P.isObject(S))throw TypeError("options must be an object");this.options=S,this.parsedOptions=null,this.name=T,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(U.prototype,{root:{get:function(){for(var T=this;null!==T.parent;)T=T.parent;return T}},fullName:{get:function(){for(var T=[this.name],S=this.parent;S;)T.unshift(S.name),S=S.parent;return T.join(".")}}}),U.prototype.toJSON=function(){throw Error()},U.prototype.onAdd=function(T){this.parent&&this.parent!==T&&this.parent.remove(this),this.parent=T,this.resolved=!1;var S=T.root;S instanceof O&&S._handleAdd(this)},U.prototype.onRemove=function(T){var S=T.root;S instanceof O&&S._handleRemove(this),this.parent=null,this.resolved=!1},U.prototype.resolve=function(){return this.resolved||this.root instanceof O&&(this.resolved=!0),this},U.prototype._resolveFeaturesRecursive=function(T){return this._resolveFeatures(this._edition||T)},U.prototype._resolveFeatures=function(T){if(!this._featuresResolved){var S={};if(!T)throw Error("Unknown edition for "+this.fullName);var N=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(T));if(this._edition){if("proto2"===T)S=Object.assign({},L);else if("proto3"===T)S=Object.assign({},V);else if("2023"===T)S=Object.assign({},M);else throw Error("Unknown edition: "+T);this._features=Object.assign(S,N||{}),this._featuresResolved=!0;return}if(this.partOf instanceof R){var O=Object.assign({},this.partOf._features);this._features=Object.assign(O,N||{})}else if(this.declaringField);else if(this.parent){var P=Object.assign({},this.parent._features);this._features=Object.assign(P,N||{})}else throw Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},U.prototype._inferLegacyProtoFeatures=function(){return{}},U.prototype.getOption=function(T){if(this.options)return this.options[T]},U.prototype.setOption=function(T,S,N){return this.options||(this.options={}),/^features\./.test(T)?P.setProperty(this.options,T,S,N):N&&void 0!==this.options[T]||(this.getOption(T)!==S&&(this.resolved=!1),this.options[T]=S),this},U.prototype.setParsedOption=function(T,S,N){this.parsedOptions||(this.parsedOptions=[]);var R=this.parsedOptions;if(N){var O=R.find(function(S){return Object.prototype.hasOwnProperty.call(S,T)});if(O){var M=O[T];P.setProperty(M,N,S)}else(O={})[T]=P.setProperty({},N,S),R.push(O)}else{var L={};L[T]=S,R.push(L)}return this},U.prototype.setOptions=function(T,S){if(T)for(var N=Object.keys(T),R=0;R<N.length;++R)this.setOption(N[R],T[N[R]],S);return this},U.prototype.toString=function(){var T=this.constructor.className,S=this.fullName;return S.length?T+" "+S:T},U.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},U._configure=function(T){O=T}},5677:(T,S,N)=>{"use strict";T.exports=M;var R=N(8831);((M.prototype=Object.create(R.prototype)).constructor=M).className="OneOf";var O=N(2548),P=N(8289);function M(T,S,N,O){if(Array.isArray(S)||(N=S,S=void 0),R.call(this,T,N),!(void 0===S||Array.isArray(S)))throw TypeError("fieldNames must be an Array");this.oneof=S||[],this.fieldsArray=[],this.comment=O}function L(T){if(T.parent)for(var S=0;S<T.fieldsArray.length;++S)T.fieldsArray[S].parent||T.parent.add(T.fieldsArray[S])}M.fromJSON=function(T,S){return new M(T,S.oneof,S.options,S.comment)},M.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return P.toObject(["options",this.options,"oneof",this.oneof,"comment",S?this.comment:void 0])},M.prototype.add=function(T){if(!(T instanceof O))throw TypeError("field must be a Field");return T.parent&&T.parent!==this.parent&&T.parent.remove(T),this.oneof.push(T.name),this.fieldsArray.push(T),T.partOf=this,L(this),this},M.prototype.remove=function(T){if(!(T instanceof O))throw TypeError("field must be a Field");var S=this.fieldsArray.indexOf(T);if(S<0)throw Error(T+" is not a member of "+this);return this.fieldsArray.splice(S,1),(S=this.oneof.indexOf(T.name))>-1&&this.oneof.splice(S,1),T.partOf=null,this},M.prototype.onAdd=function(T){R.prototype.onAdd.call(this,T);for(var S=this,N=0;N<this.oneof.length;++N){var O=T.get(this.oneof[N]);O&&!O.partOf&&(O.partOf=S,S.fieldsArray.push(O))}L(this)},M.prototype.onRemove=function(T){for(var S,N=0;N<this.fieldsArray.length;++N)(S=this.fieldsArray[N]).parent&&S.parent.remove(S);R.prototype.onRemove.call(this,T)},Object.defineProperty(M.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var T=this.fieldsArray[0];return null!=T.options&&!0===T.options.proto3_optional}}),M.d=function(){for(var T=Array(arguments.length),S=0;S<arguments.length;)T[S]=arguments[S++];return function(S,N){P.decorateType(S.constructor).add(new M(N,T)),Object.defineProperty(S,N,{get:P.oneOfGetter(T),set:P.oneOfSetter(T)})}}},580:(T,S,N)=>{"use strict";T.exports=eu,eu.filename=null,eu.defaults={keepCase:!1};var R=N(9468),O=N(4955),P=N(9396),M=N(2548),L=N(372),V=N(5677),U=N(5519),$=N(6962),W=N(3055),K=N(8831),Q=N(1627),Y=N(8289),Z=/^[1-9][0-9]*$/,ee=/^-?[1-9][0-9]*$/,et=/^0[x][0-9a-fA-F]+$/,er=/^-?0[x][0-9a-fA-F]+$/,ei=/^0[0-7]+$/,en=/^-?0[0-7]+$/,es=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,ea=/^[a-zA-Z_][a-zA-Z_0-9]*$/,eo=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function eu(T,S,N){S instanceof O||(N=S,S=new O),N||(N=eu.defaults);var ec,ed,eh,ep,ef=N.preferTrailingComment||!1,em=R(T,N.alternateCommentMode||!1),eg=em.next,ey=em.push,ev=em.peek,eb=em.skip,ew=em.cmnt,eT=!0,eS="proto2",ex=S,eE=[],eC={},e_=N.keepCase?function(T){return T}:Y.camelCase;function eI(){eE.forEach(T=>{T._edition=eS,Object.keys(eC).forEach(S=>{void 0===T.getOption(S)&&T.setOption(S,eC[S],!0)})})}function ek(T,S,N){var R=eu.filename;return N||(eu.filename=null),Error("illegal "+(S||"token")+" '"+T+"' ("+(R?R+", ":"")+"line "+em.line+")")}function eN(){var T,S=[];do{if('"'!==(T=eg())&&"'"!==T)throw ek(T);S.push(eg()),eb(T),T=ev()}while('"'===T||"'"===T);return S.join("")}function eA(T){var S=eg();switch(S){case"'":case'"':return ey(S),eN();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return eD(S,!0)}catch(N){if(T&&eo.test(S))return S;throw ek(S,"value")}}function eR(T,S){do if(S&&('"'===(N=ev())||"'"===N)){var N,R,O=eN();if(T.push(O),eS>=2023)throw ek(O,"id")}else try{T.push([R=eO(eg()),eb("to",!0)?eO(eg()):R])}catch(R){if(S&&eo.test(N)&&eS>=2023)T.push(N);else throw R}while(eb(",",!0));var P={options:void 0};P.setOption=function(T,S){void 0===this.options&&(this.options={}),this.options[T]=S},eB(P,function(T){if("option"===T)eW(P,T),eb(";");else throw ek(T)},function(){eJ(P)})}function eD(T,S){var N=1;switch("-"===T.charAt(0)&&(N=-1,T=T.substring(1)),T){case"inf":case"INF":case"Inf":return 1/0*N;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(Z.test(T))return N*parseInt(T,10);if(et.test(T))return N*parseInt(T,16);if(ei.test(T))return N*parseInt(T,8);if(es.test(T))return N*parseFloat(T);throw ek(T,"number",S)}function eO(T,S){switch(T){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!S&&"-"===T.charAt(0))throw ek(T,"id");if(ee.test(T))return parseInt(T,10);if(er.test(T))return parseInt(T,16);if(en.test(T))return parseInt(T,8);throw ek(T,"id")}function eP(){if(void 0!==ed)throw ek("package");if(ed=eg(),!eo.test(ed))throw ek(ed,"name");ex=ex.define(ed),eb(";")}function eM(){var T,S=ev();switch(S){case"weak":T=ep||(ep=[]),eg();break;case"public":eg();default:T=eh||(eh=[])}S=eN(),eb(";"),T.push(S)}function eL(){if(eb("="),(eS=eN())<2023)throw ek(eS,"syntax");eb(";")}function ej(){if(eb("="),!["2023"].includes(eS=eN()))throw ek(eS,"edition");eb(";")}function eF(T,S){switch(S){case"option":return eW(T,S),eb(";"),!0;case"message":return eV(T,S),!0;case"enum":return eH(T,S),!0;case"service":return eX(T,S),!0;case"extend":return e0(T,S),!0}return!1}function eB(T,S,N){var R,O=em.line;if(T&&("string"!=typeof T.comment&&(T.comment=ew()),T.filename=eu.filename),eb("{",!0)){for(;"}"!==(R=eg());)S(R);eb(";",!0)}else N&&N(),eb(";"),T&&("string"!=typeof T.comment||ef)&&(T.comment=ew(O)||T.comment)}function eV(T,S){if(!ea.test(S=eg()))throw ek(S,"type name");var N=new P(S);eB(N,function(T){if(!eF(N,T))switch(T){case"map":eq(N,T);break;case"required":if("proto2"!==eS)throw ek(T);case"repeated":eU(N,T);break;case"optional":if("proto3"===eS)eU(N,"proto3_optional");else if("proto2"!==eS)throw ek(T);else eU(N,"optional");break;case"oneof":e$(N,T);break;case"extensions":eR(N.extensions||(N.extensions=[]));break;case"reserved":eR(N.reserved||(N.reserved=[]),!0);break;default:if("proto2"===eS||!eo.test(T))throw ek(T);ey(T),eU(N,"optional")}}),T.add(N),T===ex&&eE.push(N)}function eU(T,S,N){var R=eg();if("group"===R){ez(T,S);return}for(;R.endsWith(".")||ev().startsWith(".");)R+=eg();if(!eo.test(R))throw ek(R,"type");var O=eg();if(!ea.test(O))throw ek(O,"name");O=e_(O),eb("=");var P=new M(O,eO(eg()),R,S,N);if(eB(P,function(T){if("option"===T)eW(P,T),eb(";");else throw ek(T)},function(){eJ(P)}),"proto3_optional"===S){var L=new V("_"+O);P.setOption("proto3_optional",!0),L.add(P),T.add(L)}else T.add(P);T===ex&&eE.push(P)}function ez(T,S){if(eS>=2023)throw ek("group");var N=eg();if(!ea.test(N))throw ek(N,"name");var R=Y.lcFirst(N);N===R&&(N=Y.ucFirst(N)),eb("=");var O=eO(eg()),L=new P(N);L.group=!0;var V=new M(R,O,N,S);V.filename=eu.filename,eB(L,function(T){switch(T){case"option":eW(L,T),eb(";");break;case"required":case"repeated":eU(L,T);break;case"optional":"proto3"===eS?eU(L,"proto3_optional"):eU(L,"optional");break;case"message":eV(L,T);break;case"enum":eH(L,T);break;case"reserved":eR(L.reserved||(L.reserved=[]),!0);break;default:throw ek(T)}}),T.add(L).add(V)}function eq(T){eb("<");var S=eg();if(void 0===Q.mapKey[S])throw ek(S,"type");eb(",");var N=eg();if(!eo.test(N))throw ek(N,"type");eb(">");var R=eg();if(!ea.test(R))throw ek(R,"name");eb("=");var O=new L(e_(R),eO(eg()),S,N);eB(O,function(T){if("option"===T)eW(O,T),eb(";");else throw ek(T)},function(){eJ(O)}),T.add(O)}function e$(T,S){if(!ea.test(S=eg()))throw ek(S,"name");var N=new V(e_(S));eB(N,function(T){"option"===T?(eW(N,T),eb(";")):(ey(T),eU(N,"optional"))}),T.add(N)}function eH(T,S){if(!ea.test(S=eg()))throw ek(S,"name");var N=new U(S);eB(N,function(T){switch(T){case"option":eW(N,T),eb(";");break;case"reserved":eR(N.reserved||(N.reserved=[]),!0),void 0===N.reserved&&(N.reserved=[]);break;default:eG(N,T)}}),T.add(N),T===ex&&eE.push(N)}function eG(T,S){if(!ea.test(S))throw ek(S,"name");eb("=");var N=eO(eg(),!0),R={options:void 0};R.getOption=function(T){return this.options[T]},R.setOption=function(T,S){K.prototype.setOption.call(R,T,S)},R.setParsedOption=function(){},eB(R,function(T){if("option"===T)eW(R,T),eb(";");else throw ek(T)},function(){eJ(R)}),T.add(S,N,R.comment,R.parsedOptions||R.options)}function eW(T,S){var N,R,O=!0;for("option"===S&&(S=eg());"="!==S;){if("("===S){var P=eg();eb(")"),S="("+P+")"}if(O){if(O=!1,S.includes(".")&&!S.includes("(")){var M=S.split(".");N=M[0]+".",S=M[1];continue}N=S}else R=R?R+=S:S;S=eg()}var L=eK(T,R?N.concat(R):N);R=R&&"."===R[0]?R.slice(1):R,eY(T,N=N&&"."===N[N.length-1]?N.slice(0,-1):N,L,R)}function eK(T,S){if(eb("{",!0)){for(var N={};!eb("}",!0);){if(!ea.test(ec=eg()))throw ek(ec,"name");if(null===ec)throw ek(ec,"end of input");var R,O,P=ec;if(eb(":",!0),"{"===ev())R=eK(T,S+"."+ec);else if("["===ev()){if(R=[],eb("[",!0)){do O=eA(!0),R.push(O);while(eb(",",!0));eb("]"),void 0!==O&&eQ(T,S+"."+ec,O)}}else R=eA(!0),eQ(T,S+"."+ec,R);var M=N[P];M&&(R=[].concat(M).concat(R)),N[P]=R,eb(",",!0),eb(";",!0)}return N}var L=eA(!0);return eQ(T,S,L),L}function eQ(T,S,N){if(ex===T&&/^features\./.test(S)){eC[S]=N;return}T.setOption&&T.setOption(S,N)}function eY(T,S,N,R){T.setParsedOption&&T.setParsedOption(S,N,R)}function eJ(T){if(eb("[",!0)){do eW(T,"option");while(eb(",",!0));eb("]")}return T}function eX(T,S){if(!ea.test(S=eg()))throw ek(S,"service name");var N=new $(S);eB(N,function(T){if(!eF(N,T)){if("rpc"===T)eZ(N,T);else throw ek(T)}}),T.add(N),T===ex&&eE.push(N)}function eZ(T,S){var N=ew(),R=S;if(!ea.test(S=eg()))throw ek(S,"name");var O,P,M,L,V=S;if(eb("("),eb("stream",!0)&&(P=!0),!eo.test(S=eg())||(O=S,eb(")"),eb("returns"),eb("("),eb("stream",!0)&&(L=!0),!eo.test(S=eg())))throw ek(S);M=S,eb(")");var U=new W(V,R,O,M,P,L);U.comment=N,eB(U,function(T){if("option"===T)eW(U,T),eb(";");else throw ek(T)}),T.add(U)}function e0(T,S){if(!eo.test(S=eg()))throw ek(S,"reference");var N=S;eB(null,function(S){switch(S){case"required":case"repeated":eU(T,S,N);break;case"optional":"proto3"===eS?eU(T,"proto3_optional",N):eU(T,"optional",N);break;default:if("proto2"===eS||!eo.test(S))throw ek(S);ey(S),eU(T,"optional",N)}})}for(;null!==(ec=eg());)switch(ec){case"package":if(!eT)throw ek(ec);eP();break;case"import":if(!eT)throw ek(ec);eM();break;case"syntax":if(!eT)throw ek(ec);eL();break;case"edition":if(!eT)throw ek(ec);ej();break;case"option":eW(ex,ec),eb(";",!0);break;default:if(eF(ex,ec)){eT=!1;continue}throw ek(ec)}return eI(),eu.filename=null,{package:ed,imports:eh,weakImports:ep,root:S}}},8645:(T,S,N)=>{"use strict";T.exports=V;var R,O=N(6416),P=O.LongBits,M=O.utf8;function L(T,S){return RangeError("index out of range: "+T.pos+" + "+(S||1)+" > "+T.len)}function V(T){this.buf=T,this.pos=0,this.len=T.length}var U="undefined"!=typeof Uint8Array?function(T){if(T instanceof Uint8Array||Array.isArray(T))return new V(T);throw Error("illegal buffer")}:function(T){if(Array.isArray(T))return new V(T);throw Error("illegal buffer")},$=function(){return O.Buffer?function(T){return(V.create=function(T){return O.Buffer.isBuffer(T)?new R(T):U(T)})(T)}:U};function W(){var T=new P(0,0),S=0;if(this.len-this.pos>4){for(;S<4;++S)if(T.lo=(T.lo|(127&this.buf[this.pos])<<7*S)>>>0,this.buf[this.pos++]<128)return T;if(T.lo=(T.lo|(127&this.buf[this.pos])<<28)>>>0,T.hi=(T.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return T;S=0}else{for(;S<3;++S){if(this.pos>=this.len)throw L(this);if(T.lo=(T.lo|(127&this.buf[this.pos])<<7*S)>>>0,this.buf[this.pos++]<128)return T}return T.lo=(T.lo|(127&this.buf[this.pos++])<<7*S)>>>0,T}if(this.len-this.pos>4){for(;S<5;++S)if(T.hi=(T.hi|(127&this.buf[this.pos])<<7*S+3)>>>0,this.buf[this.pos++]<128)return T}else for(;S<5;++S){if(this.pos>=this.len)throw L(this);if(T.hi=(T.hi|(127&this.buf[this.pos])<<7*S+3)>>>0,this.buf[this.pos++]<128)return T}throw Error("invalid varint encoding")}function K(T,S){return(T[S-4]|T[S-3]<<8|T[S-2]<<16|T[S-1]<<24)>>>0}function Q(){if(this.pos+8>this.len)throw L(this,8);return new P(K(this.buf,this.pos+=4),K(this.buf,this.pos+=4))}V.create=$(),V.prototype._slice=O.Array.prototype.subarray||O.Array.prototype.slice,V.prototype.uint32=function(){var T=4294967295;return function(){if(T=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(T=(T|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(T=(T|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(T=(T|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(T=(T|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return T;if((this.pos+=5)>this.len)throw this.pos=this.len,L(this,10);return T}}(),V.prototype.int32=function(){return 0|this.uint32()},V.prototype.sint32=function(){var T=this.uint32();return T>>>1^-(1&T)|0},V.prototype.bool=function(){return 0!==this.uint32()},V.prototype.fixed32=function(){if(this.pos+4>this.len)throw L(this,4);return K(this.buf,this.pos+=4)},V.prototype.sfixed32=function(){if(this.pos+4>this.len)throw L(this,4);return 0|K(this.buf,this.pos+=4)},V.prototype.float=function(){if(this.pos+4>this.len)throw L(this,4);var T=O.float.readFloatLE(this.buf,this.pos);return this.pos+=4,T},V.prototype.double=function(){if(this.pos+8>this.len)throw L(this,4);var T=O.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,T},V.prototype.bytes=function(){var T=this.uint32(),S=this.pos,N=this.pos+T;if(N>this.len)throw L(this,T);if(this.pos+=T,Array.isArray(this.buf))return this.buf.slice(S,N);if(S===N){var R=O.Buffer;return R?R.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,S,N)},V.prototype.string=function(){var T=this.bytes();return M.read(T,0,T.length)},V.prototype.skip=function(T){if("number"==typeof T){if(this.pos+T>this.len)throw L(this,T);this.pos+=T}else do if(this.pos>=this.len)throw L(this);while(128&this.buf[this.pos++]);return this},V.prototype.skipType=function(T){switch(T){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(T=7&this.uint32());)this.skipType(T);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+T+" at offset "+this.pos)}return this},V._configure=function(T){R=T,V.create=$(),R._configure();var S=O.Long?"toLong":"toNumber";O.merge(V.prototype,{int64:function(){return W.call(this)[S](!1)},uint64:function(){return W.call(this)[S](!0)},sint64:function(){return W.call(this).zzDecode()[S](!1)},fixed64:function(){return Q.call(this)[S](!0)},sfixed64:function(){return Q.call(this)[S](!1)}})}},2126:(T,S,N)=>{"use strict";T.exports=P;var R=N(8645);(P.prototype=Object.create(R.prototype)).constructor=P;var O=N(6416);function P(T){R.call(this,T)}P._configure=function(){O.Buffer&&(P.prototype._slice=O.Buffer.prototype.slice)},P.prototype.string=function(){var T=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+T,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+T,this.len))},P._configure()},4955:(T,S,N)=>{"use strict";T.exports=W;var R,O,P,M=N(4622);((W.prototype=Object.create(M.prototype)).constructor=W).className="Root";var L=N(2548),V=N(5519),U=N(5677),$=N(8289);function W(T){M.call(this,"",T),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function K(){}W.fromJSON=function(T,S){return S||(S=new W),T.options&&S.setOptions(T.options),S.addJSON(T.nested).resolveAll()},W.prototype.resolvePath=$.path.resolve,W.prototype.fetch=$.fetch,W.prototype.load=function T(S,N,R){"function"==typeof N&&(R=N,N=void 0);var M=this;if(!R)return $.asPromise(T,M,S,N);var L=R===K;function V(T,S){if(R){if(L)throw T;S&&S.resolveAll();var N=R;R=null,N(T,S)}}function U(T){var S=T.lastIndexOf("google/protobuf/");if(S>-1){var N=T.substring(S);if(N in P)return N}return null}function W(T,S){try{if($.isString(S)&&"{"===S.charAt(0)&&(S=JSON.parse(S)),$.isString(S)){O.filename=T;var R,P=O(S,M,N),W=0;if(P.imports)for(;W<P.imports.length;++W)(R=U(P.imports[W])||M.resolvePath(T,P.imports[W]))&&Q(R);if(P.weakImports)for(W=0;W<P.weakImports.length;++W)(R=U(P.weakImports[W])||M.resolvePath(T,P.weakImports[W]))&&Q(R,!0)}else M.setOptions(S.options).addJSON(S.nested)}catch(T){V(T)}L||Y||V(null,M)}function Q(T,S){if(T=U(T)||T,!(M.files.indexOf(T)>-1)){if(M.files.push(T),T in P){L?W(T,P[T]):(++Y,setTimeout(function(){--Y,W(T,P[T])}));return}if(L){var N;try{N=$.fs.readFileSync(T).toString("utf8")}catch(T){S||V(T);return}W(T,N)}else++Y,M.fetch(T,function(N,O){if(--Y,R){if(N){S?Y||V(null,M):V(N);return}W(T,O)}})}}var Y=0;$.isString(S)&&(S=[S]);for(var Z,ee=0;ee<S.length;++ee)(Z=M.resolvePath("",S[ee]))&&Q(Z);return L?M.resolveAll():Y||V(null,M),M},W.prototype.loadSync=function(T,S){if(!$.isNode)throw Error("not supported");return this.load(T,S,K)},W.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(T){return"'extend "+T.extend+"' in "+T.parent.fullName}).join(", "));return M.prototype.resolveAll.call(this)};var Q=/^[A-Z]/;function Y(T,S){var N=S.parent.lookup(S.extend);if(N){var R=new L(S.fullName,S.id,S.type,S.rule,void 0,S.options);return!!N.get(R.name)||(R.declaringField=S,S.extensionField=R,N.add(R),!0)}return!1}W.prototype._handleAdd=function(T){if(T instanceof L)void 0===T.extend||T.extensionField||Y(this,T)||this.deferred.push(T);else if(T instanceof V)Q.test(T.name)&&(T.parent[T.name]=T.values);else if(!(T instanceof U)){if(T instanceof R)for(var S=0;S<this.deferred.length;)Y(this,this.deferred[S])?this.deferred.splice(S,1):++S;for(var N=0;N<T.nestedArray.length;++N)this._handleAdd(T._nestedArray[N]);Q.test(T.name)&&(T.parent[T.name]=T)}(T instanceof R||T instanceof V||T instanceof L)&&(this._fullyQualifiedObjects[T.fullName]=T)},W.prototype._handleRemove=function(T){if(T instanceof L){if(void 0!==T.extend){if(T.extensionField)T.extensionField.parent.remove(T.extensionField),T.extensionField=null;else{var S=this.deferred.indexOf(T);S>-1&&this.deferred.splice(S,1)}}}else if(T instanceof V)Q.test(T.name)&&delete T.parent[T.name];else if(T instanceof M){for(var N=0;N<T.nestedArray.length;++N)this._handleRemove(T._nestedArray[N]);Q.test(T.name)&&delete T.parent[T.name]}delete this._fullyQualifiedObjects[T.fullName]},W._configure=function(T,S,N){R=T,O=S,P=N}},3675:T=>{"use strict";T.exports={}},4415:(T,S,N)=>{"use strict";S.Service=N(9861)},9861:(T,S,N)=>{"use strict";T.exports=O;var R=N(6416);function O(T,S,N){if("function"!=typeof T)throw TypeError("rpcImpl must be a function");R.EventEmitter.call(this),this.rpcImpl=T,this.requestDelimited=!!S,this.responseDelimited=!!N}(O.prototype=Object.create(R.EventEmitter.prototype)).constructor=O,O.prototype.rpcCall=function T(S,N,O,P,M){if(!P)throw TypeError("request must be specified");var L=this;if(!M)return R.asPromise(T,L,S,N,O,P);if(!L.rpcImpl){setTimeout(function(){M(Error("already ended"))},0);return}try{return L.rpcImpl(S,N[L.requestDelimited?"encodeDelimited":"encode"](P).finish(),function(T,N){if(T)return L.emit("error",T,S),M(T);if(null===N){L.end(!0);return}if(!(N instanceof O))try{N=O[L.responseDelimited?"decodeDelimited":"decode"](N)}catch(T){return L.emit("error",T,S),M(T)}return L.emit("data",N,S),M(null,N)})}catch(T){L.emit("error",T,S),setTimeout(function(){M(T)},0);return}},O.prototype.end=function(T){return this.rpcImpl&&(T||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},6962:(T,S,N)=>{"use strict";T.exports=L;var R=N(4622);((L.prototype=Object.create(R.prototype)).constructor=L).className="Service";var O=N(3055),P=N(8289),M=N(4415);function L(T,S){R.call(this,T,S),this.methods={},this._methodsArray=null}function V(T){return T._methodsArray=null,T}L.fromJSON=function(T,S){var N=new L(T,S.options);if(S.methods)for(var R=Object.keys(S.methods),P=0;P<R.length;++P)N.add(O.fromJSON(R[P],S.methods[R[P]]));return S.nested&&N.addJSON(S.nested),S.edition&&(N._edition=S.edition),N.comment=S.comment,N._defaultEdition="proto3",N},L.prototype.toJSON=function(T){var S=R.prototype.toJSON.call(this,T),N=!!T&&!!T.keepComments;return P.toObject(["edition",this._editionToJSON(),"options",S&&S.options||void 0,"methods",R.arrayToJSON(this.methodsArray,T)||{},"nested",S&&S.nested||void 0,"comment",N?this.comment:void 0])},Object.defineProperty(L.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=P.toArray(this.methods))}}),L.prototype.get=function(T){return this.methods[T]||R.prototype.get.call(this,T)},L.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;R.prototype.resolve.call(this);for(var T=this.methodsArray,S=0;S<T.length;++S)T[S].resolve();return this},L.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(T=this._edition||T,R.prototype._resolveFeaturesRecursive.call(this,T),this.methodsArray.forEach(S=>{S._resolveFeaturesRecursive(T)})),this},L.prototype.add=function(T){if(this.get(T.name))throw Error("duplicate name '"+T.name+"' in "+this);return T instanceof O?(this.methods[T.name]=T,T.parent=this,V(this)):R.prototype.add.call(this,T)},L.prototype.remove=function(T){if(T instanceof O){if(this.methods[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.methods[T.name],T.parent=null,V(this)}return R.prototype.remove.call(this,T)},L.prototype.create=function(T,S,N){for(var R,O=new M.Service(T,S,N),L=0;L<this.methodsArray.length;++L){var V=P.lcFirst((R=this._methodsArray[L]).resolve().name).replace(/[^$\w_]/g,"");O[V]=P.codegen(["r","c"],P.isReserved(V)?V+"_":V)("return this.rpcCall(m,q,s,r,c)")({m:R,q:R.resolvedRequestType.ctor,s:R.resolvedResponseType.ctor})}return O}},9468:T=>{"use strict";T.exports=W;var S=/[\s{}=;:[\],'"()<>]/g,N=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,R=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,O=/^ *[*/]+ */,P=/^\s*\*?\/*/,M=/\n/g,L=/\s/,V=/\\(.?)/g,U={0:"\x00",r:"\r",n:"\n",t:"	"};function $(T){return T.replace(V,function(T,S){switch(S){case"\\":case"":return S;default:return U[S]||""}})}function W(T,V){T=T.toString();var U=0,W=T.length,K=1,Q=0,Y={},Z=[],ee=null;function et(T){return Error("illegal "+T+" (line "+K+")")}function er(){var S="'"===ee?R:N;S.lastIndex=U-1;var O=S.exec(T);if(!O)throw et("string");return U=S.lastIndex,eu(ee),ee=null,$(O[1])}function ei(S){return T.charAt(S)}function en(S,N,R){var L,U,$={type:T.charAt(S++),lineEmpty:!1,leading:R},W=S-(L=V?2:3);do if(--W<0||"\n"===(U=T.charAt(W))){$.lineEmpty=!0;break}while(" "===U||"	"===U);for(var Z=T.substring(S,N).split(M),ee=0;ee<Z.length;++ee)Z[ee]=Z[ee].replace(V?P:O,"").trim();$.text=Z.join("\n").trim(),Y[K]=$,Q=K}function es(S){var N=ea(S),R=T.substring(S,N);return/^\s*\/\//.test(R)}function ea(T){for(var S=T;S<W&&"\n"!==ei(S);)S++;return S}function eo(){if(Z.length>0)return Z.shift();if(ee)return er();var N,R,O,P,M,$=0===U;do{if(U===W)return null;for(N=!1;L.test(O=ei(U));)if("\n"===O&&($=!0,++K),++U===W)return null;if("/"===ei(U)){if(++U===W)throw et("comment");if("/"===ei(U)){if(V){if(P=U,M=!1,es(U-1)){M=!0;do if((U=ea(U))===W||(U++,!$))break;while(es(U))}else U=Math.min(W,ea(U)+1);M&&(en(P,U,$),$=!0),K++,N=!0}else{for(M="/"===ei(P=U+1);"\n"!==ei(++U);)if(U===W)return null;++U,M&&(en(P,U-1,$),$=!0),++K,N=!0}}else{if("*"!==(O=ei(U)))return"/";P=U+1,M=V||"*"===ei(P);do{if("\n"===O&&++K,++U===W)throw et("comment");R=O,O=ei(U)}while("*"!==R||"/"!==O);++U,M&&(en(P,U-2,$),$=!0),N=!0}}}while(N);var Q=U;if(S.lastIndex=0,!S.test(ei(Q++)))for(;Q<W&&!S.test(ei(Q));)++Q;var Y=T.substring(U,U=Q);return('"'===Y||"'"===Y)&&(ee=Y),Y}function eu(T){Z.push(T)}function ec(){if(!Z.length){var T=eo();if(null===T)return null;eu(T)}return Z[0]}function ed(T,S){var N=ec();if(N===T)return eo(),!0;if(!S)throw et("token '"+N+"', '"+T+"' expected");return!1}function eh(T){var S,N=null;return void 0===T?(S=Y[K-1],delete Y[K-1],S&&(V||"*"===S.type||S.lineEmpty)&&(N=S.leading?S.text:null)):(Q<T&&ec(),S=Y[T],delete Y[T],S&&!S.lineEmpty&&(V||"/"===S.type)&&(N=S.leading?null:S.text)),N}return Object.defineProperty({next:eo,peek:ec,push:eu,skip:ed,cmnt:eh},"line",{get:function(){return K}})}W.unescape=$},9396:(T,S,N)=>{"use strict";T.exports=er;var R=N(4622);((er.prototype=Object.create(R.prototype)).constructor=er).className="Type";var O=N(5519),P=N(5677),M=N(2548),L=N(372),V=N(6962),U=N(5326),$=N(8645),W=N(7474),K=N(8289),Q=N(7337),Y=N(8983),Z=N(1181),ee=N(5944),et=N(2969);function er(T,S){R.call(this,T,S),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function ei(T){return T._fieldsById=T._fieldsArray=T._oneofsArray=null,delete T.encode,delete T.decode,delete T.verify,T}Object.defineProperties(er.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var T=Object.keys(this.fields),S=0;S<T.length;++S){var N=this.fields[T[S]],R=N.id;if(this._fieldsById[R])throw Error("duplicate id "+R+" in "+this);this._fieldsById[R]=N}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=K.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=K.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=er.generateConstructor(this)())},set:function(T){var S=T.prototype;S instanceof U||((T.prototype=new U).constructor=T,K.merge(T.prototype,S)),T.$type=T.prototype.$type=this,K.merge(T,U,!0),this._ctor=T;for(var N=0;N<this.fieldsArray.length;++N)this._fieldsArray[N].resolve();var R={};for(N=0;N<this.oneofsArray.length;++N)R[this._oneofsArray[N].resolve().name]={get:K.oneOfGetter(this._oneofsArray[N].oneof),set:K.oneOfSetter(this._oneofsArray[N].oneof)};N&&Object.defineProperties(T.prototype,R)}}}),er.generateConstructor=function(T){for(var S,N=K.codegen(["p"],T.name),R=0;R<T.fieldsArray.length;++R)(S=T._fieldsArray[R]).map?N("this%s={}",K.safeProp(S.name)):S.repeated&&N("this%s=[]",K.safeProp(S.name));return N("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},er.fromJSON=function(T,S){var N=new er(T,S.options);N.extensions=S.extensions,N.reserved=S.reserved;for(var U=Object.keys(S.fields),$=0;$<U.length;++$)N.add((void 0!==S.fields[U[$]].keyType?L.fromJSON:M.fromJSON)(U[$],S.fields[U[$]]));if(S.oneofs)for(U=Object.keys(S.oneofs),$=0;$<U.length;++$)N.add(P.fromJSON(U[$],S.oneofs[U[$]]));if(S.nested)for(U=Object.keys(S.nested),$=0;$<U.length;++$){var W=S.nested[U[$]];N.add((void 0!==W.id?M.fromJSON:void 0!==W.fields?er.fromJSON:void 0!==W.values?O.fromJSON:void 0!==W.methods?V.fromJSON:R.fromJSON)(U[$],W))}return S.extensions&&S.extensions.length&&(N.extensions=S.extensions),S.reserved&&S.reserved.length&&(N.reserved=S.reserved),S.group&&(N.group=!0),S.comment&&(N.comment=S.comment),S.edition&&(N._edition=S.edition),N._defaultEdition="proto3",N},er.prototype.toJSON=function(T){var S=R.prototype.toJSON.call(this,T),N=!!T&&!!T.keepComments;return K.toObject(["edition",this._editionToJSON(),"options",S&&S.options||void 0,"oneofs",R.arrayToJSON(this.oneofsArray,T),"fields",R.arrayToJSON(this.fieldsArray.filter(function(T){return!T.declaringField}),T)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",S&&S.nested||void 0,"comment",N?this.comment:void 0])},er.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;R.prototype.resolveAll.call(this);var T=this.oneofsArray;for(N=0;N<T.length;)T[N++].resolve();for(var S=this.fieldsArray,N=0;N<S.length;)S[N++].resolve();return this},er.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(T=this._edition||T,R.prototype._resolveFeaturesRecursive.call(this,T),this.oneofsArray.forEach(S=>{S._resolveFeatures(T)}),this.fieldsArray.forEach(S=>{S._resolveFeatures(T)})),this},er.prototype.get=function(T){return this.fields[T]||this.oneofs&&this.oneofs[T]||this.nested&&this.nested[T]||null},er.prototype.add=function(T){if(this.get(T.name))throw Error("duplicate name '"+T.name+"' in "+this);if(T instanceof M&&void 0===T.extend){if(this._fieldsById?this._fieldsById[T.id]:this.fieldsById[T.id])throw Error("duplicate id "+T.id+" in "+this);if(this.isReservedId(T.id))throw Error("id "+T.id+" is reserved in "+this);if(this.isReservedName(T.name))throw Error("name '"+T.name+"' is reserved in "+this);return T.parent&&T.parent.remove(T),this.fields[T.name]=T,T.message=this,T.onAdd(this),ei(this)}return T instanceof P?(this.oneofs||(this.oneofs={}),this.oneofs[T.name]=T,T.onAdd(this),ei(this)):R.prototype.add.call(this,T)},er.prototype.remove=function(T){if(T instanceof M&&void 0===T.extend){if(!this.fields||this.fields[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.fields[T.name],T.parent=null,T.onRemove(this),ei(this)}if(T instanceof P){if(!this.oneofs||this.oneofs[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.oneofs[T.name],T.parent=null,T.onRemove(this),ei(this)}return R.prototype.remove.call(this,T)},er.prototype.isReservedId=function(T){return R.isReservedId(this.reserved,T)},er.prototype.isReservedName=function(T){return R.isReservedName(this.reserved,T)},er.prototype.create=function(T){return new this.ctor(T)},er.prototype.setup=function(){for(var T=this.fullName,S=[],N=0;N<this.fieldsArray.length;++N)S.push(this._fieldsArray[N].resolve().resolvedType);this.encode=Q(this)({Writer:W,types:S,util:K}),this.decode=Y(this)({Reader:$,types:S,util:K}),this.verify=Z(this)({types:S,util:K}),this.fromObject=ee.fromObject(this)({types:S,util:K}),this.toObject=ee.toObject(this)({types:S,util:K});var R=et[T];if(R){var O=Object.create(this);O.fromObject=this.fromObject,this.fromObject=R.fromObject.bind(O),O.toObject=this.toObject,this.toObject=R.toObject.bind(O)}return this},er.prototype.encode=function(T,S){return this.setup().encode(T,S)},er.prototype.encodeDelimited=function(T,S){return this.encode(T,S&&S.len?S.fork():S).ldelim()},er.prototype.decode=function(T,S){return this.setup().decode(T,S)},er.prototype.decodeDelimited=function(T){return T instanceof $||(T=$.create(T)),this.decode(T,T.uint32())},er.prototype.verify=function(T){return this.setup().verify(T)},er.prototype.fromObject=function(T){return this.setup().fromObject(T)},er.prototype.toObject=function(T,S){return this.setup().toObject(T,S)},er.d=function(T){return function(S){K.decorateType(S,T)}}},1627:(T,S,N)=>{"use strict";var R=S,O=N(8289),P=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function M(T,S){var N=0,R={};for(S|=0;N<T.length;)R[P[N+S]]=T[N++];return R}R.basic=M([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),R.defaults=M([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",O.emptyArray,null]),R.long=M([0,0,0,1,1],7),R.mapKey=M([0,0,0,5,5,0,0,0,1,1,0,2],2),R.packed=M([1,5,0,0,0,5,5,0,0,0,1,1,0])},8289:(T,S,N)=>{"use strict";var R,O,P=T.exports=N(6416),M=N(3675);P.codegen=N(2012),P.fetch=N(3035),P.path=N(9986),P.fs=P.inquire("fs"),P.toArray=function(T){if(T){for(var S=Object.keys(T),N=Array(S.length),R=0;R<S.length;)N[R]=T[S[R++]];return N}return[]},P.toObject=function(T){for(var S={},N=0;N<T.length;){var R=T[N++],O=T[N++];void 0!==O&&(S[R]=O)}return S};var L=/\\/g,V=/"/g;P.isReserved=function(T){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(T)},P.safeProp=function(T){return!/^[$\w_]+$/.test(T)||P.isReserved(T)?'["'+T.replace(L,"\\\\").replace(V,'\\"')+'"]':"."+T},P.ucFirst=function(T){return T.charAt(0).toUpperCase()+T.substring(1)};var U=/_([a-z])/g;P.camelCase=function(T){return T.substring(0,1)+T.substring(1).replace(U,function(T,S){return S.toUpperCase()})},P.compareFieldsById=function(T,S){return T.id-S.id},P.decorateType=function(T,S){if(T.$type)return S&&T.$type.name!==S&&(P.decorateRoot.remove(T.$type),T.$type.name=S,P.decorateRoot.add(T.$type)),T.$type;R||(R=N(9396));var O=new R(S||T.name);return P.decorateRoot.add(O),O.ctor=T,Object.defineProperty(T,"$type",{value:O,enumerable:!1}),Object.defineProperty(T.prototype,"$type",{value:O,enumerable:!1}),O};var $=0;P.decorateEnum=function(T){if(T.$type)return T.$type;O||(O=N(5519));var S=new O("Enum"+$++,T);return P.decorateRoot.add(S),Object.defineProperty(T,"$type",{value:S,enumerable:!1}),S},P.setProperty=function(T,S,N,R){function O(T,S,N){var P=S.shift();if("__proto__"===P||"prototype"===P)return T;if(S.length>0)T[P]=O(T[P]||{},S,N);else{var M=T[P];if(M&&R)return T;M&&(N=[].concat(M).concat(N)),T[P]=N}return T}if("object"!=typeof T)throw TypeError("dst must be an object");if(!S)throw TypeError("path must be specified");return O(T,S=S.split("."),N)},Object.defineProperty(P,"decorateRoot",{get:function(){return M.decorated||(M.decorated=new(N(4955)))}})},9535:(T,S,N)=>{"use strict";T.exports=O;var R=N(6416);function O(T,S){this.lo=T>>>0,this.hi=S>>>0}var P=O.zero=new O(0,0);P.toNumber=function(){return 0},P.zzEncode=P.zzDecode=function(){return this},P.length=function(){return 1};var M=O.zeroHash="\x00\x00\x00\x00\x00\x00\x00\x00";O.fromNumber=function(T){if(0===T)return P;var S=T<0;S&&(T=-T);var N=T>>>0,R=(T-N)/4294967296>>>0;return S&&(R=~R>>>0,N=~N>>>0,++N>4294967295&&(N=0,++R>4294967295&&(R=0))),new O(N,R)},O.from=function(T){if("number"==typeof T)return O.fromNumber(T);if(R.isString(T)){if(!R.Long)return O.fromNumber(parseInt(T,10));T=R.Long.fromString(T)}return T.low||T.high?new O(T.low>>>0,T.high>>>0):P},O.prototype.toNumber=function(T){if(!T&&this.hi>>>31){var S=~this.lo+1>>>0,N=~this.hi>>>0;return S||(N=N+1>>>0),-(S+4294967296*N)}return this.lo+4294967296*this.hi},O.prototype.toLong=function(T){return R.Long?new R.Long(0|this.lo,0|this.hi,!!T):{low:0|this.lo,high:0|this.hi,unsigned:!!T}};var L=String.prototype.charCodeAt;O.fromHash=function(T){return T===M?P:new O((L.call(T,0)|L.call(T,1)<<8|L.call(T,2)<<16|L.call(T,3)<<24)>>>0,(L.call(T,4)|L.call(T,5)<<8|L.call(T,6)<<16|L.call(T,7)<<24)>>>0)},O.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},O.prototype.zzEncode=function(){var T=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^T)>>>0,this.lo=(this.lo<<1^T)>>>0,this},O.prototype.zzDecode=function(){var T=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^T)>>>0,this.hi=(this.hi>>>1^T)>>>0,this},O.prototype.length=function(){var T=this.lo,S=(this.lo>>>28|this.hi<<4)>>>0,N=this.hi>>>24;return 0===N?0===S?T<16384?T<128?1:2:T<2097152?3:4:S<16384?S<128?5:6:S<2097152?7:8:N<128?9:10}},6416:function(T,S,N){"use strict";var R=S;function O(T,S,N){for(var R=Object.keys(S),O=0;O<R.length;++O)void 0!==T[R[O]]&&N||(T[R[O]]=S[R[O]]);return T}function P(T){function S(T,N){if(!(this instanceof S))return new S(T,N);Object.defineProperty(this,"message",{get:function(){return T}}),Error.captureStackTrace?Error.captureStackTrace(this,S):Object.defineProperty(this,"stack",{value:Error().stack||""}),N&&O(this,N)}return S.prototype=Object.create(Error.prototype,{constructor:{value:S,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return T},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),S}R.asPromise=N(799),R.base64=N(2130),R.EventEmitter=N(854),R.float=N(4324),R.inquire=N(449),R.utf8=N(8131),R.pool=N(6035),R.LongBits=N(9535),R.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),R.global=R.isNode&&global||"undefined"!=typeof self&&self||this,R.emptyArray=Object.freeze?Object.freeze([]):[],R.emptyObject=Object.freeze?Object.freeze({}):{},R.isInteger=Number.isInteger||function(T){return"number"==typeof T&&isFinite(T)&&Math.floor(T)===T},R.isString=function(T){return"string"==typeof T||T instanceof String},R.isObject=function(T){return T&&"object"==typeof T},R.isset=R.isSet=function(T,S){var N=T[S];return!!(null!=N&&T.hasOwnProperty(S))&&("object"!=typeof N||(Array.isArray(N)?N.length:Object.keys(N).length)>0)},R.Buffer=function(){try{var T=R.inquire("buffer").Buffer;return T.prototype.utf8Write?T:null}catch(T){return null}}(),R._Buffer_from=null,R._Buffer_allocUnsafe=null,R.newBuffer=function(T){return"number"==typeof T?R.Buffer?R._Buffer_allocUnsafe(T):new R.Array(T):R.Buffer?R._Buffer_from(T):"undefined"==typeof Uint8Array?T:new Uint8Array(T)},R.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,R.Long=R.global.dcodeIO&&R.global.dcodeIO.Long||R.global.Long||R.inquire("long"),R.key2Re=/^true|false|0|1$/,R.key32Re=/^-?(?:0|[1-9][0-9]*)$/,R.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,R.longToHash=function(T){return T?R.LongBits.from(T).toHash():R.LongBits.zeroHash},R.longFromHash=function(T,S){var N=R.LongBits.fromHash(T);return R.Long?R.Long.fromBits(N.lo,N.hi,S):N.toNumber(!!S)},R.merge=O,R.lcFirst=function(T){return T.charAt(0).toLowerCase()+T.substring(1)},R.newError=P,R.ProtocolError=P("ProtocolError"),R.oneOfGetter=function(T){for(var S={},N=0;N<T.length;++N)S[T[N]]=1;return function(){for(var T=Object.keys(this),N=T.length-1;N>-1;--N)if(1===S[T[N]]&&void 0!==this[T[N]]&&null!==this[T[N]])return T[N]}},R.oneOfSetter=function(T){return function(S){for(var N=0;N<T.length;++N)T[N]!==S&&delete this[T[N]]}},R.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},R._configure=function(){var T=R.Buffer;if(!T){R._Buffer_from=R._Buffer_allocUnsafe=null;return}R._Buffer_from=T.from!==Uint8Array.from&&T.from||function(S,N){return new T(S,N)},R._Buffer_allocUnsafe=T.allocUnsafe||function(S){return new T(S)}}},1181:(T,S,N)=>{"use strict";T.exports=V;var R=N(5519),O=N(8289);function P(T,S){return T.name+": "+S+(T.repeated&&"array"!==S?"[]":T.map&&"object"!==S?"{k:"+T.keyType+"}":"")+" expected"}function M(T,S,N,O){if(S.resolvedType){if(S.resolvedType instanceof R){T("switch(%s){",O)("default:")("return%j",P(S,"enum value"));for(var M=Object.keys(S.resolvedType.values),L=0;L<M.length;++L)T("case %i:",S.resolvedType.values[M[L]]);T("break")("}")}else T("{")("var e=types[%i].verify(%s);",N,O)("if(e)")("return%j+e",S.name+".")("}")}else switch(S.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":T("if(!util.isInteger(%s))",O)("return%j",P(S,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":T("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",O,O,O,O)("return%j",P(S,"integer|Long"));break;case"float":case"double":T('if(typeof %s!=="number")',O)("return%j",P(S,"number"));break;case"bool":T('if(typeof %s!=="boolean")',O)("return%j",P(S,"boolean"));break;case"string":T("if(!util.isString(%s))",O)("return%j",P(S,"string"));break;case"bytes":T('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',O,O,O)("return%j",P(S,"buffer"))}return T}function L(T,S,N){switch(S.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":T("if(!util.key32Re.test(%s))",N)("return%j",P(S,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":T("if(!util.key64Re.test(%s))",N)("return%j",P(S,"integer|Long key"));break;case"bool":T("if(!util.key2Re.test(%s))",N)("return%j",P(S,"boolean key"))}return T}function V(T){var S=O.codegen(["m"],T.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),N=T.oneofsArray,R={};N.length&&S("var p={}");for(var V=0;V<T.fieldsArray.length;++V){var U=T._fieldsArray[V].resolve(),$="m"+O.safeProp(U.name);if(U.optional&&S("if(%s!=null&&m.hasOwnProperty(%j)){",$,U.name),U.map)S("if(!util.isObject(%s))",$)("return%j",P(U,"object"))("var k=Object.keys(%s)",$)("for(var i=0;i<k.length;++i){"),L(S,U,"k[i]"),M(S,U,V,$+"[k[i]]")("}");else if(U.repeated)S("if(!Array.isArray(%s))",$)("return%j",P(U,"array"))("for(var i=0;i<%s.length;++i){",$),M(S,U,V,$+"[i]")("}");else{if(U.partOf){var W=O.safeProp(U.partOf.name);1===R[U.partOf.name]&&S("if(p%s===1)",W)("return%j",U.partOf.name+": multiple values"),R[U.partOf.name]=1,S("p%s=1",W)}M(S,U,V,$)}U.optional&&S("}")}return S("return null")}},2969:(T,S,N)=>{"use strict";var R=S,O=N(5326);R[".google.protobuf.Any"]={fromObject:function(T){if(T&&T["@type"]){var S=T["@type"].substring(T["@type"].lastIndexOf("/")+1),N=this.lookup(S);if(N){var R="."===T["@type"].charAt(0)?T["@type"].slice(1):T["@type"];return -1===R.indexOf("/")&&(R="/"+R),this.create({type_url:R,value:N.encode(N.fromObject(T)).finish()})}}return this.fromObject(T)},toObject:function(T,S){var N="type.googleapis.com/",R="",P="";if(S&&S.json&&T.type_url&&T.value){P=T.type_url.substring(T.type_url.lastIndexOf("/")+1),R=T.type_url.substring(0,T.type_url.lastIndexOf("/")+1);var M=this.lookup(P);M&&(T=M.decode(T.value))}if(!(T instanceof this.ctor)&&T instanceof O){var L=T.$type.toObject(T,S),V="."===T.$type.fullName[0]?T.$type.fullName.slice(1):T.$type.fullName;return""===R&&(R=N),P=R+V,L["@type"]=P,L}return this.toObject(T,S)}}},7474:(T,S,N)=>{"use strict";T.exports=W;var R,O=N(6416),P=O.LongBits,M=O.base64,L=O.utf8;function V(T,S,N){this.fn=T,this.len=S,this.next=void 0,this.val=N}function U(){}function $(T){this.head=T.head,this.tail=T.tail,this.len=T.len,this.next=T.states}function W(){this.len=0,this.head=new V(U,0,0),this.tail=this.head,this.states=null}var K=function(){return O.Buffer?function(){return(W.create=function(){return new R})()}:function(){return new W}};function Q(T,S,N){S[N]=255&T}function Y(T,S,N){for(;T>127;)S[N++]=127&T|128,T>>>=7;S[N]=T}function Z(T,S){this.len=T,this.next=void 0,this.val=S}function ee(T,S,N){for(;T.hi;)S[N++]=127&T.lo|128,T.lo=(T.lo>>>7|T.hi<<25)>>>0,T.hi>>>=7;for(;T.lo>127;)S[N++]=127&T.lo|128,T.lo=T.lo>>>7;S[N++]=T.lo}function et(T,S,N){S[N]=255&T,S[N+1]=T>>>8&255,S[N+2]=T>>>16&255,S[N+3]=T>>>24}W.create=K(),W.alloc=function(T){return new O.Array(T)},O.Array!==Array&&(W.alloc=O.pool(W.alloc,O.Array.prototype.subarray)),W.prototype._push=function(T,S,N){return this.tail=this.tail.next=new V(T,S,N),this.len+=S,this},Z.prototype=Object.create(V.prototype),Z.prototype.fn=Y,W.prototype.uint32=function(T){return this.len+=(this.tail=this.tail.next=new Z((T>>>=0)<128?1:T<16384?2:T<2097152?3:T<268435456?4:5,T)).len,this},W.prototype.int32=function(T){return T<0?this._push(ee,10,P.fromNumber(T)):this.uint32(T)},W.prototype.sint32=function(T){return this.uint32((T<<1^T>>31)>>>0)},W.prototype.uint64=function(T){var S=P.from(T);return this._push(ee,S.length(),S)},W.prototype.int64=W.prototype.uint64,W.prototype.sint64=function(T){var S=P.from(T).zzEncode();return this._push(ee,S.length(),S)},W.prototype.bool=function(T){return this._push(Q,1,T?1:0)},W.prototype.fixed32=function(T){return this._push(et,4,T>>>0)},W.prototype.sfixed32=W.prototype.fixed32,W.prototype.fixed64=function(T){var S=P.from(T);return this._push(et,4,S.lo)._push(et,4,S.hi)},W.prototype.sfixed64=W.prototype.fixed64,W.prototype.float=function(T){return this._push(O.float.writeFloatLE,4,T)},W.prototype.double=function(T){return this._push(O.float.writeDoubleLE,8,T)};var er=O.Array.prototype.set?function(T,S,N){S.set(T,N)}:function(T,S,N){for(var R=0;R<T.length;++R)S[N+R]=T[R]};W.prototype.bytes=function(T){var S=T.length>>>0;if(!S)return this._push(Q,1,0);if(O.isString(T)){var N=W.alloc(S=M.length(T));M.decode(T,N,0),T=N}return this.uint32(S)._push(er,S,T)},W.prototype.string=function(T){var S=L.length(T);return S?this.uint32(S)._push(L.write,S,T):this._push(Q,1,0)},W.prototype.fork=function(){return this.states=new $(this),this.head=this.tail=new V(U,0,0),this.len=0,this},W.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new V(U,0,0),this.len=0),this},W.prototype.ldelim=function(){var T=this.head,S=this.tail,N=this.len;return this.reset().uint32(N),N&&(this.tail.next=T.next,this.tail=S,this.len+=N),this},W.prototype.finish=function(){for(var T=this.head.next,S=this.constructor.alloc(this.len),N=0;T;)T.fn(T.val,S,N),N+=T.len,T=T.next;return S},W._configure=function(T){R=T,W.create=K(),R._configure()}},6985:(T,S,N)=>{"use strict";T.exports=P;var R=N(7474);(P.prototype=Object.create(R.prototype)).constructor=P;var O=N(6416);function P(){R.call(this)}function M(T,S,N){T.length<40?O.utf8.write(T,S,N):S.utf8Write?S.utf8Write(T,N):S.write(T,N)}P._configure=function(){P.alloc=O._Buffer_allocUnsafe,P.writeBytesBuffer=O.Buffer&&O.Buffer.prototype instanceof Uint8Array&&"set"===O.Buffer.prototype.set.name?function(T,S,N){S.set(T,N)}:function(T,S,N){if(T.copy)T.copy(S,N,0,T.length);else for(var R=0;R<T.length;)S[N++]=T[R++]}},P.prototype.bytes=function(T){O.isString(T)&&(T=O._Buffer_from(T,"base64"));var S=T.length>>>0;return this.uint32(S),S&&this._push(P.writeBytesBuffer,S,T),this},P.prototype.string=function(T){var S=O.Buffer.byteLength(T);return this.uint32(S),S&&this._push(M,S,T),this},P._configure()},7585:T=>{let S=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,N=T=>T.match(S)||[],R=T=>T[0].toUpperCase()+T.slice(1),O=(T,S)=>N(T).join(S).toLowerCase(),P=T=>N(T).reduce((T,S)=>`${T}${T?S[0].toUpperCase()+S.slice(1).toLowerCase():S.toLowerCase()}`,""),M=T=>R(P(T)),L=T=>O(T,"_"),V=T=>O(T,"-"),U=T=>R(O(T," ")),$=T=>N(T).map(R).join(" ");T.exports={words:N,upperFirst:R,camelCase:P,pascalCase:M,snakeCase:L,kebabCase:V,sentenceCase:U,titleCase:$}},6980:T=>{function S(T,S){var N=T.length,P=Array(N),M={},L=N,V=R(S),U=O(T);for(S.forEach(function(T){if(!U.has(T[0])||!U.has(T[1]))throw Error("Unknown node. There is an unknown node in the supplied edges.")});L--;)M[L]||$(T[L],L,new Set);return P;function $(T,S,R){if(R.has(T)){var O;try{O=", node was:"+JSON.stringify(T)}catch(T){O=""}throw Error("Cyclic dependency"+O)}if(!U.has(T))throw Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(T));if(!M[S]){M[S]=!0;var L=V.get(T)||new Set;if(L=Array.from(L),S=L.length){R.add(T);do{var W=L[--S];$(W,U.get(W),R)}while(S);R.delete(T)}P[--N]=T}}}function N(T){for(var S=new Set,N=0,R=T.length;N<R;N++){var O=T[N];S.add(O[0]),S.add(O[1])}return Array.from(S)}function R(T){for(var S=new Map,N=0,R=T.length;N<R;N++){var O=T[N];S.has(O[0])||S.set(O[0],new Set),S.has(O[1])||S.set(O[1],new Set),S.get(O[0]).add(O[1])}return S}function O(T){for(var S=new Map,N=0,R=T.length;N<R;N++)S.set(T[N],N);return S}T.exports=function(T){return S(N(T),T)},T.exports.array=S},7958:(T,S,N)=>{"use strict";let R,O,P,M,L,V,U,$,W;N.r(S),N.d(S,{default:()=>Ld});var K,Q,Y,Z,ee,et,er,ei=N(2295),en=N(3729);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let es=T=>T.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ea=T=>T.replace(/^([A-Z])|[\s-_]+(\w)/g,(T,S,N)=>N?N.toUpperCase():S.toLowerCase()),eo=T=>{let S=ea(T);return S.charAt(0).toUpperCase()+S.slice(1)},eu=(...T)=>T.filter((T,S,N)=>!!T&&""!==T.trim()&&N.indexOf(T)===S).join(" ").trim(),ec=T=>{for(let S in T)if(S.startsWith("aria-")||"role"===S||"title"===S)return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ed={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let eh=(0,en.forwardRef)(({color:T="currentColor",size:S=24,strokeWidth:N=2,absoluteStrokeWidth:R,className:O="",children:P,iconNode:M,...L},V)=>(0,en.createElement)("svg",{ref:V,...ed,width:S,height:S,stroke:T,strokeWidth:R?24*Number(N)/Number(S):N,className:eu("lucide",O),...!P&&!ec(L)&&{"aria-hidden":"true"},...L},[...M.map(([T,S])=>(0,en.createElement)(T,S)),...Array.isArray(P)?P:[P]])),ep=(T,S)=>{let N=(0,en.forwardRef)(({className:N,...R},O)=>(0,en.createElement)(eh,{ref:O,iconNode:S,className:eu(`lucide-${es(eo(T))}`,`lucide-${T}`,N),...R}));return N.displayName=eo(T),N},ef=ep("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),em=ep("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),eg=ep("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ey=ep("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]),ev=(0,en.createContext)({transformPagePoint:T=>T,isStatic:!1,reducedMotion:"never"}),eb=(0,en.createContext)({}),ew=(0,en.createContext)(null),eT="undefined"!=typeof document,eS=eT?en.useLayoutEffect:en.useEffect,ex=(0,en.createContext)({strict:!1}),eE=T=>T.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),eC="data-"+eE("framerAppearId");function e_(T,S,N,R){let{visualElement:O}=(0,en.useContext)(eb),P=(0,en.useContext)(ex),M=(0,en.useContext)(ew),L=(0,en.useContext)(ev).reducedMotion,V=(0,en.useRef)();R=R||P.renderer,!V.current&&R&&(V.current=R(T,{visualState:S,parent:O,props:N,presenceContext:M,blockInitialAnimation:!!M&&!1===M.initial,reducedMotionConfig:L}));let U=V.current;(0,en.useInsertionEffect)(()=>{U&&U.update(N,M)});let $=(0,en.useRef)(!!(N[eC]&&!window.HandoffComplete));return eS(()=>{U&&(U.render(),$.current&&U.animationState&&U.animationState.animateChanges())}),(0,en.useEffect)(()=>{U&&(U.updateFeatures(),!$.current&&U.animationState&&U.animationState.animateChanges(),$.current&&($.current=!1,window.HandoffComplete=!0))}),U}function eI(T){return T&&"object"==typeof T&&Object.prototype.hasOwnProperty.call(T,"current")}function ek(T,S,N){return(0,en.useCallback)(R=>{R&&T.mount&&T.mount(R),S&&(R?S.mount(R):S.unmount()),N&&("function"==typeof N?N(R):eI(N)&&(N.current=R))},[S])}function eN(T){return"string"==typeof T||Array.isArray(T)}function eA(T){return null!==T&&"object"==typeof T&&"function"==typeof T.start}let eR=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],eD=["initial",...eR];function eO(T){return eA(T.animate)||eD.some(S=>eN(T[S]))}function eP(T){return!!(eO(T)||T.variants)}function eM(T,S){if(eO(T)){let{initial:S,animate:N}=T;return{initial:!1===S||eN(S)?S:void 0,animate:eN(N)?N:void 0}}return!1!==T.inherit?S:{}}function eL(T){let{initial:S,animate:N}=eM(T,(0,en.useContext)(eb));return(0,en.useMemo)(()=>({initial:S,animate:N}),[ej(S),ej(N)])}function ej(T){return Array.isArray(T)?T.join(" "):T}let eF={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},eB={};for(let T in eF)eB[T]={isEnabled:S=>eF[T].some(T=>!!S[T])};function eV(T){for(let S in T)eB[S]={...eB[S],...T[S]}}let eU=(0,en.createContext)({}),ez=(0,en.createContext)({}),eq=Symbol.for("motionComponentSymbol");function e$({preloadedFeatures:T,createVisualElement:S,useRender:N,useVisualState:R,Component:O}){function P(P,M){let L;let V={...(0,en.useContext)(ev),...P,layoutId:eH(P)},{isStatic:U}=V,$=eL(P),W=R(P,U);if(!U&&eT){$.visualElement=e_(O,W,V,S);let N=(0,en.useContext)(ez),R=(0,en.useContext)(ex).strict;$.visualElement&&(L=$.visualElement.loadFeatures(V,R,T,N))}return en.createElement(eb.Provider,{value:$},L&&$.visualElement?en.createElement(L,{visualElement:$.visualElement,...V}):null,N(O,P,ek(W,$.visualElement,M),W,U,$.visualElement))}T&&eV(T);let M=(0,en.forwardRef)(P);return M[eq]=O,M}function eH({layoutId:T}){let S=(0,en.useContext)(eU).id;return S&&void 0!==T?S+"-"+T:T}function eG(T){function S(S,N={}){return e$(T(S,N))}if("undefined"==typeof Proxy)return S;let N=new Map;return new Proxy(S,{get:(T,R)=>(N.has(R)||N.set(R,S(R)),N.get(R))})}let eW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function eK(T){if("string"!=typeof T||T.includes("-"));else if(eW.indexOf(T)>-1||/[A-Z]/.test(T))return!0;return!1}let eQ={};function eY(T){Object.assign(eQ,T)}let eJ=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],eX=new Set(eJ);function eZ(T,{layout:S,layoutId:N}){return eX.has(T)||T.startsWith("origin")||(S||void 0!==N)&&(!!eQ[T]||"opacity"===T)}let e0=T=>!!(T&&T.getVelocity),e1={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},e2=eJ.length;function e3(T,{enableHardwareAcceleration:S=!0,allowTransformNone:N=!0},R,O){let P="";for(let S=0;S<e2;S++){let N=eJ[S];if(void 0!==T[N]){let S=e1[N]||N;P+=`${S}(${T[N]}) `}}return S&&!T.z&&(P+="translateZ(0)"),P=P.trim(),O?P=O(T,R?"":P):N&&R&&(P="none"),P}let e4=T=>S=>"string"==typeof S&&S.startsWith(T),e6=e4("--"),e5=e4("var(--"),e9=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,e8=(T,S)=>S&&"number"==typeof T?S.transform(T):T,e7=(T,S,N)=>Math.min(Math.max(N,T),S),te={test:T=>"number"==typeof T,parse:parseFloat,transform:T=>T},tt={...te,transform:T=>e7(0,1,T)},tr={...te,default:1},ti=T=>Math.round(1e5*T)/1e5,ts=/(-)?([\d]*\.?[\d])+/g,ta=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,tl=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function tu(T){return"string"==typeof T}let tc=T=>({test:S=>tu(S)&&S.endsWith(T)&&1===S.split(" ").length,parse:parseFloat,transform:S=>`${S}${T}`}),td=tc("deg"),th=tc("%"),tp=tc("px"),tf=tc("vh"),tm=tc("vw"),tg={...th,parse:T=>th.parse(T)/100,transform:T=>th.transform(100*T)},ty={...te,transform:Math.round},tv={borderWidth:tp,borderTopWidth:tp,borderRightWidth:tp,borderBottomWidth:tp,borderLeftWidth:tp,borderRadius:tp,radius:tp,borderTopLeftRadius:tp,borderTopRightRadius:tp,borderBottomRightRadius:tp,borderBottomLeftRadius:tp,width:tp,maxWidth:tp,height:tp,maxHeight:tp,size:tp,top:tp,right:tp,bottom:tp,left:tp,padding:tp,paddingTop:tp,paddingRight:tp,paddingBottom:tp,paddingLeft:tp,margin:tp,marginTop:tp,marginRight:tp,marginBottom:tp,marginLeft:tp,rotate:td,rotateX:td,rotateY:td,rotateZ:td,scale:tr,scaleX:tr,scaleY:tr,scaleZ:tr,skew:td,skewX:td,skewY:td,distance:tp,translateX:tp,translateY:tp,translateZ:tp,x:tp,y:tp,z:tp,perspective:tp,transformPerspective:tp,opacity:tt,originX:tg,originY:tg,originZ:tp,zIndex:ty,fillOpacity:tt,strokeOpacity:tt,numOctaves:ty};function tb(T,S,N,R){let{style:O,vars:P,transform:M,transformOrigin:L}=T,V=!1,U=!1,$=!0;for(let T in S){let N=S[T];if(e6(T)){P[T]=N;continue}let R=tv[T],W=e8(N,R);if(eX.has(T)){if(V=!0,M[T]=W,!$)continue;N!==(R.default||0)&&($=!1)}else T.startsWith("origin")?(U=!0,L[T]=W):O[T]=W}if(!S.transform&&(V||R?O.transform=e3(T.transform,N,$,R):O.transform&&(O.transform="none")),U){let{originX:T="50%",originY:S="50%",originZ:N=0}=L;O.transformOrigin=`${T} ${S} ${N}`}}let tw=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function tT(T,S,N){for(let R in S)e0(S[R])||eZ(R,N)||(T[R]=S[R])}function tS({transformTemplate:T},S,N){return(0,en.useMemo)(()=>{let R=tw();return tb(R,S,{enableHardwareAcceleration:!N},T),Object.assign({},R.vars,R.style)},[S])}function tE(T,S,N){let R=T.style||{},O={};return tT(O,R,T),Object.assign(O,tS(T,S,N)),T.transformValues?T.transformValues(O):O}function tC(T,S,N){let R={},O=tE(T,S,N);return T.drag&&!1!==T.dragListener&&(R.draggable=!1,O.userSelect=O.WebkitUserSelect=O.WebkitTouchCallout="none",O.touchAction=!0===T.drag?"none":`pan-${"x"===T.drag?"y":"x"}`),void 0===T.tabIndex&&(T.onTap||T.onTapStart||T.whileTap)&&(R.tabIndex=0),R.style=O,R}let t_=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function tI(T){return T.startsWith("while")||T.startsWith("drag")&&"draggable"!==T||T.startsWith("layout")||T.startsWith("onTap")||T.startsWith("onPan")||T.startsWith("onLayout")||t_.has(T)}let tk=T=>!tI(T);function tN(T){T&&(tk=S=>S.startsWith("on")?!tI(S):T(S))}try{tN(require("@emotion/is-prop-valid").default)}catch(T){}function tA(T,S,N){let R={};for(let O in T)("values"!==O||"object"!=typeof T.values)&&(tk(O)||!0===N&&tI(O)||!S&&!tI(O)||T.draggable&&O.startsWith("onDrag"))&&(R[O]=T[O]);return R}function tR(T,S,N){return"string"==typeof T?T:tp.transform(S+N*T)}function tD(T,S,N){let R=tR(S,T.x,T.width),O=tR(N,T.y,T.height);return`${R} ${O}`}let tO={offset:"stroke-dashoffset",array:"stroke-dasharray"},tP={offset:"strokeDashoffset",array:"strokeDasharray"};function tM(T,S,N=1,R=0,O=!0){T.pathLength=1;let P=O?tO:tP;T[P.offset]=tp.transform(-R);let M=tp.transform(S),L=tp.transform(N);T[P.array]=`${M} ${L}`}function tL(T,{attrX:S,attrY:N,attrScale:R,originX:O,originY:P,pathLength:M,pathSpacing:L=1,pathOffset:V=0,...U},$,W,K){if(tb(T,U,$,K),W){T.style.viewBox&&(T.attrs.viewBox=T.style.viewBox);return}T.attrs=T.style,T.style={};let{attrs:Q,style:Y,dimensions:Z}=T;Q.transform&&(Z&&(Y.transform=Q.transform),delete Q.transform),Z&&(void 0!==O||void 0!==P||Y.transform)&&(Y.transformOrigin=tD(Z,void 0!==O?O:.5,void 0!==P?P:.5)),void 0!==S&&(Q.x=S),void 0!==N&&(Q.y=N),void 0!==R&&(Q.scale=R),void 0!==M&&tM(Q,M,L,V,!1)}let tj=()=>({...tw(),attrs:{}}),tF=T=>"string"==typeof T&&"svg"===T.toLowerCase();function tB(T,S,N,R){let O=(0,en.useMemo)(()=>{let N=tj();return tL(N,S,{enableHardwareAcceleration:!1},tF(R),T.transformTemplate),{...N.attrs,style:{...N.style}}},[S]);if(T.style){let S={};tT(S,T.style,T),O.style={...S,...O.style}}return O}function tV(T=!1){return(S,N,R,{latestValues:O},P)=>{let M=(eK(S)?tB:tC)(N,O,P,S),L={...tA(N,"string"==typeof S,T),...M,ref:R},{children:V}=N,U=(0,en.useMemo)(()=>e0(V)?V.get():V,[V]);return(0,en.createElement)(S,{...L,children:U})}}function tU(T,{style:S,vars:N},R,O){for(let P in Object.assign(T.style,S,O&&O.getProjectionStyles(R)),N)T.style.setProperty(P,N[P])}let tz=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function tq(T,S,N,R){for(let N in tU(T,S,void 0,R),S.attrs)T.setAttribute(tz.has(N)?N:eE(N),S.attrs[N])}function t$(T,S){let{style:N}=T,R={};for(let O in N)(e0(N[O])||S.style&&e0(S.style[O])||eZ(O,T))&&(R[O]=N[O]);return R}function tH(T,S){let N=t$(T,S);for(let R in T)(e0(T[R])||e0(S[R]))&&(N[-1!==eJ.indexOf(R)?"attr"+R.charAt(0).toUpperCase()+R.substring(1):R]=T[R]);return N}function tG(T,S,N,R={},O={}){return"function"==typeof S&&(S=S(void 0!==N?N:T.custom,R,O)),"string"==typeof S&&(S=T.variants&&T.variants[S]),"function"==typeof S&&(S=S(void 0!==N?N:T.custom,R,O)),S}function tW(T){let S=(0,en.useRef)(null);return null===S.current&&(S.current=T()),S.current}let tK=T=>Array.isArray(T),tQ=T=>!!(T&&"object"==typeof T&&T.mix&&T.toValue),tY=T=>tK(T)?T[T.length-1]||0:T;function tJ(T){let S=e0(T)?T.get():T;return tQ(S)?S.toValue():S}function tX({scrapeMotionValuesFromProps:T,createRenderState:S,onMount:N},R,O,P){let M={latestValues:t0(R,O,P,T),renderState:S()};return N&&(M.mount=T=>N(R,T,M)),M}let tZ=T=>(S,N)=>{let R=(0,en.useContext)(eb),O=(0,en.useContext)(ew),P=()=>tX(T,S,R,O);return N?P():tW(P)};function t0(T,S,N,R){let O={},P=R(T,{});for(let T in P)O[T]=tJ(P[T]);let{initial:M,animate:L}=T,V=eO(T),U=eP(T);S&&U&&!V&&!1!==T.inherit&&(void 0===M&&(M=S.initial),void 0===L&&(L=S.animate));let $=!!N&&!1===N.initial,W=($=$||!1===M)?L:M;return W&&"boolean"!=typeof W&&!eA(W)&&(Array.isArray(W)?W:[W]).forEach(S=>{let N=tG(T,S);if(!N)return;let{transitionEnd:R,transition:P,...M}=N;for(let T in M){let S=M[T];if(Array.isArray(S)){let T=$?S.length-1:0;S=S[T]}null!==S&&(O[T]=S)}for(let T in R)O[T]=R[T]}),O}let t1=T=>T;class t2{constructor(){this.order=[],this.scheduled=new Set}add(T){if(!this.scheduled.has(T))return this.scheduled.add(T),this.order.push(T),!0}remove(T){let S=this.order.indexOf(T);-1!==S&&(this.order.splice(S,1),this.scheduled.delete(T))}clear(){this.order.length=0,this.scheduled.clear()}}function t3(T){let S=new t2,N=new t2,R=0,O=!1,P=!1,M=new WeakSet,L={schedule:(T,P=!1,L=!1)=>{let V=L&&O,U=V?S:N;return P&&M.add(T),U.add(T)&&V&&O&&(R=S.order.length),T},cancel:T=>{N.remove(T),M.delete(T)},process:V=>{if(O){P=!0;return}if(O=!0,[S,N]=[N,S],N.clear(),R=S.order.length)for(let N=0;N<R;N++){let R=S.order[N];R(V),M.has(R)&&(L.schedule(R),T())}O=!1,P&&(P=!1,L.process(V))}};return L}let t4=["prepare","read","update","preRender","render","postRender"],t6=40,{schedule:t5,cancel:t9,state:t8,steps:t7}=function(T,S){let N=!1,R=!0,O={delta:0,timestamp:0,isProcessing:!1},P=t4.reduce((T,S)=>(T[S]=t3(()=>N=!0),T),{}),M=T=>P[T].process(O),L=()=>{let P=performance.now();N=!1,O.delta=R?1e3/60:Math.max(Math.min(P-O.timestamp,t6),1),O.timestamp=P,O.isProcessing=!0,t4.forEach(M),O.isProcessing=!1,N&&S&&(R=!1,T(L))},V=()=>{N=!0,R=!0,O.isProcessing||T(L)};return{schedule:t4.reduce((T,S)=>{let R=P[S];return T[S]=(T,S=!1,O=!1)=>(N||V(),R.schedule(T,S,O)),T},{}),cancel:T=>t4.forEach(S=>P[S].cancel(T)),state:O,steps:P}}("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:t1,!0),rt={useVisualState:tZ({scrapeMotionValuesFromProps:tH,createRenderState:tj,onMount:(T,S,{renderState:N,latestValues:R})=>{t5.read(()=>{try{N.dimensions="function"==typeof S.getBBox?S.getBBox():S.getBoundingClientRect()}catch(T){N.dimensions={x:0,y:0,width:0,height:0}}}),t5.render(()=>{tL(N,R,{enableHardwareAcceleration:!1},tF(S.tagName),T.transformTemplate),tq(S,N)})}})},rr={useVisualState:tZ({scrapeMotionValuesFromProps:t$,createRenderState:tw})};function ri(T,{forwardMotionProps:S=!1},N,R){return{...eK(T)?rt:rr,preloadedFeatures:N,useRender:tV(S),createVisualElement:R,Component:T}}function rn(T,S,N,R={passive:!0}){return T.addEventListener(S,N,R),()=>T.removeEventListener(S,N)}let rs=T=>"mouse"===T.pointerType?"number"!=typeof T.button||T.button<=0:!1!==T.isPrimary;function ra(T,S="page"){return{point:{x:T[S+"X"],y:T[S+"Y"]}}}let ro=T=>S=>rs(S)&&T(S,ra(S));function rl(T,S,N,R){return rn(T,S,ro(N),R)}let ru=(T,S)=>N=>S(T(N)),rc=(...T)=>T.reduce(ru);function rd(T){let S=null;return()=>{let N=()=>{S=null};return null===S&&(S=T,N)}}let rh=rd("dragHorizontal"),rp=rd("dragVertical");function rf(T){let S=!1;if("y"===T)S=rp();else if("x"===T)S=rh();else{let T=rh(),N=rp();T&&N?S=()=>{T(),N()}:(T&&T(),N&&N())}return S}function rm(){let T=rf(!0);return!T||(T(),!1)}class rg{constructor(T){this.isMounted=!1,this.node=T}update(){}}function ry(T,S){let N="pointer"+(S?"enter":"leave"),R="onHover"+(S?"Start":"End"),O=(N,O)=>{if("touch"===N.pointerType||rm())return;let P=T.getProps();T.animationState&&P.whileHover&&T.animationState.setActive("whileHover",S),P[R]&&t5.update(()=>P[R](N,O))};return rl(T.current,N,O,{passive:!T.getProps()[R]})}class rv extends rg{mount(){this.unmount=rc(ry(this.node,!0),ry(this.node,!1))}unmount(){}}class rb extends rg{constructor(){super(...arguments),this.isActive=!1}onFocus(){let T=!1;try{T=this.node.current.matches(":focus-visible")}catch(S){T=!0}T&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=rc(rn(this.node.current,"focus",()=>this.onFocus()),rn(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}let rw=(T,S)=>!!S&&(T===S||rw(T,S.parentElement));function rT(T,S){if(!S)return;let N=new PointerEvent("pointer"+T);S(N,ra(N))}class rS extends rg{constructor(){super(...arguments),this.removeStartListeners=t1,this.removeEndListeners=t1,this.removeAccessibleListeners=t1,this.startPointerPress=(T,S)=>{if(this.isPressing)return;this.removeEndListeners();let N=this.node.getProps(),R=(T,S)=>{if(!this.checkPressEnd())return;let{onTap:N,onTapCancel:R,globalTapTarget:O}=this.node.getProps();t5.update(()=>{O||rw(this.node.current,T.target)?N&&N(T,S):R&&R(T,S)})},O=rl(window,"pointerup",R,{passive:!(N.onTap||N.onPointerUp)}),P=rl(window,"pointercancel",(T,S)=>this.cancelPress(T,S),{passive:!(N.onTapCancel||N.onPointerCancel)});this.removeEndListeners=rc(O,P),this.startPress(T,S)},this.startAccessiblePress=()=>{let T=T=>{if("Enter"!==T.key||this.isPressing)return;let S=T=>{"Enter"===T.key&&this.checkPressEnd()&&rT("up",(T,S)=>{let{onTap:N}=this.node.getProps();N&&t5.update(()=>N(T,S))})};this.removeEndListeners(),this.removeEndListeners=rn(this.node.current,"keyup",S),rT("down",(T,S)=>{this.startPress(T,S)})},S=rn(this.node.current,"keydown",T),N=()=>{this.isPressing&&rT("cancel",(T,S)=>this.cancelPress(T,S))},R=rn(this.node.current,"blur",N);this.removeAccessibleListeners=rc(S,R)}}startPress(T,S){this.isPressing=!0;let{onTapStart:N,whileTap:R}=this.node.getProps();R&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),N&&t5.update(()=>N(T,S))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!rm()}cancelPress(T,S){if(!this.checkPressEnd())return;let{onTapCancel:N}=this.node.getProps();N&&t5.update(()=>N(T,S))}mount(){let T=this.node.getProps(),S=rl(T.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(T.onTapStart||T.onPointerStart)}),N=rn(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=rc(S,N)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}let rx=new WeakMap,rE=new WeakMap,rC=T=>{let S=rx.get(T.target);S&&S(T)},r_=T=>{T.forEach(rC)};function rI({root:T,...S}){let N=T||document;rE.has(N)||rE.set(N,{});let R=rE.get(N),O=JSON.stringify(S);return R[O]||(R[O]=new IntersectionObserver(r_,{root:T,...S})),R[O]}function rk(T,S,N){let R=rI(S);return rx.set(T,N),R.observe(T),()=>{rx.delete(T),R.unobserve(T)}}let rN={some:0,all:1};class rA extends rg{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:T={}}=this.node.getProps(),{root:S,margin:N,amount:R="some",once:O}=T,P={root:S?S.current:void 0,rootMargin:N,threshold:"number"==typeof R?R:rN[R]},M=T=>{let{isIntersecting:S}=T;if(this.isInView===S||(this.isInView=S,O&&!S&&this.hasEnteredView))return;S&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",S);let{onViewportEnter:N,onViewportLeave:R}=this.node.getProps(),P=S?N:R;P&&P(T)};return rk(this.node.current,P,M)}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:T,prevProps:S}=this.node;["amount","margin","root"].some(rR(T,S))&&this.startObserver()}unmount(){}}function rR({viewport:T={}},{viewport:S={}}={}){return N=>T[N]!==S[N]}let rD={inView:{Feature:rA},tap:{Feature:rS},focus:{Feature:rb},hover:{Feature:rv}};function rO(T,S){if(!Array.isArray(S))return!1;let N=S.length;if(N!==T.length)return!1;for(let R=0;R<N;R++)if(S[R]!==T[R])return!1;return!0}function rP(T){let S={};return T.values.forEach((T,N)=>S[N]=T.get()),S}function rM(T){let S={};return T.values.forEach((T,N)=>S[N]=T.getVelocity()),S}function rL(T,S,N){let R=T.getProps();return tG(R,S,void 0!==N?N:R.custom,rP(T),rM(T))}let rj=t1,rF=t1,rB=T=>1e3*T,rV=T=>T/1e3,rU={current:!1},rz=T=>Array.isArray(T)&&"number"==typeof T[0];function rq(T){return!!(!T||"string"==typeof T&&rH[T]||rz(T)||Array.isArray(T)&&T.every(rq))}let r$=([T,S,N,R])=>`cubic-bezier(${T}, ${S}, ${N}, ${R})`,rH={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:r$([0,.65,.55,1]),circOut:r$([.55,0,1,.45]),backIn:r$([.31,.01,.66,-.59]),backOut:r$([.33,1.53,.69,.99])};function rG(T){if(T)return rz(T)?r$(T):Array.isArray(T)?T.map(rG):rH[T]}function rW(T,S,N,{delay:R=0,duration:O,repeat:P=0,repeatType:M="loop",ease:L,times:V}={}){let U={[S]:N};V&&(U.offset=V);let $=rG(L);return Array.isArray($)&&(U.easing=$),T.animate(U,{delay:R,duration:O,easing:Array.isArray($)?"linear":$,fill:"both",iterations:P+1,direction:"reverse"===M?"alternate":"normal"})}function rK(T,{repeat:S,repeatType:N="loop"}){let R=S&&"loop"!==N&&S%2==1?0:T.length-1;return T[R]}let rQ=(T,S,N)=>(((1-3*N+3*S)*T+(3*N-6*S))*T+3*S)*T,rY=1e-7,rJ=12;function rX(T,S,N,R,O){let P,M;let L=0;do(P=rQ(M=S+(N-S)/2,R,O)-T)>0?N=M:S=M;while(Math.abs(P)>rY&&++L<rJ);return M}function rZ(T,S,N,R){if(T===S&&N===R)return t1;let O=S=>rX(S,0,1,T,N);return T=>0===T||1===T?T:rQ(O(T),S,R)}let r0=rZ(.42,0,1,1),r1=rZ(0,0,.58,1),r2=rZ(.42,0,.58,1),r3=T=>Array.isArray(T)&&"number"!=typeof T[0],r4=T=>S=>S<=.5?T(2*S)/2:(2-T(2*(1-S)))/2,r6=T=>S=>1-T(1-S),r5=T=>1-Math.sin(Math.acos(T)),r9=r6(r5),r8=r4(r5),r7=rZ(.33,1.53,.69,.99),ie=r6(r7),ir=r4(ie),ia=T=>(T*=2)<1?.5*ie(T):.5*(2-Math.pow(2,-10*(T-1))),io={linear:t1,easeIn:r0,easeInOut:r2,easeOut:r1,circIn:r5,circInOut:r8,circOut:r9,backIn:ie,backInOut:ir,backOut:r7,anticipate:ia},il=T=>{if(Array.isArray(T)){rF(4===T.length,"Cubic bezier arrays must contain four numerical values.");let[S,N,R,O]=T;return rZ(S,N,R,O)}return"string"==typeof T?(rF(void 0!==io[T],`Invalid easing type '${T}'`),io[T]):T},iu=(T,S)=>N=>!!(tu(N)&&tl.test(N)&&N.startsWith(T)||S&&Object.prototype.hasOwnProperty.call(N,S)),ic=(T,S,N)=>R=>{if(!tu(R))return R;let[O,P,M,L]=R.match(ts);return{[T]:parseFloat(O),[S]:parseFloat(P),[N]:parseFloat(M),alpha:void 0!==L?parseFloat(L):1}},ih=T=>e7(0,255,T),ip={...te,transform:T=>Math.round(ih(T))},im={test:iu("rgb","red"),parse:ic("red","green","blue"),transform:({red:T,green:S,blue:N,alpha:R=1})=>"rgba("+ip.transform(T)+", "+ip.transform(S)+", "+ip.transform(N)+", "+ti(tt.transform(R))+")"};function ig(T){let S="",N="",R="",O="";return T.length>5?(S=T.substring(1,3),N=T.substring(3,5),R=T.substring(5,7),O=T.substring(7,9)):(S=T.substring(1,2),N=T.substring(2,3),R=T.substring(3,4),O=T.substring(4,5),S+=S,N+=N,R+=R,O+=O),{red:parseInt(S,16),green:parseInt(N,16),blue:parseInt(R,16),alpha:O?parseInt(O,16)/255:1}}let iy={test:iu("#"),parse:ig,transform:im.transform},iv={test:iu("hsl","hue"),parse:ic("hue","saturation","lightness"),transform:({hue:T,saturation:S,lightness:N,alpha:R=1})=>"hsla("+Math.round(T)+", "+th.transform(ti(S))+", "+th.transform(ti(N))+", "+ti(tt.transform(R))+")"},ib={test:T=>im.test(T)||iy.test(T)||iv.test(T),parse:T=>im.test(T)?im.parse(T):iv.test(T)?iv.parse(T):iy.parse(T),transform:T=>tu(T)?T:T.hasOwnProperty("red")?im.transform(T):iv.transform(T)},iw=(T,S,N)=>-N*T+N*S+T;function iT(T,S,N){return(N<0&&(N+=1),N>1&&(N-=1),N<1/6)?T+(S-T)*6*N:N<.5?S:N<2/3?T+(S-T)*(2/3-N)*6:T}function iS({hue:T,saturation:S,lightness:N,alpha:R}){T/=360,N/=100;let O=0,P=0,M=0;if(S/=100){let R=N<.5?N*(1+S):N+S-N*S,L=2*N-R;O=iT(L,R,T+1/3),P=iT(L,R,T),M=iT(L,R,T-1/3)}else O=P=M=N;return{red:Math.round(255*O),green:Math.round(255*P),blue:Math.round(255*M),alpha:R}}let ix=(T,S,N)=>{let R=T*T;return Math.sqrt(Math.max(0,N*(S*S-R)+R))},iE=[iy,im,iv],iC=T=>iE.find(S=>S.test(T));function i_(T){let S=iC(T);rF(!!S,`'${T}' is not an animatable color. Use the equivalent color code instead.`);let N=S.parse(T);return S===iv&&(N=iS(N)),N}let iI=(T,S)=>{let N=i_(T),R=i_(S),O={...N};return T=>(O.red=ix(N.red,R.red,T),O.green=ix(N.green,R.green,T),O.blue=ix(N.blue,R.blue,T),O.alpha=iw(N.alpha,R.alpha,T),im.transform(O))};function ik(T){var S,N;return isNaN(T)&&tu(T)&&((null===(S=T.match(ts))||void 0===S?void 0:S.length)||0)+((null===(N=T.match(ta))||void 0===N?void 0:N.length)||0)>0}let iN={regex:e9,countKey:"Vars",token:"${v}",parse:t1},iA={regex:ta,countKey:"Colors",token:"${c}",parse:ib.parse},iR={regex:ts,countKey:"Numbers",token:"${n}",parse:te.parse};function iD(T,{regex:S,countKey:N,token:R,parse:O}){let P=T.tokenised.match(S);P&&(T["num"+N]=P.length,T.tokenised=T.tokenised.replace(S,R),T.values.push(...P.map(O)))}function iO(T){let S=T.toString(),N={value:S,tokenised:S,values:[],numVars:0,numColors:0,numNumbers:0};return N.value.includes("var(--")&&iD(N,iN),iD(N,iA),iD(N,iR),N}function iP(T){return iO(T).values}function iM(T){let{values:S,numColors:N,numVars:R,tokenised:O}=iO(T),P=S.length;return T=>{let S=O;for(let O=0;O<P;O++)S=O<R?S.replace(iN.token,T[O]):O<R+N?S.replace(iA.token,ib.transform(T[O])):S.replace(iR.token,ti(T[O]));return S}}let iL=T=>"number"==typeof T?0:T;function ij(T){let S=iP(T);return iM(T)(S.map(iL))}let iF={test:ik,parse:iP,createTransformer:iM,getAnimatableNone:ij},iB=(T,S)=>N=>`${N>0?S:T}`;function iV(T,S){return"number"==typeof T?N=>iw(T,S,N):ib.test(T)?iI(T,S):T.startsWith("var(")?iB(T,S):iq(T,S)}let iU=(T,S)=>{let N=[...T],R=N.length,O=T.map((T,N)=>iV(T,S[N]));return T=>{for(let S=0;S<R;S++)N[S]=O[S](T);return N}},iz=(T,S)=>{let N={...T,...S},R={};for(let O in N)void 0!==T[O]&&void 0!==S[O]&&(R[O]=iV(T[O],S[O]));return T=>{for(let S in R)N[S]=R[S](T);return N}},iq=(T,S)=>{let N=iF.createTransformer(S),R=iO(T),O=iO(S);return R.numVars===O.numVars&&R.numColors===O.numColors&&R.numNumbers>=O.numNumbers?rc(iU(R.values,O.values),N):(rj(!0,`Complex values '${T}' and '${S}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),iB(T,S))},i$=(T,S,N)=>{let R=S-T;return 0===R?1:(N-T)/R},iH=(T,S)=>N=>iw(T,S,N);function iG(T){if("number"==typeof T);else if("string"==typeof T)return ib.test(T)?iI:iq;else if(Array.isArray(T))return iU;else if("object"==typeof T)return iz;return iH}function iW(T,S,N){let R=[],O=N||iG(T[0]),P=T.length-1;for(let N=0;N<P;N++){let P=O(T[N],T[N+1]);S&&(P=rc(Array.isArray(S)?S[N]||t1:S,P)),R.push(P)}return R}function iK(T,S,{clamp:N=!0,ease:R,mixer:O}={}){let P=T.length;if(rF(P===S.length,"Both input and output ranges must be the same length"),1===P)return()=>S[0];T[0]>T[P-1]&&(T=[...T].reverse(),S=[...S].reverse());let M=iW(S,R,O),L=M.length,V=S=>{let N=0;if(L>1)for(;N<T.length-2&&!(S<T[N+1]);N++);let R=i$(T[N],T[N+1],S);return M[N](R)};return N?S=>V(e7(T[0],T[P-1],S)):V}function iQ(T,S){let N=T[T.length-1];for(let R=1;R<=S;R++){let O=i$(0,S,R);T.push(iw(N,1,O))}}function iY(T){let S=[0];return iQ(S,T.length-1),S}function iJ(T,S){return T.map(T=>T*S)}function iX(T,S){return T.map(()=>S||r2).splice(0,T.length-1)}function iZ({duration:T=300,keyframes:S,times:N,ease:R="easeInOut"}){let O=r3(R)?R.map(il):il(R),P={done:!1,value:S[0]},M=iK(iJ(N&&N.length===S.length?N:iY(S),T),S,{ease:Array.isArray(O)?O:iX(S,O)});return{calculatedDuration:T,next:S=>(P.value=M(S),P.done=S>=T,P)}}function i0(T,S){return S?1e3/S*T:0}let i1=5;function i2(T,S,N){let R=Math.max(S-i1,0);return i0(N-T(R),S-R)}let i3=.001,i4=.01,i6=10,i5=.05,i9=1;function i8({duration:T=800,bounce:S=.25,velocity:N=0,mass:R=1}){let O,P;rj(T<=rB(i6),"Spring duration must be 10 seconds or less");let M=1-S;M=e7(i5,i9,M),T=e7(i4,i6,rV(T)),M<1?(O=S=>{let R=S*M,O=R*T;return i3-(R-N)/nt(S,M)*Math.exp(-O)},P=S=>{let R=S*M*T,P=R*N+N,L=Math.pow(M,2)*Math.pow(S,2)*T,V=Math.exp(-R),U=nt(Math.pow(S,2),M);return(P-L)*V*(-O(S)+i3>0?-1:1)/U}):(O=S=>-i3+Math.exp(-S*T)*((S-N)*T+1),P=S=>T*T*(N-S)*Math.exp(-S*T));let L=ne(O,P,5/T);if(T=rB(T),isNaN(L))return{stiffness:100,damping:10,duration:T};{let S=Math.pow(L,2)*R;return{stiffness:S,damping:2*M*Math.sqrt(R*S),duration:T}}}let i7=12;function ne(T,S,N){let R=N;for(let N=1;N<i7;N++)R-=T(R)/S(R);return R}function nt(T,S){return T*Math.sqrt(1-S*S)}let ni=["duration","bounce"],nn=["stiffness","damping","mass"];function na(T,S){return S.some(S=>void 0!==T[S])}function no(T){let S={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...T};if(!na(T,nn)&&na(T,ni)){let N=i8(T);(S={...S,...N,mass:1}).isResolvedFromDuration=!0}return S}function nu({keyframes:T,restDelta:S,restSpeed:N,...R}){let O;let P=T[0],M=T[T.length-1],L={done:!1,value:P},{stiffness:V,damping:U,mass:$,duration:W,velocity:K,isResolvedFromDuration:Q}=no({...R,velocity:-rV(R.velocity||0)}),Y=K||0,Z=U/(2*Math.sqrt(V*$)),ee=M-P,et=rV(Math.sqrt(V/$)),er=5>Math.abs(ee);if(N||(N=er?.01:2),S||(S=er?.005:.5),Z<1){let T=nt(et,Z);O=S=>M-Math.exp(-Z*et*S)*((Y+Z*et*ee)/T*Math.sin(T*S)+ee*Math.cos(T*S))}else if(1===Z)O=T=>M-Math.exp(-et*T)*(ee+(Y+et*ee)*T);else{let T=et*Math.sqrt(Z*Z-1);O=S=>{let N=Math.exp(-Z*et*S),R=Math.min(T*S,300);return M-N*((Y+Z*et*ee)*Math.sinh(R)+T*ee*Math.cosh(R))/T}}return{calculatedDuration:Q&&W||null,next:T=>{let R=O(T);if(Q)L.done=T>=W;else{let P=Y;0!==T&&(P=Z<1?i2(O,T,R):0);let V=Math.abs(P)<=N,U=Math.abs(M-R)<=S;L.done=V&&U}return L.value=L.done?M:R,L}}}function nc({keyframes:T,velocity:S=0,power:N=.8,timeConstant:R=325,bounceDamping:O=10,bounceStiffness:P=500,modifyTarget:M,min:L,max:V,restDelta:U=.5,restSpeed:$}){let W,K;let Q=T[0],Y={done:!1,value:Q},Z=T=>void 0!==L&&T<L||void 0!==V&&T>V,ee=T=>void 0===L?V:void 0===V?L:Math.abs(L-T)<Math.abs(V-T)?L:V,et=N*S,er=Q+et,ei=void 0===M?er:M(er);ei!==er&&(et=ei-Q);let en=T=>-et*Math.exp(-T/R),es=T=>ei+en(T),ea=T=>{let S=en(T),N=es(T);Y.done=Math.abs(S)<=U,Y.value=Y.done?ei:N},eo=T=>{Z(Y.value)&&(W=T,K=nu({keyframes:[Y.value,ee(Y.value)],velocity:i2(es,T,Y.value),damping:O,stiffness:P,restDelta:U,restSpeed:$}))};return eo(0),{calculatedDuration:null,next:T=>{let S=!1;return(K||void 0!==W||(S=!0,ea(T),eo(T)),void 0!==W&&T>W)?K.next(T-W):(S||ea(T),Y)}}}let nd=T=>{let S=({timestamp:S})=>T(S);return{start:()=>t5.update(S,!0),stop:()=>t9(S),now:()=>t8.isProcessing?t8.timestamp:performance.now()}},nh=2e4;function np(T){let S=0,N=50,R=T.next(S);for(;!R.done&&S<nh;)S+=N,R=T.next(S);return S>=nh?1/0:S}let nf={decay:nc,inertia:nc,tween:iZ,keyframes:iZ,spring:nu};function nm({autoplay:T=!0,delay:S=0,driver:N=nd,keyframes:R,type:O="keyframes",repeat:P=0,repeatDelay:M=0,repeatType:L="loop",onPlay:V,onStop:U,onComplete:$,onUpdate:W,...K}){let Q,Y,Z,ee,et,er=1,ei=!1,en=()=>{Y=new Promise(T=>{Q=T})};en();let es=nf[O]||iZ;es!==iZ&&"number"!=typeof R[0]&&(ee=iK([0,100],R,{clamp:!1}),R=[0,100]);let ea=es({...K,keyframes:R});"mirror"===L&&(et=es({...K,keyframes:[...R].reverse(),velocity:-(K.velocity||0)}));let eo="idle",eu=null,ec=null,ed=null;null===ea.calculatedDuration&&P&&(ea.calculatedDuration=np(ea));let{calculatedDuration:eh}=ea,ep=1/0,ef=1/0;null!==eh&&(ef=(ep=eh+M)*(P+1)-M);let em=0,eg=T=>{if(null===ec)return;er>0&&(ec=Math.min(ec,T)),er<0&&(ec=Math.min(T-ef/er,ec));let N=(em=null!==eu?eu:Math.round(T-ec)*er)-S*(er>=0?1:-1),O=er>=0?N<0:N>ef;em=Math.max(N,0),"finished"===eo&&null===eu&&(em=ef);let V=em,U=ea;if(P){let T=Math.min(em,ef)/ep,S=Math.floor(T),N=T%1;!N&&T>=1&&(N=1),1===N&&S--,(S=Math.min(S,P+1))%2&&("reverse"===L?(N=1-N,M&&(N-=M/ep)):"mirror"===L&&(U=et)),V=e7(0,1,N)*ep}let $=O?{done:!1,value:R[0]}:U.next(V);ee&&($.value=ee($.value));let{done:K}=$;O||null===eh||(K=er>=0?em>=ef:em<=0);let Q=null===eu&&("finished"===eo||"running"===eo&&K);return W&&W($.value),Q&&eb(),$},ey=()=>{Z&&Z.stop(),Z=void 0},ev=()=>{eo="idle",ey(),Q(),en(),ec=ed=null},eb=()=>{eo="finished",$&&$(),ey(),Q()},ew=()=>{if(ei)return;Z||(Z=N(eg));let T=Z.now();V&&V(),null!==eu?ec=T-eu:ec&&"finished"!==eo||(ec=T),"finished"===eo&&en(),ed=ec,eu=null,eo="running",Z.start()};T&&ew();let eT={then:(T,S)=>Y.then(T,S),get time(){return rV(em)},set time(newTime){em=newTime=rB(newTime),null===eu&&Z&&0!==er?ec=Z.now()-newTime/er:eu=newTime},get duration(){return rV(null===ea.calculatedDuration?np(ea):ea.calculatedDuration)},get speed(){return er},set speed(newSpeed){if(newSpeed===er||!Z)return;er=newSpeed,eT.time=rV(em)},get state(){return eo},play:ew,pause:()=>{eo="paused",eu=em},stop:()=>{ei=!0,"idle"!==eo&&(eo="idle",U&&U(),ev())},cancel:()=>{null!==ed&&eg(ed),ev()},complete:()=>{eo="finished"},sample:T=>(ec=0,eg(T))};return eT}let ng=function(T){let S;return()=>(void 0===S&&(S=T()),S)}(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),ny=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),nv=10,nb=2e4,nw=(T,S)=>"spring"===S.type||"backgroundColor"===T||!rq(S.ease);function nT(T,S,{onUpdate:N,onComplete:R,...O}){let P,M;if(!(ng()&&ny.has(S)&&!O.repeatDelay&&"mirror"!==O.repeatType&&0!==O.damping&&"inertia"!==O.type))return!1;let L=!1,V=!1,U=()=>{M=new Promise(T=>{P=T})};U();let{keyframes:$,duration:W=300,ease:K,times:Q}=O;if(nw(S,O)){let T=nm({...O,repeat:0,delay:0}),S={done:!1,value:$[0]},N=[],R=0;for(;!S.done&&R<nb;)S=T.sample(R),N.push(S.value),R+=nv;Q=void 0,$=N,W=R-nv,K="linear"}let Y=rW(T.owner.current,S,$,{...O,duration:W,ease:K,times:Q}),Z=()=>{V=!1,Y.cancel()},ee=()=>{V=!0,t5.update(Z),P(),U()};return Y.onfinish=()=>{V||(T.set(rK($,O)),R&&R(),ee())},{then:(T,S)=>M.then(T,S),attachTimeline:T=>(Y.timeline=T,Y.onfinish=null,t1),get time(){return rV(Y.currentTime||0)},set time(newTime){Y.currentTime=rB(newTime)},get speed(){return Y.playbackRate},set speed(newSpeed){Y.playbackRate=newSpeed},get duration(){return rV(W)},play:()=>{L||(Y.play(),t9(Z))},pause:()=>Y.pause(),stop:()=>{if(L=!0,"idle"===Y.playState)return;let{currentTime:S}=Y;if(S){let N=nm({...O,autoplay:!1});T.setWithVelocity(N.sample(S-nv).value,N.sample(S).value,nv)}ee()},complete:()=>{V||Y.finish()},cancel:ee}}function nS({keyframes:T,delay:S,onUpdate:N,onComplete:R}){let O=()=>(N&&N(T[T.length-1]),R&&R(),{time:0,speed:1,duration:0,play:t1,pause:t1,stop:t1,then:T=>(T(),Promise.resolve()),cancel:t1,complete:t1});return S?nm({keyframes:[0,1],duration:0,delay:S,onComplete:O}):O()}let nx={type:"spring",stiffness:500,damping:25,restSpeed:10},nE=T=>({type:"spring",stiffness:550,damping:0===T?2*Math.sqrt(550):30,restSpeed:10}),nC={type:"keyframes",duration:.8},n_={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},nI=(T,{keyframes:S})=>S.length>2?nC:eX.has(T)?T.startsWith("scale")?nE(S[1]):nx:n_,nk=(T,S)=>"zIndex"!==T&&!!("number"==typeof S||Array.isArray(S)||"string"==typeof S&&(iF.test(S)||"0"===S)&&!S.startsWith("url(")),nN=new Set(["brightness","contrast","saturate","opacity"]);function nA(T){let[S,N]=T.slice(0,-1).split("(");if("drop-shadow"===S)return T;let[R]=N.match(ts)||[];if(!R)return T;let O=N.replace(R,""),P=nN.has(S)?1:0;return R!==N&&(P*=100),S+"("+P+O+")"}let nR=/([a-z-]*)\(.*?\)/g,nD={...iF,getAnimatableNone:T=>{let S=T.match(nR);return S?S.map(nA).join(" "):T}},nO={...tv,color:ib,backgroundColor:ib,outlineColor:ib,fill:ib,stroke:ib,borderColor:ib,borderTopColor:ib,borderRightColor:ib,borderBottomColor:ib,borderLeftColor:ib,filter:nD,WebkitFilter:nD},nP=T=>nO[T];function nM(T,S){let N=nP(T);return N!==nD&&(N=iF),N.getAnimatableNone?N.getAnimatableNone(S):void 0}let nL=T=>/^0[^.\s]+$/.test(T);function nj(T){return"number"==typeof T?0===T:null!==T?"none"===T||"0"===T||nL(T):void 0}function nF(T,S,N,R){let O,P;let M=nk(S,N);O=Array.isArray(N)?[...N]:[null,N];let L=void 0!==R.from?R.from:T.get(),V=[];for(let T=0;T<O.length;T++)null===O[T]&&(O[T]=0===T?L:O[T-1]),nj(O[T])&&V.push(T),"string"==typeof O[T]&&"none"!==O[T]&&"0"!==O[T]&&(P=O[T]);if(M&&V.length&&P)for(let T=0;T<V.length;T++)O[V[T]]=nM(S,P);return O}function nB({when:T,delay:S,delayChildren:N,staggerChildren:R,staggerDirection:O,repeat:P,repeatType:M,repeatDelay:L,from:V,elapsed:U,...$}){return!!Object.keys($).length}function nV(T,S){return T[S]||T.default||T}let nU={skipAnimations:!1},nz=(T,S,N,R={})=>O=>{let P=nV(R,T)||{},M=P.delay||R.delay||0,{elapsed:L=0}=R;L-=rB(M);let V=nF(S,T,N,P),U=V[0],$=V[V.length-1],W=nk(T,U),K=nk(T,$);rj(W===K,`You are trying to animate ${T} from "${U}" to "${$}". ${U} is not an animatable value - to enable this animation set ${U} to a value animatable to ${$} via the \`style\` property.`);let Q={keyframes:V,velocity:S.getVelocity(),ease:"easeOut",...P,delay:-L,onUpdate:T=>{S.set(T),P.onUpdate&&P.onUpdate(T)},onComplete:()=>{O(),P.onComplete&&P.onComplete()}};if(nB(P)||(Q={...Q,...nI(T,Q)}),Q.duration&&(Q.duration=rB(Q.duration)),Q.repeatDelay&&(Q.repeatDelay=rB(Q.repeatDelay)),!W||!K||rU.current||!1===P.type||nU.skipAnimations)return nS(rU.current?{...Q,delay:0}:Q);if(!R.isHandoff&&S.owner&&S.owner.current instanceof HTMLElement&&!S.owner.getProps().onUpdate){let N=nT(S,T,Q);if(N)return N}return nm(Q)};function nq(T){return!!(e0(T)&&T.add)}let n$=T=>/^\-?\d*\.?\d+$/.test(T);function nH(T,S){-1===T.indexOf(S)&&T.push(S)}function nG(T,S){let N=T.indexOf(S);N>-1&&T.splice(N,1)}class nW{constructor(){this.subscriptions=[]}add(T){return nH(this.subscriptions,T),()=>nG(this.subscriptions,T)}notify(T,S,N){let R=this.subscriptions.length;if(R){if(1===R)this.subscriptions[0](T,S,N);else for(let O=0;O<R;O++){let R=this.subscriptions[O];R&&R(T,S,N)}}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}let nK=T=>!isNaN(parseFloat(T)),nQ={current:void 0};class nY{constructor(T,S={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(T,S=!0)=>{this.prev=this.current,this.current=T;let{delta:N,timestamp:R}=t8;this.lastUpdated!==R&&(this.timeDelta=N,this.lastUpdated=R,t5.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),S&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>t5.postRender(this.velocityCheck),this.velocityCheck=({timestamp:T})=>{T!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=T,this.canTrackVelocity=nK(this.current),this.owner=S.owner}onChange(T){return this.on("change",T)}on(T,S){this.events[T]||(this.events[T]=new nW);let N=this.events[T].add(S);return"change"===T?()=>{N(),t5.read(()=>{this.events.change.getSize()||this.stop()})}:N}clearListeners(){for(let T in this.events)this.events[T].clear()}attach(T,S){this.passiveEffect=T,this.stopPassiveEffect=S}set(T,S=!0){S&&this.passiveEffect?this.passiveEffect(T,this.updateAndNotify):this.updateAndNotify(T,S)}setWithVelocity(T,S,N){this.set(S),this.prev=T,this.timeDelta=N}jump(T){this.updateAndNotify(T),this.prev=T,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return nQ.current&&nQ.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?i0(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(T){return this.stop(),new Promise(S=>{this.hasAnimated=!0,this.animation=T(S),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function nJ(T,S){return new nY(T,S)}let nX=T=>S=>S.test(T),nZ=[te,tp,th,td,tm,tf,{test:T=>"auto"===T,parse:T=>T}],n0=T=>nZ.find(nX(T)),n3=[...nZ,ib,iF],n4=T=>n3.find(nX(T));function n6(T,S,N){T.hasValue(S)?T.getValue(S).set(N):T.addValue(S,nJ(N))}function n5(T,S){let N=rL(T,S),{transitionEnd:R={},transition:O={},...P}=N?T.makeTargetAnimatable(N,!1):{};for(let S in P={...P,...R}){let N=tY(P[S]);n6(T,S,N)}}function n9(T,S,N){var R,O;let P=Object.keys(S).filter(S=>!T.hasValue(S)),M=P.length;if(M)for(let L=0;L<M;L++){let M=P[L],V=S[M],U=null;Array.isArray(V)&&(U=V[0]),null===U&&(U=null!==(O=null!==(R=N[M])&&void 0!==R?R:T.readValue(M))&&void 0!==O?O:S[M]),null!=U&&("string"==typeof U&&(n$(U)||nL(U))?U=parseFloat(U):!n4(U)&&iF.test(V)&&(U=nM(M,V)),T.addValue(M,nJ(U,{owner:T})),void 0===N[M]&&(N[M]=U),null!==U&&T.setBaseTarget(M,U))}}function n8(T,S){if(S)return(S[T]||S.default||S).from}function n7(T,S,N){let R={};for(let O in T){let T=n8(O,S);if(void 0!==T)R[O]=T;else{let T=N.getValue(O);T&&(R[O]=T.get())}}return R}function se({protectedKeys:T,needsAnimating:S},N){let R=T.hasOwnProperty(N)&&!0!==S[N];return S[N]=!1,R}function st(T,S){let N=T.get();if(!Array.isArray(S))return N!==S;for(let T=0;T<S.length;T++)if(S[T]!==N)return!0}function sr(T,S,{delay:N=0,transitionOverride:R,type:O}={}){let{transition:P=T.getDefaultTransition(),transitionEnd:M,...L}=T.makeTargetAnimatable(S),V=T.getValue("willChange");R&&(P=R);let U=[],$=O&&T.animationState&&T.animationState.getState()[O];for(let S in L){let R=T.getValue(S),O=L[S];if(!R||void 0===O||$&&se($,S))continue;let M={delay:N,elapsed:0,...nV(P||{},S)};if(window.HandoffAppearAnimations){let N=T.getProps()[eC];if(N){let T=window.HandoffAppearAnimations(N,S,R,t5);null!==T&&(M.elapsed=T,M.isHandoff=!0)}}let W=!M.isHandoff&&!st(R,O);if("spring"===M.type&&(R.getVelocity()||M.velocity)&&(W=!1),R.animation&&(W=!1),W)continue;R.start(nz(S,R,O,T.shouldReduceMotion&&eX.has(S)?{type:!1}:M));let K=R.animation;nq(V)&&(V.add(S),K.then(()=>V.remove(S))),U.push(K)}return M&&Promise.all(U).then(()=>{M&&n5(T,M)}),U}function si(T,S,N={}){let R=rL(T,S,N.custom),{transition:O=T.getDefaultTransition()||{}}=R||{};N.transitionOverride&&(O=N.transitionOverride);let P=R?()=>Promise.all(sr(T,R,N)):()=>Promise.resolve(),M=T.variantChildren&&T.variantChildren.size?(R=0)=>{let{delayChildren:P=0,staggerChildren:M,staggerDirection:L}=O;return sn(T,S,P+R,M,L,N)}:()=>Promise.resolve(),{when:L}=O;if(!L)return Promise.all([P(),M(N.delay)]);{let[T,S]="beforeChildren"===L?[P,M]:[M,P];return T().then(()=>S())}}function sn(T,S,N=0,R=0,O=1,P){let M=[],L=(T.variantChildren.size-1)*R,V=1===O?(T=0)=>T*R:(T=0)=>L-T*R;return Array.from(T.variantChildren).sort(ss).forEach((T,R)=>{T.notify("AnimationStart",S),M.push(si(T,S,{...P,delay:N+V(R)}).then(()=>T.notify("AnimationComplete",S)))}),Promise.all(M)}function ss(T,S){return T.sortNodePosition(S)}function sa(T,S,N={}){let R;if(T.notify("AnimationStart",S),Array.isArray(S))R=Promise.all(S.map(S=>si(T,S,N)));else if("string"==typeof S)R=si(T,S,N);else{let O="function"==typeof S?rL(T,S,N.custom):S;R=Promise.all(sr(T,O,N))}return R.then(()=>T.notify("AnimationComplete",S))}let so=[...eR].reverse(),sl=eR.length;function su(T){return S=>Promise.all(S.map(({animation:S,options:N})=>sa(T,S,N)))}function sc(T){let S=su(T),N=sp(),R=!0,O=(S,N)=>{let R=rL(T,N);if(R){let{transition:T,transitionEnd:N,...O}=R;S={...S,...O,...N}}return S};function P(P,M){let L=T.getProps(),V=T.getVariantContext(!0)||{},U=[],$=new Set,W={},K=1/0;for(let S=0;S<sl;S++){let Q=so[S],Y=N[Q],Z=void 0!==L[Q]?L[Q]:V[Q],ee=eN(Z),et=Q===M?Y.isActive:null;!1===et&&(K=S);let er=Z===V[Q]&&Z!==L[Q]&&ee;if(er&&R&&T.manuallyAnimateOnMount&&(er=!1),Y.protectedKeys={...W},!Y.isActive&&null===et||!Z&&!Y.prevProp||eA(Z)||"boolean"==typeof Z)continue;let ei=sd(Y.prevProp,Z)||Q===M&&Y.isActive&&!er&&ee||S>K&&ee,en=!1,es=Array.isArray(Z)?Z:[Z],ea=es.reduce(O,{});!1===et&&(ea={});let{prevResolvedValues:eo={}}=Y,eu={...eo,...ea},ec=T=>{ei=!0,$.has(T)&&(en=!0,$.delete(T)),Y.needsAnimating[T]=!0};for(let T in eu){let S=ea[T],N=eo[T];if(W.hasOwnProperty(T))continue;let R=!1;(R=tK(S)&&tK(N)?!rO(S,N):S!==N)?void 0!==S?ec(T):$.add(T):void 0!==S&&$.has(T)?ec(T):Y.protectedKeys[T]=!0}Y.prevProp=Z,Y.prevResolvedValues=ea,Y.isActive&&(W={...W,...ea}),R&&T.blockInitialAnimation&&(ei=!1),ei&&(!er||en)&&U.push(...es.map(T=>({animation:T,options:{type:Q,...P}})))}if($.size){let S={};$.forEach(N=>{let R=T.getBaseTarget(N);void 0!==R&&(S[N]=R)}),U.push({animation:S})}let Q=!!U.length;return R&&(!1===L.initial||L.initial===L.animate)&&!T.manuallyAnimateOnMount&&(Q=!1),R=!1,Q?S(U):Promise.resolve()}function M(S,R,O){var M;if(N[S].isActive===R)return Promise.resolve();null===(M=T.variantChildren)||void 0===M||M.forEach(T=>{var N;return null===(N=T.animationState)||void 0===N?void 0:N.setActive(S,R)}),N[S].isActive=R;let L=P(O,S);for(let T in N)N[T].protectedKeys={};return L}return{animateChanges:P,setActive:M,setAnimateFunction:function(N){S=N(T)},getState:()=>N}}function sd(T,S){return"string"==typeof S?S!==T:!!Array.isArray(S)&&!rO(S,T)}function sh(T=!1){return{isActive:T,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function sp(){return{animate:sh(!0),whileInView:sh(),whileHover:sh(),whileTap:sh(),whileDrag:sh(),whileFocus:sh(),exit:sh()}}class sf extends rg{constructor(T){super(T),T.animationState||(T.animationState=sc(T))}updateAnimationControlsSubscription(){let{animate:T}=this.node.getProps();this.unmount(),eA(T)&&(this.unmount=T.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:T}=this.node.getProps(),{animate:S}=this.node.prevProps||{};T!==S&&this.updateAnimationControlsSubscription()}unmount(){}}let sm=0;class sg extends rg{constructor(){super(...arguments),this.id=sm++}update(){if(!this.node.presenceContext)return;let{isPresent:T,onExitComplete:S,custom:N}=this.node.presenceContext,{isPresent:R}=this.node.prevPresenceContext||{};if(!this.node.animationState||T===R)return;let O=this.node.animationState.setActive("exit",!T,{custom:null!=N?N:this.node.getProps().custom});S&&!T&&O.then(()=>S(this.id))}mount(){let{register:T}=this.node.presenceContext||{};T&&(this.unmount=T(this.id))}unmount(){}}let sy={animation:{Feature:sf},exit:{Feature:sg}},sv=(T,S)=>Math.abs(T-S);function sb(T,S){return Math.sqrt(sv(T.x,S.x)**2+sv(T.y,S.y)**2)}class sw{constructor(T,S,{transformPagePoint:N,contextWindow:R,dragSnapToOrigin:O=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let T=sx(this.lastMoveEventInfo,this.history),S=null!==this.startEvent,N=sb(T.offset,{x:0,y:0})>=3;if(!S&&!N)return;let{point:R}=T,{timestamp:O}=t8;this.history.push({...R,timestamp:O});let{onStart:P,onMove:M}=this.handlers;S||(P&&P(this.lastMoveEvent,T),this.startEvent=this.lastMoveEvent),M&&M(this.lastMoveEvent,T)},this.handlePointerMove=(T,S)=>{this.lastMoveEvent=T,this.lastMoveEventInfo=sT(S,this.transformPagePoint),t5.update(this.updatePoint,!0)},this.handlePointerUp=(T,S)=>{this.end();let{onEnd:N,onSessionEnd:R,resumeAnimation:O}=this.handlers;if(this.dragSnapToOrigin&&O&&O(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let P=sx("pointercancel"===T.type?this.lastMoveEventInfo:sT(S,this.transformPagePoint),this.history);this.startEvent&&N&&N(T,P),R&&R(T,P)},!rs(T))return;this.dragSnapToOrigin=O,this.handlers=S,this.transformPagePoint=N,this.contextWindow=R||window;let P=sT(ra(T),this.transformPagePoint),{point:M}=P,{timestamp:L}=t8;this.history=[{...M,timestamp:L}];let{onSessionStart:V}=S;V&&V(T,sx(P,this.history)),this.removeListeners=rc(rl(this.contextWindow,"pointermove",this.handlePointerMove),rl(this.contextWindow,"pointerup",this.handlePointerUp),rl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(T){this.handlers=T}end(){this.removeListeners&&this.removeListeners(),t9(this.updatePoint)}}function sT(T,S){return S?{point:S(T.point)}:T}function sS(T,S){return{x:T.x-S.x,y:T.y-S.y}}function sx({point:T},S){return{point:T,delta:sS(T,sC(S)),offset:sS(T,sE(S)),velocity:s_(S,.1)}}function sE(T){return T[0]}function sC(T){return T[T.length-1]}function s_(T,S){if(T.length<2)return{x:0,y:0};let N=T.length-1,R=null,O=sC(T);for(;N>=0&&(R=T[N],!(O.timestamp-R.timestamp>rB(S)));)N--;if(!R)return{x:0,y:0};let P=rV(O.timestamp-R.timestamp);if(0===P)return{x:0,y:0};let M={x:(O.x-R.x)/P,y:(O.y-R.y)/P};return M.x===1/0&&(M.x=0),M.y===1/0&&(M.y=0),M}function sI(T){return T.max-T.min}function sk(T,S=0,N=.01){return Math.abs(T-S)<=N}function sN(T,S,N,R=.5){T.origin=R,T.originPoint=iw(S.min,S.max,T.origin),T.scale=sI(N)/sI(S),(sk(T.scale,1,1e-4)||isNaN(T.scale))&&(T.scale=1),T.translate=iw(N.min,N.max,T.origin)-T.originPoint,(sk(T.translate)||isNaN(T.translate))&&(T.translate=0)}function sA(T,S,N,R){sN(T.x,S.x,N.x,R?R.originX:void 0),sN(T.y,S.y,N.y,R?R.originY:void 0)}function sR(T,S,N){T.min=N.min+S.min,T.max=T.min+sI(S)}function sD(T,S,N){sR(T.x,S.x,N.x),sR(T.y,S.y,N.y)}function sO(T,S,N){T.min=S.min-N.min,T.max=T.min+sI(S)}function sP(T,S,N){sO(T.x,S.x,N.x),sO(T.y,S.y,N.y)}function sM(T,{min:S,max:N},R){return void 0!==S&&T<S?T=R?iw(S,T,R.min):Math.max(T,S):void 0!==N&&T>N&&(T=R?iw(N,T,R.max):Math.min(T,N)),T}function sL(T,S,N){return{min:void 0!==S?T.min+S:void 0,max:void 0!==N?T.max+N-(T.max-T.min):void 0}}function sj(T,{top:S,left:N,bottom:R,right:O}){return{x:sL(T.x,N,O),y:sL(T.y,S,R)}}function sF(T,S){let N=S.min-T.min,R=S.max-T.max;return S.max-S.min<T.max-T.min&&([N,R]=[R,N]),{min:N,max:R}}function sB(T,S){return{x:sF(T.x,S.x),y:sF(T.y,S.y)}}function sV(T,S){let N=.5,R=sI(T),O=sI(S);return O>R?N=i$(S.min,S.max-R,T.min):R>O&&(N=i$(T.min,T.max-O,S.min)),e7(0,1,N)}function sU(T,S){let N={};return void 0!==S.min&&(N.min=S.min-T.min),void 0!==S.max&&(N.max=S.max-T.min),N}let sz=.35;function sq(T=sz){return!1===T?T=0:!0===T&&(T=sz),{x:s$(T,"left","right"),y:s$(T,"top","bottom")}}function s$(T,S,N){return{min:sH(T,S),max:sH(T,N)}}function sH(T,S){return"number"==typeof T?T:T[S]||0}let sG=()=>({translate:0,scale:1,origin:0,originPoint:0}),sW=()=>({x:sG(),y:sG()}),sK=()=>({min:0,max:0}),sQ=()=>({x:sK(),y:sK()});function sY(T){return[T("x"),T("y")]}function sJ({top:T,left:S,right:N,bottom:R}){return{x:{min:S,max:N},y:{min:T,max:R}}}function sX({x:T,y:S}){return{top:S.min,right:T.max,bottom:S.max,left:T.min}}function sZ(T,S){if(!S)return T;let N=S({x:T.left,y:T.top}),R=S({x:T.right,y:T.bottom});return{top:N.y,left:N.x,bottom:R.y,right:R.x}}function s0(T){return void 0===T||1===T}function s1({scale:T,scaleX:S,scaleY:N}){return!s0(T)||!s0(S)||!s0(N)}function s2(T){return s1(T)||s3(T)||T.z||T.rotate||T.rotateX||T.rotateY}function s3(T){return s4(T.x)||s4(T.y)}function s4(T){return T&&"0%"!==T}function s6(T,S,N){let R=S*(T-N);return N+R}function s5(T,S,N,R,O){return void 0!==O&&(T=s6(T,O,R)),s6(T,N,R)+S}function s9(T,S=0,N=1,R,O){T.min=s5(T.min,S,N,R,O),T.max=s5(T.max,S,N,R,O)}function s8(T,{x:S,y:N}){s9(T.x,S.translate,S.scale,S.originPoint),s9(T.y,N.translate,N.scale,N.originPoint)}function s7(T,S,N,R=!1){let O,P;let M=N.length;if(M){S.x=S.y=1;for(let L=0;L<M;L++){P=(O=N[L]).projectionDelta;let M=O.instance;(!M||!M.style||"contents"!==M.style.display)&&(R&&O.options.layoutScroll&&O.scroll&&O!==O.root&&as(T,{x:-O.scroll.offset.x,y:-O.scroll.offset.y}),P&&(S.x*=P.x.scale,S.y*=P.y.scale,s8(T,P)),R&&s2(O.latestValues)&&as(T,O.latestValues))}S.x=ae(S.x),S.y=ae(S.y)}}function ae(T){return Number.isInteger(T)?T:T>1.0000000000001||T<.999999999999?T:1}function at(T,S){T.min=T.min+S,T.max=T.max+S}function ar(T,S,[N,R,O]){let P=void 0!==S[O]?S[O]:.5,M=iw(T.min,T.max,P);s9(T,S[N],S[R],M,S.scale)}let ai=["x","scaleX","originX"],an=["y","scaleY","originY"];function as(T,S){ar(T.x,S,ai),ar(T.y,S,an)}function aa(T,S){return sJ(sZ(T.getBoundingClientRect(),S))}function ao(T,S,N){let R=aa(T,N),{scroll:O}=S;return O&&(at(R.x,O.offset.x),at(R.y,O.offset.y)),R}let al=({current:T})=>T?T.ownerDocument.defaultView:null,au=new WeakMap;class ac{constructor(T){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=sQ(),this.visualElement=T}start(T,{snapToCursor:S=!1}={}){let{presenceContext:N}=this.visualElement;if(N&&!1===N.isPresent)return;let R=T=>{let{dragSnapToOrigin:N}=this.getProps();N?this.pauseAnimation():this.stopAnimation(),S&&this.snapToCursor(ra(T,"page").point)},O=(T,S)=>{let{drag:N,dragPropagation:R,onDragStart:O}=this.getProps();if(N&&!R&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=rf(N),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),sY(T=>{let S=this.getAxisMotionValue(T).get()||0;if(th.test(S)){let{projection:N}=this.visualElement;if(N&&N.layout){let R=N.layout.layoutBox[T];if(R){let T=sI(R);S=parseFloat(S)/100*T}}}this.originPoint[T]=S}),O&&t5.update(()=>O(T,S),!1,!0);let{animationState:P}=this.visualElement;P&&P.setActive("whileDrag",!0)},P=(T,S)=>{let{dragPropagation:N,dragDirectionLock:R,onDirectionLock:O,onDrag:P}=this.getProps();if(!N&&!this.openGlobalLock)return;let{offset:M}=S;if(R&&null===this.currentDirection){this.currentDirection=ah(M),null!==this.currentDirection&&O&&O(this.currentDirection);return}this.updateAxis("x",S.point,M),this.updateAxis("y",S.point,M),this.visualElement.render(),P&&P(T,S)},M=(T,S)=>this.stop(T,S),L=()=>sY(T=>{var S;return"paused"===this.getAnimationState(T)&&(null===(S=this.getAxisMotionValue(T).animation)||void 0===S?void 0:S.play())}),{dragSnapToOrigin:V}=this.getProps();this.panSession=new sw(T,{onSessionStart:R,onStart:O,onMove:P,onSessionEnd:M,resumeAnimation:L},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:V,contextWindow:al(this.visualElement)})}stop(T,S){let N=this.isDragging;if(this.cancel(),!N)return;let{velocity:R}=S;this.startAnimation(R);let{onDragEnd:O}=this.getProps();O&&t5.update(()=>O(T,S))}cancel(){this.isDragging=!1;let{projection:T,animationState:S}=this.visualElement;T&&(T.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:N}=this.getProps();!N&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),S&&S.setActive("whileDrag",!1)}updateAxis(T,S,N){let{drag:R}=this.getProps();if(!N||!ad(T,R,this.currentDirection))return;let O=this.getAxisMotionValue(T),P=this.originPoint[T]+N[T];this.constraints&&this.constraints[T]&&(P=sM(P,this.constraints[T],this.elastic[T])),O.set(P)}resolveConstraints(){var T;let{dragConstraints:S,dragElastic:N}=this.getProps(),R=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(T=this.visualElement.projection)||void 0===T?void 0:T.layout,O=this.constraints;S&&eI(S)?this.constraints||(this.constraints=this.resolveRefConstraints()):S&&R?this.constraints=sj(R.layoutBox,S):this.constraints=!1,this.elastic=sq(N),O!==this.constraints&&R&&this.constraints&&!this.hasMutatedConstraints&&sY(T=>{this.getAxisMotionValue(T)&&(this.constraints[T]=sU(R.layoutBox[T],this.constraints[T]))})}resolveRefConstraints(){let{dragConstraints:T,onMeasureDragConstraints:S}=this.getProps();if(!T||!eI(T))return!1;let N=T.current;rF(null!==N,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:R}=this.visualElement;if(!R||!R.layout)return!1;let O=ao(N,R.root,this.visualElement.getTransformPagePoint()),P=sB(R.layout.layoutBox,O);if(S){let T=S(sX(P));this.hasMutatedConstraints=!!T,T&&(P=sJ(T))}return P}startAnimation(T){let{drag:S,dragMomentum:N,dragElastic:R,dragTransition:O,dragSnapToOrigin:P,onDragTransitionEnd:M}=this.getProps(),L=this.constraints||{};return Promise.all(sY(M=>{if(!ad(M,S,this.currentDirection))return;let V=L&&L[M]||{};P&&(V={min:0,max:0});let U=R?200:1e6,$=R?40:1e7,W={type:"inertia",velocity:N?T[M]:0,bounceStiffness:U,bounceDamping:$,timeConstant:750,restDelta:1,restSpeed:10,...O,...V};return this.startAxisValueAnimation(M,W)})).then(M)}startAxisValueAnimation(T,S){let N=this.getAxisMotionValue(T);return N.start(nz(T,N,0,S))}stopAnimation(){sY(T=>this.getAxisMotionValue(T).stop())}pauseAnimation(){sY(T=>{var S;return null===(S=this.getAxisMotionValue(T).animation)||void 0===S?void 0:S.pause()})}getAnimationState(T){var S;return null===(S=this.getAxisMotionValue(T).animation)||void 0===S?void 0:S.state}getAxisMotionValue(T){let S="_drag"+T.toUpperCase(),N=this.visualElement.getProps();return N[S]||this.visualElement.getValue(T,(N.initial?N.initial[T]:void 0)||0)}snapToCursor(T){sY(S=>{let{drag:N}=this.getProps();if(!ad(S,N,this.currentDirection))return;let{projection:R}=this.visualElement,O=this.getAxisMotionValue(S);if(R&&R.layout){let{min:N,max:P}=R.layout.layoutBox[S];O.set(T[S]-iw(N,P,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:T,dragConstraints:S}=this.getProps(),{projection:N}=this.visualElement;if(!eI(S)||!N||!this.constraints)return;this.stopAnimation();let R={x:0,y:0};sY(T=>{let S=this.getAxisMotionValue(T);if(S){let N=S.get();R[T]=sV({min:N,max:N},this.constraints[T])}});let{transformTemplate:O}=this.visualElement.getProps();this.visualElement.current.style.transform=O?O({},""):"none",N.root&&N.root.updateScroll(),N.updateLayout(),this.resolveConstraints(),sY(S=>{if(!ad(S,T,null))return;let N=this.getAxisMotionValue(S),{min:O,max:P}=this.constraints[S];N.set(iw(O,P,R[S]))})}addListeners(){if(!this.visualElement.current)return;au.set(this.visualElement,this);let T=rl(this.visualElement.current,"pointerdown",T=>{let{drag:S,dragListener:N=!0}=this.getProps();S&&N&&this.start(T)}),S=()=>{let{dragConstraints:T}=this.getProps();eI(T)&&(this.constraints=this.resolveRefConstraints())},{projection:N}=this.visualElement,R=N.addEventListener("measure",S);N&&!N.layout&&(N.root&&N.root.updateScroll(),N.updateLayout()),S();let O=rn(window,"resize",()=>this.scalePositionWithinConstraints()),P=N.addEventListener("didUpdate",({delta:T,hasLayoutChanged:S})=>{this.isDragging&&S&&(sY(S=>{let N=this.getAxisMotionValue(S);N&&(this.originPoint[S]+=T[S].translate,N.set(N.get()+T[S].translate))}),this.visualElement.render())});return()=>{O(),T(),R(),P&&P()}}getProps(){let T=this.visualElement.getProps(),{drag:S=!1,dragDirectionLock:N=!1,dragPropagation:R=!1,dragConstraints:O=!1,dragElastic:P=sz,dragMomentum:M=!0}=T;return{...T,drag:S,dragDirectionLock:N,dragPropagation:R,dragConstraints:O,dragElastic:P,dragMomentum:M}}}function ad(T,S,N){return(!0===S||S===T)&&(null===N||N===T)}function ah(T,S=10){let N=null;return Math.abs(T.y)>S?N="y":Math.abs(T.x)>S&&(N="x"),N}class ap extends rg{constructor(T){super(T),this.removeGroupControls=t1,this.removeListeners=t1,this.controls=new ac(T)}mount(){let{dragControls:T}=this.node.getProps();T&&(this.removeGroupControls=T.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||t1}unmount(){this.removeGroupControls(),this.removeListeners()}}let af=T=>(S,N)=>{T&&t5.update(()=>T(S,N))};class am extends rg{constructor(){super(...arguments),this.removePointerDownListener=t1}onPointerDown(T){this.session=new sw(T,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:al(this.node)})}createPanHandlers(){let{onPanSessionStart:T,onPanStart:S,onPan:N,onPanEnd:R}=this.node.getProps();return{onSessionStart:af(T),onStart:af(S),onMove:N,onEnd:(T,S)=>{delete this.session,R&&t5.update(()=>R(T,S))}}}mount(){this.removePointerDownListener=rl(this.node.current,"pointerdown",T=>this.onPointerDown(T))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function ag(){let T=(0,en.useContext)(ew);if(null===T)return[!0,null];let{isPresent:S,onExitComplete:N,register:R}=T,O=(0,en.useId)();(0,en.useEffect)(()=>R(O),[]);let P=()=>N&&N(O);return!S&&N?[!1,P]:[!0]}let ay={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function av(T,S){return S.max===S.min?0:T/(S.max-S.min)*100}let ab={correct:(T,S)=>{if(!S.target)return T;if("string"==typeof T){if(!tp.test(T))return T;T=parseFloat(T)}let N=av(T,S.target.x),R=av(T,S.target.y);return`${N}% ${R}%`}},aw={correct:(T,{treeScale:S,projectionDelta:N})=>{let R=T,O=iF.parse(T);if(O.length>5)return R;let P=iF.createTransformer(T),M="number"!=typeof O[0]?1:0,L=N.x.scale*S.x,V=N.y.scale*S.y;O[0+M]/=L,O[1+M]/=V;let U=iw(L,V,.5);return"number"==typeof O[2+M]&&(O[2+M]/=U),"number"==typeof O[3+M]&&(O[3+M]/=U),P(O)}};class aT extends en.Component{componentDidMount(){let{visualElement:T,layoutGroup:S,switchLayoutGroup:N,layoutId:R}=this.props,{projection:O}=T;eY(ax),O&&(S.group&&S.group.add(O),N&&N.register&&R&&N.register(O),O.root.didUpdate(),O.addEventListener("animationComplete",()=>{this.safeToRemove()}),O.setOptions({...O.options,onExitComplete:()=>this.safeToRemove()})),ay.hasEverUpdated=!0}getSnapshotBeforeUpdate(T){let{layoutDependency:S,visualElement:N,drag:R,isPresent:O}=this.props,P=N.projection;return P&&(P.isPresent=O,R||T.layoutDependency!==S||void 0===S?P.willUpdate():this.safeToRemove(),T.isPresent===O||(O?P.promote():P.relegate()||t5.postRender(()=>{let T=P.getStack();T&&T.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:T}=this.props.visualElement;T&&(T.root.didUpdate(),queueMicrotask(()=>{!T.currentAnimation&&T.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:T,layoutGroup:S,switchLayoutGroup:N}=this.props,{projection:R}=T;R&&(R.scheduleCheckAfterUnmount(),S&&S.group&&S.group.remove(R),N&&N.deregister&&N.deregister(R))}safeToRemove(){let{safeToRemove:T}=this.props;T&&T()}render(){return null}}function aS(T){let[S,N]=ag(),R=(0,en.useContext)(eU);return en.createElement(aT,{...T,layoutGroup:R,switchLayoutGroup:(0,en.useContext)(ez),isPresent:S,safeToRemove:N})}let ax={borderRadius:{...ab,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ab,borderTopRightRadius:ab,borderBottomLeftRadius:ab,borderBottomRightRadius:ab,boxShadow:aw},aE=["TopLeft","TopRight","BottomLeft","BottomRight"],aC=aE.length,a_=T=>"string"==typeof T?parseFloat(T):T,aI=T=>"number"==typeof T||tp.test(T);function ak(T,S,N,R,O,P){O?(T.opacity=iw(0,void 0!==N.opacity?N.opacity:1,aA(R)),T.opacityExit=iw(void 0!==S.opacity?S.opacity:1,0,aR(R))):P&&(T.opacity=iw(void 0!==S.opacity?S.opacity:1,void 0!==N.opacity?N.opacity:1,R));for(let O=0;O<aC;O++){let P=`border${aE[O]}Radius`,M=aN(S,P),L=aN(N,P);(void 0!==M||void 0!==L)&&(M||(M=0),L||(L=0),0===M||0===L||aI(M)===aI(L)?(T[P]=Math.max(iw(a_(M),a_(L),R),0),(th.test(L)||th.test(M))&&(T[P]+="%")):T[P]=L)}(S.rotate||N.rotate)&&(T.rotate=iw(S.rotate||0,N.rotate||0,R))}function aN(T,S){return void 0!==T[S]?T[S]:T.borderRadius}let aA=aD(0,.5,r9),aR=aD(.5,.95,t1);function aD(T,S,N){return R=>R<T?0:R>S?1:N(i$(T,S,R))}function aO(T,S){T.min=S.min,T.max=S.max}function aP(T,S){aO(T.x,S.x),aO(T.y,S.y)}function aM(T,S,N,R,O){return T-=S,T=s6(T,1/N,R),void 0!==O&&(T=s6(T,1/O,R)),T}function aL(T,S=0,N=1,R=.5,O,P=T,M=T){if(th.test(S)&&(S=parseFloat(S),S=iw(M.min,M.max,S/100)-M.min),"number"!=typeof S)return;let L=iw(P.min,P.max,R);T===P&&(L-=S),T.min=aM(T.min,S,N,L,O),T.max=aM(T.max,S,N,L,O)}function aj(T,S,[N,R,O],P,M){aL(T,S[N],S[R],S[O],S.scale,P,M)}let aF=["x","scaleX","originX"],aB=["y","scaleY","originY"];function aV(T,S,N,R){aj(T.x,S,aF,N?N.x:void 0,R?R.x:void 0),aj(T.y,S,aB,N?N.y:void 0,R?R.y:void 0)}function aU(T){return 0===T.translate&&1===T.scale}function az(T){return aU(T.x)&&aU(T.y)}function aq(T,S){return T.x.min===S.x.min&&T.x.max===S.x.max&&T.y.min===S.y.min&&T.y.max===S.y.max}function a$(T,S){return Math.round(T.x.min)===Math.round(S.x.min)&&Math.round(T.x.max)===Math.round(S.x.max)&&Math.round(T.y.min)===Math.round(S.y.min)&&Math.round(T.y.max)===Math.round(S.y.max)}function aH(T){return sI(T.x)/sI(T.y)}class aG{constructor(){this.members=[]}add(T){nH(this.members,T),T.scheduleRender()}remove(T){if(nG(this.members,T),T===this.prevLead&&(this.prevLead=void 0),T===this.lead){let T=this.members[this.members.length-1];T&&this.promote(T)}}relegate(T){let S;let N=this.members.findIndex(S=>T===S);if(0===N)return!1;for(let T=N;T>=0;T--){let N=this.members[T];if(!1!==N.isPresent){S=N;break}}return!!S&&(this.promote(S),!0)}promote(T,S){let N=this.lead;if(T!==N&&(this.prevLead=N,this.lead=T,T.show(),N)){N.instance&&N.scheduleRender(),T.scheduleRender(),T.resumeFrom=N,S&&(T.resumeFrom.preserveOpacity=!0),N.snapshot&&(T.snapshot=N.snapshot,T.snapshot.latestValues=N.animationValues||N.latestValues),T.root&&T.root.isUpdating&&(T.isLayoutDirty=!0);let{crossfade:R}=T.options;!1===R&&N.hide()}}exitAnimationComplete(){this.members.forEach(T=>{let{options:S,resumingFrom:N}=T;S.onExitComplete&&S.onExitComplete(),N&&N.options.onExitComplete&&N.options.onExitComplete()})}scheduleRender(){this.members.forEach(T=>{T.instance&&T.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function aW(T,S,N){let R="",O=T.x.translate/S.x,P=T.y.translate/S.y;if((O||P)&&(R=`translate3d(${O}px, ${P}px, 0) `),(1!==S.x||1!==S.y)&&(R+=`scale(${1/S.x}, ${1/S.y}) `),N){let{rotate:T,rotateX:S,rotateY:O}=N;T&&(R+=`rotate(${T}deg) `),S&&(R+=`rotateX(${S}deg) `),O&&(R+=`rotateY(${O}deg) `)}let M=T.x.scale*S.x,L=T.y.scale*S.y;return(1!==M||1!==L)&&(R+=`scale(${M}, ${L})`),R||"none"}let aK=(T,S)=>T.depth-S.depth;class aQ{constructor(){this.children=[],this.isDirty=!1}add(T){nH(this.children,T),this.isDirty=!0}remove(T){nG(this.children,T),this.isDirty=!0}forEach(T){this.isDirty&&this.children.sort(aK),this.isDirty=!1,this.children.forEach(T)}}function aY(T,S){let N=performance.now(),R=({timestamp:O})=>{let P=O-N;P>=S&&(t9(R),T(P-S))};return t5.read(R,!0),()=>t9(R)}function aJ(T){window.MotionDebug&&window.MotionDebug.record(T)}function aZ(T){return T instanceof SVGElement&&"svg"!==T.tagName}function a0(T,S,N){let R=e0(T)?T:nJ(T);return R.start(nz("",R,S,N)),R.animation}let a3=["","X","Y","Z"],a4={visibility:"hidden"},a6=1e3,a5=0,a9={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function a8({attachResizeListener:T,defaultParent:S,measureScroll:N,checkIsScrollRoot:R,resetTransform:O}){return class{constructor(T={},N=null==S?void 0:S()){this.id=a5++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,a9.totalNodes=a9.resolvedTargetDeltas=a9.recalculatedProjection=0,this.nodes.forEach(ot),this.nodes.forEach(ou),this.nodes.forEach(oc),this.nodes.forEach(or),aJ(a9)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=T,this.root=N?N.root||N:this,this.path=N?[...N.path,N]:[],this.parent=N,this.depth=N?N.depth+1:0;for(let T=0;T<this.path.length;T++)this.path[T].shouldResetTransform=!0;this.root===this&&(this.nodes=new aQ)}addEventListener(T,S){return this.eventHandlers.has(T)||this.eventHandlers.set(T,new nW),this.eventHandlers.get(T).add(S)}notifyListeners(T,...S){let N=this.eventHandlers.get(T);N&&N.notify(...S)}hasListeners(T){return this.eventHandlers.has(T)}mount(S,N=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=aZ(S),this.instance=S;let{layoutId:R,layout:O,visualElement:P}=this.options;if(P&&!P.current&&P.mount(S),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),N&&(O||R)&&(this.isLayoutDirty=!0),T){let N;let R=()=>this.root.updateBlockedByResize=!1;T(S,()=>{this.root.updateBlockedByResize=!0,N&&N(),N=aY(R,250),ay.hasAnimatedSinceResize&&(ay.hasAnimatedSinceResize=!1,this.nodes.forEach(ol))})}R&&this.root.registerSharedNode(R,this),!1!==this.options.animate&&P&&(R||O)&&this.addEventListener("didUpdate",({delta:T,hasLayoutChanged:S,hasRelativeTargetChanged:N,layout:R})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let O=this.options.transition||P.getDefaultTransition()||ov,{onLayoutAnimationStart:M,onLayoutAnimationComplete:L}=P.getProps(),V=!this.targetLayout||!a$(this.targetLayout,R)||N,U=!S&&N;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||U||S&&(V||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(T,U);let S={...nV(O,"layout"),onPlay:M,onComplete:L};(P.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else S||ol(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=R})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let T=this.getStack();T&&T.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,t9(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(od),this.animationId++)}getTransformTemplate(){let{visualElement:T}=this.options;return T&&T.getProps().transformTemplate}willUpdate(T=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let T=0;T<this.path.length;T++){let S=this.path[T];S.shouldResetTransform=!0,S.updateScroll("snapshot"),S.options.layoutRoot&&S.willUpdate(!1)}let{layoutId:S,layout:N}=this.options;if(void 0===S&&!N)return;let R=this.getTransformTemplate();this.prevTransformTemplateValue=R?R(this.latestValues,""):void 0,this.updateSnapshot(),T&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(on);return}this.isUpdating||this.nodes.forEach(oa),this.isUpdating=!1,this.nodes.forEach(oo),this.nodes.forEach(a7),this.nodes.forEach(oe),this.clearAllSnapshots();let T=performance.now();t8.delta=e7(0,1e3/60,T-t8.timestamp),t8.timestamp=T,t8.isProcessing=!0,t7.update.process(t8),t7.preRender.process(t8),t7.render.process(t8),t8.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(oi),this.sharedNodes.forEach(oh)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,t5.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){t5.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let T=0;T<this.path.length;T++)this.path[T].updateScroll();let T=this.layout;this.layout=this.measure(!1),this.layoutCorrected=sQ(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:S}=this.options;S&&S.notify("LayoutMeasure",this.layout.layoutBox,T?T.layoutBox:void 0)}updateScroll(T="measure"){let S=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===T&&(S=!1),S&&(this.scroll={animationId:this.root.animationId,phase:T,isRoot:R(this.instance),offset:N(this.instance)})}resetTransform(){if(!O)return;let T=this.isLayoutDirty||this.shouldResetTransform,S=this.projectionDelta&&!az(this.projectionDelta),N=this.getTransformTemplate(),R=N?N(this.latestValues,""):void 0,P=R!==this.prevTransformTemplateValue;T&&(S||s2(this.latestValues)||P)&&(O(this.instance,R),this.shouldResetTransform=!1,this.scheduleRender())}measure(T=!0){let S=this.measurePageBox(),N=this.removeElementScroll(S);return T&&(N=this.removeTransform(N)),oS(N),{animationId:this.root.animationId,measuredBox:S,layoutBox:N,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:T}=this.options;if(!T)return sQ();let S=T.measureViewportBox(),{scroll:N}=this.root;return N&&(at(S.x,N.offset.x),at(S.y,N.offset.y)),S}removeElementScroll(T){let S=sQ();aP(S,T);for(let N=0;N<this.path.length;N++){let R=this.path[N],{scroll:O,options:P}=R;if(R!==this.root&&O&&P.layoutScroll){if(O.isRoot){aP(S,T);let{scroll:N}=this.root;N&&(at(S.x,-N.offset.x),at(S.y,-N.offset.y))}at(S.x,O.offset.x),at(S.y,O.offset.y)}}return S}applyTransform(T,S=!1){let N=sQ();aP(N,T);for(let T=0;T<this.path.length;T++){let R=this.path[T];!S&&R.options.layoutScroll&&R.scroll&&R!==R.root&&as(N,{x:-R.scroll.offset.x,y:-R.scroll.offset.y}),s2(R.latestValues)&&as(N,R.latestValues)}return s2(this.latestValues)&&as(N,this.latestValues),N}removeTransform(T){let S=sQ();aP(S,T);for(let T=0;T<this.path.length;T++){let N=this.path[T];if(!N.instance||!s2(N.latestValues))continue;s1(N.latestValues)&&N.updateSnapshot();let R=sQ();aP(R,N.measurePageBox()),aV(S,N.latestValues,N.snapshot?N.snapshot.layoutBox:void 0,R)}return s2(this.latestValues)&&aV(S,this.latestValues),S}setTargetDelta(T){this.targetDelta=T,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(T){this.options={...this.options,...T,crossfade:void 0===T.crossfade||T.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==t8.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(T=!1){var S;let N=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=N.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=N.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=N.isSharedProjectionDirty);let R=!!this.resumingFrom||this!==N;if(!(T||R&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(S=this.parent)||void 0===S?void 0:S.isProjectionDirty)||this.attemptToResolveRelativeTarget))return;let{layout:O,layoutId:P}=this.options;if(this.layout&&(O||P)){if(this.resolvedRelativeTargetAt=t8.timestamp,!this.targetDelta&&!this.relativeTarget){let T=this.getClosestProjectingParent();T&&T.layout&&1!==this.animationProgress?(this.relativeParent=T,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sQ(),this.relativeTargetOrigin=sQ(),sP(this.relativeTargetOrigin,this.layout.layoutBox,T.layout.layoutBox),aP(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if(this.target||(this.target=sQ(),this.targetWithTransforms=sQ()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),sD(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):aP(this.target,this.layout.layoutBox),s8(this.target,this.targetDelta)):aP(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let T=this.getClosestProjectingParent();T&&!!T.resumingFrom==!!this.resumingFrom&&!T.options.layoutScroll&&T.target&&1!==this.animationProgress?(this.relativeParent=T,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sQ(),this.relativeTargetOrigin=sQ(),sP(this.relativeTargetOrigin,this.target,T.target),aP(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}a9.resolvedTargetDeltas++}}}getClosestProjectingParent(){return!this.parent||s1(this.parent.latestValues)||s3(this.parent.latestValues)?void 0:this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var T;let S=this.getLead(),N=!!this.resumingFrom||this!==S,R=!0;if((this.isProjectionDirty||(null===(T=this.parent)||void 0===T?void 0:T.isProjectionDirty))&&(R=!1),N&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(R=!1),this.resolvedRelativeTargetAt===t8.timestamp&&(R=!1),R)return;let{layout:O,layoutId:P}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(O||P))return;aP(this.layoutCorrected,this.layout.layoutBox);let M=this.treeScale.x,L=this.treeScale.y;s7(this.layoutCorrected,this.treeScale,this.path,N),S.layout&&!S.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(S.target=S.layout.layoutBox);let{target:V}=S;if(!V){this.projectionTransform&&(this.projectionDelta=sW(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=sW(),this.projectionDeltaWithTransform=sW());let U=this.projectionTransform;sA(this.projectionDelta,this.layoutCorrected,V,this.latestValues),this.projectionTransform=aW(this.projectionDelta,this.treeScale),(this.projectionTransform!==U||this.treeScale.x!==M||this.treeScale.y!==L)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",V)),a9.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(T=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),T){let T=this.getStack();T&&T.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(T,S=!1){let N;let R=this.snapshot,O=R?R.latestValues:{},P={...this.latestValues},M=sW();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!S;let L=sQ(),V=(R?R.source:void 0)!==(this.layout?this.layout.source:void 0),U=this.getStack(),$=!U||U.members.length<=1,W=!!(V&&!$&&!0===this.options.crossfade&&!this.path.some(oy));this.animationProgress=0,this.mixTargetDelta=S=>{let R=S/1e3;of(M.x,T.x,R),of(M.y,T.y,R),this.setTargetDelta(M),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(sP(L,this.layout.layoutBox,this.relativeParent.layout.layoutBox),og(this.relativeTarget,this.relativeTargetOrigin,L,R),N&&aq(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=sQ()),aP(N,this.relativeTarget)),V&&(this.animationValues=P,ak(P,O,this.latestValues,R,W,$)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(T){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(t9(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=t5.update(()=>{ay.hasAnimatedSinceResize=!0,this.currentAnimation=a0(0,a6,{...T,onUpdate:S=>{this.mixTargetDelta(S),T.onUpdate&&T.onUpdate(S)},onComplete:()=>{T.onComplete&&T.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let T=this.getStack();T&&T.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(a6),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let T=this.getLead(),{targetWithTransforms:S,target:N,layout:R,latestValues:O}=T;if(S&&N&&R){if(this!==T&&this.layout&&R&&ox(this.options.animationType,this.layout.layoutBox,R.layoutBox)){N=this.target||sQ();let S=sI(this.layout.layoutBox.x);N.x.min=T.target.x.min,N.x.max=N.x.min+S;let R=sI(this.layout.layoutBox.y);N.y.min=T.target.y.min,N.y.max=N.y.min+R}aP(S,N),as(S,O),sA(this.projectionDeltaWithTransform,this.layoutCorrected,S,O)}}registerSharedNode(T,S){this.sharedNodes.has(T)||this.sharedNodes.set(T,new aG),this.sharedNodes.get(T).add(S);let N=S.options.initialPromotionConfig;S.promote({transition:N?N.transition:void 0,preserveFollowOpacity:N&&N.shouldPreserveFollowOpacity?N.shouldPreserveFollowOpacity(S):void 0})}isLead(){let T=this.getStack();return!T||T.lead===this}getLead(){var T;let{layoutId:S}=this.options;return S&&(null===(T=this.getStack())||void 0===T?void 0:T.lead)||this}getPrevLead(){var T;let{layoutId:S}=this.options;return S?null===(T=this.getStack())||void 0===T?void 0:T.prevLead:void 0}getStack(){let{layoutId:T}=this.options;if(T)return this.root.sharedNodes.get(T)}promote({needsReset:T,transition:S,preserveFollowOpacity:N}={}){let R=this.getStack();R&&R.promote(this,N),T&&(this.projectionDelta=void 0,this.needsReset=!0),S&&this.setOptions({transition:S})}relegate(){let T=this.getStack();return!!T&&T.relegate(this)}resetRotation(){let{visualElement:T}=this.options;if(!T)return;let S=!1,{latestValues:N}=T;if((N.rotate||N.rotateX||N.rotateY||N.rotateZ)&&(S=!0),!S)return;let R={};for(let S=0;S<a3.length;S++){let O="rotate"+a3[S];N[O]&&(R[O]=N[O],T.setStaticValue(O,0))}for(let S in T.render(),R)T.setStaticValue(S,R[S]);T.scheduleRender()}getProjectionStyles(T){var S,N;if(!this.instance||this.isSVG)return;if(!this.isVisible)return a4;let R={visibility:""},O=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,R.opacity="",R.pointerEvents=tJ(null==T?void 0:T.pointerEvents)||"",R.transform=O?O(this.latestValues,""):"none",R;let P=this.getLead();if(!this.projectionDelta||!this.layout||!P.target){let S={};return this.options.layoutId&&(S.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,S.pointerEvents=tJ(null==T?void 0:T.pointerEvents)||""),this.hasProjected&&!s2(this.latestValues)&&(S.transform=O?O({},""):"none",this.hasProjected=!1),S}let M=P.animationValues||P.latestValues;this.applyTransformsToTarget(),R.transform=aW(this.projectionDeltaWithTransform,this.treeScale,M),O&&(R.transform=O(M,R.transform));let{x:L,y:V}=this.projectionDelta;for(let T in R.transformOrigin=`${100*L.origin}% ${100*V.origin}% 0`,P.animationValues?R.opacity=P===this?null!==(N=null!==(S=M.opacity)&&void 0!==S?S:this.latestValues.opacity)&&void 0!==N?N:1:this.preserveOpacity?this.latestValues.opacity:M.opacityExit:R.opacity=P===this?void 0!==M.opacity?M.opacity:"":void 0!==M.opacityExit?M.opacityExit:0,eQ){if(void 0===M[T])continue;let{correct:S,applyTo:N}=eQ[T],O="none"===R.transform?M[T]:S(M[T],P);if(N){let T=N.length;for(let S=0;S<T;S++)R[N[S]]=O}else R[T]=O}return this.options.layoutId&&(R.pointerEvents=P===this?tJ(null==T?void 0:T.pointerEvents)||"":"none"),R}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(T=>{var S;return null===(S=T.currentAnimation)||void 0===S?void 0:S.stop()}),this.root.nodes.forEach(on),this.root.sharedNodes.clear()}}}function a7(T){T.updateLayout()}function oe(T){var S;let N=(null===(S=T.resumeFrom)||void 0===S?void 0:S.snapshot)||T.snapshot;if(T.isLead()&&T.layout&&N&&T.hasListeners("didUpdate")){let{layoutBox:S,measuredBox:R}=T.layout,{animationType:O}=T.options,P=N.source!==T.layout.source;"size"===O?sY(T=>{let R=P?N.measuredBox[T]:N.layoutBox[T],O=sI(R);R.min=S[T].min,R.max=R.min+O}):ox(O,N.layoutBox,S)&&sY(R=>{let O=P?N.measuredBox[R]:N.layoutBox[R],M=sI(S[R]);O.max=O.min+M,T.relativeTarget&&!T.currentAnimation&&(T.isProjectionDirty=!0,T.relativeTarget[R].max=T.relativeTarget[R].min+M)});let M=sW();sA(M,S,N.layoutBox);let L=sW();P?sA(L,T.applyTransform(R,!0),N.measuredBox):sA(L,S,N.layoutBox);let V=!az(M),U=!1;if(!T.resumeFrom){let R=T.getClosestProjectingParent();if(R&&!R.resumeFrom){let{snapshot:O,layout:P}=R;if(O&&P){let M=sQ();sP(M,N.layoutBox,O.layoutBox);let L=sQ();sP(L,S,P.layoutBox),a$(M,L)||(U=!0),R.options.layoutRoot&&(T.relativeTarget=L,T.relativeTargetOrigin=M,T.relativeParent=R)}}}T.notifyListeners("didUpdate",{layout:S,snapshot:N,delta:L,layoutDelta:M,hasLayoutChanged:V,hasRelativeTargetChanged:U})}else if(T.isLead()){let{onExitComplete:S}=T.options;S&&S()}T.options.transition=void 0}function ot(T){a9.totalNodes++,T.parent&&(T.isProjecting()||(T.isProjectionDirty=T.parent.isProjectionDirty),T.isSharedProjectionDirty||(T.isSharedProjectionDirty=!!(T.isProjectionDirty||T.parent.isProjectionDirty||T.parent.isSharedProjectionDirty)),T.isTransformDirty||(T.isTransformDirty=T.parent.isTransformDirty))}function or(T){T.isProjectionDirty=T.isSharedProjectionDirty=T.isTransformDirty=!1}function oi(T){T.clearSnapshot()}function on(T){T.clearMeasurements()}function oa(T){T.isLayoutDirty=!1}function oo(T){let{visualElement:S}=T.options;S&&S.getProps().onBeforeLayoutMeasure&&S.notify("BeforeLayoutMeasure"),T.resetTransform()}function ol(T){T.finishAnimation(),T.targetDelta=T.relativeTarget=T.target=void 0,T.isProjectionDirty=!0}function ou(T){T.resolveTargetDelta()}function oc(T){T.calcProjection()}function od(T){T.resetRotation()}function oh(T){T.removeLeadSnapshot()}function of(T,S,N){T.translate=iw(S.translate,0,N),T.scale=iw(S.scale,1,N),T.origin=S.origin,T.originPoint=S.originPoint}function om(T,S,N,R){T.min=iw(S.min,N.min,R),T.max=iw(S.max,N.max,R)}function og(T,S,N,R){om(T.x,S.x,N.x,R),om(T.y,S.y,N.y,R)}function oy(T){return T.animationValues&&void 0!==T.animationValues.opacityExit}let ov={duration:.45,ease:[.4,0,.1,1]},ob=T=>"undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().includes(T),ow=ob("applewebkit/")&&!ob("chrome/")?Math.round:t1;function oT(T){T.min=ow(T.min),T.max=ow(T.max)}function oS(T){oT(T.x),oT(T.y)}function ox(T,S,N){return"position"===T||"preserve-aspect"===T&&!sk(aH(S),aH(N),.2)}let oE=a8({attachResizeListener:(T,S)=>rn(T,"resize",S),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),oC={current:void 0},o_=a8({measureScroll:T=>({x:T.scrollLeft,y:T.scrollTop}),defaultParent:()=>{if(!oC.current){let T=new oE({});T.mount(window),T.setOptions({layoutScroll:!0}),oC.current=T}return oC.current},resetTransform:(T,S)=>{T.style.transform=void 0!==S?S:"none"},checkIsScrollRoot:T=>"fixed"===window.getComputedStyle(T).position}),oI={pan:{Feature:am},drag:{Feature:ap,ProjectionNode:o_,MeasureLayout:aS}},ok=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function oN(T){let S=ok.exec(T);if(!S)return[,];let[,N,R]=S;return[N,R]}let oA=4;function oR(T,S,N=1){rF(N<=oA,`Max CSS variable fallback depth detected in property "${T}". This may indicate a circular fallback dependency.`);let[R,O]=oN(T);if(!R)return;let P=window.getComputedStyle(S).getPropertyValue(R);if(P){let T=P.trim();return n$(T)?parseFloat(T):T}return e5(O)?oR(O,S,N+1):O}function oD(T,{...S},N){let R=T.current;if(!(R instanceof Element))return{target:S,transitionEnd:N};for(let O in N&&(N={...N}),T.values.forEach(T=>{let S=T.get();if(!e5(S))return;let N=oR(S,R);N&&T.set(N)}),S){let T=S[O];if(!e5(T))continue;let P=oR(T,R);P&&(S[O]=P,N||(N={}),void 0===N[O]&&(N[O]=T))}return{target:S,transitionEnd:N}}let oO=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),oP=T=>oO.has(T),oM=T=>Object.keys(T).some(oP),oL=T=>T===te||T===tp,oj=(T,S)=>parseFloat(T.split(", ")[S]),oF=(T,S)=>(N,{transform:R})=>{if("none"===R||!R)return 0;let O=R.match(/^matrix3d\((.+)\)$/);if(O)return oj(O[1],S);{let S=R.match(/^matrix\((.+)\)$/);return S?oj(S[1],T):0}},oB=new Set(["x","y","z"]),oV=eJ.filter(T=>!oB.has(T));function oU(T){let S=[];return oV.forEach(N=>{let R=T.getValue(N);void 0!==R&&(S.push([N,R.get()]),R.set(N.startsWith("scale")?1:0))}),S.length&&T.render(),S}let oz={width:({x:T},{paddingLeft:S="0",paddingRight:N="0"})=>T.max-T.min-parseFloat(S)-parseFloat(N),height:({y:T},{paddingTop:S="0",paddingBottom:N="0"})=>T.max-T.min-parseFloat(S)-parseFloat(N),top:(T,{top:S})=>parseFloat(S),left:(T,{left:S})=>parseFloat(S),bottom:({y:T},{top:S})=>parseFloat(S)+(T.max-T.min),right:({x:T},{left:S})=>parseFloat(S)+(T.max-T.min),x:oF(4,13),y:oF(5,14)};oz.translateX=oz.x,oz.translateY=oz.y;let oq=(T,S,N)=>{let R=S.measureViewportBox(),O=S.current,P=getComputedStyle(O),{display:M}=P,L={};"none"===M&&S.setStaticValue("display",T.display||"block"),N.forEach(T=>{L[T]=oz[T](R,P)}),S.render();let V=S.measureViewportBox();return N.forEach(N=>{let R=S.getValue(N);R&&R.jump(L[N]),T[N]=oz[N](V,P)}),T},o$=(T,S,N={},R={})=>{S={...S},R={...R};let O=Object.keys(S).filter(oP),P=[],M=!1,L=[];if(O.forEach(O=>{let V;let U=T.getValue(O);if(!T.hasValue(O))return;let $=N[O],W=n0($),K=S[O];if(tK(K)){let T=K.length,S=null===K[0]?1:0;W=n0($=K[S]);for(let N=S;N<T&&null!==K[N];N++)V?rF(n0(K[N])===V,"All keyframes must be of the same type"):rF((V=n0(K[N]))===W||oL(W)&&oL(V),"Keyframes must be of the same dimension as the current value")}else V=n0(K);if(W!==V){if(oL(W)&&oL(V)){let T=U.get();"string"==typeof T&&U.set(parseFloat(T)),"string"==typeof K?S[O]=parseFloat(K):Array.isArray(K)&&V===tp&&(S[O]=K.map(parseFloat))}else(null==W?void 0:W.transform)&&(null==V?void 0:V.transform)&&(0===$||0===K)?0===$?U.set(V.transform($)):S[O]=W.transform(K):(M||(P=oU(T),M=!0),L.push(O),R[O]=void 0!==R[O]?R[O]:S[O],U.jump(K))}}),!L.length)return{target:S,transitionEnd:R};{let N=L.indexOf("height")>=0?window.pageYOffset:null,O=oq(S,T,L);return P.length&&P.forEach(([S,N])=>{T.getValue(S).set(N)}),T.render(),eT&&null!==N&&window.scrollTo({top:N}),{target:O,transitionEnd:R}}};function oH(T,S,N,R){return oM(S)?o$(T,S,N,R):{target:S,transitionEnd:R}}let oG=(T,S,N,R)=>{let O=oD(T,S,R);return oH(T,S=O.target,N,R=O.transitionEnd)},oW={current:null},oK={current:!1};function oQ(){if(oK.current=!0,eT){if(window.matchMedia){let T=window.matchMedia("(prefers-reduced-motion)"),S=()=>oW.current=T.matches;T.addListener(S),S()}else oW.current=!1}}function oY(T,S,N){let{willChange:R}=S;for(let O in S){let P=S[O],M=N[O];if(e0(P))T.addValue(O,P),nq(R)&&R.add(O);else if(e0(M))T.addValue(O,nJ(P,{owner:T})),nq(R)&&R.remove(O);else if(M!==P){if(T.hasValue(O)){let S=T.getValue(O);S.hasAnimated||S.set(P)}else{let S=T.getStaticValue(O);T.addValue(O,nJ(void 0!==S?S:P,{owner:T}))}}}for(let R in N)void 0===S[R]&&T.removeValue(R);return S}let oJ=new WeakMap,oX=Object.keys(eB),oZ=oX.length,o0=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],o1=eD.length;class o2{constructor({parent:T,props:S,presenceContext:N,reducedMotionConfig:R,visualState:O},P={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>t5.render(this.render,!1,!0);let{latestValues:M,renderState:L}=O;this.latestValues=M,this.baseTarget={...M},this.initialValues=S.initial?{...M}:{},this.renderState=L,this.parent=T,this.props=S,this.presenceContext=N,this.depth=T?T.depth+1:0,this.reducedMotionConfig=R,this.options=P,this.isControllingVariants=eO(S),this.isVariantNode=eP(S),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(T&&T.current);let{willChange:V,...U}=this.scrapeMotionValuesFromProps(S,{});for(let T in U){let S=U[T];void 0!==M[T]&&e0(S)&&(S.set(M[T],!1),nq(V)&&V.add(T))}}scrapeMotionValuesFromProps(T,S){return{}}mount(T){this.current=T,oJ.set(T,this),this.projection&&!this.projection.instance&&this.projection.mount(T),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((T,S)=>this.bindToMotionValue(S,T)),oK.current||oQ(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||oW.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let T in oJ.delete(this.current),this.projection&&this.projection.unmount(),t9(this.notifyUpdate),t9(this.render),this.valueSubscriptions.forEach(T=>T()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[T].clear();for(let T in this.features)this.features[T].unmount();this.current=null}bindToMotionValue(T,S){let N=eX.has(T),R=S.on("change",S=>{this.latestValues[T]=S,this.props.onUpdate&&t5.update(this.notifyUpdate,!1,!0),N&&this.projection&&(this.projection.isTransformDirty=!0)}),O=S.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(T,()=>{R(),O()})}sortNodePosition(T){return this.current&&this.sortInstanceNodePosition&&this.type===T.type?this.sortInstanceNodePosition(this.current,T.current):0}loadFeatures({children:T,...S},N,R,O){let P,M;for(let T=0;T<oZ;T++){let N=oX[T],{isEnabled:R,Feature:O,ProjectionNode:L,MeasureLayout:V}=eB[N];L&&(P=L),R(S)&&(!this.features[N]&&O&&(this.features[N]=new O(this)),V&&(M=V))}if(("html"===this.type||"svg"===this.type)&&!this.projection&&P){this.projection=new P(this.latestValues,this.parent&&this.parent.projection);let{layoutId:T,layout:N,drag:R,dragConstraints:M,layoutScroll:L,layoutRoot:V}=S;this.projection.setOptions({layoutId:T,layout:N,alwaysMeasureLayout:!!R||M&&eI(M),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"==typeof N?N:"both",initialPromotionConfig:O,layoutScroll:L,layoutRoot:V})}return M}updateFeatures(){for(let T in this.features){let S=this.features[T];S.isMounted?S.update():(S.mount(),S.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):sQ()}getStaticValue(T){return this.latestValues[T]}setStaticValue(T,S){this.latestValues[T]=S}makeTargetAnimatable(T,S=!0){return this.makeTargetAnimatableFromInstance(T,this.props,S)}update(T,S){(T.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=T,this.prevPresenceContext=this.presenceContext,this.presenceContext=S;for(let S=0;S<o0.length;S++){let N=o0[S];this.propEventSubscriptions[N]&&(this.propEventSubscriptions[N](),delete this.propEventSubscriptions[N]);let R=T["on"+N];R&&(this.propEventSubscriptions[N]=this.on(N,R))}this.prevMotionValues=oY(this,this.scrapeMotionValuesFromProps(T,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(T){return this.props.variants?this.props.variants[T]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(T=!1){if(T)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){let T=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(T.initial=this.props.initial),T}let S={};for(let T=0;T<o1;T++){let N=eD[T],R=this.props[N];(eN(R)||!1===R)&&(S[N]=R)}return S}addVariantChild(T){let S=this.getClosestVariantNode();if(S)return S.variantChildren&&S.variantChildren.add(T),()=>S.variantChildren.delete(T)}addValue(T,S){S!==this.values.get(T)&&(this.removeValue(T),this.bindToMotionValue(T,S)),this.values.set(T,S),this.latestValues[T]=S.get()}removeValue(T){this.values.delete(T);let S=this.valueSubscriptions.get(T);S&&(S(),this.valueSubscriptions.delete(T)),delete this.latestValues[T],this.removeValueFromRenderState(T,this.renderState)}hasValue(T){return this.values.has(T)}getValue(T,S){if(this.props.values&&this.props.values[T])return this.props.values[T];let N=this.values.get(T);return void 0===N&&void 0!==S&&(N=nJ(S,{owner:this}),this.addValue(T,N)),N}readValue(T){var S;return void 0===this.latestValues[T]&&this.current?null!==(S=this.getBaseTargetFromProps(this.props,T))&&void 0!==S?S:this.readValueFromInstance(this.current,T,this.options):this.latestValues[T]}setBaseTarget(T,S){this.baseTarget[T]=S}getBaseTarget(T){var S;let{initial:N}=this.props,R="string"==typeof N||"object"==typeof N?null===(S=tG(this.props,N))||void 0===S?void 0:S[T]:void 0;if(N&&void 0!==R)return R;let O=this.getBaseTargetFromProps(this.props,T);return void 0===O||e0(O)?void 0!==this.initialValues[T]&&void 0===R?void 0:this.baseTarget[T]:O}on(T,S){return this.events[T]||(this.events[T]=new nW),this.events[T].add(S)}notify(T,...S){this.events[T]&&this.events[T].notify(...S)}}class o3 extends o2{sortInstanceNodePosition(T,S){return 2&T.compareDocumentPosition(S)?1:-1}getBaseTargetFromProps(T,S){return T.style?T.style[S]:void 0}removeValueFromRenderState(T,{vars:S,style:N}){delete S[T],delete N[T]}makeTargetAnimatableFromInstance({transition:T,transitionEnd:S,...N},{transformValues:R},O){let P=n7(N,T||{},this);if(R&&(S&&(S=R(S)),N&&(N=R(N)),P&&(P=R(P))),O){n9(this,N,P);let T=oG(this,N,P,S);S=T.transitionEnd,N=T.target}return{transition:T,transitionEnd:S,...N}}}function o4(T){return window.getComputedStyle(T)}class o6 extends o3{constructor(){super(...arguments),this.type="html"}readValueFromInstance(T,S){if(eX.has(S)){let T=nP(S);return T&&T.default||0}{let N=o4(T),R=(e6(S)?N.getPropertyValue(S):N[S])||0;return"string"==typeof R?R.trim():R}}measureInstanceViewportBox(T,{transformPagePoint:S}){return aa(T,S)}build(T,S,N,R){tb(T,S,N,R.transformTemplate)}scrapeMotionValuesFromProps(T,S){return t$(T,S)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:T}=this.props;e0(T)&&(this.childSubscription=T.on("change",T=>{this.current&&(this.current.textContent=`${T}`)}))}renderInstance(T,S,N,R){tU(T,S,N,R)}}class o5 extends o3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(T,S){return T[S]}readValueFromInstance(T,S){if(eX.has(S)){let T=nP(S);return T&&T.default||0}return S=tz.has(S)?S:eE(S),T.getAttribute(S)}measureInstanceViewportBox(){return sQ()}scrapeMotionValuesFromProps(T,S){return tH(T,S)}build(T,S,N,R){tL(T,S,N,this.isSVGTag,R.transformTemplate)}renderInstance(T,S,N,R){tq(T,S,N,R)}mount(T){this.isSVGTag=tF(T.tagName),super.mount(T)}}let o9=(T,S)=>eK(T)?new o5(S,{enableHardwareAcceleration:!1}):new o6(S,{enableHardwareAcceleration:!0}),o8={layout:{ProjectionNode:o_,MeasureLayout:aS}},o7={...sy,...rD,...oI,...o8},lt=eG((T,S)=>ri(T,S,o7,o9));function lr(){let T=(0,en.useRef)(!1);return eS(()=>(T.current=!0,()=>{T.current=!1}),[]),T}function li(){let T=lr(),[S,N]=(0,en.useState)(0),R=(0,en.useCallback)(()=>{T.current&&N(S+1)},[S]);return[(0,en.useCallback)(()=>t5.postRender(R),[R]),S]}class ln extends en.Component{getSnapshotBeforeUpdate(T){let S=this.props.childRef.current;if(S&&T.isPresent&&!this.props.isPresent){let T=this.props.sizeRef.current;T.height=S.offsetHeight||0,T.width=S.offsetWidth||0,T.top=S.offsetTop,T.left=S.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ls({children:T,isPresent:S}){let N=(0,en.useId)(),R=(0,en.useRef)(null),O=(0,en.useRef)({width:0,height:0,top:0,left:0});return(0,en.useInsertionEffect)(()=>{let{width:T,height:P,top:M,left:L}=O.current;if(S||!R.current||!T||!P)return;R.current.dataset.motionPopId=N;let V=document.createElement("style");return document.head.appendChild(V),V.sheet&&V.sheet.insertRule(`
          [data-motion-pop-id="${N}"] {
            position: absolute !important;
            width: ${T}px !important;
            height: ${P}px !important;
            top: ${M}px !important;
            left: ${L}px !important;
          }
        `),()=>{document.head.removeChild(V)}},[S]),en.createElement(ln,{isPresent:S,childRef:R,sizeRef:O},en.cloneElement(T,{ref:R}))}let la=({children:T,initial:S,isPresent:N,onExitComplete:R,custom:O,presenceAffectsLayout:P,mode:M})=>{let L=tW(ll),V=(0,en.useId)(),U=(0,en.useMemo)(()=>({id:V,initial:S,isPresent:N,custom:O,onExitComplete:T=>{for(let S of(L.set(T,!0),L.values()))if(!S)return;R&&R()},register:T=>(L.set(T,!1),()=>L.delete(T))}),P?void 0:[N]);return(0,en.useMemo)(()=>{L.forEach((T,S)=>L.set(S,!1))},[N]),en.useEffect(()=>{N||L.size||!R||R()},[N]),"popLayout"===M&&(T=en.createElement(ls,{isPresent:N},T)),en.createElement(ew.Provider,{value:U},T)};function ll(){return new Map}function lu(T){return(0,en.useEffect)(()=>()=>T(),[])}let lc=T=>T.key||"";function ld(T,S){T.forEach(T=>{let N=lc(T);S.set(N,T)})}function lh(T){let S=[];return en.Children.forEach(T,T=>{(0,en.isValidElement)(T)&&S.push(T)}),S}let lp=({children:T,custom:S,initial:N=!0,onExitComplete:R,exitBeforeEnter:O,presenceAffectsLayout:P=!0,mode:M="sync"})=>{rF(!O,"Replace exitBeforeEnter with mode='wait'");let L=(0,en.useContext)(eU).forceRender||li()[0],V=lr(),U=lh(T),$=U,W=(0,en.useRef)(new Map).current,K=(0,en.useRef)($),Q=(0,en.useRef)(new Map).current,Y=(0,en.useRef)(!0);if(eS(()=>{Y.current=!1,ld(U,Q),K.current=$}),lu(()=>{Y.current=!0,Q.clear(),W.clear()}),Y.current)return en.createElement(en.Fragment,null,$.map(T=>en.createElement(la,{key:lc(T),isPresent:!0,initial:!!N&&void 0,presenceAffectsLayout:P,mode:M},T)));$=[...$];let Z=K.current.map(lc),ee=U.map(lc),et=Z.length;for(let T=0;T<et;T++){let S=Z[T];-1!==ee.indexOf(S)||W.has(S)||W.set(S,void 0)}return"wait"===M&&W.size&&($=[]),W.forEach((T,N)=>{if(-1!==ee.indexOf(N))return;let O=Q.get(N);if(!O)return;let Y=Z.indexOf(N),et=T;if(!et){let T=()=>{W.delete(N);let T=Array.from(Q.keys()).filter(T=>!ee.includes(T));if(T.forEach(T=>Q.delete(T)),K.current=U.filter(S=>{let R=lc(S);return R===N||T.includes(R)}),!W.size){if(!1===V.current)return;L(),R&&R()}};et=en.createElement(la,{key:lc(O),isPresent:!1,onExitComplete:T,custom:S,presenceAffectsLayout:P,mode:M},O),W.set(N,et)}$.splice(Y,0,et)}),$=$.map(T=>{let S=T.key;return W.has(S)?T:en.createElement(la,{key:lc(T),isPresent:!0,presenceAffectsLayout:P,mode:M},T)}),en.createElement(en.Fragment,null,W.size?$:$.map(T=>(0,en.cloneElement)(T)))},lf=()=>{let[T,S]=(0,en.useState)(!1),[N,R]=(0,en.useState)(!1);(0,en.useEffect)(()=>{let T=()=>{R(window.scrollY>50)};return window.addEventListener("scroll",T),()=>window.removeEventListener("scroll",T)},[]);let O=[{name:"Home",href:"#home"},{name:"Services",href:"#services"},{name:"Wigs & Hair Solutions",href:"#wigs"},{name:"Book Appointment",href:"#booking"},{name:"About",href:"#about"},{name:"Blog",href:"#blog"},{name:"Contact",href:"#contact"}];return(0,ei.jsxs)(lt.header,{initial:{y:-100},animate:{y:0},className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${N?"bg-white/95 backdrop-blur-md shadow-lg":"bg-transparent"}`,children:[ei.jsx("div",{className:"hidden md:block bg-maroon text-white py-2",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4 flex justify-between items-center text-sm",children:[(0,ei.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,ei.jsxs)("div",{className:"flex items-center space-x-2",children:[ei.jsx(ef,{className:"w-4 h-4"}),ei.jsx("span",{children:"+91 98765 43210"})]}),(0,ei.jsxs)("div",{className:"flex items-center space-x-2",children:[ei.jsx(em,{className:"w-4 h-4"}),ei.jsx("span",{children:"hello@keshwala.com"})]})]}),ei.jsx("div",{className:"text-sm",children:"Professional Hair & Wig Care at Your Doorstep"})]})}),ei.jsx("nav",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,ei.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ei.jsxs)(lt.div,{whileHover:{scale:1.05},className:"flex items-center space-x-2",children:[ei.jsx("div",{className:"w-10 h-10 bg-maroon rounded-full flex items-center justify-center",children:ei.jsx("span",{className:"text-white font-bold text-lg",children:"K"})}),ei.jsx("span",{className:"text-2xl font-montserrat font-bold text-maroon",children:"Keshwala"})]}),ei.jsx("div",{className:"hidden lg:flex items-center space-x-8",children:O.map(T=>ei.jsx(lt.a,{href:T.href,whileHover:{scale:1.05},className:"text-brown hover:text-maroon font-medium transition-colors duration-300",children:T.name},T.name))}),ei.jsx("div",{className:"hidden lg:block",children:ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"btn-primary",children:"Book Now"})}),ei.jsx("button",{onClick:()=>S(!T),className:"lg:hidden p-2 text-brown hover:text-maroon transition-colors",children:T?ei.jsx(eg,{className:"w-6 h-6"}):ei.jsx(ey,{className:"w-6 h-6"})})]})}),ei.jsx(lp,{children:T&&ei.jsx(lt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"lg:hidden bg-white shadow-lg",children:(0,ei.jsxs)("div",{className:"px-4 py-6 space-y-4",children:[O.map(T=>ei.jsx(lt.a,{href:T.href,onClick:()=>S(!1),whileHover:{x:10},className:"block text-brown hover:text-maroon font-medium py-2 transition-colors",children:T.name},T.name)),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"w-full btn-primary mt-4",children:"Book Now"})]})})})]})},lm=ep("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),lg=ep("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),ly=ep("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),lv=ep("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var lb=Object.defineProperty,lw=new Map,lT=new WeakMap,lS=0,lx=void 0;function lE(T){return T?(lT.has(T)||(lS+=1,lT.set(T,lS.toString())),lT.get(T)):"0"}function lC(T){return Object.keys(T).sort().filter(S=>void 0!==T[S]).map(S=>`${S}_${"root"===S?lE(T.root):T[S]}`).toString()}function l_(T){let S=lC(T),N=lw.get(S);if(!N){let R;let O=new Map,P=new IntersectionObserver(S=>{S.forEach(S=>{var N;let P=S.isIntersecting&&R.some(T=>S.intersectionRatio>=T);T.trackVisibility&&void 0===S.isVisible&&(S.isVisible=P),null==(N=O.get(S.target))||N.forEach(T=>{T(P,S)})})},T);R=P.thresholds||(Array.isArray(T.threshold)?T.threshold:[T.threshold||0]),N={id:S,observer:P,elements:O},lw.set(S,N)}return N}function lI(T,S,N={},R=lx){if(void 0===window.IntersectionObserver&&void 0!==R){let O=T.getBoundingClientRect();return S(R,{isIntersecting:R,target:T,intersectionRatio:"number"==typeof N.threshold?N.threshold:0,time:0,boundingClientRect:O,intersectionRect:O,rootBounds:O}),()=>{}}let{id:O,observer:P,elements:M}=l_(N),L=M.get(T)||[];return M.has(T)||M.set(T,L),L.push(S),P.observe(T),function(){L.splice(L.indexOf(S),1),0===L.length&&(M.delete(T),P.unobserve(T)),0===M.size&&(P.disconnect(),lw.delete(O))}}function lk({threshold:T,delay:S,trackVisibility:N,rootMargin:R,root:O,triggerOnce:P,skip:M,initialInView:L,fallbackInView:V,onChange:U}={}){var $;let[W,K]=en.useState(null),Q=en.useRef(U),[Y,Z]=en.useState({inView:!!L,entry:void 0});Q.current=U,en.useEffect(()=>{let L;if(!M&&W)return L=lI(W,(T,S)=>{Z({inView:T,entry:S}),Q.current&&Q.current(T,S),S.isIntersecting&&P&&L&&(L(),L=void 0)},{root:O,rootMargin:R,threshold:T,trackVisibility:N,delay:S},V),()=>{L&&L()}},[Array.isArray(T)?T.toString():T,W,O,R,P,M,N,V,S]);let ee=null==($=Y.entry)?void 0:$.target,et=en.useRef(void 0);W||!ee||P||M||et.current===ee||(et.current=ee,Z({inView:!!L,entry:void 0}));let er=[K,Y.inView,Y.entry];return er.ref=er[0],er.inView=er[1],er.entry=er[2],er}en.Component;let lN=()=>{let[T,S]=lk({triggerOnce:!0,threshold:.1}),N=[{icon:lm,value:"500+",label:"Happy Clients"},{icon:lg,value:"4.9",label:"Rating"},{icon:ly,value:"50+",label:"Expert Stylists"}];return(0,ei.jsxs)("section",{id:"home",className:"relative min-h-screen flex items-center overflow-hidden",children:[ei.jsx("div",{className:"absolute inset-0 z-0",children:(0,ei.jsxs)("div",{className:"w-full h-full bg-gradient-to-br from-maroon/90 via-maroon/70 to-pink/50",children:[ei.jsx("div",{className:"absolute inset-0 bg-black/20"}),ei.jsx("div",{className:"w-full h-full bg-gradient-to-r from-maroon/80 to-pink/60 flex items-center justify-center",children:(0,ei.jsxs)("div",{className:"text-center text-white/30",children:[ei.jsx("div",{className:"w-32 h-32 mx-auto mb-4 rounded-full bg-white/10 flex items-center justify-center",children:ei.jsx("span",{className:"text-4xl",children:"\uD83D\uDC87‍♀️"})}),ei.jsx("p",{className:"text-lg",children:"Professional Hair & Wig Care"})]})})]})}),ei.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-20",children:(0,ei.jsxs)("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[(0,ei.jsxs)(lt.div,{ref:T,initial:{opacity:0,x:-50},animate:S?{opacity:1,x:0}:{},transition:{duration:.8,delay:.2},className:"text-white",children:[(0,ei.jsxs)(lt.h1,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.4},className:"text-5xl lg:text-7xl font-montserrat font-bold mb-6 leading-tight",children:["Confidence,"," ",ei.jsx("span",{className:"text-pink",children:"One Hair"})," ","at a Time"]}),ei.jsx(lt.p,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.6},className:"text-xl lg:text-2xl mb-8 text-white/90 leading-relaxed",children:"Personalized Hair & Wig Care Delivered at Your Doorstep"}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.8},className:"flex flex-col sm:flex-row gap-4 mb-12",children:[(0,ei.jsxs)(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-pink text-maroon px-8 py-4 rounded-lg font-semibold text-lg flex items-center justify-center group hover:bg-pink/90 transition-all duration-300",children:["Book Appointment",ei.jsx(lv,{className:"ml-2 w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"border-2 border-white text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-white hover:text-maroon transition-all duration-300",children:"View Services"})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:1},className:"grid grid-cols-3 gap-8",children:N.map((T,S)=>(0,ei.jsxs)("div",{className:"text-center",children:[ei.jsx("div",{className:"flex justify-center mb-2",children:ei.jsx(T.icon,{className:"w-8 h-8 text-pink"})}),ei.jsx("div",{className:"text-3xl font-bold font-montserrat",children:T.value}),ei.jsx("div",{className:"text-white/80 text-sm",children:T.label})]},S))})]}),ei.jsx(lt.div,{initial:{opacity:0,x:50},animate:S?{opacity:1,x:0}:{},transition:{duration:.8,delay:.4},className:"relative",children:(0,ei.jsxs)("div",{className:"relative",children:[ei.jsx("div",{className:"w-full h-96 lg:h-[500px] bg-white/10 rounded-2xl backdrop-blur-sm border border-white/20 flex items-center justify-center",children:(0,ei.jsxs)("div",{className:"text-center text-white/60",children:[ei.jsx("div",{className:"w-24 h-24 mx-auto mb-4 rounded-full bg-white/20 flex items-center justify-center",children:ei.jsx("span",{className:"text-3xl",children:"✨"})}),ei.jsx("p",{className:"text-lg",children:"Professional Styling"}),ei.jsx("p",{className:"text-sm",children:"At Your Home"})]})}),ei.jsx(lt.div,{animate:{y:[0,-10,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"absolute -top-4 -right-4 w-16 h-16 bg-pink/80 rounded-full flex items-center justify-center",children:ei.jsx("span",{className:"text-2xl",children:"\uD83D\uDC84"})}),ei.jsx(lt.div,{animate:{y:[0,10,0]},transition:{duration:4,repeat:1/0,ease:"easeInOut",delay:1},className:"absolute -bottom-4 -left-4 w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:ei.jsx("span",{className:"text-xl",children:"\uD83C\uDF1F"})})]})})]})}),ei.jsx(lt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:2},className:"absolute bottom-8 left-1/2 transform -translate-x-1/2",children:ei.jsx(lt.div,{animate:{y:[0,10,0]},transition:{duration:2,repeat:1/0},className:"w-6 h-10 border-2 border-white/50 rounded-full flex justify-center",children:ei.jsx(lt.div,{animate:{y:[0,12,0]},transition:{duration:2,repeat:1/0},className:"w-1 h-3 bg-white/50 rounded-full mt-2"})})})]})},lA=ep("scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),lR=ep("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),lD=ep("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),lO=ep("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),lP=ep("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),lM={NODE_CLIENT:!1,SDK_VERSION:"${JSCORE_VERSION}"},lL=function(T){let S=[],N=0;for(let R=0;R<T.length;R++){let O=T.charCodeAt(R);O<128?S[N++]=O:(O<2048?S[N++]=O>>6|192:((64512&O)==55296&&R+1<T.length&&(64512&T.charCodeAt(R+1))==56320?(O=65536+((1023&O)<<10)+(1023&T.charCodeAt(++R)),S[N++]=O>>18|240,S[N++]=O>>12&63|128):S[N++]=O>>12|224,S[N++]=O>>6&63|128),S[N++]=63&O|128)}return S},lj=function(T){let S=[],N=0,R=0;for(;N<T.length;){let O=T[N++];if(O<128)S[R++]=String.fromCharCode(O);else if(O>191&&O<224){let P=T[N++];S[R++]=String.fromCharCode((31&O)<<6|63&P)}else if(O>239&&O<365){let P=((7&O)<<18|(63&T[N++])<<12|(63&T[N++])<<6|63&T[N++])-65536;S[R++]=String.fromCharCode(55296+(P>>10)),S[R++]=String.fromCharCode(56320+(1023&P))}else{let P=T[N++],M=T[N++];S[R++]=String.fromCharCode((15&O)<<12|(63&P)<<6|63&M)}}return S.join("")},lF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(T,S){if(!Array.isArray(T))throw Error("encodeByteArray takes an array as a parameter");this.init_();let N=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,R=[];for(let S=0;S<T.length;S+=3){let O=T[S],P=S+1<T.length,M=P?T[S+1]:0,L=S+2<T.length,V=L?T[S+2]:0,U=O>>2,$=(3&O)<<4|M>>4,W=(15&M)<<2|V>>6,K=63&V;L||(K=64,P||(W=64)),R.push(N[U],N[$],N[W],N[K])}return R.join("")},encodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(T):this.encodeByteArray(lL(T),S)},decodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(T):lj(this.decodeStringToByteArray(T,S))},decodeStringToByteArray(T,S){this.init_();let N=S?this.charToByteMapWebSafe_:this.charToByteMap_,R=[];for(let S=0;S<T.length;){let O=N[T.charAt(S++)],P=S<T.length?N[T.charAt(S)]:0,M=++S<T.length?N[T.charAt(S)]:64,L=++S<T.length?N[T.charAt(S)]:64;if(++S,null==O||null==P||null==M||null==L)throw new lB;let V=O<<2|P>>4;if(R.push(V),64!==M){let T=P<<4&240|M>>2;if(R.push(T),64!==L){let T=M<<6&192|L;R.push(T)}}}return R},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let T=0;T<this.ENCODED_VALS.length;T++)this.byteToCharMap_[T]=this.ENCODED_VALS.charAt(T),this.charToByteMap_[this.byteToCharMap_[T]]=T,this.byteToCharMapWebSafe_[T]=this.ENCODED_VALS_WEBSAFE.charAt(T),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[T]]=T,T>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(T)]=T,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(T)]=T)}}};class lB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let lV=function(T){let S=lL(T);return lF.encodeByteArray(S,!0)},lU=function(T){return lV(T).replace(/\./g,"")},lz=function(T){try{return lF.decodeString(T,!0)}catch(T){console.error("base64Decode failed: ",T)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lq(){if("undefined"!=typeof self)return self;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l$=()=>lq().__FIREBASE_DEFAULTS__,lH=()=>{if("undefined"==typeof process||void 0===process.env)return;let T=process.env.__FIREBASE_DEFAULTS__;if(T)return JSON.parse(T)},lG=()=>{let T;if("undefined"==typeof document)return;try{T=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(T){return}let S=T&&lz(T[1]);return S&&JSON.parse(S)},lW=()=>{try{return l$()||lH()||lG()}catch(T){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${T}`);return}},lK=()=>{var T;return null===(T=lW())||void 0===T?void 0:T.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((T,S)=>{this.resolve=T,this.reject=S})}wrapCallback(T){return(S,N)=>{S?this.reject(S):this.resolve(N),"function"==typeof T&&(this.promise.catch(()=>{}),1===T.length?T(S):T(S,N))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lY(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function lJ(){return!1}function lX(){var T;let S=null===(T=lW())||void 0===T?void 0:T.forceEnvironment;if("node"===S)return!0;if("browser"===S)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(T){return!1}}function lZ(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function l0(){let T="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof T&&void 0!==T.id}function l1(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function l2(){return!lX()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l3(){try{return"object"==typeof indexedDB}catch(T){return!1}}function l4(){return new Promise((T,S)=>{try{let N=!0,R="validate-browser-context-for-indexeddb-analytics-module",O=self.indexedDB.open(R);O.onsuccess=()=>{O.result.close(),N||self.indexedDB.deleteDatabase(R),T(!0)},O.onupgradeneeded=()=>{N=!1},O.onerror=()=>{var T;S((null===(T=O.error)||void 0===T?void 0:T.message)||"")}}catch(T){S(T)}})}function l6(){return"undefined"!=typeof navigator&&!!navigator.cookieEnabled}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l5="FirebaseError";class l9 extends Error{constructor(T,S,N){super(S),this.code=T,this.customData=N,this.name=l5,Object.setPrototypeOf(this,l9.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,l8.prototype.create)}}class l8{constructor(T,S,N){this.service=T,this.serviceName=S,this.errors=N}create(T,...S){let N=S[0]||{},R=`${this.service}/${T}`,O=this.errors[T],P=O?l7(O,N):"Error",M=`${this.serviceName}: ${P} (${R}).`;return new l9(R,M,N)}}function l7(T,S){return T.replace(ue,(T,N)=>{let R=S[N];return null!=R?String(R):`<${N}?>`})}let ue=/\{\$([^}]+)}/g;function ut(T,S){if(T===S)return!0;let N=Object.keys(T),R=Object.keys(S);for(let O of N){if(!R.includes(O))return!1;let N=T[O],P=S[O];if(ur(N)&&ur(P)){if(!ut(N,P))return!1}else if(N!==P)return!1}for(let T of R)if(!N.includes(T))return!1;return!0}function ur(T){return null!==T&&"object"==typeof T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(T){let S=[];for(let[N,R]of Object.entries(T))Array.isArray(R)?R.forEach(T=>{S.push(encodeURIComponent(N)+"="+encodeURIComponent(T))}):S.push(encodeURIComponent(N)+"="+encodeURIComponent(R));return S.length?"&"+S.join("&"):""}function un(T){let S={};return T.replace(/^\?/,"").split("&").forEach(T=>{if(T){let[N,R]=T.split("=");S[decodeURIComponent(N)]=decodeURIComponent(R)}}),S}function us(T){let S=T.indexOf("?");if(!S)return"";let N=T.indexOf("#",S);return T.substring(S,N>0?N:void 0)}function uo(T,S){let N=new ul(T,S);return N.subscribe.bind(N)}class ul{constructor(T,S){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=S,this.task.then(()=>{T(this)}).catch(T=>{this.error(T)})}next(T){this.forEachObserver(S=>{S.next(T)})}error(T){this.forEachObserver(S=>{S.error(T)}),this.close(T)}complete(){this.forEachObserver(T=>{T.complete()}),this.close()}subscribe(T,S,N){let R;if(void 0===T&&void 0===S&&void 0===N)throw Error("Missing Observer.");void 0===(R=uu(T,["next","error","complete"])?T:{next:T,error:S,complete:N}).next&&(R.next=uc),void 0===R.error&&(R.error=uc),void 0===R.complete&&(R.complete=uc);let O=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?R.error(this.finalError):R.complete()}catch(T){}}),this.observers.push(R),O}unsubscribeOne(T){void 0!==this.observers&&void 0!==this.observers[T]&&(delete this.observers[T],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(T){if(!this.finalized)for(let S=0;S<this.observers.length;S++)this.sendOne(S,T)}sendOne(T,S){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[T])try{S(this.observers[T])}catch(T){"undefined"!=typeof console&&console.error&&console.error(T)}})}close(T){this.finalized||(this.finalized=!0,void 0!==T&&(this.finalError=T),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uu(T,S){if("object"!=typeof T||null===T)return!1;for(let N of S)if(N in T&&"function"==typeof T[N])return!0;return!1}function uc(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ud=1e3,uh=2,up=144e5,uf=.5;function um(T,S=ud,N=uh){let R=S*Math.pow(N,T),O=Math.round(uf*R*(Math.random()-.5)*2);return Math.min(up,R+O)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(T){return T&&T._delegate?T._delegate:T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lM.NODE_CLIENT=!0;class uy{constructor(T,S,N){this.name=T,this.instanceFactory=S,this.type=N,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(T){return this.instantiationMode=T,this}setMultipleInstances(T){return this.multipleInstances=T,this}setServiceProps(T){return this.serviceProps=T,this}setInstanceCreatedCallback(T){return this.onInstanceCreated=T,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uv="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(T,S){this.name=T,this.container=S,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(T){let S=this.normalizeInstanceIdentifier(T);if(!this.instancesDeferred.has(S)){let T=new lQ;if(this.instancesDeferred.set(S,T),this.isInitialized(S)||this.shouldAutoInitialize())try{let N=this.getOrInitializeService({instanceIdentifier:S});N&&T.resolve(N)}catch(T){}}return this.instancesDeferred.get(S).promise}getImmediate(T){var S;let N=this.normalizeInstanceIdentifier(null==T?void 0:T.identifier),R=null!==(S=null==T?void 0:T.optional)&&void 0!==S&&S;if(this.isInitialized(N)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:N})}catch(T){if(R)return null;throw T}else{if(R)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(T){if(T.name!==this.name)throw Error(`Mismatching Component ${T.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=T,this.shouldAutoInitialize()){if(uT(T))try{this.getOrInitializeService({instanceIdentifier:uv})}catch(T){}for(let[T,S]of this.instancesDeferred.entries()){let N=this.normalizeInstanceIdentifier(T);try{let T=this.getOrInitializeService({instanceIdentifier:N});S.resolve(T)}catch(T){}}}}clearInstance(T=uv){this.instancesDeferred.delete(T),this.instancesOptions.delete(T),this.instances.delete(T)}async delete(){let T=Array.from(this.instances.values());await Promise.all([...T.filter(T=>"INTERNAL"in T).map(T=>T.INTERNAL.delete()),...T.filter(T=>"_delete"in T).map(T=>T._delete())])}isComponentSet(){return null!=this.component}isInitialized(T=uv){return this.instances.has(T)}getOptions(T=uv){return this.instancesOptions.get(T)||{}}initialize(T={}){let{options:S={}}=T,N=this.normalizeInstanceIdentifier(T.instanceIdentifier);if(this.isInitialized(N))throw Error(`${this.name}(${N}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let R=this.getOrInitializeService({instanceIdentifier:N,options:S});for(let[T,S]of this.instancesDeferred.entries())N===this.normalizeInstanceIdentifier(T)&&S.resolve(R);return R}onInit(T,S){var N;let R=this.normalizeInstanceIdentifier(S),O=null!==(N=this.onInitCallbacks.get(R))&&void 0!==N?N:new Set;O.add(T),this.onInitCallbacks.set(R,O);let P=this.instances.get(R);return P&&T(P,R),()=>{O.delete(T)}}invokeOnInitCallbacks(T,S){let N=this.onInitCallbacks.get(S);if(N)for(let R of N)try{R(T,S)}catch(T){}}getOrInitializeService({instanceIdentifier:T,options:S={}}){let N=this.instances.get(T);if(!N&&this.component&&(N=this.component.instanceFactory(this.container,{instanceIdentifier:uw(T),options:S}),this.instances.set(T,N),this.instancesOptions.set(T,S),this.invokeOnInitCallbacks(N,T),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,T,N)}catch(T){}return N||null}normalizeInstanceIdentifier(T=uv){return this.component?this.component.multipleInstances?T:uv:T}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function uw(T){return T===uv?void 0:T}function uT(T){return"EAGER"===T.instantiationMode}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(T){this.name=T,this.providers=new Map}addComponent(T){let S=this.getProvider(T.name);if(S.isComponentSet())throw Error(`Component ${T.name} has already been registered with ${this.name}`);S.setComponent(T)}addOrOverwriteComponent(T){this.getProvider(T.name).isComponentSet()&&this.providers.delete(T.name),this.addComponent(T)}getProvider(T){if(this.providers.has(T))return this.providers.get(T);let S=new ub(T,this);return this.providers.set(T,S),S}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ux=[];!function(T){T[T.DEBUG=0]="DEBUG",T[T.VERBOSE=1]="VERBOSE",T[T.INFO=2]="INFO",T[T.WARN=3]="WARN",T[T.ERROR=4]="ERROR",T[T.SILENT=5]="SILENT"}(K||(K={}));let uE={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},uC=K.INFO,u_={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},uI=(T,S,...N)=>{if(S<T.logLevel)return;let R=new Date().toISOString(),O=u_[S];if(O)console[O](`[${R}]  ${T.name}:`,...N);else throw Error(`Attempted to log a message with an invalid logType (value: ${S})`)};class uk{constructor(T){this.name=T,this._logLevel=uC,this._logHandler=uI,this._userLogHandler=null,ux.push(this)}get logLevel(){return this._logLevel}set logLevel(T){if(!(T in K))throw TypeError(`Invalid value "${T}" assigned to \`logLevel\``);this._logLevel=T}setLogLevel(T){this._logLevel="string"==typeof T?uE[T]:T}get logHandler(){return this._logHandler}set logHandler(T){if("function"!=typeof T)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=T}get userLogHandler(){return this._userLogHandler}set userLogHandler(T){this._userLogHandler=T}debug(...T){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...T),this._logHandler(this,K.DEBUG,...T)}log(...T){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...T),this._logHandler(this,K.VERBOSE,...T)}info(...T){this._userLogHandler&&this._userLogHandler(this,K.INFO,...T),this._logHandler(this,K.INFO,...T)}warn(...T){this._userLogHandler&&this._userLogHandler(this,K.WARN,...T),this._logHandler(this,K.WARN,...T)}error(...T){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...T),this._logHandler(this,K.ERROR,...T)}}let uN=(T,S)=>S.some(S=>T instanceof S);function uA(){return R||(R=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uR(){return O||(O=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let uD=new WeakMap,uO=new WeakMap,uP=new WeakMap,uM=new WeakMap,uL=new WeakMap;function uj(T){let S=new Promise((S,N)=>{let R=()=>{T.removeEventListener("success",O),T.removeEventListener("error",P)},O=()=>{S(uq(T.result)),R()},P=()=>{N(T.error),R()};T.addEventListener("success",O),T.addEventListener("error",P)});return S.then(S=>{S instanceof IDBCursor&&uD.set(S,T)}).catch(()=>{}),uL.set(S,T),S}function uF(T){if(uO.has(T))return;let S=new Promise((S,N)=>{let R=()=>{T.removeEventListener("complete",O),T.removeEventListener("error",P),T.removeEventListener("abort",P)},O=()=>{S(),R()},P=()=>{N(T.error||new DOMException("AbortError","AbortError")),R()};T.addEventListener("complete",O),T.addEventListener("error",P),T.addEventListener("abort",P)});uO.set(T,S)}let uB={get(T,S,N){if(T instanceof IDBTransaction){if("done"===S)return uO.get(T);if("objectStoreNames"===S)return T.objectStoreNames||uP.get(T);if("store"===S)return N.objectStoreNames[1]?void 0:N.objectStore(N.objectStoreNames[0])}return uq(T[S])},set:(T,S,N)=>(T[S]=N,!0),has:(T,S)=>T instanceof IDBTransaction&&("done"===S||"store"===S)||S in T};function uV(T){uB=T(uB)}function uU(T){return T!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?uR().includes(T)?function(...S){return T.apply(u$(this),S),uq(uD.get(this))}:function(...S){return uq(T.apply(u$(this),S))}:function(S,...N){let R=T.call(u$(this),S,...N);return uP.set(R,S.sort?S.sort():[S]),uq(R)}}function uz(T){return"function"==typeof T?uU(T):(T instanceof IDBTransaction&&uF(T),uN(T,uA()))?new Proxy(T,uB):T}function uq(T){if(T instanceof IDBRequest)return uj(T);if(uM.has(T))return uM.get(T);let S=uz(T);return S!==T&&(uM.set(T,S),uL.set(S,T)),S}let u$=T=>uL.get(T);function uH(T,S,{blocked:N,upgrade:R,blocking:O,terminated:P}={}){let M=indexedDB.open(T,S),L=uq(M);return R&&M.addEventListener("upgradeneeded",T=>{R(uq(M.result),T.oldVersion,T.newVersion,uq(M.transaction),T)}),N&&M.addEventListener("blocked",T=>N(T.oldVersion,T.newVersion,T)),L.then(T=>{P&&T.addEventListener("close",()=>P()),O&&T.addEventListener("versionchange",T=>O(T.oldVersion,T.newVersion,T))}).catch(()=>{}),L}let uG=["get","getKey","getAll","getAllKeys","count"],uW=["put","add","delete","clear"],uK=new Map;function uQ(T,S){if(!(T instanceof IDBDatabase&&!(S in T)&&"string"==typeof S))return;if(uK.get(S))return uK.get(S);let N=S.replace(/FromIndex$/,""),R=S!==N,O=uW.includes(N);if(!(N in(R?IDBIndex:IDBObjectStore).prototype)||!(O||uG.includes(N)))return;let P=async function(T,...S){let P=this.transaction(T,O?"readwrite":"readonly"),M=P.store;return R&&(M=M.index(S.shift())),(await Promise.all([M[N](...S),O&&P.done]))[0]};return uK.set(S,P),P}uV(T=>({...T,get:(S,N,R)=>uQ(S,N)||T.get(S,N,R),has:(S,N)=>!!uQ(S,N)||T.has(S,N)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uY{constructor(T){this.container=T}getPlatformInfoString(){return this.container.getProviders().map(T=>{if(!uJ(T))return null;{let S=T.getImmediate();return`${S.library}/${S.version}`}}).filter(T=>T).join(" ")}}function uJ(T){let S=T.getComponent();return(null==S?void 0:S.type)==="VERSION"}let uX="@firebase/app",uZ="0.10.13",u0=new uk("@firebase/app"),u1="10.14.1",u2="[DEFAULT]",u3={[uX]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai-preview":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},u4=new Map,u6=new Map,u5=new Map;function u9(T,S){try{T.container.addComponent(S)}catch(N){u0.debug(`Component ${S.name} failed to register with FirebaseApp ${T.name}`,N)}}function u8(T){let S=T.name;if(u5.has(S))return u0.debug(`There were multiple attempts to register component ${S}.`),!1;for(let N of(u5.set(S,T),u4.values()))u9(N,T);for(let S of u6.values())u9(S,T);return!0}function u7(T,S){let N=T.container.getProvider("heartbeat").getImmediate({optional:!0});return N&&N.triggerHeartbeat(),T.container.getProvider(S)}function ce(T){return void 0!==T.settings}let ct=new l8("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(T,S,N){this._isDeleted=!1,this._options=Object.assign({},T),this._config=Object.assign({},S),this._name=S.name,this._automaticDataCollectionEnabled=S.automaticDataCollectionEnabled,this._container=N,this.container.addComponent(new uy("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(T){this.checkDestroyed(),this._automaticDataCollectionEnabled=T}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(T){this._isDeleted=T}checkDestroyed(){if(this.isDeleted)throw ct.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ci=u1;function cn(T,S={}){let N=T;"object"!=typeof S&&(S={name:S});let R=Object.assign({name:u2,automaticDataCollectionEnabled:!1},S),O=R.name;if("string"!=typeof O||!O)throw ct.create("bad-app-name",{appName:String(O)});if(N||(N=lK()),!N)throw ct.create("no-options");let P=u4.get(O);if(P){if(ut(N,P.options)&&ut(R,P.config))return P;throw ct.create("duplicate-app",{appName:O})}let M=new uS(O);for(let T of u5.values())M.addComponent(T);let L=new cr(N,R,M);return u4.set(O,L),L}function cs(T,S,N){var R;let O=null!==(R=u3[T])&&void 0!==R?R:T;N&&(O+=`-${N}`);let P=O.match(/\s|\//),M=S.match(/\s|\//);if(P||M){let T=[`Unable to register library "${O}" with version "${S}":`];P&&T.push(`library name "${O}" contains illegal characters (whitespace or "/")`),P&&M&&T.push("and"),M&&T.push(`version name "${S}" contains illegal characters (whitespace or "/")`),u0.warn(T.join(" "));return}u8(new uy(`${O}-version`,()=>({library:O,version:S}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ca="firebase-heartbeat-database",co=1,cl="firebase-heartbeat-store",cu=null;function cc(){return cu||(cu=uH(ca,co,{upgrade:(T,S)=>{if(0===S)try{T.createObjectStore(cl)}catch(T){console.warn(T)}}}).catch(T=>{throw ct.create("idb-open",{originalErrorMessage:T.message})})),cu}async function cd(T){try{let S=(await cc()).transaction(cl),N=await S.objectStore(cl).get(cp(T));return await S.done,N}catch(T){if(T instanceof l9)u0.warn(T.message);else{let S=ct.create("idb-get",{originalErrorMessage:null==T?void 0:T.message});u0.warn(S.message)}}}async function ch(T,S){try{let N=(await cc()).transaction(cl,"readwrite"),R=N.objectStore(cl);await R.put(S,cp(T)),await N.done}catch(T){if(T instanceof l9)u0.warn(T.message);else{let S=ct.create("idb-set",{originalErrorMessage:null==T?void 0:T.message});u0.warn(S.message)}}}function cp(T){return`${T.name}!${T.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cf=1024,cm=2592e6;class cy{constructor(T){this.container=T,this._heartbeatsCache=null;let S=this.container.getProvider("app").getImmediate();this._storage=new cT(S),this._heartbeatsCachePromise=this._storage.read().then(T=>(this._heartbeatsCache=T,T))}async triggerHeartbeat(){var T,S;try{let N=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),R=cv();if((null===(T=this._heartbeatsCache)||void 0===T?void 0:T.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null===(S=this._heartbeatsCache)||void 0===S?void 0:S.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===R||this._heartbeatsCache.heartbeats.some(T=>T.date===R))return;return this._heartbeatsCache.heartbeats.push({date:R,agent:N}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(T=>{let S=new Date(T.date).valueOf();return Date.now()-S<=cm}),this._storage.overwrite(this._heartbeatsCache)}catch(T){u0.warn(T)}}async getHeartbeatsHeader(){var T;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null===(T=this._heartbeatsCache)||void 0===T?void 0:T.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let S=cv(),{heartbeatsToSend:N,unsentEntries:R}=cw(this._heartbeatsCache.heartbeats),O=lU(JSON.stringify({version:2,heartbeats:N}));return this._heartbeatsCache.lastSentHeartbeatDate=S,R.length>0?(this._heartbeatsCache.heartbeats=R,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),O}catch(T){return u0.warn(T),""}}}function cv(){return new Date().toISOString().substring(0,10)}function cw(T,S=cf){let N=[],R=T.slice();for(let O of T){let T=N.find(T=>T.agent===O.agent);if(T){if(T.dates.push(O.date),cS(N)>S){T.dates.pop();break}}else if(N.push({agent:O.agent,dates:[O.date]}),cS(N)>S){N.pop();break}R=R.slice(1)}return{heartbeatsToSend:N,unsentEntries:R}}class cT{constructor(T){this.app=T,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!l3()&&l4().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let T=await cd(this.app);return(null==T?void 0:T.heartbeats)?T:{heartbeats:[]}}}async overwrite(T){var S;if(await this._canUseIndexedDBPromise){let N=await this.read();return ch(this.app,{lastSentHeartbeatDate:null!==(S=T.lastSentHeartbeatDate)&&void 0!==S?S:N.lastSentHeartbeatDate,heartbeats:T.heartbeats})}}async add(T){var S;if(await this._canUseIndexedDBPromise){let N=await this.read();return ch(this.app,{lastSentHeartbeatDate:null!==(S=T.lastSentHeartbeatDate)&&void 0!==S?S:N.lastSentHeartbeatDate,heartbeats:[...N.heartbeats,...T.heartbeats]})}}}function cS(T){return lU(JSON.stringify({version:2,heartbeats:T})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(T){u8(new uy("platform-logger",T=>new uY(T),"PRIVATE")),u8(new uy("heartbeat",T=>new cy(T),"PRIVATE")),cs(uX,uZ,""),cs(uX,uZ,"esm2017"),cs("fire-js","")})(0);var cx=N(3837);let cE=require("crypto");var cC="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},c_={};(function(){function T(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function S(T,S,N){N||(N=0);var R=Array(16);if("string"==typeof S)for(var O=0;16>O;++O)R[O]=S.charCodeAt(N++)|S.charCodeAt(N++)<<8|S.charCodeAt(N++)<<16|S.charCodeAt(N++)<<24;else for(O=0;16>O;++O)R[O]=S[N++]|S[N++]<<8|S[N++]<<16|S[N++]<<24;S=T.g[0],N=T.g[1],O=T.g[2];var P=T.g[3],M=S+(P^N&(O^P))+R[0]+3614090360&4294967295;M=P+(O^(S=N+(M<<7&4294967295|M>>>25))&(N^O))+R[1]+3905402710&4294967295,M=O+(N^(P=S+(M<<12&4294967295|M>>>20))&(S^N))+R[2]+606105819&4294967295,M=N+(S^(O=P+(M<<17&4294967295|M>>>15))&(P^S))+R[3]+3250441966&4294967295,M=S+(P^(N=O+(M<<22&4294967295|M>>>10))&(O^P))+R[4]+4118548399&4294967295,M=P+(O^(S=N+(M<<7&4294967295|M>>>25))&(N^O))+R[5]+1200080426&4294967295,M=O+(N^(P=S+(M<<12&4294967295|M>>>20))&(S^N))+R[6]+2821735955&4294967295,M=N+(S^(O=P+(M<<17&4294967295|M>>>15))&(P^S))+R[7]+4249261313&4294967295,M=S+(P^(N=O+(M<<22&4294967295|M>>>10))&(O^P))+R[8]+1770035416&4294967295,M=P+(O^(S=N+(M<<7&4294967295|M>>>25))&(N^O))+R[9]+2336552879&4294967295,M=O+(N^(P=S+(M<<12&4294967295|M>>>20))&(S^N))+R[10]+4294925233&4294967295,M=N+(S^(O=P+(M<<17&4294967295|M>>>15))&(P^S))+R[11]+2304563134&4294967295,M=S+(P^(N=O+(M<<22&4294967295|M>>>10))&(O^P))+R[12]+1804603682&4294967295,M=P+(O^(S=N+(M<<7&4294967295|M>>>25))&(N^O))+R[13]+4254626195&4294967295,M=O+(N^(P=S+(M<<12&4294967295|M>>>20))&(S^N))+R[14]+2792965006&4294967295,M=N+(S^(O=P+(M<<17&4294967295|M>>>15))&(P^S))+R[15]+1236535329&4294967295,N=O+(M<<22&4294967295|M>>>10),M=S+(O^P&(N^O))+R[1]+4129170786&4294967295,S=N+(M<<5&4294967295|M>>>27),M=P+(N^O&(S^N))+R[6]+3225465664&4294967295,P=S+(M<<9&4294967295|M>>>23),M=O+(S^N&(P^S))+R[11]+643717713&4294967295,O=P+(M<<14&4294967295|M>>>18),M=N+(P^S&(O^P))+R[0]+3921069994&4294967295,N=O+(M<<20&4294967295|M>>>12),M=S+(O^P&(N^O))+R[5]+3593408605&4294967295,S=N+(M<<5&4294967295|M>>>27),M=P+(N^O&(S^N))+R[10]+38016083&4294967295,P=S+(M<<9&4294967295|M>>>23),M=O+(S^N&(P^S))+R[15]+3634488961&4294967295,O=P+(M<<14&4294967295|M>>>18),M=N+(P^S&(O^P))+R[4]+3889429448&4294967295,N=O+(M<<20&4294967295|M>>>12),M=S+(O^P&(N^O))+R[9]+568446438&4294967295,S=N+(M<<5&4294967295|M>>>27),M=P+(N^O&(S^N))+R[14]+3275163606&4294967295,P=S+(M<<9&4294967295|M>>>23),M=O+(S^N&(P^S))+R[3]+4107603335&4294967295,O=P+(M<<14&4294967295|M>>>18),M=N+(P^S&(O^P))+R[8]+1163531501&4294967295,N=O+(M<<20&4294967295|M>>>12),M=S+(O^P&(N^O))+R[13]+2850285829&4294967295,S=N+(M<<5&4294967295|M>>>27),M=P+(N^O&(S^N))+R[2]+4243563512&4294967295,P=S+(M<<9&4294967295|M>>>23),M=O+(S^N&(P^S))+R[7]+1735328473&4294967295,O=P+(M<<14&4294967295|M>>>18),M=N+(P^S&(O^P))+R[12]+2368359562&4294967295,M=S+((N=O+(M<<20&4294967295|M>>>12))^O^P)+R[5]+4294588738&4294967295,M=P+((S=N+(M<<4&4294967295|M>>>28))^N^O)+R[8]+2272392833&4294967295,M=O+((P=S+(M<<11&4294967295|M>>>21))^S^N)+R[11]+1839030562&4294967295,M=N+((O=P+(M<<16&4294967295|M>>>16))^P^S)+R[14]+4259657740&4294967295,M=S+((N=O+(M<<23&4294967295|M>>>9))^O^P)+R[1]+2763975236&4294967295,M=P+((S=N+(M<<4&4294967295|M>>>28))^N^O)+R[4]+1272893353&4294967295,M=O+((P=S+(M<<11&4294967295|M>>>21))^S^N)+R[7]+4139469664&4294967295,M=N+((O=P+(M<<16&4294967295|M>>>16))^P^S)+R[10]+3200236656&4294967295,M=S+((N=O+(M<<23&4294967295|M>>>9))^O^P)+R[13]+681279174&4294967295,M=P+((S=N+(M<<4&4294967295|M>>>28))^N^O)+R[0]+3936430074&4294967295,M=O+((P=S+(M<<11&4294967295|M>>>21))^S^N)+R[3]+3572445317&4294967295,M=N+((O=P+(M<<16&4294967295|M>>>16))^P^S)+R[6]+76029189&4294967295,M=S+((N=O+(M<<23&4294967295|M>>>9))^O^P)+R[9]+3654602809&4294967295,M=P+((S=N+(M<<4&4294967295|M>>>28))^N^O)+R[12]+3873151461&4294967295,M=O+((P=S+(M<<11&4294967295|M>>>21))^S^N)+R[15]+530742520&4294967295,M=N+((O=P+(M<<16&4294967295|M>>>16))^P^S)+R[2]+3299628645&4294967295,N=O+(M<<23&4294967295|M>>>9),M=S+(O^(N|~P))+R[0]+4096336452&4294967295,S=N+(M<<6&4294967295|M>>>26),M=P+(N^(S|~O))+R[7]+1126891415&4294967295,P=S+(M<<10&4294967295|M>>>22),M=O+(S^(P|~N))+R[14]+2878612391&4294967295,O=P+(M<<15&4294967295|M>>>17),M=N+(P^(O|~S))+R[5]+4237533241&4294967295,N=O+(M<<21&4294967295|M>>>11),M=S+(O^(N|~P))+R[12]+1700485571&4294967295,S=N+(M<<6&4294967295|M>>>26),M=P+(N^(S|~O))+R[3]+2399980690&4294967295,P=S+(M<<10&4294967295|M>>>22),M=O+(S^(P|~N))+R[10]+4293915773&4294967295,O=P+(M<<15&4294967295|M>>>17),M=N+(P^(O|~S))+R[1]+2240044497&4294967295,N=O+(M<<21&4294967295|M>>>11),M=S+(O^(N|~P))+R[8]+1873313359&4294967295,S=N+(M<<6&4294967295|M>>>26),M=P+(N^(S|~O))+R[15]+4264355552&4294967295,P=S+(M<<10&4294967295|M>>>22),M=O+(S^(P|~N))+R[6]+2734768916&4294967295,O=P+(M<<15&4294967295|M>>>17),M=N+(P^(O|~S))+R[13]+1309151649&4294967295,N=O+(M<<21&4294967295|M>>>11),M=S+(O^(N|~P))+R[4]+4149444226&4294967295,S=N+(M<<6&4294967295|M>>>26),M=P+(N^(S|~O))+R[11]+3174756917&4294967295,P=S+(M<<10&4294967295|M>>>22),M=O+(S^(P|~N))+R[2]+718787259&4294967295,O=P+(M<<15&4294967295|M>>>17),M=N+(P^(O|~S))+R[9]+3951481745&4294967295,T.g[0]=T.g[0]+S&4294967295,T.g[1]=T.g[1]+(O+(M<<21&4294967295|M>>>11))&4294967295,T.g[2]=T.g[2]+O&4294967295,T.g[3]=T.g[3]+P&4294967295}function N(T,S){var N=P;return Object.prototype.hasOwnProperty.call(N,T)?N[T]:N[T]=S(T)}function R(T,S){this.h=S;for(var N=[],R=!0,O=T.length-1;0<=O;O--){var P=0|T[O];R&&P==S||(N[O]=P,R=!1)}this.g=N}(function(T,S){function N(){}N.prototype=S.prototype,T.D=S.prototype,T.prototype=new N,T.prototype.constructor=T,T.C=function(T,N,R){for(var O=Array(arguments.length-2),P=2;P<arguments.length;P++)O[P-2]=arguments[P];return S.prototype[N].apply(T,O)}})(T,function(){this.blockSize=-1}),T.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},T.prototype.u=function(T,N){void 0===N&&(N=T.length);for(var R=N-this.blockSize,O=this.B,P=this.h,M=0;M<N;){if(0==P)for(;M<=R;)S(this,T,M),M+=this.blockSize;if("string"==typeof T){for(;M<N;)if(O[P++]=T.charCodeAt(M++),P==this.blockSize){S(this,O),P=0;break}}else for(;M<N;)if(O[P++]=T[M++],P==this.blockSize){S(this,O),P=0;break}}this.h=P,this.o+=N},T.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var S=1;S<T.length-8;++S)T[S]=0;var N=8*this.o;for(S=T.length-8;S<T.length;++S)T[S]=255&N,N/=256;for(this.u(T),T=Array(16),S=N=0;4>S;++S)for(var R=0;32>R;R+=8)T[N++]=this.g[S]>>>R&255;return T};var O,P={};function M(T){return -128<=T&&128>T?N(T,function(T){return new R([0|T],0>T?-1:0)}):new R([0|T],0>T?-1:0)}function L(T){if(isNaN(T)||!isFinite(T))return U;if(0>T)return ee(L(-T));for(var S=[],N=1,O=0;T>=N;O++)S[O]=T/N|0,N*=4294967296;return new R(S,0)}function V(T,S){if(0==T.length)throw Error("number format error: empty string");if(2>(S=S||10)||36<S)throw Error("radix out of range: "+S);if("-"==T.charAt(0))return ee(V(T.substring(1),S));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=L(Math.pow(S,8)),R=U,O=0;O<T.length;O+=8){var P=Math.min(8,T.length-O),M=parseInt(T.substring(O,O+P),S);8>P?(P=L(Math.pow(S,P)),R=R.j(P).add(L(M))):R=(R=R.j(N)).add(L(M))}return R}var U=M(0),$=M(1),W=M(16777216);function K(T){if(0!=T.h)return!1;for(var S=0;S<T.g.length;S++)if(0!=T.g[S])return!1;return!0}function Z(T){return -1==T.h}function ee(T){for(var S=T.g.length,N=[],O=0;O<S;O++)N[O]=~T.g[O];return new R(N,~T.h).add($)}function et(T,S){return T.add(ee(S))}function er(T,S){for(;(65535&T[S])!=T[S];)T[S+1]+=T[S]>>>16,T[S]&=65535,S++}function ei(T,S){this.g=T,this.h=S}function en(T,S){if(K(S))throw Error("division by zero");if(K(T))return new ei(U,U);if(Z(T))return S=en(ee(T),S),new ei(ee(S.g),ee(S.h));if(Z(S))return S=en(T,ee(S)),new ei(ee(S.g),S.h);if(30<T.g.length){if(Z(T)||Z(S))throw Error("slowDivide_ only works with positive integers.");for(var N=$,R=S;0>=R.l(T);)N=es(N),R=es(R);var O=ea(N,1),P=ea(R,1);for(R=ea(R,2),N=ea(N,2);!K(R);){var M=P.add(R);0>=M.l(T)&&(O=O.add(N),P=M),R=ea(R,1),N=ea(N,1)}return S=et(T,O.j(S)),new ei(O,S)}for(O=U;0<=T.l(S);){for(R=48>=(R=Math.ceil(Math.log(N=Math.max(1,Math.floor(T.m()/S.m())))/Math.LN2))?1:Math.pow(2,R-48),M=(P=L(N)).j(S);Z(M)||0<M.l(T);)N-=R,M=(P=L(N)).j(S);K(P)&&(P=$),O=O.add(P),T=et(T,M)}return new ei(O,T)}function es(T){for(var S=T.g.length+1,N=[],O=0;O<S;O++)N[O]=T.i(O)<<1|T.i(O-1)>>>31;return new R(N,T.h)}function ea(T,S){var N=S>>5;S%=32;for(var O=T.g.length-N,P=[],M=0;M<O;M++)P[M]=0<S?T.i(M+N)>>>S|T.i(M+N+1)<<32-S:T.i(M+N);return new R(P,T.h)}(O=R.prototype).m=function(){if(Z(this))return-ee(this).m();for(var T=0,S=1,N=0;N<this.g.length;N++){var R=this.i(N);T+=(0<=R?R:4294967296+R)*S,S*=4294967296}return T},O.toString=function(T){if(2>(T=T||10)||36<T)throw Error("radix out of range: "+T);if(K(this))return"0";if(Z(this))return"-"+ee(this).toString(T);for(var S=L(Math.pow(T,6)),N=this,R="";;){var O=en(N,S).g,P=((0<(N=et(N,O.j(S))).g.length?N.g[0]:N.h)>>>0).toString(T);if(K(N=O))return P+R;for(;6>P.length;)P="0"+P;R=P+R}},O.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h},O.l=function(T){return Z(T=et(this,T))?-1:K(T)?0:1},O.abs=function(){return Z(this)?ee(this):this},O.add=function(T){for(var S=Math.max(this.g.length,T.g.length),N=[],O=0,P=0;P<=S;P++){var M=O+(65535&this.i(P))+(65535&T.i(P)),L=(M>>>16)+(this.i(P)>>>16)+(T.i(P)>>>16);O=L>>>16,M&=65535,L&=65535,N[P]=L<<16|M}return new R(N,-2147483648&N[N.length-1]?-1:0)},O.j=function(T){if(K(this)||K(T))return U;if(Z(this))return Z(T)?ee(this).j(ee(T)):ee(ee(this).j(T));if(Z(T))return ee(this.j(ee(T)));if(0>this.l(W)&&0>T.l(W))return L(this.m()*T.m());for(var S=this.g.length+T.g.length,N=[],O=0;O<2*S;O++)N[O]=0;for(O=0;O<this.g.length;O++)for(var P=0;P<T.g.length;P++){var M=this.i(O)>>>16,V=65535&this.i(O),$=T.i(P)>>>16,Q=65535&T.i(P);N[2*O+2*P]+=V*Q,er(N,2*O+2*P),N[2*O+2*P+1]+=M*Q,er(N,2*O+2*P+1),N[2*O+2*P+1]+=V*$,er(N,2*O+2*P+1),N[2*O+2*P+2]+=M*$,er(N,2*O+2*P+2)}for(O=0;O<S;O++)N[O]=N[2*O+1]<<16|N[2*O];for(O=S;O<2*S;O++)N[O]=0;return new R(N,0)},O.A=function(T){return en(this,T).h},O.and=function(T){for(var S=Math.max(this.g.length,T.g.length),N=[],O=0;O<S;O++)N[O]=this.i(O)&T.i(O);return new R(N,this.h&T.h)},O.or=function(T){for(var S=Math.max(this.g.length,T.g.length),N=[],O=0;O<S;O++)N[O]=this.i(O)|T.i(O);return new R(N,this.h|T.h)},O.xor=function(T){for(var S=Math.max(this.g.length,T.g.length),N=[],O=0;O<S;O++)N[O]=this.i(O)^T.i(O);return new R(N,this.h^T.h)},T.prototype.digest=T.prototype.v,T.prototype.reset=T.prototype.s,T.prototype.update=T.prototype.u,Y=c_.Md5=T,R.prototype.add=R.prototype.add,R.prototype.multiply=R.prototype.j,R.prototype.modulo=R.prototype.A,R.prototype.compare=R.prototype.l,R.prototype.toNumber=R.prototype.m,R.prototype.toString=R.prototype.toString,R.prototype.getBits=R.prototype.i,R.fromNumber=L,R.fromString=V,Q=c_.Integer=R}).apply(void 0!==cC?cC:"undefined"!=typeof self?self:{});var cI=N(2165),ck=N(8715);let cN="@firebase/firestore",cA="4.7.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(T){this.uid=T}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(T){return T.uid===this.uid}}cR.UNAUTHENTICATED=new cR(null),cR.GOOGLE_CREDENTIALS=new cR("google-credentials-uid"),cR.FIRST_PARTY=new cR("first-party-uid"),cR.MOCK_USER=new cR("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cD="10.14.0";function cO(T){cD=T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(T){return(0,cx.inspect)(T,{depth:100})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cM=new uk("@firebase/firestore");function cL(){return cM.logLevel}function cj(T,...S){if(cM.logLevel<=K.DEBUG){let N=S.map(cV);cM.debug(`Firestore (${cD}): ${T}`,...N)}}function cF(T,...S){if(cM.logLevel<=K.ERROR){let N=S.map(cV);cM.error(`Firestore (${cD}): ${T}`,...N)}}function cB(T,...S){if(cM.logLevel<=K.WARN){let N=S.map(cV);cM.warn(`Firestore (${cD}): ${T}`,...N)}}function cV(T){if("string"==typeof T)return T;try{return cP(T)}catch(S){return T}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cU(T="Unexpected state"){let S=`FIRESTORE (${cD}) INTERNAL ASSERTION FAILED: `+T;throw cF(S),Error(S)}function cz(T,S){T||cU()}function cq(T,S){return T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c$={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class cH extends l9{constructor(T,S){super(T,S),this.code=T,this.message=S,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cG{constructor(){this.promise=new Promise((T,S)=>{this.resolve=T,this.reject=S})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cW{constructor(T,S){this.user=S,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${T}`)}}class cK{getToken(){return Promise.resolve(null)}invalidateToken(){}start(T,S){T.enqueueRetryable(()=>S(cR.UNAUTHENTICATED))}shutdown(){}}class cQ{constructor(T){this.authProvider=T,this.currentUser=cR.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(T,S){cz(void 0===this.tokenListener);let N=this.tokenCounter,R=T=>this.tokenCounter!==N?(N=this.tokenCounter,S(T)):Promise.resolve(),O=new cG;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),O.resolve(),O=new cG,T.enqueueRetryable(()=>R(this.currentUser))};let P=()=>{let S=O;T.enqueueRetryable(async()=>{await S.promise,await R(this.currentUser)})},M=T=>{cj("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=T,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),P())};this.authProvider.onInit(T=>M(T)),setTimeout(()=>{if(!this.auth){let T=this.authProvider.getImmediate({optional:!0});T?M(T):(cj("FirebaseAuthCredentialsProvider","Auth not yet detected"),O.resolve(),O=new cG)}},0),P()}getToken(){let T=this.tokenCounter,S=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(S).then(S=>this.tokenCounter!==T?(cj("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):S?(cz("string"==typeof S.accessToken),new cW(S.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let T=this.auth&&this.auth.getUid();return cz(null===T||"string"==typeof T),new cR(T)}}class cY{constructor(T,S,N){this.sessionIndex=T,this.iamToken=S,this.authTokenFactory=N,this.type="FirstParty",this.user=cR.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let T=this.getAuthToken();return T&&this._headers.set("Authorization",T),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class cJ{constructor(T,S,N){this.sessionIndex=T,this.iamToken=S,this.authTokenFactory=N}getToken(){return Promise.resolve(new cY(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(T,S){T.enqueueRetryable(()=>S(cR.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cX{constructor(T){this.value=T,this.type="AppCheck",this.headers=new Map,T&&T.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cZ{constructor(T){this.appCheckProvider=T,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(T,S){cz(void 0===this.tokenListener);let N=T=>{null!=T.error&&cj("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${T.error.message}`);let N=T.token!==this.latestAppCheckToken;return this.latestAppCheckToken=T.token,cj("FirebaseAppCheckTokenProvider",`Received ${N?"new":"existing"} token.`),N?S(T.token):Promise.resolve()};this.tokenListener=S=>{T.enqueueRetryable(()=>N(S))};let R=T=>{cj("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=T,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(T=>R(T)),setTimeout(()=>{if(!this.appCheck){let T=this.appCheckProvider.getImmediate({optional:!0});T?R(T):cj("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let T=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(T).then(T=>T?(cz("string"==typeof T.token),this.latestAppCheckToken=T.token,new cX(T.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function c0(T){if(!T)return new cK;switch(T.type){case"firstParty":return new cJ(T.sessionIndex||"0",T.iamToken||null,T.authTokenFactory||null);case"provider":return T.client;default:throw new cH(c$.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(T){return(0,cE.randomBytes)(T)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{static newId(){let T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",S=Math.floor(256/T.length)*T.length,N="",R=20;for(;N.length<R;){let O=c4(40);for(let P=0;P<O.length;++P)N.length<R&&O[P]<S&&(N+=T.charAt(O[P]%T.length))}return N}}function c5(T,S){return T<S?-1:T>S?1:0}function c9(T,S,N){return T.length===S.length&&T.every((T,R)=>N(T,S[R]))}function c8(T){return T+"\x00"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c7=-62135596800,de=1e6;class dt{constructor(T,S){if(this.seconds=T,this.nanoseconds=S,S<0||S>=1e9)throw new cH(c$.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+S);if(T<c7||T>=253402300800)throw new cH(c$.INVALID_ARGUMENT,"Timestamp seconds out of range: "+T)}static now(){return dt.fromMillis(Date.now())}static fromDate(T){return dt.fromMillis(T.getTime())}static fromMillis(T){let S=Math.floor(T/1e3),N=Math.floor((T-1e3*S)*de);return new dt(S,N)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/de}_compareTo(T){return this.seconds===T.seconds?c5(this.nanoseconds,T.nanoseconds):c5(this.seconds,T.seconds)}isEqual(T){return T.seconds===this.seconds&&T.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds-c7).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(T){this.timestamp=T}static fromTimestamp(T){return new dr(T)}static min(){return new dr(new dt(0,0))}static max(){return new dr(new dt(253402300799,1e9-1))}compareTo(T){return this.timestamp._compareTo(T.timestamp)}isEqual(T){return this.timestamp.isEqual(T.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let di="__name__";class dn{constructor(T,S,N){void 0===S?S=0:S>T.length&&cU(),void 0===N?N=T.length-S:N>T.length-S&&cU(),this.segments=T,this.offset=S,this.len=N}get length(){return this.len}isEqual(T){return 0===dn.comparator(this,T)}child(T){let S=this.segments.slice(this.offset,this.limit());return T instanceof dn?T.forEach(T=>{S.push(T)}):S.push(T),this.construct(S)}limit(){return this.offset+this.length}popFirst(T){return T=void 0===T?1:T,this.construct(this.segments,this.offset+T,this.length-T)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(T){return this.segments[this.offset+T]}isEmpty(){return 0===this.length}isPrefixOf(T){if(T.length<this.length)return!1;for(let S=0;S<this.length;S++)if(this.get(S)!==T.get(S))return!1;return!0}isImmediateParentOf(T){if(this.length+1!==T.length)return!1;for(let S=0;S<this.length;S++)if(this.get(S)!==T.get(S))return!1;return!0}forEach(T){for(let S=this.offset,N=this.limit();S<N;S++)T(this.segments[S])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(T,S){let N=Math.min(T.length,S.length);for(let R=0;R<N;R++){let N=T.get(R),O=S.get(R);if(N<O)return -1;if(N>O)return 1}return T.length<S.length?-1:T.length>S.length?1:0}}class ds extends dn{construct(T,S,N){return new ds(T,S,N)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...T){let S=[];for(let N of T){if(N.indexOf("//")>=0)throw new cH(c$.INVALID_ARGUMENT,`Invalid segment (${N}). Paths must not contain // in them.`);S.push(...N.split("/").filter(T=>T.length>0))}return new ds(S)}static emptyPath(){return new ds([])}}let da=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dl extends dn{construct(T,S,N){return new dl(T,S,N)}static isValidIdentifier(T){return da.test(T)}canonicalString(){return this.toArray().map(T=>(T=T.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dl.isValidIdentifier(T)||(T="`"+T+"`"),T)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===di}static keyField(){return new dl([di])}static fromServerFormat(T){let S=[],N="",R=0,O=()=>{if(0===N.length)throw new cH(c$.INVALID_ARGUMENT,`Invalid field path (${T}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);S.push(N),N=""},P=!1;for(;R<T.length;){let S=T[R];if("\\"===S){if(R+1===T.length)throw new cH(c$.INVALID_ARGUMENT,"Path has trailing escape character: "+T);let S=T[R+1];if(!("\\"===S||"."===S||"`"===S))throw new cH(c$.INVALID_ARGUMENT,"Path has invalid escape sequence: "+T);N+=S,R+=2}else"`"===S?P=!P:"."!==S||P?N+=S:O(),R++}if(O(),P)throw new cH(c$.INVALID_ARGUMENT,"Unterminated ` in path: "+T);return new dl(S)}static emptyPath(){return new dl([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(T){this.path=T}static fromPath(T){return new du(ds.fromString(T))}static fromName(T){return new du(ds.fromString(T).popFirst(5))}static empty(){return new du(ds.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(T){return this.path.length>=2&&this.path.get(this.path.length-2)===T}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(T){return null!==T&&0===ds.comparator(this.path,T.path)}toString(){return this.path.toString()}static comparator(T,S){return ds.comparator(T.path,S.path)}static isDocumentKey(T){return T.length%2==0}static fromSegments(T){return new du(new ds(T.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dc=-1,dd=0;class dh{constructor(T,S,N,R){this.indexId=T,this.collectionGroup=S,this.fields=N,this.indexState=R}}function dp(T){return T.fields.find(T=>2===T.kind)}function df(T){return T.fields.filter(T=>2!==T.kind)}function dm(T){let S=df(T);return 0===S.length?0:S[S.length-1].kind}function dg(T,S){let N=c5(T.collectionGroup,S.collectionGroup);if(0!==N)return N;for(let R=0;R<Math.min(T.fields.length,S.fields.length);++R)if(0!==(N=dT(T.fields[R],S.fields[R])))return N;return c5(T.fields.length,S.fields.length)}function dy(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}dh.UNKNOWN_ID=-1;class dw{constructor(T,S){this.fieldPath=T,this.kind=S}}function dT(T,S){let N=dl.comparator(T.fieldPath,S.fieldPath);return 0!==N?N:c5(T.kind,S.kind)}class dS{constructor(T,S){this.sequenceNumber=T,this.offset=S}static empty(){return new dS(dd,dC.min())}}function dx(T,S){let N=T.toTimestamp().seconds,R=T.toTimestamp().nanoseconds+1;return new dC(dr.fromTimestamp(1e9===R?new dt(N+1,0):new dt(N,R)),du.empty(),S)}function dE(T){return new dC(T.readTime,T.key,dc)}class dC{constructor(T,S,N){this.readTime=T,this.documentKey=S,this.largestBatchId=N}static min(){return new dC(dr.min(),du.empty(),dc)}static max(){return new dC(dr.max(),du.empty(),dc)}}function d_(T,S){let N=T.readTime.compareTo(S.readTime);return 0!==N||0!==(N=du.comparator(T.documentKey,S.documentKey))?N:c5(T.largestBatchId,S.largestBatchId)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(T){this.onCommittedListeners.push(T)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(T=>T())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dN(T){if(T.code===c$.FAILED_PRECONDITION&&T.message===dI)cj("LocalStore","Unexpectedly lost primary lease");else throw T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(T){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,T(T=>{this.isDone=!0,this.result=T,this.nextCallback&&this.nextCallback(T)},T=>{this.isDone=!0,this.error=T,this.catchCallback&&this.catchCallback(T)})}catch(T){return this.next(void 0,T)}next(T,S){return(this.callbackAttached&&cU(),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(S,this.error):this.wrapSuccess(T,this.result):new dA((N,R)=>{this.nextCallback=S=>{this.wrapSuccess(T,S).next(N,R)},this.catchCallback=T=>{this.wrapFailure(S,T).next(N,R)}})}toPromise(){return new Promise((T,S)=>{this.next(T,S)})}wrapUserFunction(T){try{let S=T();if(S instanceof dA)return S;return dA.resolve(S)}catch(T){return dA.reject(T)}}wrapSuccess(T,S){return T?this.wrapUserFunction(()=>T(S)):dA.resolve(S)}wrapFailure(T,S){return T?this.wrapUserFunction(()=>T(S)):dA.reject(S)}static resolve(T){return new dA((S,N)=>{S(T)})}static reject(T){return new dA((S,N)=>{N(T)})}static waitFor(T){return new dA((S,N)=>{let R=0,O=0,P=!1;T.forEach(T=>{++R,T.next(()=>{++O,P&&O===R&&S()},T=>N(T))}),P=!0,O===R&&S()})}static or(T){let S=dA.resolve(!1);for(let N of T)S=S.next(T=>T?dA.resolve(T):N());return S}static forEach(T,S){let N=[];return T.forEach((T,R)=>{N.push(S.call(this,T,R))}),this.waitFor(N)}static mapArray(T,S){return new dA((N,R)=>{let O=T.length,P=Array(O),M=0;for(let L=0;L<O;L++){let V=L;S(T[V]).next(T=>{P[V]=T,++M===O&&N(P)},T=>R(T))}})}static doWhile(T,S){return new dA((N,R)=>{let O=()=>{!0===T()?S().next(()=>{O()},R):N()};O()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dR="SimpleDb",dD=3;class dO{constructor(T,S){this.action=T,this.transaction=S,this.aborted=!1,this.completionDeferred=new cG,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{S.error?this.completionDeferred.reject(new dj(T,S.error)):this.completionDeferred.resolve()},this.transaction.onerror=S=>{let N=dz(S.target.error);this.completionDeferred.reject(new dj(T,N))}}static open(T,S,N,R){try{return new dO(S,T.transaction(R,N))}catch(T){throw new dj(S,T)}}get completionPromise(){return this.completionDeferred.promise}abort(T){T&&this.completionDeferred.reject(T),this.aborted||(cj(dR,"Aborting transaction:",T?T.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let T=this.transaction;this.aborted||"function"!=typeof T.commit||T.commit()}store(T){return new dB(this.transaction.objectStore(T))}}class dP{constructor(T,S,N){this.name=T,this.version=S,this.schemaConverter=N,12.2===dP.getIOSVersion(getUA())&&cF("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(T){return cj(dR,"Removing database:",T),dV(window.indexedDB.deleteDatabase(T)).toPromise()}static isAvailable(){if(!isIndexedDBAvailable())return!1;if(dP.isMockPersistence())return!0;let T=getUA(),S=dP.getIOSVersion(T),N=0<S&&S<10,R=dM(T),O=0<R&&R<4.5;return!(T.indexOf("MSIE ")>0||T.indexOf("Trident/")>0||T.indexOf("Edge/")>0)&&!N&&!O}static isMockPersistence(){var T;return"undefined"!=typeof process&&(null===(T=process.env)||void 0===T?void 0:T.USE_MOCK_PERSISTENCE)==="YES"}static getStore(T,S){return T.store(S)}static getIOSVersion(T){let S=T.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(S?S[1].split("_").slice(0,2).join("."):"-1")}async ensureDb(T){return this.db||(cj(dR,"Opening database:",this.name),this.db=await new Promise((S,N)=>{let R=indexedDB.open(this.name,this.version);R.onsuccess=T=>{S(T.target.result)},R.onblocked=()=>{N(new dj(T,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},R.onerror=S=>{let R=S.target.error;"VersionError"===R.name?N(new cH(c$.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===R.name?N(new cH(c$.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+R)):N(new dj(T,R))},R.onupgradeneeded=T=>{cj(dR,'Database "'+this.name+'" requires upgrade from version:',T.oldVersion);let S=T.target.result;this.schemaConverter.createOrUpgrade(S,R.transaction,T.oldVersion,this.version).next(()=>{cj(dR,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=T=>this.versionchangelistener(T)),this.db}setVersionChangeListener(T){this.versionchangelistener=T,this.db&&(this.db.onversionchange=S=>T(S))}async runTransaction(T,S,N,R){let O="readonly"===S,P=0;for(;;){++P;try{this.db=await this.ensureDb(T);let S=dO.open(this.db,T,O?"readonly":"readwrite",N),P=R(S).next(T=>(S.maybeCommit(),T)).catch(T=>(S.abort(T),dA.reject(T))).toPromise();return P.catch(()=>{}),await S.completionPromise,P}catch(N){let T=N,S="FirebaseError"!==T.name&&P<dD;if(cj(dR,"Transaction failed with error:",T.message,"Retrying:",S),this.close(),!S)return Promise.reject(T)}}}close(){this.db&&this.db.close(),this.db=void 0}}function dM(T){let S=T.match(/Android ([\d.]+)/i);return Number(S?S[1].split(".").slice(0,2).join("."):"-1")}class dL{constructor(T){this.dbCursor=T,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(T){this.dbCursor=T}done(){this.shouldStop=!0}skip(T){this.nextKey=T}delete(){return dV(this.dbCursor.delete())}}class dj extends null{constructor(T,S){super(c$.UNAVAILABLE,`IndexedDB transaction '${T}' failed: ${S}`),this.name="IndexedDbTransactionError"}}function dF(T){return"IndexedDbTransactionError"===T.name}class dB{constructor(T){this.store=T}put(T,S){let N;return void 0!==S?(cj(dR,"PUT",this.store.name,T,S),N=this.store.put(S,T)):(cj(dR,"PUT",this.store.name,"<auto-key>",T),N=this.store.put(T)),dV(N)}add(T){return cj(dR,"ADD",this.store.name,T,T),dV(this.store.add(T))}get(T){return dV(this.store.get(T)).next(S=>(void 0===S&&(S=null),cj(dR,"GET",this.store.name,T,S),S))}delete(T){return cj(dR,"DELETE",this.store.name,T),dV(this.store.delete(T))}count(){return cj(dR,"COUNT",this.store.name),dV(this.store.count())}loadAll(T,S){let N=this.options(T,S),R=N.index?this.store.index(N.index):this.store;if("function"==typeof R.getAll){let T=R.getAll(N.range);return new dA((S,N)=>{T.onerror=T=>{N(T.target.error)},T.onsuccess=T=>{S(T.target.result)}})}{let T=this.cursor(N),S=[];return this.iterateCursor(T,(T,N)=>{S.push(N)}).next(()=>S)}}loadFirst(T,S){let N=this.store.getAll(T,null===S?void 0:S);return new dA((T,S)=>{N.onerror=T=>{S(T.target.error)},N.onsuccess=S=>{T(S.target.result)}})}deleteAll(T,S){cj(dR,"DELETE ALL",this.store.name);let N=this.options(T,S);N.keysOnly=!1;let R=this.cursor(N);return this.iterateCursor(R,(T,S,N)=>N.delete())}iterate(T,S){let N;S?N=T:(N={},S=T);let R=this.cursor(N);return this.iterateCursor(R,S)}iterateSerial(T){let S=this.cursor({});return new dA((N,R)=>{S.onerror=T=>{R(dz(T.target.error))},S.onsuccess=S=>{let R=S.target.result;if(!R){N();return}T(R.primaryKey,R.value).next(T=>{T?R.continue():N()})}})}iterateCursor(T,S){let N=[];return new dA((R,O)=>{T.onerror=T=>{O(T.target.error)},T.onsuccess=T=>{let O=T.target.result;if(!O){R();return}let P=new dL(O),M=S(O.primaryKey,O.value,P);if(M instanceof dA){let T=M.catch(T=>(P.done(),dA.reject(T)));N.push(T)}P.isDone?R():null===P.skipToKey?O.continue():O.continue(P.skipToKey)}}).next(()=>dA.waitFor(N))}options(T,S){let N;return void 0!==T&&("string"==typeof T?N=T:S=T),{index:N,range:S}}cursor(T){let S="next";if(T.reverse&&(S="prev"),!T.index)return this.store.openCursor(T.range,S);{let N=this.store.index(T.index);return T.keysOnly?N.openKeyCursor(T.range,S):N.openCursor(T.range,S)}}}function dV(T){return new dA((S,N)=>{T.onsuccess=T=>{S(T.target.result)},T.onerror=T=>{N(dz(T.target.error))}})}let dU=!1;function dz(T){let S=dP.getIOSVersion(getUA());if(S>=12.2&&S<13){let S="An internal error was encountered in the Indexed Database server";if(T.message.indexOf(S)>=0){let T=new cH("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${S}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dU||(dU=!0,setTimeout(()=>{throw T},0)),T}}return T}let dq="IndexBackfiller",d$=null,dH=null,dG=50;class dW{constructor(T,S){this.asyncQueue=T,this.backfiller=S,this.task=null}start(){this.schedule(d$)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(T){cj(dq,`Scheduled in ${T}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",T,async()=>{this.task=null;try{let T=await this.backfiller.backfill();cj(dq,`Documents written: ${T}`)}catch(T){dF(T)?cj(dq,"Ignoring IndexedDB error during index backfill: ",T):await dN(T)}await this.schedule(dH)})}}class dK{constructor(T,S){this.localStore=T,this.persistence=S}async backfill(T=dG){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",S=>this.writeIndexEntries(S,T))}writeIndexEntries(T,S){let N=new Set,R=S,O=!0;return dA.doWhile(()=>!0===O&&R>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(T).next(S=>{if(!(null===S||N.has(S)))return cj(dq,`Processing collection: ${S}`),this.writeEntriesForCollectionGroup(T,S,R).next(T=>{R-=T,N.add(S)});O=!1})).next(()=>S-R)}writeEntriesForCollectionGroup(T,S,N){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(T,S).next(R=>this.localStore.localDocuments.getNextDocuments(T,S,R,N).next(N=>{let O=N.changes;return this.localStore.indexManager.updateIndexEntries(T,O).next(()=>this.getNewOffset(R,N)).next(N=>(cj(dq,`Updating offset: ${N}`),this.localStore.indexManager.updateCollectionGroup(T,S,N))).next(()=>O.size)}))}getNewOffset(T,S){let N=T;return S.changes.forEach((T,S)=>{let R=dE(S);d_(R,N)>0&&(N=R)}),new dC(N.readTime,N.documentKey,Math.max(S.batchId,T.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dQ{constructor(T,S){this.previousValue=T,S&&(S.sequenceNumberHandler=T=>this.setPreviousValue(T),this.writeNewSequenceNumber=T=>S.writeSequenceNumber(T))}setPreviousValue(T){return this.previousValue=Math.max(T,this.previousValue),this.previousValue}next(){let T=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(T),T}}dQ.INVALID=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dY="\x01",dJ="\x01",dX="\x10",dZ="\x11";function d0(T){let S="";for(let N=0;N<T.length;N++)S.length>0&&(S=d4(S)),S=d3(T.get(N),S);return d4(S)}function d3(T,S){let N=S,R=T.length;for(let S=0;S<R;S++){let R=T.charAt(S);switch(R){case"\x00":N+=dY+dX;break;case dY:N+=dY+dZ;break;default:N+=R}}return N}function d4(T){return T+dY+dJ}function d6(T){let S=T.length;if(cz(S>=2),2===S)return cz(T.charAt(0)===dY&&T.charAt(1)===dJ),ds.emptyPath();let N=S-2,R=[],O="";for(let P=0;P<S;){let S=T.indexOf(dY,P);switch((S<0||S>N)&&cU(),T.charAt(S+1)){case dJ:let M;let L=T.substring(P,S);0===O.length?M=L:(O+=L,M=O,O=""),R.push(M);break;case dX:O+=T.substring(P,S)+"\x00";break;case dZ:O+=T.substring(P,S+1);break;default:cU()}P=S+2}return new ds(R)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d5="remoteDocuments",d9="owner",d8="owner",d7="mutationQueues",he="userId",ht="mutations",hr="batchId",hn="userMutationsIndex",hs=null;function ha(T){return[T]}function ho(T,S){return[T,d0(S)]}function hl(T,S,N){return[T,d0(S),N]}let hu={},hc="documentMutations",hd="remoteDocumentsV14",hh=null,hp="documentKeyIndex",hf=null,hm="collectionGroupIndex",hg=null,hy="remoteDocumentGlobal",hv="remoteDocumentGlobalKey",hw="targets",hT="targetId",hS="queryTargetsIndex",hx=null,hE="targetDocuments",hC=null,h_="documentTargetsIndex",hI=null,hk="targetGlobalKey",hN="targetGlobal",hA="collectionParents",hR=null,hD="clientMetadata",hO="clientId",hP="bundles",hM="bundleId",hL="namedQueries",hj="name",hF="indexConfiguration",hB="indexId",hV="collectionGroupIndex",hU="collectionGroup",hz="indexState",hq=null,h$="sequenceNumberIndex",hH=null,hG="indexEntries",hW=null,hK="documentKeyIndex",hQ=null,hY="documentOverlays",hJ=null,hX="collectionPathOverlayIndex",hZ=null,h0="collectionGroupOverlayIndex",h1=null,h2="globals",h3="name",h4=[d7,ht,hc,d5,hw,d9,hN,hE,hD,hy,hA,hP,hL],h6=[...h4,hY],h5=[d7,ht,hc,hd,hw,d9,hN,hE,hD,hy,hA,hP,hL,hY],h9=h5,h8=[...h9,hF,hz,hG],h7=null,pe=[...h8,h2];function pt(T){return 17===T?pe:16===T?h7:15===T?h8:14===T?h9:13===T?h5:12===T?h6:11===T?h4:void cU()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends null{constructor(T,S){super(),this.simpleDbTransaction=T,this.currentSequenceNumber=S}}function pi(T,S){let N=cq(T);return dP.getStore(N.simpleDbTransaction,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(T){let S=0;for(let N in T)Object.prototype.hasOwnProperty.call(T,N)&&S++;return S}function ps(T,S){for(let N in T)Object.prototype.hasOwnProperty.call(T,N)&&S(N,T[N])}function pa(T){for(let S in T)if(Object.prototype.hasOwnProperty.call(T,S))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(T,S){this.comparator=T,this.root=S||pu.EMPTY}insert(T,S){return new po(this.comparator,this.root.insert(T,S,this.comparator).copy(null,null,pu.BLACK,null,null))}remove(T){return new po(this.comparator,this.root.remove(T,this.comparator).copy(null,null,pu.BLACK,null,null))}get(T){let S=this.root;for(;!S.isEmpty();){let N=this.comparator(T,S.key);if(0===N)return S.value;N<0?S=S.left:N>0&&(S=S.right)}return null}indexOf(T){let S=0,N=this.root;for(;!N.isEmpty();){let R=this.comparator(T,N.key);if(0===R)return S+N.left.size;R<0?N=N.left:(S+=N.left.size+1,N=N.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(T){return this.root.inorderTraversal(T)}forEach(T){this.inorderTraversal((S,N)=>(T(S,N),!1))}toString(){let T=[];return this.inorderTraversal((S,N)=>(T.push(`${S}:${N}`),!1)),`{${T.join(", ")}}`}reverseTraversal(T){return this.root.reverseTraversal(T)}getIterator(){return new pl(this.root,null,this.comparator,!1)}getIteratorFrom(T){return new pl(this.root,T,this.comparator,!1)}getReverseIterator(){return new pl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(T){return new pl(this.root,T,this.comparator,!0)}}class pl{constructor(T,S,N,R){this.isReverse=R,this.nodeStack=[];let O=1;for(;!T.isEmpty();)if(O=S?N(T.key,S):1,S&&R&&(O*=-1),O<0)T=this.isReverse?T.left:T.right;else if(0===O){this.nodeStack.push(T);break}else this.nodeStack.push(T),T=this.isReverse?T.right:T.left}getNext(){let T=this.nodeStack.pop(),S={key:T.key,value:T.value};if(this.isReverse)for(T=T.left;!T.isEmpty();)this.nodeStack.push(T),T=T.right;else for(T=T.right;!T.isEmpty();)this.nodeStack.push(T),T=T.left;return S}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let T=this.nodeStack[this.nodeStack.length-1];return{key:T.key,value:T.value}}}class pu{constructor(T,S,N,R,O){this.key=T,this.value=S,this.color=null!=N?N:pu.RED,this.left=null!=R?R:pu.EMPTY,this.right=null!=O?O:pu.EMPTY,this.size=this.left.size+1+this.right.size}copy(T,S,N,R,O){return new pu(null!=T?T:this.key,null!=S?S:this.value,null!=N?N:this.color,null!=R?R:this.left,null!=O?O:this.right)}isEmpty(){return!1}inorderTraversal(T){return this.left.inorderTraversal(T)||T(this.key,this.value)||this.right.inorderTraversal(T)}reverseTraversal(T){return this.right.reverseTraversal(T)||T(this.key,this.value)||this.left.reverseTraversal(T)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(T,S,N){let R=this,O=N(T,R.key);return(R=O<0?R.copy(null,null,null,R.left.insert(T,S,N),null):0===O?R.copy(null,S,null,null,null):R.copy(null,null,null,null,R.right.insert(T,S,N))).fixUp()}removeMin(){if(this.left.isEmpty())return pu.EMPTY;let T=this;return T.left.isRed()||T.left.left.isRed()||(T=T.moveRedLeft()),(T=T.copy(null,null,null,T.left.removeMin(),null)).fixUp()}remove(T,S){let N;let R=this;if(0>S(T,R.key))R.left.isEmpty()||R.left.isRed()||R.left.left.isRed()||(R=R.moveRedLeft()),R=R.copy(null,null,null,R.left.remove(T,S),null);else{if(R.left.isRed()&&(R=R.rotateRight()),R.right.isEmpty()||R.right.isRed()||R.right.left.isRed()||(R=R.moveRedRight()),0===S(T,R.key)){if(R.right.isEmpty())return pu.EMPTY;N=R.right.min(),R=R.copy(N.key,N.value,null,null,R.right.removeMin())}R=R.copy(null,null,null,null,R.right.remove(T,S))}return R.fixUp()}isRed(){return this.color}fixUp(){let T=this;return T.right.isRed()&&!T.left.isRed()&&(T=T.rotateLeft()),T.left.isRed()&&T.left.left.isRed()&&(T=T.rotateRight()),T.left.isRed()&&T.right.isRed()&&(T=T.colorFlip()),T}moveRedLeft(){let T=this.colorFlip();return T.right.left.isRed()&&(T=(T=(T=T.copy(null,null,null,null,T.right.rotateRight())).rotateLeft()).colorFlip()),T}moveRedRight(){let T=this.colorFlip();return T.left.left.isRed()&&(T=(T=T.rotateRight()).colorFlip()),T}rotateLeft(){let T=this.copy(null,null,pu.RED,null,this.right.left);return this.right.copy(null,null,this.color,T,null)}rotateRight(){let T=this.copy(null,null,pu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,T)}colorFlip(){let T=this.left.copy(null,null,!this.left.color,null,null),S=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,T,S)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw cU();let T=this.left.check();if(T===this.right.check())return T+(this.isRed()?0:1);throw cU()}}pu.EMPTY=null,pu.RED=!0,pu.BLACK=!1;class pc{constructor(){this.size=0}get key(){throw cU()}get value(){throw cU()}get color(){throw cU()}get left(){throw cU()}get right(){throw cU()}copy(T,S,N,R,O){return this}insert(T,S,N){return new pu(T,S)}remove(T,S){return this}isEmpty(){return!0}inorderTraversal(T){return!1}reverseTraversal(T){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}pu.EMPTY=new pc;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(T){this.comparator=T,this.data=new po(this.comparator)}has(T){return null!==this.data.get(T)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(T){return this.data.indexOf(T)}forEach(T){this.data.inorderTraversal((S,N)=>(T(S),!1))}forEachInRange(T,S){let N=this.data.getIteratorFrom(T[0]);for(;N.hasNext();){let R=N.getNext();if(this.comparator(R.key,T[1])>=0)return;S(R.key)}}forEachWhile(T,S){let N;for(N=void 0!==S?this.data.getIteratorFrom(S):this.data.getIterator();N.hasNext();)if(!T(N.getNext().key))return}firstAfterOrEqual(T){let S=this.data.getIteratorFrom(T);return S.hasNext()?S.getNext().key:null}getIterator(){return new ph(this.data.getIterator())}getIteratorFrom(T){return new ph(this.data.getIteratorFrom(T))}add(T){return this.copy(this.data.remove(T).insert(T,!0))}delete(T){return this.has(T)?this.copy(this.data.remove(T)):this}isEmpty(){return this.data.isEmpty()}unionWith(T){let S=this;return S.size<T.size&&(S=T,T=this),T.forEach(T=>{S=S.add(T)}),S}isEqual(T){if(!(T instanceof pd)||this.size!==T.size)return!1;let S=this.data.getIterator(),N=T.data.getIterator();for(;S.hasNext();){let T=S.getNext().key,R=N.getNext().key;if(0!==this.comparator(T,R))return!1}return!0}toArray(){let T=[];return this.forEach(S=>{T.push(S)}),T}toString(){let T=[];return this.forEach(S=>T.push(S)),"SortedSet("+T.toString()+")"}copy(T){let S=new pd(this.comparator);return S.data=T,S}}class ph{constructor(T){this.iter=T}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function pp(T,S,N,R,O){let P=T.getIterator(),M=S.getIterator(),L=pf(P),V=pf(M);for(;L||V;){let T=!1,S=!1;if(L&&V){let R=N(L,V);R<0?S=!0:R>0&&(T=!0)}else null!=L?S=!0:T=!0;T?(R(V),V=pf(M)):S?(O(L),L=pf(P)):(L=pf(P),V=pf(M))}}function pf(T){return T.hasNext()?T.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(T){this.fields=T,T.sort(dl.comparator)}static empty(){return new pm([])}unionWith(T){let S=new pd(dl.comparator);for(let T of this.fields)S=S.add(T);for(let N of T)S=S.add(N);return new pm(S.toArray())}covers(T){for(let S of this.fields)if(S.isPrefixOf(T))return!0;return!1}isEqual(T){return c9(this.fields,T.fields,(T,S)=>T.isEqual(S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(T){return Buffer.from(T,"base64").toString("binary")}function py(T){return Buffer.from(T,"binary").toString("base64")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(T){this.binaryString=T}static fromBase64String(T){return new pv(pg(T))}static fromUint8Array(T){return new pv(pb(T))}[Symbol.iterator](){let T=0;return{next:()=>T<this.binaryString.length?{value:this.binaryString.charCodeAt(T++),done:!1}:{value:void 0,done:!0}}}toBase64(){return py(this.binaryString)}toUint8Array(){return pw(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(T){return c5(this.binaryString,T.binaryString)}isEqual(T){return this.binaryString===T.binaryString}}function pb(T){let S="";for(let N=0;N<T.length;++N)S+=String.fromCharCode(T[N]);return S}function pw(T){let S=new Uint8Array(T.length);for(let N=0;N<T.length;N++)S[N]=T.charCodeAt(N);return S}pv.EMPTY_BYTE_STRING=new pv("");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pS(T){if(cz(!!T),"string"==typeof T){let S=0,N=pT.exec(T);if(cz(!!N),N[1]){let T=N[1];S=Number(T=(T+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(T).getTime()/1e3),nanos:S}}return{seconds:pE(T.seconds),nanos:pE(T.nanos)}}function pE(T){return"number"==typeof T?T:"string"==typeof T?Number(T):0}function pC(T){return"string"==typeof T?pv.fromBase64String(T):pv.fromUint8Array(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let p_="server_timestamp",pI="__type__",pk="__previous_value__",pN="__local_write_time__";function pA(T){var S,N;return(null===(N=((null===(S=null==T?void 0:T.mapValue)||void 0===S?void 0:S.fields)||{})[pI])||void 0===N?void 0:N.stringValue)===p_}function pR(T,S){let N={fields:{[pI]:{stringValue:p_},[pN]:{timestampValue:{seconds:T.seconds,nanos:T.nanoseconds}}}};return S&&pA(S)&&(S=pD(S)),S&&(N.fields[pk]=S),{mapValue:N}}function pD(T){let S=T.mapValue.fields[pk];return pA(S)?pD(S):S}function pO(T){let S=pS(T.mapValue.fields[pN].timestampValue);return new dt(S.seconds,S.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(T,S,N,R,O,P,M,L,V){this.databaseId=T,this.appId=S,this.persistenceKey=N,this.host=R,this.ssl=O,this.forceLongPolling=P,this.autoDetectLongPolling=M,this.longPollingOptions=L,this.useFetchStreams=V}}let pM="(default)";class pL{constructor(T,S){this.projectId=T,this.database=S||pM}static empty(){return new pL("","")}get isDefaultDatabase(){return this.database===pM}isEqual(T){return T instanceof pL&&T.projectId===this.projectId&&T.database===this.database}}function pj(T,S){if(!Object.prototype.hasOwnProperty.apply(T.options,["projectId"]))throw new cH(c$.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pL(T.options.projectId,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pF=-1;function pB(T){return null==T}function pV(T){return 0===T&&1/T==-1/0}function pU(T){return"number"==typeof T&&Number.isInteger(T)&&!pV(T)&&T<=Number.MAX_SAFE_INTEGER&&T>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pz="__type__",pq="__max__",p$={mapValue:{fields:{__type__:{stringValue:pq}}}},pH="__vector__",pG="value",pW={nullValue:"NULL_VALUE"};function pK(T){return"nullValue"in T?0:"booleanValue"in T?1:"integerValue"in T||"doubleValue"in T?2:"timestampValue"in T?3:"stringValue"in T?5:"bytesValue"in T?6:"referenceValue"in T?7:"geoPointValue"in T?8:"arrayValue"in T?9:"mapValue"in T?pA(T)?4:f_(T)?9007199254740991:fE(T)?10:11:cU()}function pQ(T,S){if(T===S)return!0;let N=pK(T);if(N!==pK(S))return!1;switch(N){case 0:case 9007199254740991:return!0;case 1:return T.booleanValue===S.booleanValue;case 4:return pO(T).isEqual(pO(S));case 3:return pY(T,S);case 5:return T.stringValue===S.stringValue;case 6:return pX(T,S);case 7:return T.referenceValue===S.referenceValue;case 8:return pJ(T,S);case 2:return pZ(T,S);case 9:return c9(T.arrayValue.values||[],S.arrayValue.values||[],pQ);case 10:case 11:return p0(T,S);default:return cU()}}function pY(T,S){if("string"==typeof T.timestampValue&&"string"==typeof S.timestampValue&&T.timestampValue.length===S.timestampValue.length)return T.timestampValue===S.timestampValue;let N=pS(T.timestampValue),R=pS(S.timestampValue);return N.seconds===R.seconds&&N.nanos===R.nanos}function pJ(T,S){return pE(T.geoPointValue.latitude)===pE(S.geoPointValue.latitude)&&pE(T.geoPointValue.longitude)===pE(S.geoPointValue.longitude)}function pX(T,S){return pC(T.bytesValue).isEqual(pC(S.bytesValue))}function pZ(T,S){if("integerValue"in T&&"integerValue"in S)return pE(T.integerValue)===pE(S.integerValue);if("doubleValue"in T&&"doubleValue"in S){let N=pE(T.doubleValue),R=pE(S.doubleValue);return N===R?pV(N)===pV(R):isNaN(N)&&isNaN(R)}return!1}function p0(T,S){let N=T.mapValue.fields||{},R=S.mapValue.fields||{};if(pn(N)!==pn(R))return!1;for(let T in N)if(N.hasOwnProperty(T)&&(void 0===R[T]||!pQ(N[T],R[T])))return!1;return!0}function p3(T,S){return void 0!==(T.values||[]).find(T=>pQ(T,S))}function p4(T,S){if(T===S)return 0;let N=pK(T),R=pK(S);if(N!==R)return c5(N,R);switch(N){case 0:case 9007199254740991:return 0;case 1:return c5(T.booleanValue,S.booleanValue);case 2:return p6(T,S);case 3:return p5(T.timestampValue,S.timestampValue);case 4:return p5(pO(T),pO(S));case 5:return c5(T.stringValue,S.stringValue);case 6:return p7(T.bytesValue,S.bytesValue);case 7:return p9(T.referenceValue,S.referenceValue);case 8:return p8(T.geoPointValue,S.geoPointValue);case 9:return fe(T.arrayValue,S.arrayValue);case 10:return ft(T.mapValue,S.mapValue);case 11:return fr(T.mapValue,S.mapValue);default:throw cU()}}function p6(T,S){let N=pE(T.integerValue||T.doubleValue),R=pE(S.integerValue||S.doubleValue);return N<R?-1:N>R?1:N===R?0:isNaN(N)?isNaN(R)?0:-1:1}function p5(T,S){if("string"==typeof T&&"string"==typeof S&&T.length===S.length)return c5(T,S);let N=pS(T),R=pS(S),O=c5(N.seconds,R.seconds);return 0!==O?O:c5(N.nanos,R.nanos)}function p9(T,S){let N=T.split("/"),R=S.split("/");for(let T=0;T<N.length&&T<R.length;T++){let S=c5(N[T],R[T]);if(0!==S)return S}return c5(N.length,R.length)}function p8(T,S){let N=c5(pE(T.latitude),pE(S.latitude));return 0!==N?N:c5(pE(T.longitude),pE(S.longitude))}function p7(T,S){let N=pC(T),R=pC(S);return N.compareTo(R)}function fe(T,S){let N=T.values||[],R=S.values||[];for(let T=0;T<N.length&&T<R.length;++T){let S=p4(N[T],R[T]);if(S)return S}return c5(N.length,R.length)}function ft(T,S){var N,R,O,P;let M=T.fields||{},L=S.fields||{},V=null===(N=M[pG])||void 0===N?void 0:N.arrayValue,U=null===(R=L[pG])||void 0===R?void 0:R.arrayValue,$=c5((null===(O=null==V?void 0:V.values)||void 0===O?void 0:O.length)||0,(null===(P=null==U?void 0:U.values)||void 0===P?void 0:P.length)||0);return 0!==$?$:fe(V,U)}function fr(T,S){if(T===p$.mapValue&&S===p$.mapValue)return 0;if(T===p$.mapValue)return 1;if(S===p$.mapValue)return -1;let N=T.fields||{},R=Object.keys(N),O=S.fields||{},P=Object.keys(O);R.sort(),P.sort();for(let T=0;T<R.length&&T<P.length;++T){let S=c5(R[T],P[T]);if(0!==S)return S;let M=p4(N[R[T]],O[P[T]]);if(0!==M)return M}return c5(R.length,P.length)}function fi(T){return fa(T)}function fa(T){if("nullValue"in T)return"null";if("booleanValue"in T)return""+T.booleanValue;if("integerValue"in T)return""+T.integerValue;if("doubleValue"in T)return""+T.doubleValue;if("timestampValue"in T)return fl(T.timestampValue);if("stringValue"in T)return T.stringValue;if("bytesValue"in T)return fo(T.bytesValue);else if("referenceValue"in T)return fc(T.referenceValue);else if("geoPointValue"in T)return fu(T.geoPointValue);else if("arrayValue"in T)return fh(T.arrayValue);else if("mapValue"in T)return fd(T.mapValue);else return cU()}function fo(T){return pC(T).toBase64()}function fl(T){let S=pS(T);return`time(${S.seconds},${S.nanos})`}function fu(T){return`geo(${T.latitude},${T.longitude})`}function fc(T){return du.fromName(T).toString()}function fd(T){let S=Object.keys(T.fields||{}).sort(),N="{",R=!0;for(let O of S)R?R=!1:N+=",",N+=`${O}:${fa(T.fields[O])}`;return N+"}"}function fh(T){let S="[",N=!0;for(let R of T.values||[])N?N=!1:S+=",",S+=fa(R);return S+"]"}function fp(T){switch(pK(T)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let S=pD(T);return S?16+fp(S):16;case 5:return 2*T.stringValue.length;case 6:return pC(T.bytesValue).approximateByteSize();case 7:return T.referenceValue.length;case 9:return fm(T.arrayValue);case 10:case 11:return ff(T.mapValue);default:throw cU()}}function ff(T){let S=0;return ps(T.fields,(T,N)=>{S+=T.length+fp(N)}),S}function fm(T){return(T.values||[]).reduce((T,S)=>T+fp(S),0)}function fg(T,S){return{referenceValue:`projects/${T.projectId}/databases/${T.database}/documents/${S.path.canonicalString()}`}}function fy(T){return!!T&&"integerValue"in T}function fv(T){return!!T&&"doubleValue"in T}function fb(T){return fy(T)||fv(T)}function fw(T){return!!T&&"arrayValue"in T}function fT(T){return!!T&&"nullValue"in T}function fS(T){return!!T&&"doubleValue"in T&&isNaN(Number(T.doubleValue))}function fx(T){return!!T&&"mapValue"in T}function fE(T){var S,N;return(null===(N=((null===(S=null==T?void 0:T.mapValue)||void 0===S?void 0:S.fields)||{})[pz])||void 0===N?void 0:N.stringValue)===pH}function fC(T){if(T.geoPointValue)return{geoPointValue:Object.assign({},T.geoPointValue)};if(T.timestampValue&&"object"==typeof T.timestampValue)return{timestampValue:Object.assign({},T.timestampValue)};if(T.mapValue){let S={mapValue:{fields:{}}};return ps(T.mapValue.fields,(T,N)=>S.mapValue.fields[T]=fC(N)),S}{if(!T.arrayValue)return Object.assign({},T);let S={arrayValue:{values:[]}};for(let N=0;N<(T.arrayValue.values||[]).length;++N)S.arrayValue.values[N]=fC(T.arrayValue.values[N]);return S}}function f_(T){return(((T.mapValue||{}).fields||{}).__type__||{}).stringValue===pq}let fI={mapValue:{fields:{[pz]:{stringValue:pH},[pG]:{arrayValue:{}}}}};function fk(T){if("nullValue"in T)return pW;if("booleanValue"in T)return{booleanValue:!1};if("integerValue"in T||"doubleValue"in T)return{doubleValue:NaN};if("timestampValue"in T)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in T)return{stringValue:""};if("bytesValue"in T)return{bytesValue:""};if("referenceValue"in T)return fg(pL.empty(),du.empty());else if("geoPointValue"in T)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in T)return{arrayValue:{}};else if(!("mapValue"in T))return cU();else return fE(T)?fI:{mapValue:{}}}function fN(T){if("nullValue"in T)return{booleanValue:!1};if("booleanValue"in T)return{doubleValue:NaN};if("integerValue"in T||"doubleValue"in T)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in T)return{stringValue:""};if("stringValue"in T)return{bytesValue:""};if("bytesValue"in T)return fg(pL.empty(),du.empty());if("referenceValue"in T)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in T)return{arrayValue:{}};else if("arrayValue"in T)return fI;else if(!("mapValue"in T))return cU();else return fE(T)?{mapValue:{}}:p$}function fA(T,S){let N=p4(T.value,S.value);return 0!==N?N:T.inclusive&&!S.inclusive?-1:!T.inclusive&&S.inclusive?1:0}function fR(T,S){let N=p4(T.value,S.value);return 0!==N?N:T.inclusive&&!S.inclusive?1:!T.inclusive&&S.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(T){this.value=T}static empty(){return new fD({mapValue:{}})}field(T){if(T.isEmpty())return this.value;{let S=this.value;for(let N=0;N<T.length-1;++N)if(!fx(S=(S.mapValue.fields||{})[T.get(N)]))return null;return(S=(S.mapValue.fields||{})[T.lastSegment()])||null}}set(T,S){this.getFieldsMap(T.popLast())[T.lastSegment()]=fC(S)}setAll(T){let S=dl.emptyPath(),N={},R=[];T.forEach((T,O)=>{if(!S.isImmediateParentOf(O)){let T=this.getFieldsMap(S);this.applyChanges(T,N,R),N={},R=[],S=O.popLast()}T?N[O.lastSegment()]=fC(T):R.push(O.lastSegment())});let O=this.getFieldsMap(S);this.applyChanges(O,N,R)}delete(T){let S=this.field(T.popLast());fx(S)&&S.mapValue.fields&&delete S.mapValue.fields[T.lastSegment()]}isEqual(T){return pQ(this.value,T.value)}getFieldsMap(T){let S=this.value;S.mapValue.fields||(S.mapValue={fields:{}});for(let N=0;N<T.length;++N){let R=S.mapValue.fields[T.get(N)];fx(R)&&R.mapValue.fields||(R={mapValue:{fields:{}}},S.mapValue.fields[T.get(N)]=R),S=R}return S.mapValue.fields}applyChanges(T,S,N){for(let R of(ps(S,(S,N)=>T[S]=N),N))delete T[R]}clone(){return new fD(fC(this.value))}}function fO(T){let S=[];return ps(T.fields,(T,N)=>{let R=new dl([T]);if(fx(N)){let T=fO(N.mapValue).fields;if(0===T.length)S.push(R);else for(let N of T)S.push(R.child(N))}else S.push(R)}),new pm(S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(T,S,N,R,O,P,M){this.key=T,this.documentType=S,this.version=N,this.readTime=R,this.createTime=O,this.data=P,this.documentState=M}static newInvalidDocument(T){return new fP(T,0,dr.min(),dr.min(),dr.min(),fD.empty(),0)}static newFoundDocument(T,S,N,R){return new fP(T,1,S,dr.min(),N,R,0)}static newNoDocument(T,S){return new fP(T,2,S,dr.min(),dr.min(),fD.empty(),0)}static newUnknownDocument(T,S){return new fP(T,3,S,dr.min(),dr.min(),fD.empty(),2)}convertToFoundDocument(T,S){return this.createTime.isEqual(dr.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=T),this.version=T,this.documentType=1,this.data=S,this.documentState=0,this}convertToNoDocument(T){return this.version=T,this.documentType=2,this.data=fD.empty(),this.documentState=0,this}convertToUnknownDocument(T){return this.version=T,this.documentType=3,this.data=fD.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=dr.min(),this}setReadTime(T){return this.readTime=T,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(T){return T instanceof fP&&this.key.isEqual(T.key)&&this.version.isEqual(T.version)&&this.documentType===T.documentType&&this.documentState===T.documentState&&this.data.isEqual(T.data)}mutableCopy(){return new fP(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function fM(T,S,N){let R=S.data.field(T),O=N.data.field(T);return null!==R&&null!==O?p4(R,O):cU()}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(T,S){this.position=T,this.inclusive=S}}function fj(T,S,N){let R=0;for(let O=0;O<T.position.length;O++){let P=S[O],M=T.position[O];if(R=P.field.isKeyField()?du.comparator(du.fromName(M.referenceValue),N.key):p4(M,N.data.field(P.field)),"desc"===P.dir&&(R*=-1),0!==R)break}return R}function fF(T,S,N){let R=fj(T,S,N);return T.inclusive?R>=0:R>0}function fB(T,S,N){let R=fj(T,S,N);return T.inclusive?R<=0:R<0}function fV(T,S){if(null===T)return null===S;if(null===S||T.inclusive!==S.inclusive||T.position.length!==S.position.length)return!1;for(let N=0;N<T.position.length;N++)if(!pQ(T.position[N],S.position[N]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(T,S="asc"){this.field=T,this.dir=S}}function fz(T){return T.field.canonicalString()+T.dir}function fq(T){return`${T.field.canonicalString()} (${T.dir})`}function f$(T,S){return T.dir===S.dir&&T.field.isEqual(S.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fH{}class fG extends fH{constructor(T,S,N){super(),this.field=T,this.op=S,this.value=N}static create(T,S,N){return T.isKeyField()?"in"===S||"not-in"===S?this.createKeyFieldInFilter(T,S,N):new f8(T,S,N):"array-contains"===S?new mr(T,N):"in"===S?new mi(T,N):"not-in"===S?new mn(T,N):"array-contains-any"===S?new ma(T,N):new fG(T,S,N)}static createKeyFieldInFilter(T,S,N){return"in"===S?new f7(T,N):new me(T,N)}matches(T){let S=T.data.field(this.field);return"!="===this.op?null!==S&&this.matchesComparison(p4(S,this.value)):null!==S&&pK(this.value)===pK(S)&&this.matchesComparison(p4(S,this.value))}matchesComparison(T){switch(this.op){case"<":return T<0;case"<=":return T<=0;case"==":return 0===T;case"!=":return 0!==T;case">":return T>0;case">=":return T>=0;default:return cU()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fW extends fH{constructor(T,S){super(),this.filters=T,this.op=S,this.memoizedFlattenedFilters=null}static create(T,S){return new fW(T,S)}matches(T){return fK(this)?void 0===this.filters.find(S=>!S.matches(T)):void 0!==this.filters.find(S=>S.matches(T))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((T,S)=>T.concat(S.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function fK(T){return"and"===T.op}function fQ(T){return"or"===T.op}function fY(T){return fJ(T)&&fK(T)}function fJ(T){for(let S of T.filters)if(S instanceof fW)return!1;return!0}function fX(T){if(T instanceof fG)return T.field.canonicalString()+T.op.toString()+fi(T.value);if(fY(T))return T.filters.map(T=>fX(T)).join(",");{let S=T.filters.map(T=>fX(T)).join(",");return`${T.op}(${S})`}}function fZ(T,S){return T instanceof fG?f0(T,S):T instanceof fW?f3(T,S):void cU()}function f0(T,S){return S instanceof fG&&T.op===S.op&&T.field.isEqual(S.field)&&pQ(T.value,S.value)}function f3(T,S){return S instanceof fW&&T.op===S.op&&T.filters.length===S.filters.length&&T.filters.reduce((T,N,R)=>T&&fZ(N,S.filters[R]),!0)}function f4(T,S){let N=T.filters.concat(S);return fW.create(N,T.op)}function f6(T){return T instanceof fG?f9(T):T instanceof fW?f5(T):"Filter"}function f5(T){return T.op.toString()+" {"+T.getFilters().map(f6).join(" ,")+"}"}function f9(T){return`${T.field.canonicalString()} ${T.op} ${fi(T.value)}`}class f8 extends fG{constructor(T,S,N){super(T,S,N),this.key=du.fromName(N.referenceValue)}matches(T){let S=du.comparator(T.key,this.key);return this.matchesComparison(S)}}class f7 extends fG{constructor(T,S){super(T,"in",S),this.keys=mt("in",S)}matches(T){return this.keys.some(S=>S.isEqual(T.key))}}class me extends fG{constructor(T,S){super(T,"not-in",S),this.keys=mt("not-in",S)}matches(T){return!this.keys.some(S=>S.isEqual(T.key))}}function mt(T,S){var N;return((null===(N=S.arrayValue)||void 0===N?void 0:N.values)||[]).map(T=>du.fromName(T.referenceValue))}class mr extends fG{constructor(T,S){super(T,"array-contains",S)}matches(T){let S=T.data.field(this.field);return fw(S)&&p3(S.arrayValue,this.value)}}class mi extends fG{constructor(T,S){super(T,"in",S)}matches(T){let S=T.data.field(this.field);return null!==S&&p3(this.value.arrayValue,S)}}class mn extends fG{constructor(T,S){super(T,"not-in",S)}matches(T){if(p3(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let S=T.data.field(this.field);return null!==S&&!p3(this.value.arrayValue,S)}}class ma extends fG{constructor(T,S){super(T,"array-contains-any",S)}matches(T){let S=T.data.field(this.field);return!!fw(S)&&!!S.arrayValue.values&&S.arrayValue.values.some(T=>p3(this.value.arrayValue,T))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(T,S=null,N=[],R=[],O=null,P=null,M=null){this.path=T,this.collectionGroup=S,this.orderBy=N,this.filters=R,this.limit=O,this.startAt=P,this.endAt=M,this.memoizedCanonicalId=null}}function ml(T,S=null,N=[],R=[],O=null,P=null,M=null){return new mo(T,S,N,R,O,P,M)}function mu(T){let S=cq(T);if(null===S.memoizedCanonicalId){let T=S.path.canonicalString();null!==S.collectionGroup&&(T+="|cg:"+S.collectionGroup),T+="|f:"+S.filters.map(T=>fX(T)).join(",")+"|ob:"+S.orderBy.map(T=>fz(T)).join(","),pB(S.limit)||(T+="|l:"+S.limit),S.startAt&&(T+="|lb:"+(S.startAt.inclusive?"b:":"a:")+S.startAt.position.map(T=>fi(T)).join(",")),S.endAt&&(T+="|ub:"+(S.endAt.inclusive?"a:":"b:")+S.endAt.position.map(T=>fi(T)).join(",")),S.memoizedCanonicalId=T}return S.memoizedCanonicalId}function mc(T){let S=T.path.canonicalString();return null!==T.collectionGroup&&(S+=" collectionGroup="+T.collectionGroup),T.filters.length>0&&(S+=`, filters: [${T.filters.map(T=>f6(T)).join(", ")}]`),pB(T.limit)||(S+=", limit: "+T.limit),T.orderBy.length>0&&(S+=`, orderBy: [${T.orderBy.map(T=>fq(T)).join(", ")}]`),T.startAt&&(S+=", startAt: "+(T.startAt.inclusive?"b:":"a:")+T.startAt.position.map(T=>fi(T)).join(",")),T.endAt&&(S+=", endAt: "+(T.endAt.inclusive?"a:":"b:")+T.endAt.position.map(T=>fi(T)).join(",")),`Target(${S})`}function mh(T,S){if(T.limit!==S.limit||T.orderBy.length!==S.orderBy.length)return!1;for(let N=0;N<T.orderBy.length;N++)if(!f$(T.orderBy[N],S.orderBy[N]))return!1;if(T.filters.length!==S.filters.length)return!1;for(let N=0;N<T.filters.length;N++)if(!fZ(T.filters[N],S.filters[N]))return!1;return!!(T.collectionGroup===S.collectionGroup&&T.path.isEqual(S.path)&&fV(T.startAt,S.startAt))&&fV(T.endAt,S.endAt)}function mp(T){return du.isDocumentKey(T.path)&&null===T.collectionGroup&&0===T.filters.length}function mf(T,S){return T.filters.filter(T=>T instanceof fG&&T.field.isEqual(S))}function mm(T,S){let N=dp(S);if(void 0===N)return null;for(let S of mf(T,N.fieldPath))switch(S.op){case"array-contains-any":return S.value.arrayValue.values||[];case"array-contains":return[S.value]}return null}function mg(T,S){let N=new Map;for(let R of df(S))for(let S of mf(T,R.fieldPath))switch(S.op){case"==":case"in":N.set(R.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return N.set(R.fieldPath.canonicalString(),S.value),Array.from(N.values())}return null}function my(T,S){let N=[],R=!0;for(let O of df(S)){let S=0===O.kind?mb(T,O.fieldPath,T.startAt):mw(T,O.fieldPath,T.startAt);N.push(S.value),R&&(R=S.inclusive)}return new fL(N,R)}function mv(T,S){let N=[],R=!0;for(let O of df(S)){let S=0===O.kind?mw(T,O.fieldPath,T.endAt):mb(T,O.fieldPath,T.endAt);N.push(S.value),R&&(R=S.inclusive)}return new fL(N,R)}function mb(T,S,N){let R=pW,O=!0;for(let N of mf(T,S)){let T=pW,S=!0;switch(N.op){case"<":case"<=":T=fk(N.value);break;case"==":case"in":case">=":T=N.value;break;case">":T=N.value,S=!1;break;case"!=":case"not-in":T=pW}0>fA({value:R,inclusive:O},{value:T,inclusive:S})&&(R=T,O=S)}if(null!==N){for(let P=0;P<T.orderBy.length;++P)if(T.orderBy[P].field.isEqual(S)){let T=N.position[P];0>fA({value:R,inclusive:O},{value:T,inclusive:N.inclusive})&&(R=T,O=N.inclusive);break}}return{value:R,inclusive:O}}function mw(T,S,N){let R=p$,O=!0;for(let N of mf(T,S)){let T=p$,S=!0;switch(N.op){case">=":case">":T=fN(N.value),S=!1;break;case"==":case"in":case"<=":T=N.value;break;case"<":T=N.value,S=!1;break;case"!=":case"not-in":T=p$}fR({value:R,inclusive:O},{value:T,inclusive:S})>0&&(R=T,O=S)}if(null!==N){for(let P=0;P<T.orderBy.length;++P)if(T.orderBy[P].field.isEqual(S)){let T=N.position[P];fR({value:R,inclusive:O},{value:T,inclusive:N.inclusive})>0&&(R=T,O=N.inclusive);break}}return{value:R,inclusive:O}}function mT(T){let S=new pd(dl.comparator),N=!1;for(let R of T.filters)for(let T of R.getFlattenedFilters())T.field.isKeyField()||("array-contains"===T.op||"array-contains-any"===T.op?N=!0:S=S.add(T.field));for(let N of T.orderBy)N.field.isKeyField()||(S=S.add(N.field));return S.size+(N?1:0)}function mS(T){return null!==T.limit}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(T,S=null,N=[],R=[],O=null,P="F",M=null,L=null){this.path=T,this.collectionGroup=S,this.explicitOrderBy=N,this.filters=R,this.limit=O,this.limitType=P,this.startAt=M,this.endAt=L,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function mE(T,S,N,R,O,P,M,L){return new mx(T,S,N,R,O,P,M,L)}function mC(T){return new mx(T)}function m_(T,S){return new mx(S,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}function mI(T){return 0===T.filters.length&&null===T.limit&&null==T.startAt&&null==T.endAt&&(0===T.explicitOrderBy.length||1===T.explicitOrderBy.length&&T.explicitOrderBy[0].field.isKeyField())}function mk(T){let S=new pd(dl.comparator);return T.filters.forEach(T=>{T.getFlattenedFilters().forEach(T=>{T.isInequality()&&(S=S.add(T.field))})}),S}function mN(T){return du.isDocumentKey(T.path)&&null===T.collectionGroup&&0===T.filters.length}function mA(T){return null!==T.collectionGroup}function mR(T){let S=cq(T);if(null===S.memoizedNormalizedOrderBy){S.memoizedNormalizedOrderBy=[];let T=new Set;for(let N of S.explicitOrderBy)S.memoizedNormalizedOrderBy.push(N),T.add(N.field.canonicalString());let N=S.explicitOrderBy.length>0?S.explicitOrderBy[S.explicitOrderBy.length-1].dir:"asc";mk(S).forEach(R=>{T.has(R.canonicalString())||R.isKeyField()||S.memoizedNormalizedOrderBy.push(new fU(R,N))}),T.has(dl.keyField().canonicalString())||S.memoizedNormalizedOrderBy.push(new fU(dl.keyField(),N))}return S.memoizedNormalizedOrderBy}function mD(T){let S=cq(T);return S.memoizedTarget||(S.memoizedTarget=mP(S,mR(T))),S.memoizedTarget}function mO(T){let S=cq(T);return S.memoizedAggregateTarget||(S.memoizedAggregateTarget=mP(S,T.explicitOrderBy)),S.memoizedAggregateTarget}function mP(T,S){if("F"===T.limitType)return ml(T.path,T.collectionGroup,S,T.filters,T.limit,T.startAt,T.endAt);{S=S.map(T=>{let S="desc"===T.dir?"asc":"desc";return new fU(T.field,S)});let N=T.endAt?new fL(T.endAt.position,T.endAt.inclusive):null,R=T.startAt?new fL(T.startAt.position,T.startAt.inclusive):null;return ml(T.path,T.collectionGroup,S,T.filters,T.limit,N,R)}}function mM(T,S){let N=T.filters.concat([S]);return new mx(T.path,T.collectionGroup,T.explicitOrderBy.slice(),N,T.limit,T.limitType,T.startAt,T.endAt)}function mL(T,S){let N=T.explicitOrderBy.concat([S]);return new mx(T.path,T.collectionGroup,N,T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}function mj(T,S,N){return new mx(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),S,N,T.startAt,T.endAt)}function mF(T,S){return new mx(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,S,T.endAt)}function mB(T,S){return new mx(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,S)}function mV(T,S){return mh(mD(T),mD(S))&&T.limitType===S.limitType}function mU(T){return`${mu(mD(T))}|lt:${T.limitType}`}function mz(T){return`Query(target=${mc(mD(T))}; limitType=${T.limitType})`}function mq(T,S){return S.isFoundDocument()&&m$(T,S)&&mH(T,S)&&mG(T,S)&&mW(T,S)}function m$(T,S){let N=S.key.path;return null!==T.collectionGroup?S.key.hasCollectionId(T.collectionGroup)&&T.path.isPrefixOf(N):du.isDocumentKey(T.path)?T.path.isEqual(N):T.path.isImmediateParentOf(N)}function mH(T,S){for(let N of mR(T))if(!N.field.isKeyField()&&null===S.data.field(N.field))return!1;return!0}function mG(T,S){for(let N of T.filters)if(!N.matches(S))return!1;return!0}function mW(T,S){return(!T.startAt||!!fB(T.startAt,mR(T),S))&&(!T.endAt||!!fF(T.endAt,mR(T),S))}function mK(T){return T.collectionGroup||(T.path.length%2==1?T.path.lastSegment():T.path.get(T.path.length-2))}function mQ(T){return(S,N)=>{let R=!1;for(let O of mR(T)){let T=mY(O,S,N);if(0!==T)return T;R=R||O.field.isKeyField()}return 0}}function mY(T,S,N){let R=T.field.isKeyField()?du.comparator(S.key,N.key):fM(T.field,S,N);switch(T.dir){case"asc":return R;case"desc":return -1*R;default:return cU()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mJ{constructor(T,S){this.mapKeyFn=T,this.equalsFn=S,this.inner={},this.innerSize=0}get(T){let S=this.mapKeyFn(T),N=this.inner[S];if(void 0!==N){for(let[S,R]of N)if(this.equalsFn(S,T))return R}}has(T){return void 0!==this.get(T)}set(T,S){let N=this.mapKeyFn(T),R=this.inner[N];if(void 0===R){this.inner[N]=[[T,S]],this.innerSize++;return}for(let N=0;N<R.length;N++)if(this.equalsFn(R[N][0],T)){R[N]=[T,S];return}R.push([T,S]),this.innerSize++}delete(T){let S=this.mapKeyFn(T),N=this.inner[S];if(void 0===N)return!1;for(let R=0;R<N.length;R++)if(this.equalsFn(N[R][0],T))return 1===N.length?delete this.inner[S]:N.splice(R,1),this.innerSize--,!0;return!1}forEach(T){ps(this.inner,(S,N)=>{for(let[S,R]of N)T(S,R)})}isEmpty(){return pa(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mX=new po(du.comparator);function mZ(){return mX}let m0=new po(du.comparator);function m1(...T){let S=m0;for(let N of T)S=S.insert(N.key,N);return S}function m2(){return m5()}function m3(T){let S=m0;return T.forEach((T,N)=>S=S.insert(T,N.overlayedDocument)),S}function m4(){return m5()}function m6(){return m5()}function m5(){return new mJ(T=>T.toString(),(T,S)=>T.isEqual(S))}let m9=new po(du.comparator);function m8(){return m9}let m7=new pd(du.comparator);function ge(...T){let S=m7;for(let N of T)S=S.add(N);return S}let gt=new pd(c5);function gr(){return gt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(T,S){if(T.useProto3Json){if(isNaN(S))return{doubleValue:"NaN"};if(S===1/0)return{doubleValue:"Infinity"};if(S===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pV(S)?"-0":S}}function gn(T){return{integerValue:""+T}}function gs(T,S){return pU(S)?gn(S):gi(T,S)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(){this._=void 0}}function go(T,S,N){return T instanceof gd?pR(N,S):T instanceof gh?gp(T,S):T instanceof gf?gm(T,S):gy(T,S)}function gl(T,S,N){return T instanceof gh?gp(T,S):T instanceof gf?gm(T,S):N}function gu(T,S){return T instanceof gg?fb(S)?S:{integerValue:0}:null}function gc(T,S){return T instanceof gh&&S instanceof gh||T instanceof gf&&S instanceof gf?c9(T.elements,S.elements,pQ):T instanceof gg&&S instanceof gg?pQ(T.operand,S.operand):T instanceof gd&&S instanceof gd}class gd extends ga{}class gh extends ga{constructor(T){super(),this.elements=T}}function gp(T,S){let N=gb(S);for(let S of T.elements)N.some(T=>pQ(T,S))||N.push(S);return{arrayValue:{values:N}}}class gf extends ga{constructor(T){super(),this.elements=T}}function gm(T,S){let N=gb(S);for(let S of T.elements)N=N.filter(T=>!pQ(T,S));return{arrayValue:{values:N}}}class gg extends ga{constructor(T,S){super(),this.serializer=T,this.operand=S}}function gy(T,S){let N=gu(T,S),R=gv(N)+gv(T.operand);return fy(N)&&fy(T.operand)?gn(R):gi(T.serializer,R)}function gv(T){return pE(T.integerValue||T.doubleValue)}function gb(T){return fw(T)&&T.arrayValue.values?T.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(T,S){this.field=T,this.transform=S}}function gT(T,S){return T.field.isEqual(S.field)&&gc(T.transform,S.transform)}function gS(T,S){return void 0===T&&void 0===S||!!T&&!!S&&c9(T,S,(T,S)=>gT(T,S))}class gx{constructor(T,S){this.version=T,this.transformResults=S}}class gE{constructor(T,S){this.updateTime=T,this.exists=S}static none(){return new gE}static exists(T){return new gE(void 0,T)}static updateTime(T){return new gE(T)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(T){return this.exists===T.exists&&(this.updateTime?!!T.updateTime&&this.updateTime.isEqual(T.updateTime):!T.updateTime)}}function gC(T,S){return void 0!==T.updateTime?S.isFoundDocument()&&S.version.isEqual(T.updateTime):void 0===T.exists||T.exists===S.isFoundDocument()}class g_{}function gI(T,S){if(!T.hasLocalMutations||S&&0===S.fields.length)return null;if(null===S)return T.isNoDocument()?new gU(T.key,gE.none()):new gD(T.key,T.data,gE.none());{let N=T.data,R=fD.empty(),O=new pd(dl.comparator);for(let T of S.fields)if(!O.has(T)){let S=N.field(T);null===S&&T.length>1&&(T=T.popLast(),S=N.field(T)),null===S?R.delete(T):R.set(T,S),O=O.add(T)}return new gM(T.key,R,new pm(O.toArray()),gE.none())}}function gk(T,S,N){T instanceof gD?gO(T,S,N):T instanceof gM?gL(T,S,N):gz(T,S,N)}function gN(T,S,N,R){return T instanceof gD?gP(T,S,N,R):T instanceof gM?gj(T,S,N,R):gq(T,S,N)}function gA(T,S){let N=null;for(let R of T.fieldTransforms){let T=S.data.field(R.field),O=gu(R.transform,T||null);null!=O&&(null===N&&(N=fD.empty()),N.set(R.field,O))}return N||null}function gR(T,S){return!!(T.type===S.type&&T.key.isEqual(S.key)&&T.precondition.isEqual(S.precondition)&&gS(T.fieldTransforms,S.fieldTransforms))&&(0===T.type?T.value.isEqual(S.value):1!==T.type||T.data.isEqual(S.data)&&T.fieldMask.isEqual(S.fieldMask))}class gD extends g_{constructor(T,S,N,R=[]){super(),this.key=T,this.value=S,this.precondition=N,this.fieldTransforms=R,this.type=0}getFieldMask(){return null}}function gO(T,S,N){let R=T.value.clone(),O=gB(T.fieldTransforms,S,N.transformResults);R.setAll(O),S.convertToFoundDocument(N.version,R).setHasCommittedMutations()}function gP(T,S,N,R){if(!gC(T.precondition,S))return N;let O=T.value.clone(),P=gV(T.fieldTransforms,R,S);return O.setAll(P),S.convertToFoundDocument(S.version,O).setHasLocalMutations(),null}class gM extends g_{constructor(T,S,N,R,O=[]){super(),this.key=T,this.data=S,this.fieldMask=N,this.precondition=R,this.fieldTransforms=O,this.type=1}getFieldMask(){return this.fieldMask}}function gL(T,S,N){if(!gC(T.precondition,S)){S.convertToUnknownDocument(N.version);return}let R=gB(T.fieldTransforms,S,N.transformResults),O=S.data;O.setAll(gF(T)),O.setAll(R),S.convertToFoundDocument(N.version,O).setHasCommittedMutations()}function gj(T,S,N,R){if(!gC(T.precondition,S))return N;let O=gV(T.fieldTransforms,R,S),P=S.data;return(P.setAll(gF(T)),P.setAll(O),S.convertToFoundDocument(S.version,P).setHasLocalMutations(),null===N)?null:N.unionWith(T.fieldMask.fields).unionWith(T.fieldTransforms.map(T=>T.field))}function gF(T){let S=new Map;return T.fieldMask.fields.forEach(N=>{if(!N.isEmpty()){let R=T.data.field(N);S.set(N,R)}}),S}function gB(T,S,N){let R=new Map;cz(T.length===N.length);for(let O=0;O<N.length;O++){let P=T[O],M=P.transform,L=S.data.field(P.field);R.set(P.field,gl(M,L,N[O]))}return R}function gV(T,S,N){let R=new Map;for(let O of T){let T=O.transform,P=N.data.field(O.field);R.set(O.field,go(T,P,S))}return R}class gU extends g_{constructor(T,S){super(),this.key=T,this.precondition=S,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function gz(T,S,N){S.convertToNoDocument(N.version).setHasCommittedMutations()}function gq(T,S,N){return gC(T.precondition,S)?(S.convertToNoDocument(S.version).setHasLocalMutations(),null):N}class g$ extends g_{constructor(T,S){super(),this.key=T,this.precondition=S,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(T,S,N,R){this.batchId=T,this.localWriteTime=S,this.baseMutations=N,this.mutations=R}applyToRemoteDocument(T,S){let N=S.mutationResults;for(let S=0;S<this.mutations.length;S++){let R=this.mutations[S];R.key.isEqual(T.key)&&gk(R,T,N[S])}}applyToLocalView(T,S){for(let N of this.baseMutations)N.key.isEqual(T.key)&&(S=gN(N,T,S,this.localWriteTime));for(let N of this.mutations)N.key.isEqual(T.key)&&(S=gN(N,T,S,this.localWriteTime));return S}applyToLocalDocumentSet(T,S){let N=m6();return this.mutations.forEach(R=>{let O=T.get(R.key),P=O.overlayedDocument,M=this.applyToLocalView(P,O.mutatedFields),L=gI(P,M=S.has(R.key)?null:M);null!==L&&N.set(R.key,L),P.isValidDocument()||P.convertToNoDocument(dr.min())}),N}keys(){return this.mutations.reduce((T,S)=>T.add(S.key),ge())}isEqual(T){return this.batchId===T.batchId&&c9(this.mutations,T.mutations,(T,S)=>gR(T,S))&&c9(this.baseMutations,T.baseMutations,(T,S)=>gR(T,S))}}class gG{constructor(T,S,N,R){this.batch=T,this.commitVersion=S,this.mutationResults=N,this.docVersions=R}static from(T,S,N){cz(T.mutations.length===N.length);let R=m8(),O=T.mutations;for(let T=0;T<O.length;T++)R=R.insert(O[T].key,N[T].version);return new gG(T,S,N,R)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gW{constructor(T,S){this.largestBatchId=T,this.mutation=S}getKey(){return this.mutation.key}isEqual(T){return null!==T&&this.mutation===T.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gK{constructor(T,S){this.count=T,this.unchangedNames=S}}function gQ(T){switch(T){case c$.OK:return cU();case c$.CANCELLED:case c$.UNKNOWN:case c$.DEADLINE_EXCEEDED:case c$.RESOURCE_EXHAUSTED:case c$.INTERNAL:case c$.UNAVAILABLE:case c$.UNAUTHENTICATED:return!1;case c$.INVALID_ARGUMENT:case c$.NOT_FOUND:case c$.ALREADY_EXISTS:case c$.PERMISSION_DENIED:case c$.FAILED_PRECONDITION:case c$.ABORTED:case c$.OUT_OF_RANGE:case c$.UNIMPLEMENTED:case c$.DATA_LOSS:return!0;default:return cU()}}function gY(T){return gQ(T)&&T!==c$.ABORTED}function gJ(T){if(void 0===T)return cF("GRPC error has no .code"),c$.UNKNOWN;switch(T){case Z.OK:return c$.OK;case Z.CANCELLED:return c$.CANCELLED;case Z.UNKNOWN:return c$.UNKNOWN;case Z.DEADLINE_EXCEEDED:return c$.DEADLINE_EXCEEDED;case Z.RESOURCE_EXHAUSTED:return c$.RESOURCE_EXHAUSTED;case Z.INTERNAL:return c$.INTERNAL;case Z.UNAVAILABLE:return c$.UNAVAILABLE;case Z.UNAUTHENTICATED:return c$.UNAUTHENTICATED;case Z.INVALID_ARGUMENT:return c$.INVALID_ARGUMENT;case Z.NOT_FOUND:return c$.NOT_FOUND;case Z.ALREADY_EXISTS:return c$.ALREADY_EXISTS;case Z.PERMISSION_DENIED:return c$.PERMISSION_DENIED;case Z.FAILED_PRECONDITION:return c$.FAILED_PRECONDITION;case Z.ABORTED:return c$.ABORTED;case Z.OUT_OF_RANGE:return c$.OUT_OF_RANGE;case Z.UNIMPLEMENTED:return c$.UNIMPLEMENTED;case Z.DATA_LOSS:return c$.DATA_LOSS;default:return cU()}}!function(T){T[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS"}(Z||(Z={}));/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gX extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gZ=null;function g0(T){if(gZ)throw Error("a TestingHooksSpi instance is already set");gZ=T}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g1(){return new cx.TextEncoder}function g2(){return new TextDecoder("utf-8")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g3=new Q([4294967295,4294967295],0);function g4(T){let S=g1().encode(T),N=new Y;return N.update(S),new Uint8Array(N.digest())}function g6(T){let S=new DataView(T.buffer),N=S.getUint32(0,!0),R=S.getUint32(4,!0),O=S.getUint32(8,!0),P=S.getUint32(12,!0);return[new Q([N,R],0),new Q([O,P],0)]}class g5{constructor(T,S,N){if(this.bitmap=T,this.padding=S,this.hashCount=N,S<0||S>=8)throw new g9(`Invalid padding: ${S}`);if(N<0||T.length>0&&0===this.hashCount)throw new g9(`Invalid hash count: ${N}`);if(0===T.length&&0!==S)throw new g9(`Invalid padding when bitmap length is 0: ${S}`);this.bitCount=8*T.length-S,this.bitCountInInteger=Q.fromNumber(this.bitCount)}getBitIndex(T,S,N){let R=T.add(S.multiply(Q.fromNumber(N)));return 1===R.compare(g3)&&(R=new Q([R.getBits(0),R.getBits(1)],0)),R.modulo(this.bitCountInInteger).toNumber()}isBitSet(T){return(this.bitmap[Math.floor(T/8)]&1<<T%8)!=0}mightContain(T){if(0===this.bitCount)return!1;let[S,N]=g6(g4(T));for(let T=0;T<this.hashCount;T++){let R=this.getBitIndex(S,N,T);if(!this.isBitSet(R))return!1}return!0}static create(T,S,N){let R=T%8==0?0:8-T%8,O=new g5(new Uint8Array(Math.ceil(T/8)),R,S);return N.forEach(T=>O.insert(T)),O}insert(T){if(0===this.bitCount)return;let[S,N]=g6(g4(T));for(let T=0;T<this.hashCount;T++){let R=this.getBitIndex(S,N,T);this.setBit(R)}}setBit(T){let S=Math.floor(T/8),N=T%8;this.bitmap[S]|=1<<N}}class g9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{constructor(T,S,N,R,O){this.snapshotVersion=T,this.targetChanges=S,this.targetMismatches=N,this.documentUpdates=R,this.resolvedLimboDocuments=O}static createSynthesizedRemoteEventForCurrentChange(T,S,N){let R=new Map;return R.set(T,g7.createSynthesizedTargetChangeForCurrentChange(T,S,N)),new g8(dr.min(),R,new po(c5),mZ(),ge())}}class g7{constructor(T,S,N,R,O){this.resumeToken=T,this.current=S,this.addedDocuments=N,this.modifiedDocuments=R,this.removedDocuments=O}static createSynthesizedTargetChangeForCurrentChange(T,S,N){return new g7(N,S,ge(),ge(),ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(T,S,N,R){this.updatedTargetIds=T,this.removedTargetIds=S,this.key=N,this.newDoc=R}}class yt{constructor(T,S){this.targetId=T,this.existenceFilter=S}}class yr{constructor(T,S,N=pv.EMPTY_BYTE_STRING,R=null){this.state=T,this.targetIds=S,this.resumeToken=N,this.cause=R}}class yi{constructor(){this.pendingResponses=0,this.documentChanges=yo(),this._resumeToken=pv.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(T){T.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=T)}toTargetChange(){let T=ge(),S=ge(),N=ge();return this.documentChanges.forEach((R,O)=>{switch(O){case 0:T=T.add(R);break;case 2:S=S.add(R);break;case 1:N=N.add(R);break;default:cU()}}),new g7(this._resumeToken,this._current,T,S,N)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=yo()}addDocumentChange(T,S){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(T,S)}removeDocumentChange(T){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(T)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,cz(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let yn="WatchChangeAggregator";class ys{constructor(T){this.metadataProvider=T,this.targetStates=new Map,this.pendingDocumentUpdates=mZ(),this.pendingDocumentTargetMapping=ya(),this.pendingTargetResets=new po(c5)}handleDocumentChange(T){for(let S of T.updatedTargetIds)T.newDoc&&T.newDoc.isFoundDocument()?this.addDocumentToTarget(S,T.newDoc):this.removeDocumentFromTarget(S,T.key,T.newDoc);for(let S of T.removedTargetIds)this.removeDocumentFromTarget(S,T.key,T.newDoc)}handleTargetChange(T){this.forEachTarget(T,S=>{let N=this.ensureTargetState(S);switch(T.state){case 0:this.isActiveTarget(S)&&N.updateResumeToken(T.resumeToken);break;case 1:N.recordTargetResponse(),N.isPending||N.clearPendingChanges(),N.updateResumeToken(T.resumeToken);break;case 2:N.recordTargetResponse(),N.isPending||this.removeTarget(S);break;case 3:this.isActiveTarget(S)&&(N.markCurrent(),N.updateResumeToken(T.resumeToken));break;case 4:this.isActiveTarget(S)&&(this.resetTarget(S),N.updateResumeToken(T.resumeToken));break;default:cU()}})}forEachTarget(T,S){T.targetIds.length>0?T.targetIds.forEach(S):this.targetStates.forEach((T,N)=>{this.isActiveTarget(N)&&S(N)})}handleExistenceFilter(T){let S=T.targetId,N=T.existenceFilter.count,R=this.targetDataForActiveTarget(S);if(R){let O=R.target;if(mp(O)){if(0===N){let T=new du(O.path);this.removeDocumentFromTarget(S,T,fP.newNoDocument(T,dr.min()))}else cz(1===N)}else{let R=this.getCurrentDocumentCountForTarget(S);if(R!==N){let N=this.parseBloomFilter(T),O=N?this.applyBloomFilter(N,T,R):1;if(0!==O){this.resetTarget(S);let T=2===O?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(S,T)}null==gZ||gZ.notifyOnExistenceFilterMismatch(yl(R,T.existenceFilter,this.metadataProvider.getDatabaseId(),N,O))}}}}parseBloomFilter(T){let S,N;let R=T.existenceFilter.unchangedNames;if(!R||!R.bits)return null;let{bits:{bitmap:O="",padding:P=0},hashCount:M=0}=R;try{S=pC(O).toUint8Array()}catch(T){if(T instanceof gX)return cB("Decoding the base64 bloom filter in existence filter failed ("+T.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw T}try{N=new g5(S,P,M)}catch(T){return T instanceof g9?cB("BloomFilter error: ",T):cB("Applying bloom filter failed: ",T),null}return 0===N.bitCount?null:N}applyBloomFilter(T,S,N){return S.existenceFilter.count===N-this.filterRemovedDocuments(T,S.targetId)?0:2}filterRemovedDocuments(T,S){let N=this.metadataProvider.getRemoteKeysForTarget(S),R=0;return N.forEach(N=>{let O=this.metadataProvider.getDatabaseId(),P=`projects/${O.projectId}/databases/${O.database}/documents/${N.path.canonicalString()}`;!T.mightContain(P)&&(this.removeDocumentFromTarget(S,N,null),R++)}),R}createRemoteEvent(T){let S=new Map;this.targetStates.forEach((N,R)=>{let O=this.targetDataForActiveTarget(R);if(O){if(N.current&&mp(O.target)){let S=new du(O.target.path);null!==this.pendingDocumentUpdates.get(S)||this.targetContainsDocument(R,S)||this.removeDocumentFromTarget(R,S,fP.newNoDocument(S,T))}N.hasPendingChanges&&(S.set(R,N.toTargetChange()),N.clearPendingChanges())}});let N=ge();this.pendingDocumentTargetMapping.forEach((T,S)=>{let R=!0;S.forEachWhile(T=>{let S=this.targetDataForActiveTarget(T);return!S||"TargetPurposeLimboResolution"===S.purpose||(R=!1,!1)}),R&&(N=N.add(T))}),this.pendingDocumentUpdates.forEach((S,N)=>N.setReadTime(T));let R=new g8(T,S,this.pendingTargetResets,this.pendingDocumentUpdates,N);return this.pendingDocumentUpdates=mZ(),this.pendingDocumentTargetMapping=ya(),this.pendingTargetResets=new po(c5),R}addDocumentToTarget(T,S){if(!this.isActiveTarget(T))return;let N=this.targetContainsDocument(T,S.key)?2:0;this.ensureTargetState(T).addDocumentChange(S.key,N),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(S.key,S),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(S.key,this.ensureDocumentTargetMapping(S.key).add(T))}removeDocumentFromTarget(T,S,N){if(!this.isActiveTarget(T))return;let R=this.ensureTargetState(T);this.targetContainsDocument(T,S)?R.addDocumentChange(S,1):R.removeDocumentChange(S),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(S,this.ensureDocumentTargetMapping(S).delete(T)),N&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(S,N))}removeTarget(T){this.targetStates.delete(T)}getCurrentDocumentCountForTarget(T){let S=this.ensureTargetState(T).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(T).size+S.addedDocuments.size-S.removedDocuments.size}recordPendingTargetRequest(T){this.ensureTargetState(T).recordPendingTargetRequest()}ensureTargetState(T){let S=this.targetStates.get(T);return S||(S=new yi,this.targetStates.set(T,S)),S}ensureDocumentTargetMapping(T){let S=this.pendingDocumentTargetMapping.get(T);return S||(S=new pd(c5),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(T,S)),S}isActiveTarget(T){let S=null!==this.targetDataForActiveTarget(T);return S||cj(yn,"Detected inactive target",T),S}targetDataForActiveTarget(T){let S=this.targetStates.get(T);return S&&S.isPending?null:this.metadataProvider.getTargetDataForTarget(T)}resetTarget(T){this.targetStates.set(T,new yi),this.metadataProvider.getRemoteKeysForTarget(T).forEach(S=>{this.removeDocumentFromTarget(T,S,null)})}targetContainsDocument(T,S){return this.metadataProvider.getRemoteKeysForTarget(T).has(S)}}function ya(){return new po(du.comparator)}function yo(){return new po(du.comparator)}function yl(T,S,N,R,O){var P,M,L,V,U,$;let W={localCacheCount:T,existenceFilterCount:S.count,databaseId:N.database,projectId:N.projectId},K=S.unchangedNames;return K&&(W.bloomFilter={applied:0===O,hashCount:null!==(P=null==K?void 0:K.hashCount)&&void 0!==P?P:0,bitmapLength:null!==(V=null===(L=null===(M=null==K?void 0:K.bits)||void 0===M?void 0:M.bitmap)||void 0===L?void 0:L.length)&&void 0!==V?V:0,padding:null!==($=null===(U=null==K?void 0:K.bits)||void 0===U?void 0:U.padding)&&void 0!==$?$:0,mightContain:T=>{var S;return null!==(S=null==R?void 0:R.mightContain(T))&&void 0!==S&&S}}),W}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yu=(()=>{let T={};return T.asc="ASCENDING",T.desc="DESCENDING",T})(),yc=(()=>{let T={};return T["<"]="LESS_THAN",T["<="]="LESS_THAN_OR_EQUAL",T[">"]="GREATER_THAN",T[">="]="GREATER_THAN_OR_EQUAL",T["=="]="EQUAL",T["!="]="NOT_EQUAL",T["array-contains"]="ARRAY_CONTAINS",T.in="IN",T["not-in"]="NOT_IN",T["array-contains-any"]="ARRAY_CONTAINS_ANY",T})(),yd=(()=>{let T={};return T.and="AND",T.or="OR",T})();class yh{constructor(T,S){this.databaseId=T,this.useProto3Json=S}}function yp(T){return new cH(void 0===T.code?c$.UNKNOWN:gJ(T.code),T.message||"")}function yf(T,S){return T.useProto3Json||pB(S)?S:{value:S}}function ym(T){let S;return pB(S="object"==typeof T?T.value:T)?null:S}function yg(T,S){if(!T.useProto3Json)return{seconds:""+S.seconds,nanos:S.nanoseconds};{let T=new Date(1e3*S.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),N=("000000000"+S.nanoseconds).slice(-9);return`${T}.${N}Z`}}function yy(T){let S=pS(T);return new dt(S.seconds,S.nanos)}function yv(T,S){return T.useProto3Json?S.toBase64():S.toUint8Array()}function yb(T,S){return T.useProto3Json?(cz(void 0===S||"string"==typeof S),pv.fromBase64String(S||"")):(cz(void 0===S||S instanceof Buffer||S instanceof Uint8Array),pv.fromUint8Array(S||new Uint8Array))}function yw(T,S){return yg(T,S.toTimestamp())}function yT(T){return cz(!!T),dr.fromTimestamp(yy(T))}function yS(T,S){return yx(T,S).canonicalString()}function yx(T,S){let N=yA(T).child("documents");return void 0===S?N:N.child(S)}function yE(T){let S=ds.fromString(T);return cz(vC(S)),S}function yC(T,S){return yS(T.databaseId,S.path)}function y_(T,S){let N=yE(S);if(N.get(1)!==T.databaseId.projectId)throw new cH(c$.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+N.get(1)+" vs "+T.databaseId.projectId);if(N.get(3)!==T.databaseId.database)throw new cH(c$.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+N.get(3)+" vs "+T.databaseId.database);return new du(yR(N))}function yI(T,S){return yS(T.databaseId,S)}function yk(T){let S=yE(T);return 4===S.length?ds.emptyPath():yR(S)}function yN(T){return new ds(["projects",T.databaseId.projectId,"databases",T.databaseId.database]).canonicalString()}function yA(T){return new ds(["projects",T.projectId,"databases",T.database])}function yR(T){return cz(T.length>4&&"documents"===T.get(4)),T.popFirst(5)}function yD(T,S,N){return{name:yC(T,S),fields:N.value.mapValue.fields}}function yO(T,S){return{name:yC(T,S.key),fields:S.data.value.mapValue.fields,updateTime:yg(T,S.version.toTimestamp()),createTime:yg(T,S.createTime.toTimestamp())}}function yP(T,S,N){let R=y_(T,S.name),O=yT(S.updateTime),P=S.createTime?yT(S.createTime):dr.min(),M=new fD({mapValue:{fields:S.fields}}),L=fP.newFoundDocument(R,O,P,M);return N&&L.setHasCommittedMutations(),N?L.setHasCommittedMutations():L}function yM(T,S){cz(!!S.found),S.found.name,S.found.updateTime;let N=y_(T,S.found.name),R=yT(S.found.updateTime),O=S.found.createTime?yT(S.found.createTime):dr.min(),P=new fD({mapValue:{fields:S.found.fields}});return fP.newFoundDocument(N,R,O,P)}function yL(T,S){cz(!!S.missing),cz(!!S.readTime);let N=y_(T,S.missing),R=yT(S.readTime);return fP.newNoDocument(N,R)}function yj(T,S){return"found"in S?yM(T,S):"missing"in S?yL(T,S):cU()}function yF(T,S){let N;if("targetChange"in S){S.targetChange;let R=yB(S.targetChange.targetChangeType||"NO_CHANGE"),O=S.targetChange.targetIds||[],P=yb(T,S.targetChange.resumeToken),M=S.targetChange.cause;N=new yr(R,O,P,M&&yp(M)||null)}else if("documentChange"in S){S.documentChange;let R=S.documentChange;R.document,R.document.name,R.document.updateTime;let O=y_(T,R.document.name),P=yT(R.document.updateTime),M=R.document.createTime?yT(R.document.createTime):dr.min(),L=new fD({mapValue:{fields:R.document.fields}}),V=fP.newFoundDocument(O,P,M,L);N=new ye(R.targetIds||[],R.removedTargetIds||[],V.key,V)}else if("documentDelete"in S){S.documentDelete;let R=S.documentDelete;R.document;let O=y_(T,R.document),P=R.readTime?yT(R.readTime):dr.min(),M=fP.newNoDocument(O,P);N=new ye([],R.removedTargetIds||[],M.key,M)}else if("documentRemove"in S){S.documentRemove;let R=S.documentRemove;R.document;let O=y_(T,R.document);N=new ye([],R.removedTargetIds||[],O,null)}else{if(!("filter"in S))return cU();S.filter;let T=S.filter;T.targetId;let{count:R=0,unchangedNames:O}=T,P=new gK(R,O);N=new yt(T.targetId,P)}return N}function yB(T){return"NO_CHANGE"===T?0:"ADD"===T?1:"REMOVE"===T?2:"CURRENT"===T?3:"RESET"===T?4:cU()}function yV(T){if(!("targetChange"in T))return dr.min();let S=T.targetChange;return S.targetIds&&S.targetIds.length||!S.readTime?dr.min():yT(S.readTime)}function yU(T,S){let N;if(S instanceof gD)N={update:yD(T,S.key,S.value)};else if(S instanceof gU)N={delete:yC(T,S.key)};else if(S instanceof gM)N={update:yD(T,S.key,S.data),updateMask:vx(S.fieldMask)};else{if(!(S instanceof g$))return cU();N={verify:yC(T,S.key)}}return S.fieldTransforms.length>0&&(N.updateTransforms=S.fieldTransforms.map(S=>yW(T,S))),S.precondition.isNone||(N.currentDocument=yq(T,S.precondition)),N}function yz(T,S){let N=S.currentDocument?y$(S.currentDocument):gE.none(),R=S.updateTransforms?S.updateTransforms.map(S=>yK(T,S)):[];if(S.update){S.update.name;let O=y_(T,S.update.name),P=new fD({mapValue:{fields:S.update.fields}});return S.updateMask?new gM(O,P,vE(S.updateMask),N,R):new gD(O,P,N,R)}return S.delete?new gU(y_(T,S.delete),N):S.verify?new g$(y_(T,S.verify),N):cU()}function yq(T,S){return void 0!==S.updateTime?{updateTime:yw(T,S.updateTime)}:void 0!==S.exists?{exists:S.exists}:cU()}function y$(T){return void 0!==T.updateTime?gE.updateTime(yT(T.updateTime)):void 0!==T.exists?gE.exists(T.exists):gE.none()}function yH(T,S){let N=T.updateTime?yT(T.updateTime):yT(S);return N.isEqual(dr.min())&&(N=yT(S)),new gx(N,T.transformResults||[])}function yG(T,S){return T&&T.length>0?(cz(void 0!==S),T.map(T=>yH(T,S))):[]}function yW(T,S){let N=S.transform;if(N instanceof gd)return{fieldPath:S.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(N instanceof gh)return{fieldPath:S.field.canonicalString(),appendMissingElements:{values:N.elements}};if(N instanceof gf)return{fieldPath:S.field.canonicalString(),removeAllFromArray:{values:N.elements}};if(N instanceof gg)return{fieldPath:S.field.canonicalString(),increment:N.operand};throw cU()}function yK(T,S){let N=null;return"setToServerValue"in S?(cz("REQUEST_TIME"===S.setToServerValue),N=new gd):"appendMissingElements"in S?N=new gh(S.appendMissingElements.values||[]):"removeAllFromArray"in S?N=new gf(S.removeAllFromArray.values||[]):"increment"in S?N=new gg(T,S.increment):cU(),new gw(dl.fromServerFormat(S.fieldPath),N)}function yQ(T,S){return{documents:[yI(T,S.path)]}}function yY(T){return cz(1===T.documents.length),mD(mC(yk(T.documents[0])))}function yJ(T,S){let N;let R={structuredQuery:{}},O=S.path;null!==S.collectionGroup?(N=O,R.structuredQuery.from=[{collectionId:S.collectionGroup,allDescendants:!0}]):(N=O.popLast(),R.structuredQuery.from=[{collectionId:O.lastSegment()}]),R.parent=yI(T,N);let P=y5(S.filters);P&&(R.structuredQuery.where=P);let M=y7(S.orderBy);M&&(R.structuredQuery.orderBy=M);let L=yf(T,S.limit);return null!==L&&(R.structuredQuery.limit=L),S.startAt&&(R.structuredQuery.startAt=vt(S.startAt)),S.endAt&&(R.structuredQuery.endAt=vr(S.endAt)),{queryTarget:R,parent:N}}function yX(T,S,N,R){let{queryTarget:O,parent:P}=yJ(T,S),M={},L=[],V=0;return N.forEach(T=>{let S=R?T.alias:`aggregate_${V++}`;M[S]=T.alias,"count"===T.aggregateType?L.push({alias:S,count:{}}):"avg"===T.aggregateType?L.push({alias:S,avg:{field:vd(T.fieldPath)}}):"sum"===T.aggregateType&&L.push({alias:S,sum:{field:vd(T.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:L,structuredQuery:O.structuredQuery},parent:O.parent},aliasMap:M,parent:P}}function yZ(T){let S=yk(T.parent),N=T.structuredQuery,R=N.from?N.from.length:0,O=null;if(R>0){cz(1===R);let T=N.from[0];T.allDescendants?O=T.collectionId:S=S.child(T.collectionId)}let P=[];N.where&&(P=y9(N.where));let M=[];N.orderBy&&(M=ve(N.orderBy));let L=null;N.limit&&(L=ym(N.limit));let V=null;N.startAt&&(V=vi(N.startAt));let U=null;return N.endAt&&(U=vn(N.endAt)),mE(S,O,M,P,L,"F",V,U)}function y0(T){return mD(yZ(T))}function y3(T,S){let N=y4(S.purpose);return null==N?null:{"goog-listen-tags":N}}function y4(T){switch(T){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cU()}}function y6(T,S){let N;let R=S.target;if((N=mp(R)?{documents:yQ(T,R)}:{query:yJ(T,R).queryTarget}).targetId=S.targetId,S.resumeToken.approximateByteSize()>0){N.resumeToken=yv(T,S.resumeToken);let R=yf(T,S.expectedCount);null!==R&&(N.expectedCount=R)}else if(S.snapshotVersion.compareTo(dr.min())>0){N.readTime=yg(T,S.snapshotVersion.toTimestamp());let R=yf(T,S.expectedCount);null!==R&&(N.expectedCount=R)}return N}function y5(T){if(0!==T.length)return vg(fW.create(T,"and"))}function y9(T){let S=y8(T);return S instanceof fW&&fY(S)?S.getFilters():[S]}function y8(T){return void 0!==T.unaryFilter?vb(T):void 0!==T.fieldFilter?vT(T):void 0!==T.compositeFilter?vS(T):cU()}function y7(T){if(0!==T.length)return T.map(T=>vf(T))}function ve(T){return T.map(T=>vm(T))}function vt(T){return{before:T.inclusive,values:T.position}}function vr(T){return{before:!T.inclusive,values:T.position}}function vi(T){let S=!!T.before;return new fL(T.values||[],S)}function vn(T){let S=!T.before;return new fL(T.values||[],S)}function vs(T){return yu[T]}function va(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function vo(T){return yc[T]}function vl(T){return yd[T]}function vu(T){switch(T){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return cU()}}function vc(T){switch(T){case"AND":return"and";case"OR":return"or";default:return cU()}}function vd(T){return{fieldPath:T.canonicalString()}}function vp(T){return dl.fromServerFormat(T.fieldPath)}function vf(T){return{field:vd(T.field),direction:vs(T.dir)}}function vm(T){return new fU(vp(T.field),va(T.direction))}function vg(T){return T instanceof fG?vv(T):T instanceof fW?vy(T):cU()}function vy(T){let S=T.getFilters().map(T=>vg(T));return 1===S.length?S[0]:{compositeFilter:{op:vl(T.op),filters:S}}}function vv(T){if("=="===T.op){if(fS(T.value))return{unaryFilter:{field:vd(T.field),op:"IS_NAN"}};if(fT(T.value))return{unaryFilter:{field:vd(T.field),op:"IS_NULL"}}}else if("!="===T.op){if(fS(T.value))return{unaryFilter:{field:vd(T.field),op:"IS_NOT_NAN"}};if(fT(T.value))return{unaryFilter:{field:vd(T.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vd(T.field),op:vo(T.op),value:T.value}}}function vb(T){switch(T.unaryFilter.op){case"IS_NAN":let S=vp(T.unaryFilter.field);return fG.create(S,"==",{doubleValue:NaN});case"IS_NULL":let N=vp(T.unaryFilter.field);return fG.create(N,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let R=vp(T.unaryFilter.field);return fG.create(R,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let O=vp(T.unaryFilter.field);return fG.create(O,"!=",{nullValue:"NULL_VALUE"});default:return cU()}}function vT(T){return fG.create(vp(T.fieldFilter.field),vu(T.fieldFilter.op),T.fieldFilter.value)}function vS(T){return fW.create(T.compositeFilter.filters.map(T=>y8(T)),vc(T.compositeFilter.op))}function vx(T){let S=[];return T.fields.forEach(T=>S.push(T.canonicalString())),{fieldPaths:S}}function vE(T){return new pm((T.fieldPaths||[]).map(T=>dl.fromServerFormat(T)))}function vC(T){return T.length>=4&&"projects"===T.get(0)&&"databases"===T.get(2)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(T,S,N,R,O=dr.min(),P=dr.min(),M=pv.EMPTY_BYTE_STRING,L=null){this.target=T,this.targetId=S,this.purpose=N,this.sequenceNumber=R,this.snapshotVersion=O,this.lastLimboFreeSnapshotVersion=P,this.resumeToken=M,this.expectedCount=L}withSequenceNumber(T){return new v_(this.target,this.targetId,this.purpose,T,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(T,S){return new v_(this.target,this.targetId,this.purpose,this.sequenceNumber,S,this.lastLimboFreeSnapshotVersion,T,null)}withExpectedCount(T){return new v_(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,T)}withLastLimboFreeSnapshotVersion(T){return new v_(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,T,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(T){this.remoteSerializer=T}}function vk(T,S){let N;if(S.document)N=yP(T.remoteSerializer,S.document,!!S.hasCommittedMutations);else if(S.noDocument){let T=du.fromSegments(S.noDocument.path),R=vO(S.noDocument.readTime);N=fP.newNoDocument(T,R),S.hasCommittedMutations&&N.setHasCommittedMutations()}else{if(!S.unknownDocument)return cU();let T=du.fromSegments(S.unknownDocument.path),R=vO(S.unknownDocument.version);N=fP.newUnknownDocument(T,R)}return S.readTime&&N.setReadTime(vR(S.readTime)),N}function vN(T,S){let N=S.key,R={prefixPath:N.getCollectionPath().popLast().toArray(),collectionGroup:N.collectionGroup,documentId:N.path.lastSegment(),readTime:vA(S.readTime),hasCommittedMutations:S.hasCommittedMutations};if(S.isFoundDocument())R.document=yO(T.remoteSerializer,S);else if(S.isNoDocument())R.noDocument={path:N.path.toArray(),readTime:vD(S.version)};else{if(!S.isUnknownDocument())return cU();R.unknownDocument={path:N.path.toArray(),version:vD(S.version)}}return R}function vA(T){let S=T.toTimestamp();return[S.seconds,S.nanoseconds]}function vR(T){let S=new dt(T[0],T[1]);return dr.fromTimestamp(S)}function vD(T){let S=T.toTimestamp();return{seconds:S.seconds,nanoseconds:S.nanoseconds}}function vO(T){let S=new dt(T.seconds,T.nanoseconds);return dr.fromTimestamp(S)}function vP(T,S,N){let R=N.baseMutations.map(S=>yU(T.remoteSerializer,S)),O=N.mutations.map(S=>yU(T.remoteSerializer,S));return{userId:S,batchId:N.batchId,localWriteTimeMs:N.localWriteTime.toMillis(),baseMutations:R,mutations:O}}function vM(T,S){let N=(S.baseMutations||[]).map(S=>yz(T.remoteSerializer,S));for(let T=0;T<S.mutations.length-1;++T){let N=S.mutations[T];if(T+1<S.mutations.length&&void 0!==S.mutations[T+1].transform){let R=S.mutations[T+1];N.updateTransforms=R.transform.fieldTransforms,S.mutations.splice(T+1,1),++T}}let R=S.mutations.map(S=>yz(T.remoteSerializer,S)),O=dt.fromMillis(S.localWriteTimeMs);return new gH(S.batchId,O,N,R)}function vL(T){let S;let N=vO(T.readTime),R=void 0!==T.lastLimboFreeSnapshotVersion?vO(T.lastLimboFreeSnapshotVersion):dr.min();return new v_(S=vF(T.query)?yY(T.query):y0(T.query),T.targetId,"TargetPurposeListen",T.lastListenSequenceNumber,N,R,pv.fromBase64String(T.resumeToken))}function vj(T,S){let N;let R=vD(S.snapshotVersion),O=vD(S.lastLimboFreeSnapshotVersion);N=mp(S.target)?yQ(T.remoteSerializer,S.target):yJ(T.remoteSerializer,S.target).queryTarget;let P=S.resumeToken.toBase64();return{targetId:S.targetId,canonicalId:mu(S.target),readTime:R,resumeToken:P,lastListenSequenceNumber:S.sequenceNumber,lastLimboFreeSnapshotVersion:O,query:N}}function vF(T){return void 0!==T.documents}function vB(T){return{id:T.bundleId,createTime:vO(T.createTime),version:T.version}}function vV(T){return{bundleId:T.id,createTime:vD(yT(T.createTime)),version:T.version}}function vU(T){return{name:T.name,query:vq(T.bundledQuery),readTime:vO(T.readTime)}}function vz(T){return{name:T.name,readTime:vD(yT(T.readTime)),bundledQuery:T.bundledQuery}}function vq(T){let S=yZ({parent:T.parent,structuredQuery:T.structuredQuery});return"LAST"===T.limitType?mj(S,S.limit,"L"):S}function v$(T){return{name:T.name,query:vq(T.bundledQuery),readTime:yT(T.readTime)}}function vH(T){return{id:T.id,version:T.version,createTime:yT(T.createTime)}}function vG(T,S){return new gW(S.largestBatchId,yz(T.remoteSerializer,S.overlayMutation))}function vW(T,S,N){let[R,O,P]=vK(S,N.mutation.key);return{userId:S,collectionPath:O,documentId:P,collectionGroup:N.mutation.key.getCollectionGroup(),largestBatchId:N.largestBatchId,overlayMutation:yU(T.remoteSerializer,N.mutation)}}function vK(T,S){let N=S.path.lastSegment();return[T,d0(S.path.popLast()),N]}function vQ(T){return{indexId:T.indexId,collectionGroup:T.collectionGroup,fields:T.fields.map(T=>[T.fieldPath.canonicalString(),T.kind])}}function vY(T,S){let N=S?new dS(S.sequenceNumber,new dC(vO(S.readTime),new du(d6(S.documentKey)),S.largestBatchId)):dS.empty(),R=T.fields.map(([T,S])=>new dw(dl.fromServerFormat(T),S));return new dh(T.indexId,T.collectionGroup,R,N)}function vJ(T,S,N,R){return{indexId:T,uid:S,sequenceNumber:N,readTime:vD(R.readTime),documentKey:d0(R.documentKey.path),largestBatchId:R.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vX{getBundleMetadata(T,S){return vZ(T).get(S).next(T=>{if(T)return vB(T)})}saveBundleMetadata(T,S){return vZ(T).put(vV(S))}getNamedQuery(T,S){return v0(T).get(S).next(T=>{if(T)return vU(T)})}saveNamedQuery(T,S){return v0(T).put(vz(S))}}function vZ(T){return pi(T,hP)}function v0(T){return pi(T,hL)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(T,S){this.serializer=T,this.userId=S}static forUser(T,S){return new v3(T,S.uid||"")}getOverlay(T,S){return v4(T).get(vK(this.userId,S)).next(T=>T?vG(this.serializer,T):null)}getOverlays(T,S){let N=m4();return dA.forEach(S,S=>this.getOverlay(T,S).next(T=>{null!==T&&N.set(S,T)})).next(()=>N)}saveOverlays(T,S,N){let R=[];return N.forEach((N,O)=>{let P=new gW(S,O);R.push(this.saveOverlay(T,P))}),dA.waitFor(R)}removeOverlaysForBatchId(T,S,N){let R=new Set;S.forEach(T=>R.add(d0(T.getCollectionPath())));let O=[];return R.forEach(S=>{let R=IDBKeyRange.bound([this.userId,S,N],[this.userId,S,N+1],!1,!0);O.push(v4(T).deleteAll(hX,R))}),dA.waitFor(O)}getOverlaysForCollection(T,S,N){let R=m4(),O=d0(S),P=IDBKeyRange.bound([this.userId,O,N],[this.userId,O,Number.POSITIVE_INFINITY],!0);return v4(T).loadAll(hX,P).next(T=>{for(let S of T){let T=vG(this.serializer,S);R.set(T.getKey(),T)}return R})}getOverlaysForCollectionGroup(T,S,N,R){let O;let P=m4(),M=IDBKeyRange.bound([this.userId,S,N],[this.userId,S,Number.POSITIVE_INFINITY],!0);return v4(T).iterate({index:h0,range:M},(T,S,N)=>{let M=vG(this.serializer,S);P.size()<R||M.largestBatchId===O?(P.set(M.getKey(),M),O=M.largestBatchId):N.done()}).next(()=>P)}saveOverlay(T,S){return v4(T).put(vW(this.serializer,this.userId,S))}}function v4(T){return pi(T,hY)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{globalsStore(T){return pi(T,h2)}getSessionToken(T){return this.globalsStore(T).get("sessionToken").next(T=>{let S=null==T?void 0:T.value;return S?pv.fromUint8Array(S):pv.EMPTY_BYTE_STRING})}setSessionToken(T,S){return this.globalsStore(T).put({name:"sessionToken",value:S.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let v5=5,v9=10,v8=13,v7=15,be=20,bt=25,br=30,bi=37,bn=45,bs=50,ba=53,bo=55,bl=60,bu=2;class bc{constructor(){}writeIndexValue(T,S){this.writeIndexValueAux(T,S),S.writeInfinity()}writeIndexValueAux(T,S){if("nullValue"in T)this.writeValueTypeLabel(S,v5);else if("booleanValue"in T)this.writeValueTypeLabel(S,v9),S.writeNumber(T.booleanValue?1:0);else if("integerValue"in T)this.writeValueTypeLabel(S,v7),S.writeNumber(pE(T.integerValue));else if("doubleValue"in T){let N=pE(T.doubleValue);isNaN(N)?this.writeValueTypeLabel(S,v8):(this.writeValueTypeLabel(S,v7),pV(N)?S.writeNumber(0):S.writeNumber(N))}else if("timestampValue"in T){let N=T.timestampValue;this.writeValueTypeLabel(S,be),"string"==typeof N&&(N=pS(N)),S.writeString(`${N.seconds||""}`),S.writeNumber(N.nanos||0)}else if("stringValue"in T)this.writeIndexString(T.stringValue,S),this.writeTruncationMarker(S);else if("bytesValue"in T)this.writeValueTypeLabel(S,br),S.writeBytes(pC(T.bytesValue)),this.writeTruncationMarker(S);else if("referenceValue"in T)this.writeIndexEntityRef(T.referenceValue,S);else if("geoPointValue"in T){let N=T.geoPointValue;this.writeValueTypeLabel(S,bn),S.writeNumber(N.latitude||0),S.writeNumber(N.longitude||0)}else"mapValue"in T?f_(T)?this.writeValueTypeLabel(S,Number.MAX_SAFE_INTEGER):fE(T)?this.writeIndexVector(T.mapValue,S):(this.writeIndexMap(T.mapValue,S),this.writeTruncationMarker(S)):"arrayValue"in T?(this.writeIndexArray(T.arrayValue,S),this.writeTruncationMarker(S)):cU()}writeIndexString(T,S){this.writeValueTypeLabel(S,bt),this.writeUnlabeledIndexString(T,S)}writeUnlabeledIndexString(T,S){S.writeString(T)}writeIndexMap(T,S){let N=T.fields||{};for(let T of(this.writeValueTypeLabel(S,bo),Object.keys(N)))this.writeIndexString(T,S),this.writeIndexValueAux(N[T],S)}writeIndexVector(T,S){var N,R;let O=T.fields||{};this.writeValueTypeLabel(S,ba);let P=pG,M=(null===(R=null===(N=O[P].arrayValue)||void 0===N?void 0:N.values)||void 0===R?void 0:R.length)||0;this.writeValueTypeLabel(S,v7),S.writeNumber(pE(M)),this.writeIndexString(P,S),this.writeIndexValueAux(O[P],S)}writeIndexArray(T,S){let N=T.values||[];for(let T of(this.writeValueTypeLabel(S,bs),N))this.writeIndexValueAux(T,S)}writeIndexEntityRef(T,S){this.writeValueTypeLabel(S,bi),du.fromName(T).path.forEach(T=>{this.writeValueTypeLabel(S,bl),this.writeUnlabeledIndexString(T,S)})}writeValueTypeLabel(T,S){T.writeNumber(S)}writeTruncationMarker(T){T.writeNumber(bu)}}bc.INSTANCE=new bc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bd="\uD800",bh="\uDBFF",bp=0,bf=255,bm=1,bg=255,by=255,bv=0,bw=64,bT=8,bS=1024;function bx(T){let S=new DataView(new ArrayBuffer(8));return S.setFloat64(0,T,!1),new Uint8Array(S.buffer)}function bE(T){if(0===T)return 8;let S=0;return T>>4==0&&(S+=4,T<<=4),T>>6==0&&(S+=2,T<<=2),T>>7==0&&(S+=1),S}function bC(T){let S=0;for(let N=0;N<8;++N){let R=bE(255&T[N]);if(S+=R,8!==R)break}return S}function b_(T){return Math.ceil((bw-bC(T))/bT)}class bI{constructor(){this.buffer=new Uint8Array(bS),this.position=0}writeBytesAscending(T){let S=T[Symbol.iterator](),N=S.next();for(;!N.done;)this.writeByteAscending(N.value),N=S.next();this.writeSeparatorAscending()}writeBytesDescending(T){let S=T[Symbol.iterator](),N=S.next();for(;!N.done;)this.writeByteDescending(N.value),N=S.next();this.writeSeparatorDescending()}writeUtf8Ascending(T){for(let S of T){let T=S.charCodeAt(0);if(T<128)this.writeByteAscending(T);else if(T<2048)this.writeByteAscending(960|T>>>6),this.writeByteAscending(128|63&T);else if(S<bd||bh<S)this.writeByteAscending(480|T>>>12),this.writeByteAscending(128|63&T>>>6),this.writeByteAscending(128|63&T);else{let T=S.codePointAt(0);this.writeByteAscending(240|T>>>18),this.writeByteAscending(128|63&T>>>12),this.writeByteAscending(128|63&T>>>6),this.writeByteAscending(128|63&T)}}this.writeSeparatorAscending()}writeUtf8Descending(T){for(let S of T){let T=S.charCodeAt(0);if(T<128)this.writeByteDescending(T);else if(T<2048)this.writeByteDescending(960|T>>>6),this.writeByteDescending(128|63&T);else if(S<bd||bh<S)this.writeByteDescending(480|T>>>12),this.writeByteDescending(128|63&T>>>6),this.writeByteDescending(128|63&T);else{let T=S.codePointAt(0);this.writeByteDescending(240|T>>>18),this.writeByteDescending(128|63&T>>>12),this.writeByteDescending(128|63&T>>>6),this.writeByteDescending(128|63&T)}}this.writeSeparatorDescending()}writeNumberAscending(T){let S=this.toOrderedBits(T),N=b_(S);this.ensureAvailable(1+N),this.buffer[this.position++]=255&N;for(let T=S.length-N;T<S.length;++T)this.buffer[this.position++]=255&S[T]}writeNumberDescending(T){let S=this.toOrderedBits(T),N=b_(S);this.ensureAvailable(1+N),this.buffer[this.position++]=~(255&N);for(let T=S.length-N;T<S.length;++T)this.buffer[this.position++]=~(255&S[T])}writeInfinityAscending(){this.writeEscapedByteAscending(bg),this.writeEscapedByteAscending(by)}writeInfinityDescending(){this.writeEscapedByteDescending(bg),this.writeEscapedByteDescending(by)}reset(){this.position=0}seed(T){this.ensureAvailable(T.length),this.buffer.set(T,this.position),this.position+=T.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(T){let S=bx(T),N=(128&S[0])!=0;S[0]^=N?255:128;for(let T=1;T<S.length;++T)S[T]^=N?255:0;return S}writeByteAscending(T){let S=255&T;S===bp?(this.writeEscapedByteAscending(bp),this.writeEscapedByteAscending(bf)):S===bg?(this.writeEscapedByteAscending(bg),this.writeEscapedByteAscending(bv)):this.writeEscapedByteAscending(S)}writeByteDescending(T){let S=255&T;S===bp?(this.writeEscapedByteDescending(bp),this.writeEscapedByteDescending(bf)):S===bg?(this.writeEscapedByteDescending(bg),this.writeEscapedByteDescending(bv)):this.writeEscapedByteDescending(T)}writeSeparatorAscending(){this.writeEscapedByteAscending(bp),this.writeEscapedByteAscending(bm)}writeSeparatorDescending(){this.writeEscapedByteDescending(bp),this.writeEscapedByteDescending(bm)}writeEscapedByteAscending(T){this.ensureAvailable(1),this.buffer[this.position++]=T}writeEscapedByteDescending(T){this.ensureAvailable(1),this.buffer[this.position++]=~T}ensureAvailable(T){let S=T+this.position;if(S<=this.buffer.length)return;let N=2*this.buffer.length;N<S&&(N=S);let R=new Uint8Array(N);R.set(this.buffer),this.buffer=R}}class bk{constructor(T){this.orderedCode=T}writeBytes(T){this.orderedCode.writeBytesAscending(T)}writeString(T){this.orderedCode.writeUtf8Ascending(T)}writeNumber(T){this.orderedCode.writeNumberAscending(T)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class bN{constructor(T){this.orderedCode=T}writeBytes(T){this.orderedCode.writeBytesDescending(T)}writeString(T){this.orderedCode.writeUtf8Descending(T)}writeNumber(T){this.orderedCode.writeNumberDescending(T)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class bA{constructor(){this.orderedCode=new bI,this.ascending=new bk(this.orderedCode),this.descending=new bN(this.orderedCode)}seed(T){this.orderedCode.seed(T)}forKind(T){return 0===T?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(T,S,N,R){this.indexId=T,this.documentKey=S,this.arrayValue=N,this.directionalValue=R}successor(){let T=this.directionalValue.length,S=0===T||255===this.directionalValue[T-1]?T+1:T,N=new Uint8Array(S);return N.set(this.directionalValue,0),S!==T?N.set([0],this.directionalValue.length):++N[N.length-1],new bR(this.indexId,this.documentKey,this.arrayValue,N)}}function bD(T,S){let N=T.indexId-S.indexId;return 0!==N||0!==(N=bO(T.arrayValue,S.arrayValue))||0!==(N=bO(T.directionalValue,S.directionalValue))?N:du.comparator(T.documentKey,S.documentKey)}function bO(T,S){for(let N=0;N<T.length&&N<S.length;++N){let R=T[N]-S[N];if(0!==R)return R}return T.length-S.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(T){for(let S of(this.inequalityFilters=new pd((T,S)=>dl.comparator(T.field,S.field)),this.collectionId=null!=T.collectionGroup?T.collectionGroup:T.path.lastSegment(),this.orderBys=T.orderBy,this.equalityFilters=[],T.filters)){let T=S;T.isInequality()?this.inequalityFilters=this.inequalityFilters.add(T):this.equalityFilters.push(T)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(T){if(cz(T.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let S=dp(T);if(void 0!==S&&!this.hasMatchingEqualityFilter(S))return!1;let N=df(T),R=new Set,O=0,P=0;for(;O<N.length;++O)if(this.hasMatchingEqualityFilter(N[O]))R=R.add(N[O].fieldPath.canonicalString());else break;if(O===N.length)return!0;if(this.inequalityFilters.size>0){let T=this.inequalityFilters.getIterator().getNext();if(!R.has(T.field.canonicalString())){let S=N[O];if(!this.matchesFilter(T,S)||!this.matchesOrderBy(this.orderBys[P++],S))return!1}++O}for(;O<N.length;++O){let T=N[O];if(P>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[P++],T))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let T=new pd(dl.comparator),S=[];for(let N of this.equalityFilters)if(!N.field.isKeyField()){if("array-contains"===N.op||"array-contains-any"===N.op)S.push(new dw(N.field,2));else{if(T.has(N.field))continue;T=T.add(N.field),S.push(new dw(N.field,0))}}for(let N of this.orderBys)N.field.isKeyField()||T.has(N.field)||(T=T.add(N.field),S.push(new dw(N.field,"asc"===N.dir?0:1)));return new dh(dh.UNKNOWN_ID,this.collectionId,S,dS.empty())}hasMatchingEqualityFilter(T){for(let S of this.equalityFilters)if(this.matchesFilter(S,T))return!0;return!1}matchesFilter(T,S){if(void 0===T||!T.field.isEqual(S.fieldPath))return!1;let N="array-contains"===T.op||"array-contains-any"===T.op;return 2===S.kind===N}matchesOrderBy(T,S){return!!T.field.isEqual(S.fieldPath)&&(0===S.kind&&"asc"===T.dir||1===S.kind&&"desc"===T.dir)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bM(T){var S,N;if(cz(T instanceof fG||T instanceof fW),T instanceof fG){if(!(T instanceof mi))return T;{let R=(null===(N=null===(S=T.value.arrayValue)||void 0===S?void 0:S.values)||void 0===N?void 0:N.map(S=>fG.create(T.field,"==",S)))||[];return fW.create(R,"or")}}let R=T.filters.map(T=>bM(T));return fW.create(R,T.op)}function bL(T){if(0===T.getFilters().length)return[];let S=bU(bM(T));return(cz(bB(S)),bj(S)||bF(S))?[S]:S.getFilters()}function bj(T){return T instanceof fG}function bF(T){return T instanceof fW&&fY(T)}function bB(T){return bj(T)||bF(T)||bV(T)}function bV(T){if(T instanceof fW&&fQ(T)){for(let S of T.getFilters())if(!bj(S)&&!bF(S))return!1;return!0}return!1}function bU(T){if(cz(T instanceof fG||T instanceof fW),T instanceof fG)return T;if(1===T.filters.length)return bU(T.filters[0]);let S=T.filters.map(T=>bU(T)),N=fW.create(S,T.op);return bB(N=bG(N))?N:(cz(N instanceof fW),cz(fK(N)),cz(N.filters.length>1),N.filters.reduce((T,S)=>bz(T,S)))}function bz(T,S){let N;return cz(T instanceof fG||T instanceof fW),cz(S instanceof fG||S instanceof fW),bG(N=T instanceof fG?S instanceof fG?bq(T,S):bH(T,S):S instanceof fG?bH(S,T):b$(T,S))}function bq(T,S){return fW.create([T,S],"and")}function b$(T,S){if(cz(T.filters.length>0&&S.filters.length>0),fK(T)&&fK(S))return f4(T,S.getFilters());let N=fQ(T)?T:S,R=fQ(T)?S:T,O=N.filters.map(T=>bz(T,R));return fW.create(O,"or")}function bH(T,S){if(fK(S))return f4(S,T.getFilters());{let N=S.filters.map(S=>bz(T,S));return fW.create(N,"or")}}function bG(T){if(cz(T instanceof fG||T instanceof fW),T instanceof fG)return T;let S=T.getFilters();if(1===S.length)return bG(S[0]);if(fJ(T))return T;let N=S.map(T=>bG(T)),R=[];return(N.forEach(S=>{S instanceof fG?R.push(S):S instanceof fW&&(S.op===T.op?R.push(...S.filters):R.push(S))}),1===R.length)?R[0]:fW.create(R,T.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bW{constructor(){this.collectionParentIndex=new bK}addToCollectionParentIndex(T,S){return this.collectionParentIndex.add(S),dA.resolve()}getCollectionParents(T,S){return dA.resolve(this.collectionParentIndex.getEntries(S))}addFieldIndex(T,S){return dA.resolve()}deleteFieldIndex(T,S){return dA.resolve()}deleteAllFieldIndexes(T){return dA.resolve()}createTargetIndexes(T,S){return dA.resolve()}getDocumentsMatchingTarget(T,S){return dA.resolve(null)}getIndexType(T,S){return dA.resolve(0)}getFieldIndexes(T,S){return dA.resolve([])}getNextCollectionGroupToUpdate(T){return dA.resolve(null)}getMinOffset(T,S){return dA.resolve(dC.min())}getMinOffsetFromCollectionGroup(T,S){return dA.resolve(dC.min())}updateCollectionGroup(T,S,N){return dA.resolve()}updateIndexEntries(T,S){return dA.resolve()}}class bK{constructor(){this.index={}}add(T){let S=T.lastSegment(),N=T.popLast(),R=this.index[S]||new pd(ds.comparator),O=!R.has(N);return this.index[S]=R.add(N),O}has(T){let S=T.lastSegment(),N=T.popLast(),R=this.index[S];return R&&R.has(N)}getEntries(T){return(this.index[T]||new pd(ds.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bQ="IndexedDbIndexManager",bY=new Uint8Array(0);class bJ{constructor(T,S){this.databaseId=S,this.collectionParentsCache=new bK,this.targetToDnfSubTargets=new mJ(T=>mu(T),(T,S)=>mh(T,S)),this.uid=T.uid||""}addToCollectionParentIndex(T,S){if(!this.collectionParentsCache.has(S)){let N=S.lastSegment(),R=S.popLast();T.addOnCommittedListener(()=>{this.collectionParentsCache.add(S)});let O={collectionId:N,parent:d0(R)};return bX(T).put(O)}return dA.resolve()}getCollectionParents(T,S){let N=[],R=IDBKeyRange.bound([S,""],[c8(S),""],!1,!0);return bX(T).loadAll(R).next(T=>{for(let R of T){if(R.collectionId!==S)break;N.push(d6(R.parent))}return N})}addFieldIndex(T,S){let N=b0(T),R=vQ(S);delete R.indexId;let O=N.add(R);if(!S.indexState)return O.next();{let N=b1(T);return O.next(T=>{N.put(vJ(T,this.uid,S.indexState.sequenceNumber,S.indexState.offset))})}}deleteFieldIndex(T,S){let N=b0(T),R=b1(T),O=bZ(T);return N.delete(S.indexId).next(()=>R.delete(IDBKeyRange.bound([S.indexId],[S.indexId+1],!1,!0))).next(()=>O.delete(IDBKeyRange.bound([S.indexId],[S.indexId+1],!1,!0)))}deleteAllFieldIndexes(T){let S=b0(T),N=bZ(T),R=b1(T);return S.deleteAll().next(()=>N.deleteAll()).next(()=>R.deleteAll())}createTargetIndexes(T,S){return dA.forEach(this.getSubTargets(S),S=>this.getIndexType(T,S).next(N=>{if(0===N||1===N){let N=new bP(S).buildTargetIndex();if(null!=N)return this.addFieldIndex(T,N)}}))}getDocumentsMatchingTarget(T,S){let N=bZ(T),R=!0,O=new Map;return dA.forEach(this.getSubTargets(S),S=>this.getFieldIndex(T,S).next(T=>{R&&(R=!!T),O.set(S,T)})).next(()=>{if(!R)return dA.resolve(null);{let T=ge(),R=[];return dA.forEach(O,(O,P)=>{cj(bQ,`Using index ${dy(O)} to execute ${mu(S)}`);let M=mm(P,O),L=mg(P,O),V=my(P,O),U=mv(P,O),$=this.encodeBound(O,P,V),W=this.encodeBound(O,P,U),K=this.encodeValues(O,P,L),Q=this.generateIndexRanges(O.indexId,M,$,V.inclusive,W,U.inclusive,K);return dA.forEach(Q,O=>N.loadFirst(O,S.limit).next(S=>{S.forEach(S=>{let N=du.fromSegments(S.documentKey);T.has(N)||(T=T.add(N),R.push(N))})}))}).next(()=>R)}})}getSubTargets(T){let S=this.targetToDnfSubTargets.get(T);return S||(S=0===T.filters.length?[T]:bL(fW.create(T.filters,"and")).map(S=>ml(T.path,T.collectionGroup,T.orderBy,S.getFilters(),T.limit,T.startAt,T.endAt)),this.targetToDnfSubTargets.set(T,S)),S}generateIndexRanges(T,S,N,R,O,P,M){let L=(null!=S?S.length:1)*Math.max(N.length,O.length),V=L/(null!=S?S.length:1),U=[];for(let $=0;$<L;++$){let L=S?this.encodeSingleElement(S[$/V]):bY,W=this.generateLowerBound(T,L,N[$%V],R),K=this.generateUpperBound(T,L,O[$%V],P),Q=M.map(S=>this.generateLowerBound(T,L,S,!0));U.push(...this.createRange(W,K,Q))}return U}generateLowerBound(T,S,N,R){let O=new bR(T,du.empty(),S,N);return R?O:O.successor()}generateUpperBound(T,S,N,R){let O=new bR(T,du.empty(),S,N);return R?O.successor():O}getFieldIndex(T,S){let N=new bP(S),R=null!=S.collectionGroup?S.collectionGroup:S.path.lastSegment();return this.getFieldIndexes(T,R).next(T=>{let S=null;for(let R of T)N.servedByIndex(R)&&(!S||R.fields.length>S.fields.length)&&(S=R);return S})}getIndexType(T,S){let N=2,R=this.getSubTargets(S);return dA.forEach(R,S=>this.getFieldIndex(T,S).next(T=>{T?0!==N&&T.fields.length<mT(S)&&(N=1):N=0})).next(()=>mS(S)&&R.length>1&&2===N?1:N)}encodeDirectionalElements(T,S){let N=new bA;for(let R of df(T)){let T=S.data.field(R.fieldPath);if(null==T)return null;let O=N.forKind(R.kind);bc.INSTANCE.writeIndexValue(T,O)}return N.encodedBytes()}encodeSingleElement(T){let S=new bA;return bc.INSTANCE.writeIndexValue(T,S.forKind(0)),S.encodedBytes()}encodeDirectionalKey(T,S){let N=new bA;return bc.INSTANCE.writeIndexValue(fg(this.databaseId,S),N.forKind(dm(T))),N.encodedBytes()}encodeValues(T,S,N){if(null===N)return[];let R=[];R.push(new bA);let O=0;for(let P of df(T)){let T=N[O++];for(let N of R)if(this.isInFilter(S,P.fieldPath)&&fw(T))R=this.expandIndexValues(R,P,T);else{let S=N.forKind(P.kind);bc.INSTANCE.writeIndexValue(T,S)}}return this.getEncodedBytes(R)}encodeBound(T,S,N){return this.encodeValues(T,S,N.position)}getEncodedBytes(T){let S=[];for(let N=0;N<T.length;++N)S[N]=T[N].encodedBytes();return S}expandIndexValues(T,S,N){let R=[...T],O=[];for(let T of N.arrayValue.values||[])for(let N of R){let R=new bA;R.seed(N.encodedBytes()),bc.INSTANCE.writeIndexValue(T,R.forKind(S.kind)),O.push(R)}return O}isInFilter(T,S){return!!T.filters.find(T=>T instanceof fG&&T.field.isEqual(S)&&("in"===T.op||"not-in"===T.op))}getFieldIndexes(T,S){let N=b0(T),R=b1(T);return(S?N.loadAll(hV,IDBKeyRange.bound(S,S)):N.loadAll()).next(T=>{let S=[];return dA.forEach(T,T=>R.get([T.indexId,this.uid]).next(N=>{S.push(vY(T,N))})).next(()=>S)})}getNextCollectionGroupToUpdate(T){return this.getFieldIndexes(T).next(T=>0===T.length?null:(T.sort((T,S)=>{let N=T.indexState.sequenceNumber-S.indexState.sequenceNumber;return 0!==N?N:c5(T.collectionGroup,S.collectionGroup)}),T[0].collectionGroup))}updateCollectionGroup(T,S,N){let R=b0(T),O=b1(T);return this.getNextSequenceNumber(T).next(T=>R.loadAll(hV,IDBKeyRange.bound(S,S)).next(S=>dA.forEach(S,S=>O.put(vJ(S.indexId,this.uid,T,N)))))}updateIndexEntries(T,S){let N=new Map;return dA.forEach(S,(S,R)=>{let O=N.get(S.collectionGroup);return(O?dA.resolve(O):this.getFieldIndexes(T,S.collectionGroup)).next(O=>(N.set(S.collectionGroup,O),dA.forEach(O,N=>this.getExistingIndexEntries(T,S,N).next(S=>{let O=this.computeIndexEntries(R,N);return S.isEqual(O)?dA.resolve():this.updateEntries(T,R,N,S,O)}))))})}addIndexEntry(T,S,N,R){return bZ(T).put({indexId:R.indexId,uid:this.uid,arrayValue:R.arrayValue,directionalValue:R.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(N,S.key),documentKey:S.key.path.toArray()})}deleteIndexEntry(T,S,N,R){return bZ(T).delete([R.indexId,this.uid,R.arrayValue,R.directionalValue,this.encodeDirectionalKey(N,S.key),S.key.path.toArray()])}getExistingIndexEntries(T,S,N){let R=bZ(T),O=new pd(bD);return R.iterate({index:hK,range:IDBKeyRange.only([N.indexId,this.uid,this.encodeDirectionalKey(N,S)])},(T,R)=>{O=O.add(new bR(N.indexId,S,R.arrayValue,R.directionalValue))}).next(()=>O)}computeIndexEntries(T,S){let N=new pd(bD),R=this.encodeDirectionalElements(S,T);if(null==R)return N;let O=dp(S);if(null!=O){let P=T.data.field(O.fieldPath);if(fw(P))for(let O of P.arrayValue.values||[])N=N.add(new bR(S.indexId,T.key,this.encodeSingleElement(O),R))}else N=N.add(new bR(S.indexId,T.key,bY,R));return N}updateEntries(T,S,N,R,O){cj(bQ,"Updating index entries for document '%s'",S.key);let P=[];return pp(R,O,bD,R=>{P.push(this.addIndexEntry(T,S,N,R))},R=>{P.push(this.deleteIndexEntry(T,S,N,R))}),dA.waitFor(P)}getNextSequenceNumber(T){let S=1;return b1(T).iterate({index:h$,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(T,N,R)=>{R.done(),S=N.sequenceNumber+1}).next(()=>S)}createRange(T,S,N){N=N.sort((T,S)=>bD(T,S)).filter((T,S,N)=>!S||0!==bD(T,N[S-1]));let R=[];for(let O of(R.push(T),N)){let N=bD(O,T),P=bD(O,S);if(0===N)R[0]=T.successor();else if(N>0&&P<0)R.push(O),R.push(O.successor());else if(P>0)break}R.push(S);let O=[];for(let T=0;T<R.length;T+=2){if(this.isRangeMatchable(R[T],R[T+1]))return[];let S=[R[T].indexId,this.uid,R[T].arrayValue,R[T].directionalValue,bY,[]],N=[R[T+1].indexId,this.uid,R[T+1].arrayValue,R[T+1].directionalValue,bY,[]];O.push(IDBKeyRange.bound(S,N))}return O}isRangeMatchable(T,S){return bD(T,S)>0}getMinOffsetFromCollectionGroup(T,S){return this.getFieldIndexes(T,S).next(b2)}getMinOffset(T,S){return dA.mapArray(this.getSubTargets(S),S=>this.getFieldIndex(T,S).next(T=>T||cU())).next(b2)}}function bX(T){return pi(T,hA)}function bZ(T){return pi(T,hG)}function b0(T){return pi(T,hF)}function b1(T){return pi(T,hz)}function b2(T){cz(0!==T.length);let S=T[0].indexState.offset,N=S.largestBatchId;for(let R=1;R<T.length;R++){let O=T[R].indexState.offset;0>d_(O,S)&&(S=O),N<O.largestBatchId&&(N=O.largestBatchId)}return new dC(S.readTime,S.documentKey,N)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b3(T,S,N){let R=T.store(ht),O=T.store(hc),P=[],M=IDBKeyRange.only(N.batchId),L=0,V=R.iterate({range:M},(T,S,N)=>(L++,N.delete()));P.push(V.next(()=>{cz(1===L)}));let U=[];for(let T of N.mutations){let R=hl(S,T.key.path,N.batchId);P.push(O.delete(R)),U.push(T.key)}return dA.waitFor(P).next(()=>U)}function b4(T){let S;if(!T)return 0;if(T.document)S=T.document;else if(T.unknownDocument)S=T.unknownDocument;else if(T.noDocument)S=T.noDocument;else throw cU();return JSON.stringify(S).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(T,S,N,R){this.userId=T,this.serializer=S,this.indexManager=N,this.referenceDelegate=R,this.documentKeysByBatchId={}}static forUser(T,S,N,R){return cz(""!==T.uid),new b6(T.isAuthenticated()?T.uid:"",S,N,R)}checkEmpty(T){let S=!0,N=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return b8(T).iterate({index:hn,range:N},(T,N,R)=>{S=!1,R.done()}).next(()=>S)}addMutationBatch(T,S,N,R){let O=b7(T),P=b8(T);return P.add({}).next(M=>{cz("number"==typeof M);let L=new gH(M,S,N,R),V=vP(this.serializer,this.userId,L),U=[],$=new pd((T,S)=>c5(T.canonicalString(),S.canonicalString()));for(let T of R){let S=hl(this.userId,T.key.path,M);$=$.add(T.key.path.popLast()),U.push(P.put(V)),U.push(O.put(S,hu))}return $.forEach(S=>{U.push(this.indexManager.addToCollectionParentIndex(T,S))}),T.addOnCommittedListener(()=>{this.documentKeysByBatchId[M]=L.keys()}),dA.waitFor(U).next(()=>L)})}lookupMutationBatch(T,S){return b8(T).get(S).next(T=>T?(cz(T.userId===this.userId),vM(this.serializer,T)):null)}lookupMutationKeys(T,S){return this.documentKeysByBatchId[S]?dA.resolve(this.documentKeysByBatchId[S]):this.lookupMutationBatch(T,S).next(T=>{if(!T)return null;{let N=T.keys();return this.documentKeysByBatchId[S]=N,N}})}getNextMutationBatchAfterBatchId(T,S){let N=S+1,R=IDBKeyRange.lowerBound([this.userId,N]),O=null;return b8(T).iterate({index:hn,range:R},(T,S,R)=>{S.userId===this.userId&&(cz(S.batchId>=N),O=vM(this.serializer,S)),R.done()}).next(()=>O)}getHighestUnacknowledgedBatchId(T){let S=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),N=pF;return b8(T).iterate({index:hn,range:S,reverse:!0},(T,S,R)=>{N=S.batchId,R.done()}).next(()=>N)}getAllMutationBatches(T){let S=IDBKeyRange.bound([this.userId,pF],[this.userId,Number.POSITIVE_INFINITY]);return b8(T).loadAll(hn,S).next(T=>T.map(T=>vM(this.serializer,T)))}getAllMutationBatchesAffectingDocumentKey(T,S){let N=ho(this.userId,S.path),R=IDBKeyRange.lowerBound(N),O=[];return b7(T).iterate({range:R},(N,R,P)=>{let[M,L,V]=N,U=d6(L);if(M!==this.userId||!S.path.isEqual(U)){P.done();return}return b8(T).get(V).next(T=>{if(!T)throw cU();cz(T.userId===this.userId),O.push(vM(this.serializer,T))})}).next(()=>O)}getAllMutationBatchesAffectingDocumentKeys(T,S){let N=new pd(c5),R=[];return S.forEach(S=>{let O=ho(this.userId,S.path),P=IDBKeyRange.lowerBound(O),M=b7(T).iterate({range:P},(T,R,O)=>{let[P,M,L]=T,V=d6(M);if(P!==this.userId||!S.path.isEqual(V)){O.done();return}N=N.add(L)});R.push(M)}),dA.waitFor(R).next(()=>this.lookupMutationBatches(T,N))}getAllMutationBatchesAffectingQuery(T,S){let N=S.path,R=N.length+1,O=ho(this.userId,N),P=IDBKeyRange.lowerBound(O),M=new pd(c5);return b7(T).iterate({range:P},(T,S,O)=>{let[P,L,V]=T,U=d6(L);if(P!==this.userId||!N.isPrefixOf(U)){O.done();return}U.length===R&&(M=M.add(V))}).next(()=>this.lookupMutationBatches(T,M))}lookupMutationBatches(T,S){let N=[],R=[];return S.forEach(S=>{R.push(b8(T).get(S).next(T=>{if(null===T)throw cU();cz(T.userId===this.userId),N.push(vM(this.serializer,T))}))}),dA.waitFor(R).next(()=>N)}removeMutationBatch(T,S){return b3(T.simpleDbTransaction,this.userId,S).next(N=>(T.addOnCommittedListener(()=>{this.removeCachedMutationKeys(S.batchId)}),dA.forEach(N,S=>this.referenceDelegate.markPotentiallyOrphaned(T,S))))}removeCachedMutationKeys(T){delete this.documentKeysByBatchId[T]}performConsistencyCheck(T){return this.checkEmpty(T).next(S=>{if(!S)return dA.resolve();let N=IDBKeyRange.lowerBound(ha(this.userId)),R=[];return b7(T).iterate({range:N},(T,S,N)=>{if(T[0]!==this.userId){N.done();return}{let S=d6(T[1]);R.push(S)}}).next(()=>{cz(0===R.length)})})}containsKey(T,S){return b5(T,this.userId,S)}getMutationQueueMetadata(T){return we(T).get(this.userId).next(T=>T||{userId:this.userId,lastAcknowledgedBatchId:pF,lastStreamToken:""})}}function b5(T,S,N){let R=ho(S,N.path),O=R[1],P=IDBKeyRange.lowerBound(R),M=!1;return b7(T).iterate({range:P,keysOnly:!0},(T,N,R)=>{let[P,L,V]=T;P===S&&L===O&&(M=!0),R.done()}).next(()=>M)}function b9(T,S){let N=!1;return we(T).iterateSerial(R=>b5(T,R,S).next(T=>(T&&(N=!0),dA.resolve(!T)))).next(()=>N)}function b8(T){return pi(T,ht)}function b7(T){return pi(T,hc)}function we(T){return pi(T,d7)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wt=2;class wr{constructor(T){this.lastId=T}next(){return this.lastId+=wt,this.lastId}static forTargetCache(){return new wr(2-wt)}static forSyncEngine(){return new wr(1-wt)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(T,S){this.referenceDelegate=T,this.serializer=S}allocateTargetId(T){return this.retrieveMetadata(T).next(S=>{let N=new wr(S.highestTargetId);return S.highestTargetId=N.next(),this.saveMetadata(T,S).next(()=>S.highestTargetId)})}getLastRemoteSnapshotVersion(T){return this.retrieveMetadata(T).next(T=>dr.fromTimestamp(new dt(T.lastRemoteSnapshotVersion.seconds,T.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(T){return this.retrieveMetadata(T).next(T=>T.highestListenSequenceNumber)}setTargetsMetadata(T,S,N){return this.retrieveMetadata(T).next(R=>(R.highestListenSequenceNumber=S,N&&(R.lastRemoteSnapshotVersion=N.toTimestamp()),S>R.highestListenSequenceNumber&&(R.highestListenSequenceNumber=S),this.saveMetadata(T,R)))}addTargetData(T,S){return this.saveTargetData(T,S).next(()=>this.retrieveMetadata(T).next(N=>(N.targetCount+=1,this.updateMetadataFromTargetData(S,N),this.saveMetadata(T,N))))}updateTargetData(T,S){return this.saveTargetData(T,S)}removeTargetData(T,S){return this.removeMatchingKeysForTargetId(T,S.targetId).next(()=>wn(T).delete(S.targetId)).next(()=>this.retrieveMetadata(T)).next(S=>(cz(S.targetCount>0),S.targetCount-=1,this.saveMetadata(T,S)))}removeTargets(T,S,N){let R=0,O=[];return wn(T).iterate((P,M)=>{let L=vL(M);L.sequenceNumber<=S&&null===N.get(L.targetId)&&(R++,O.push(this.removeTargetData(T,L)))}).next(()=>dA.waitFor(O)).next(()=>R)}forEachTarget(T,S){return wn(T).iterate((T,N)=>{S(vL(N))})}retrieveMetadata(T){return ws(T).get(hk).next(T=>(cz(null!==T),T))}saveMetadata(T,S){return ws(T).put(hk,S)}saveTargetData(T,S){return wn(T).put(vj(this.serializer,S))}updateMetadataFromTargetData(T,S){let N=!1;return T.targetId>S.highestTargetId&&(S.highestTargetId=T.targetId,N=!0),T.sequenceNumber>S.highestListenSequenceNumber&&(S.highestListenSequenceNumber=T.sequenceNumber,N=!0),N}getTargetCount(T){return this.retrieveMetadata(T).next(T=>T.targetCount)}getTargetData(T,S){let N=mu(S),R=IDBKeyRange.bound([N,Number.NEGATIVE_INFINITY],[N,Number.POSITIVE_INFINITY]),O=null;return wn(T).iterate({range:R,index:hS},(T,N,R)=>{let P=vL(N);mh(S,P.target)&&(O=P,R.done())}).next(()=>O)}addMatchingKeys(T,S,N){let R=[],O=wa(T);return S.forEach(S=>{let P=d0(S.path);R.push(O.put({targetId:N,path:P})),R.push(this.referenceDelegate.addReference(T,N,S))}),dA.waitFor(R)}removeMatchingKeys(T,S,N){let R=wa(T);return dA.forEach(S,S=>{let O=d0(S.path);return dA.waitFor([R.delete([N,O]),this.referenceDelegate.removeReference(T,N,S)])})}removeMatchingKeysForTargetId(T,S){let N=wa(T),R=IDBKeyRange.bound([S],[S+1],!1,!0);return N.delete(R)}getMatchingKeysForTargetId(T,S){let N=IDBKeyRange.bound([S],[S+1],!1,!0),R=wa(T),O=ge();return R.iterate({range:N,keysOnly:!0},(T,S,N)=>{let R=new du(d6(T[1]));O=O.add(R)}).next(()=>O)}containsKey(T,S){let N=d0(S.path),R=IDBKeyRange.bound([N],[c8(N)],!1,!0),O=0;return wa(T).iterate({index:h_,keysOnly:!0,range:R},([T,S],N,R)=>{0!==T&&(O++,R.done())}).next(()=>O>0)}getTargetDataForTarget(T,S){return wn(T).get(S).next(T=>T?vL(T):null)}}function wn(T){return pi(T,hw)}function ws(T){return pi(T,hN)}function wa(T){return pi(T,hE)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wo={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},wl=-1,wu=41943040;class wc{constructor(T,S,N){this.cacheSizeCollectionThreshold=T,this.percentileToCollect=S,this.maximumSequenceNumbersToCollect=N}static withCacheSize(T){return new wc(T,wc.DEFAULT_COLLECTION_PERCENTILE,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}wc.DEFAULT_COLLECTION_PERCENTILE=10,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wc.DEFAULT=new wc(wu,wc.DEFAULT_COLLECTION_PERCENTILE,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wc.DISABLED=new wc(wl,0,0);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wd="LruGarbageCollector",wh=1048576,wp=null,wf=null;function wm([T,S],[N,R]){let O=c5(T,N);return 0===O?c5(S,R):O}class wg{constructor(T){this.maxElements=T,this.buffer=new pd(wm),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(T){let S=[T,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(S);else{let T=this.buffer.last();0>wm(S,T)&&(this.buffer=this.buffer.delete(T).add(S))}}get maxValue(){return this.buffer.last()[0]}}class wy{constructor(T,S,N){this.garbageCollector=T,this.asyncQueue=S,this.localStore=N,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==wl&&this.scheduleGC(wp)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(T){cj(wd,`Garbage collection scheduled in ${T}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",T,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(T){dF(T)?cj(wd,"Ignoring IndexedDB error during garbage collection: ",T):await dN(T)}await this.scheduleGC(wf)})}}class wv{constructor(T,S){this.delegate=T,this.params=S}calculateTargetCount(T,S){return this.delegate.getSequenceNumberCount(T).next(T=>Math.floor(S/100*T))}nthSequenceNumber(T,S){if(0===S)return dA.resolve(dQ.INVALID);let N=new wg(S);return this.delegate.forEachTarget(T,T=>N.addElement(T.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(T,T=>N.addElement(T))).next(()=>N.maxValue)}removeTargets(T,S,N){return this.delegate.removeTargets(T,S,N)}removeOrphanedDocuments(T,S){return this.delegate.removeOrphanedDocuments(T,S)}collect(T,S){return this.params.cacheSizeCollectionThreshold===wl?(cj("LruGarbageCollector","Garbage collection skipped; disabled"),dA.resolve(wo)):this.getCacheSize(T).next(N=>N<this.params.cacheSizeCollectionThreshold?(cj("LruGarbageCollector",`Garbage collection skipped; Cache size ${N} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wo):this.runGarbageCollection(T,S))}getCacheSize(T){return this.delegate.getCacheSize(T)}runGarbageCollection(T,S){let N,R,O,P,M,L,V;let U=Date.now();return this.calculateTargetCount(T,this.params.percentileToCollect).next(S=>(S>this.params.maximumSequenceNumbersToCollect?(cj("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),R=this.params.maximumSequenceNumbersToCollect):R=S,P=Date.now(),this.nthSequenceNumber(T,R))).next(R=>(N=R,M=Date.now(),this.removeTargets(T,N,S))).next(S=>(O=S,L=Date.now(),this.removeOrphanedDocuments(T,N))).next(T=>(V=Date.now(),cL()<=LogLevel.DEBUG&&cj("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${P-U}ms
	Determined least recently used ${R} in ${M-P}ms
	Removed ${O} targets in ${L-M}ms
	Removed ${T} documents in ${V-L}ms
Total Duration: ${V-U}ms`),dA.resolve({didRun:!0,sequenceNumbersCollected:R,targetsRemoved:O,documentsRemoved:T})))}}function wb(T,S){return new wv(T,S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(T,S){this.db=T,this.garbageCollector=wb(this,S)}getSequenceNumberCount(T){let S=this.orphanedDocumentCount(T);return this.db.getTargetCache().getTargetCount(T).next(T=>S.next(S=>T+S))}orphanedDocumentCount(T){let S=0;return this.forEachOrphanedDocumentSequenceNumber(T,T=>{S++}).next(()=>S)}forEachTarget(T,S){return this.db.getTargetCache().forEachTarget(T,S)}forEachOrphanedDocumentSequenceNumber(T,S){return this.forEachOrphanedDocument(T,(T,N)=>S(N))}addReference(T,S,N){return wx(T,N)}removeReference(T,S,N){return wx(T,N)}removeTargets(T,S,N){return this.db.getTargetCache().removeTargets(T,S,N)}markPotentiallyOrphaned(T,S){return wx(T,S)}isPinned(T,S){return b9(T,S)}removeOrphanedDocuments(T,S){let N=this.db.getRemoteDocumentCache().newChangeBuffer(),R=[],O=0;return this.forEachOrphanedDocument(T,(P,M)=>{if(M<=S){let S=this.isPinned(T,P).next(S=>{if(!S)return O++,N.getEntry(T,P).next(()=>(N.removeEntry(P,dr.min()),wa(T).delete(wT(P))))});R.push(S)}}).next(()=>dA.waitFor(R)).next(()=>N.apply(T)).next(()=>O)}removeTarget(T,S){let N=S.withSequenceNumber(T.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(T,N)}updateLimboDocument(T,S){return wx(T,S)}forEachOrphanedDocument(T,S){let N;let R=wa(T),O=dQ.INVALID;return R.iterate({index:h_},([T,R],{path:P,sequenceNumber:M})=>{0===T?(O!==dQ.INVALID&&S(new du(d6(N)),O),O=M,N=P):O=dQ.INVALID}).next(()=>{O!==dQ.INVALID&&S(new du(d6(N)),O)})}getCacheSize(T){return this.db.getRemoteDocumentCache().getSize(T)}}function wT(T){return[0,d0(T.path)]}function wS(T,S){return{targetId:0,path:d0(T.path),sequenceNumber:S}}function wx(T,S){return wa(T).put(wS(S,T.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.changes=new mJ(T=>T.toString(),(T,S)=>T.isEqual(S)),this.changesApplied=!1}addEntry(T){this.assertNotApplied(),this.changes.set(T.key,T)}removeEntry(T,S){this.assertNotApplied(),this.changes.set(T,fP.newInvalidDocument(T).setReadTime(S))}getEntry(T,S){this.assertNotApplied();let N=this.changes.get(S);return void 0!==N?dA.resolve(N):this.getFromCache(T,S)}getEntries(T,S){return this.getAllFromCache(T,S)}apply(T){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(T)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(T){this.serializer=T}setIndexManager(T){this.indexManager=T}addEntry(T,S,N){return wN(T).put(N)}removeEntry(T,S,N){return wN(T).delete(wR(S,N))}updateMetadata(T,S){return this.getMetadata(T).next(N=>(N.byteSize+=S,this.setMetadata(T,N)))}getEntry(T,S){let N=fP.newInvalidDocument(S);return wN(T).iterate({index:hp,range:IDBKeyRange.only(wA(S))},(T,R)=>{N=this.maybeDecodeDocument(S,R)}).next(()=>N)}getSizedEntry(T,S){let N={size:0,document:fP.newInvalidDocument(S)};return wN(T).iterate({index:hp,range:IDBKeyRange.only(wA(S))},(T,R)=>{N={document:this.maybeDecodeDocument(S,R),size:b4(R)}}).next(()=>N)}getEntries(T,S){let N=mZ();return this.forEachDbEntry(T,S,(T,S)=>{let R=this.maybeDecodeDocument(T,S);N=N.insert(T,R)}).next(()=>N)}getSizedEntries(T,S){let N=mZ(),R=new po(du.comparator);return this.forEachDbEntry(T,S,(T,S)=>{let O=this.maybeDecodeDocument(T,S);N=N.insert(T,O),R=R.insert(T,b4(S))}).next(()=>({documents:N,sizeMap:R}))}forEachDbEntry(T,S,N){if(S.isEmpty())return dA.resolve();let R=new pd(wO);S.forEach(T=>R=R.add(T));let O=IDBKeyRange.bound(wA(R.first()),wA(R.last())),P=R.getIterator(),M=P.getNext();return wN(T).iterate({index:hp,range:O},(T,S,R)=>{let O=du.fromSegments([...S.prefixPath,S.collectionGroup,S.documentId]);for(;M&&0>wO(M,O);)N(M,null),M=P.getNext();M&&M.isEqual(O)&&(N(M,S),M=P.hasNext()?P.getNext():null),M?R.skip(wA(M)):R.done()}).next(()=>{for(;M;)N(M,null),M=P.hasNext()?P.getNext():null})}getDocumentsMatchingQuery(T,S,N,R,O){let P=S.path,M=[P.popLast().toArray(),P.lastSegment(),vA(N.readTime),N.documentKey.path.isEmpty()?"":N.documentKey.path.lastSegment()],L=[P.popLast().toArray(),P.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wN(T).loadAll(IDBKeyRange.bound(M,L,!0)).next(T=>{null==O||O.incrementDocumentReadCount(T.length);let N=mZ();for(let O of T){let T=this.maybeDecodeDocument(du.fromSegments(O.prefixPath.concat(O.collectionGroup,O.documentId)),O);T.isFoundDocument()&&(mq(S,T)||R.has(T.key))&&(N=N.insert(T.key,T))}return N})}getAllFromCollectionGroup(T,S,N,R){let O=mZ(),P=wD(S,N),M=wD(S,dC.max());return wN(T).iterate({index:hm,range:IDBKeyRange.bound(P,M,!0)},(T,S,N)=>{let P=this.maybeDecodeDocument(du.fromSegments(S.prefixPath.concat(S.collectionGroup,S.documentId)),S);(O=O.insert(P.key,P)).size===R&&N.done()}).next(()=>O)}newChangeBuffer(T){return new wI(this,!!T&&T.trackRemovals)}getSize(T){return this.getMetadata(T).next(T=>T.byteSize)}getMetadata(T){return wk(T).get(hv).next(T=>(cz(!!T),T))}setMetadata(T,S){return wk(T).put(hv,S)}maybeDecodeDocument(T,S){if(S){let T=vk(this.serializer,S);if(!(T.isNoDocument()&&T.version.isEqual(dr.min())))return T}return fP.newInvalidDocument(T)}}function w_(T){return new wC(T)}class wI extends null{constructor(T,S){super(),this.documentCache=T,this.trackRemovals=S,this.documentStates=new mJ(T=>T.toString(),(T,S)=>T.isEqual(S))}applyChanges(T){let S=[],N=0,R=new pd((T,S)=>c5(T.canonicalString(),S.canonicalString()));return this.changes.forEach((O,P)=>{let M=this.documentStates.get(O);if(S.push(this.documentCache.removeEntry(T,O,M.readTime)),P.isValidDocument()){let L=vN(this.documentCache.serializer,P);R=R.add(O.path.popLast());let V=b4(L);N+=V-M.size,S.push(this.documentCache.addEntry(T,O,L))}else if(N-=M.size,this.trackRemovals){let N=vN(this.documentCache.serializer,P.convertToNoDocument(dr.min()));S.push(this.documentCache.addEntry(T,O,N))}}),R.forEach(N=>{S.push(this.documentCache.indexManager.addToCollectionParentIndex(T,N))}),S.push(this.documentCache.updateMetadata(T,N)),dA.waitFor(S)}getFromCache(T,S){return this.documentCache.getSizedEntry(T,S).next(T=>(this.documentStates.set(S,{size:T.size,readTime:T.document.readTime}),T.document))}getAllFromCache(T,S){return this.documentCache.getSizedEntries(T,S).next(({documents:T,sizeMap:S})=>(S.forEach((S,N)=>{this.documentStates.set(S,{size:N,readTime:T.get(S).readTime})}),T))}}function wk(T){return pi(T,hy)}function wN(T){return pi(T,hd)}function wA(T){let S=T.path.toArray();return[S.slice(0,S.length-2),S[S.length-2],S[S.length-1]]}function wR(T,S){let N=T.path.toArray();return[N.slice(0,N.length-2),N[N.length-2],vA(S),N[N.length-1]]}function wD(T,S){let N=S.documentKey.path.toArray();return[T,vA(S.readTime),N.slice(0,N.length-2),N.length>0?N[N.length-1]:""]}function wO(T,S){let N=T.path.toArray(),R=S.path.toArray(),O=0;for(let T=0;T<N.length-2&&T<R.length-2;++T)if(O=c5(N[T],R[T]))return O;return(O=c5(N.length,R.length))||(O=c5(N[N.length-2],R[R.length-2]))?O:c5(N[N.length-1],R[R.length-1])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wP=17;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(T,S){this.overlayedDocument=T,this.mutatedFields=S}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(T,S,N,R){this.remoteDocumentCache=T,this.mutationQueue=S,this.documentOverlayCache=N,this.indexManager=R}getDocument(T,S){let N=null;return this.documentOverlayCache.getOverlay(T,S).next(R=>(N=R,this.remoteDocumentCache.getEntry(T,S))).next(T=>(null!==N&&gN(N.mutation,T,pm.empty(),dt.now()),T))}getDocuments(T,S){return this.remoteDocumentCache.getEntries(T,S).next(S=>this.getLocalViewOfDocuments(T,S,ge()).next(()=>S))}getLocalViewOfDocuments(T,S,N=ge()){let R=m4();return this.populateOverlays(T,R,S).next(()=>this.computeViews(T,S,R,N).next(T=>{let S=m1();return T.forEach((T,N)=>{S=S.insert(T,N.overlayedDocument)}),S}))}getOverlayedDocuments(T,S){let N=m4();return this.populateOverlays(T,N,S).next(()=>this.computeViews(T,S,N,ge()))}populateOverlays(T,S,N){let R=[];return N.forEach(T=>{S.has(T)||R.push(T)}),this.documentOverlayCache.getOverlays(T,R).next(T=>{T.forEach((T,N)=>{S.set(T,N)})})}computeViews(T,S,N,R){let O=mZ(),P=m5(),M=m2();return S.forEach((T,S)=>{let M=N.get(S.key);R.has(S.key)&&(void 0===M||M.mutation instanceof gM)?O=O.insert(S.key,S):void 0!==M?(P.set(S.key,M.mutation.getFieldMask()),gN(M.mutation,S,M.mutation.getFieldMask(),dt.now())):P.set(S.key,pm.empty())}),this.recalculateAndSaveOverlays(T,O).next(T=>(T.forEach((T,S)=>P.set(T,S)),S.forEach((T,S)=>{var N;return M.set(T,new wM(S,null!==(N=P.get(T))&&void 0!==N?N:null))}),M))}recalculateAndSaveOverlays(T,S){let N=m5(),R=new po((T,S)=>T-S),O=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(T,S).next(T=>{for(let O of T)O.keys().forEach(T=>{let P=S.get(T);if(null===P)return;let M=N.get(T)||pm.empty();M=O.applyToLocalView(P,M),N.set(T,M);let L=(R.get(O.batchId)||ge()).add(T);R=R.insert(O.batchId,L)})}).next(()=>{let P=[],M=R.getReverseIterator();for(;M.hasNext();){let R=M.getNext(),L=R.key,V=R.value,U=m6();V.forEach(T=>{if(!O.has(T)){let R=gI(S.get(T),N.get(T));null!==R&&U.set(T,R),O=O.add(T)}}),P.push(this.documentOverlayCache.saveOverlays(T,L,U))}return dA.waitFor(P)}).next(()=>N)}recalculateAndSaveOverlaysForDocumentKeys(T,S){return this.remoteDocumentCache.getEntries(T,S).next(S=>this.recalculateAndSaveOverlays(T,S))}getDocumentsMatchingQuery(T,S,N,R){return mN(S)?this.getDocumentsMatchingDocumentQuery(T,S.path):mA(S)?this.getDocumentsMatchingCollectionGroupQuery(T,S,N,R):this.getDocumentsMatchingCollectionQuery(T,S,N,R)}getNextDocuments(T,S,N,R){return this.remoteDocumentCache.getAllFromCollectionGroup(T,S,N,R).next(O=>{let P=R-O.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(T,S,N.largestBatchId,R-O.size):dA.resolve(m4()),M=dc,L=O;return P.next(S=>dA.forEach(S,(S,N)=>(M<N.largestBatchId&&(M=N.largestBatchId),O.get(S))?dA.resolve():this.remoteDocumentCache.getEntry(T,S).next(T=>{L=L.insert(S,T)})).next(()=>this.populateOverlays(T,S,O)).next(()=>this.computeViews(T,L,S,ge())).next(T=>({batchId:M,changes:m3(T)})))})}getDocumentsMatchingDocumentQuery(T,S){return this.getDocument(T,new du(S)).next(T=>{let S=m1();return T.isFoundDocument()&&(S=S.insert(T.key,T)),S})}getDocumentsMatchingCollectionGroupQuery(T,S,N,R){let O=S.collectionGroup,P=m1();return this.indexManager.getCollectionParents(T,O).next(M=>dA.forEach(M,M=>{let L=m_(S,M.child(O));return this.getDocumentsMatchingCollectionQuery(T,L,N,R).next(T=>{T.forEach((T,S)=>{P=P.insert(T,S)})})}).next(()=>P))}getDocumentsMatchingCollectionQuery(T,S,N,R){let O;return this.documentOverlayCache.getOverlaysForCollection(T,S.path,N.largestBatchId).next(P=>(O=P,this.remoteDocumentCache.getDocumentsMatchingQuery(T,S,N,O,R))).next(T=>{O.forEach((S,N)=>{let R=N.getKey();null===T.get(R)&&(T=T.insert(R,fP.newInvalidDocument(R)))});let N=m1();return T.forEach((T,R)=>{let P=O.get(T);void 0!==P&&gN(P.mutation,R,pm.empty(),dt.now()),mq(S,R)&&(N=N.insert(T,R))}),N})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(T){this.serializer=T,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(T,S){return dA.resolve(this.bundles.get(S))}saveBundleMetadata(T,S){return this.bundles.set(S.id,vH(S)),dA.resolve()}getNamedQuery(T,S){return dA.resolve(this.namedQueries.get(S))}saveNamedQuery(T,S){return this.namedQueries.set(S.name,v$(S)),dA.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(){this.overlays=new po(du.comparator),this.overlayByBatchId=new Map}getOverlay(T,S){return dA.resolve(this.overlays.get(S))}getOverlays(T,S){let N=m4();return dA.forEach(S,S=>this.getOverlay(T,S).next(T=>{null!==T&&N.set(S,T)})).next(()=>N)}saveOverlays(T,S,N){return N.forEach((N,R)=>{this.saveOverlay(T,S,R)}),dA.resolve()}removeOverlaysForBatchId(T,S,N){let R=this.overlayByBatchId.get(N);return void 0!==R&&(R.forEach(T=>this.overlays=this.overlays.remove(T)),this.overlayByBatchId.delete(N)),dA.resolve()}getOverlaysForCollection(T,S,N){let R=m4(),O=S.length+1,P=new du(S.child("")),M=this.overlays.getIteratorFrom(P);for(;M.hasNext();){let T=M.getNext().value,P=T.getKey();if(!S.isPrefixOf(P.path))break;P.path.length===O&&T.largestBatchId>N&&R.set(T.getKey(),T)}return dA.resolve(R)}getOverlaysForCollectionGroup(T,S,N,R){let O=new po((T,S)=>T-S),P=this.overlays.getIterator();for(;P.hasNext();){let T=P.getNext().value;if(T.getKey().getCollectionGroup()===S&&T.largestBatchId>N){let S=O.get(T.largestBatchId);null===S&&(S=m4(),O=O.insert(T.largestBatchId,S)),S.set(T.getKey(),T)}}let M=m4(),L=O.getIterator();for(;L.hasNext()&&(L.getNext().value.forEach((T,S)=>M.set(T,S)),!(M.size()>=R)););return dA.resolve(M)}saveOverlay(T,S,N){let R=this.overlays.get(N.key);if(null!==R){let T=this.overlayByBatchId.get(R.largestBatchId).delete(N.key);this.overlayByBatchId.set(R.largestBatchId,T)}this.overlays=this.overlays.insert(N.key,new gW(S,N));let O=this.overlayByBatchId.get(S);void 0===O&&(O=ge(),this.overlayByBatchId.set(S,O)),this.overlayByBatchId.set(S,O.add(N.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wB{constructor(){this.sessionToken=pv.EMPTY_BYTE_STRING}getSessionToken(T){return dA.resolve(this.sessionToken)}setSessionToken(T,S){return this.sessionToken=S,dA.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(){this.refsByKey=new pd(wU.compareByKey),this.refsByTarget=new pd(wU.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(T,S){let N=new wU(T,S);this.refsByKey=this.refsByKey.add(N),this.refsByTarget=this.refsByTarget.add(N)}addReferences(T,S){T.forEach(T=>this.addReference(T,S))}removeReference(T,S){this.removeRef(new wU(T,S))}removeReferences(T,S){T.forEach(T=>this.removeReference(T,S))}removeReferencesForId(T){let S=new du(new ds([])),N=new wU(S,T),R=new wU(S,T+1),O=[];return this.refsByTarget.forEachInRange([N,R],T=>{this.removeRef(T),O.push(T.key)}),O}removeAllReferences(){this.refsByKey.forEach(T=>this.removeRef(T))}removeRef(T){this.refsByKey=this.refsByKey.delete(T),this.refsByTarget=this.refsByTarget.delete(T)}referencesForId(T){let S=new du(new ds([])),N=new wU(S,T),R=new wU(S,T+1),O=ge();return this.refsByTarget.forEachInRange([N,R],T=>{O=O.add(T.key)}),O}containsKey(T){let S=new wU(T,0),N=this.refsByKey.firstAfterOrEqual(S);return null!==N&&T.isEqual(N.key)}}class wU{constructor(T,S){this.key=T,this.targetOrBatchId=S}static compareByKey(T,S){return du.comparator(T.key,S.key)||c5(T.targetOrBatchId,S.targetOrBatchId)}static compareByTargetId(T,S){return c5(T.targetOrBatchId,S.targetOrBatchId)||du.comparator(T.key,S.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wz{constructor(T,S){this.indexManager=T,this.referenceDelegate=S,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new pd(wU.compareByKey)}checkEmpty(T){return dA.resolve(0===this.mutationQueue.length)}addMutationBatch(T,S,N,R){let O=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let P=new gH(O,S,N,R);for(let S of(this.mutationQueue.push(P),R))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new wU(S.key,O)),this.indexManager.addToCollectionParentIndex(T,S.key.path.popLast());return dA.resolve(P)}lookupMutationBatch(T,S){return dA.resolve(this.findMutationBatch(S))}getNextMutationBatchAfterBatchId(T,S){let N=S+1,R=this.indexOfBatchId(N),O=R<0?0:R;return dA.resolve(this.mutationQueue.length>O?this.mutationQueue[O]:null)}getHighestUnacknowledgedBatchId(){return dA.resolve(0===this.mutationQueue.length?pF:this.nextBatchId-1)}getAllMutationBatches(T){return dA.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(T,S){let N=new wU(S,0),R=new wU(S,Number.POSITIVE_INFINITY),O=[];return this.batchesByDocumentKey.forEachInRange([N,R],T=>{let S=this.findMutationBatch(T.targetOrBatchId);O.push(S)}),dA.resolve(O)}getAllMutationBatchesAffectingDocumentKeys(T,S){let N=new pd(c5);return S.forEach(T=>{let S=new wU(T,0),R=new wU(T,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([S,R],T=>{N=N.add(T.targetOrBatchId)})}),dA.resolve(this.findMutationBatches(N))}getAllMutationBatchesAffectingQuery(T,S){let N=S.path,R=N.length+1,O=N;du.isDocumentKey(O)||(O=O.child(""));let P=new wU(new du(O),0),M=new pd(c5);return this.batchesByDocumentKey.forEachWhile(T=>{let S=T.key.path;return!!N.isPrefixOf(S)&&(S.length===R&&(M=M.add(T.targetOrBatchId)),!0)},P),dA.resolve(this.findMutationBatches(M))}findMutationBatches(T){let S=[];return T.forEach(T=>{let N=this.findMutationBatch(T);null!==N&&S.push(N)}),S}removeMutationBatch(T,S){cz(0===this.indexOfExistingBatchId(S.batchId,"removed")),this.mutationQueue.shift();let N=this.batchesByDocumentKey;return dA.forEach(S.mutations,R=>{let O=new wU(R.key,S.batchId);return N=N.delete(O),this.referenceDelegate.markPotentiallyOrphaned(T,R.key)}).next(()=>{this.batchesByDocumentKey=N})}removeCachedMutationKeys(T){}containsKey(T,S){let N=new wU(S,0),R=this.batchesByDocumentKey.firstAfterOrEqual(N);return dA.resolve(S.isEqual(R&&R.key))}performConsistencyCheck(T){return this.mutationQueue.length,dA.resolve()}indexOfExistingBatchId(T,S){return this.indexOfBatchId(T)}indexOfBatchId(T){return 0===this.mutationQueue.length?0:T-this.mutationQueue[0].batchId}findMutationBatch(T){let S=this.indexOfBatchId(T);return S<0||S>=this.mutationQueue.length?null:this.mutationQueue[S]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wq(){return new po(du.comparator)}class w${constructor(T){this.sizer=T,this.docs=wq(),this.size=0}setIndexManager(T){this.indexManager=T}addEntry(T,S){let N=S.key,R=this.docs.get(N),O=R?R.size:0,P=this.sizer(S);return this.docs=this.docs.insert(N,{document:S.mutableCopy(),size:P}),this.size+=P-O,this.indexManager.addToCollectionParentIndex(T,N.path.popLast())}removeEntry(T){let S=this.docs.get(T);S&&(this.docs=this.docs.remove(T),this.size-=S.size)}getEntry(T,S){let N=this.docs.get(S);return dA.resolve(N?N.document.mutableCopy():fP.newInvalidDocument(S))}getEntries(T,S){let N=mZ();return S.forEach(T=>{let S=this.docs.get(T);N=N.insert(T,S?S.document.mutableCopy():fP.newInvalidDocument(T))}),dA.resolve(N)}getDocumentsMatchingQuery(T,S,N,R){let O=mZ(),P=S.path,M=new du(P.child("")),L=this.docs.getIteratorFrom(M);for(;L.hasNext();){let{key:T,value:{document:M}}=L.getNext();if(!P.isPrefixOf(T.path))break;!(T.path.length>P.length+1||0>=d_(dE(M),N))&&(R.has(M.key)||mq(S,M))&&(O=O.insert(M.key,M.mutableCopy()))}return dA.resolve(O)}getAllFromCollectionGroup(T,S,N,R){cU()}forEachDocumentKey(T,S){return dA.forEach(this.docs,T=>S(T))}newChangeBuffer(T){return new wG(this)}getSize(T){return dA.resolve(this.size)}}function wH(T){return new w$(T)}class wG extends wE{constructor(T){super(),this.documentCache=T}applyChanges(T){let S=[];return this.changes.forEach((N,R)=>{R.isValidDocument()?S.push(this.documentCache.addEntry(T,R)):this.documentCache.removeEntry(N)}),dA.waitFor(S)}getFromCache(T,S){return this.documentCache.getEntry(T,S)}getAllFromCache(T,S){return this.documentCache.getEntries(T,S)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wW{constructor(T){this.persistence=T,this.targets=new mJ(T=>mu(T),mh),this.lastRemoteSnapshotVersion=dr.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new wV,this.targetCount=0,this.targetIdGenerator=wr.forTargetCache()}forEachTarget(T,S){return this.targets.forEach((T,N)=>S(N)),dA.resolve()}getLastRemoteSnapshotVersion(T){return dA.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(T){return dA.resolve(this.highestSequenceNumber)}allocateTargetId(T){return this.highestTargetId=this.targetIdGenerator.next(),dA.resolve(this.highestTargetId)}setTargetsMetadata(T,S,N){return N&&(this.lastRemoteSnapshotVersion=N),S>this.highestSequenceNumber&&(this.highestSequenceNumber=S),dA.resolve()}saveTargetData(T){this.targets.set(T.target,T);let S=T.targetId;S>this.highestTargetId&&(this.targetIdGenerator=new wr(S),this.highestTargetId=S),T.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=T.sequenceNumber)}addTargetData(T,S){return this.saveTargetData(S),this.targetCount+=1,dA.resolve()}updateTargetData(T,S){return this.saveTargetData(S),dA.resolve()}removeTargetData(T,S){return this.targets.delete(S.target),this.references.removeReferencesForId(S.targetId),this.targetCount-=1,dA.resolve()}removeTargets(T,S,N){let R=0,O=[];return this.targets.forEach((P,M)=>{M.sequenceNumber<=S&&null===N.get(M.targetId)&&(this.targets.delete(P),O.push(this.removeMatchingKeysForTargetId(T,M.targetId)),R++)}),dA.waitFor(O).next(()=>R)}getTargetCount(T){return dA.resolve(this.targetCount)}getTargetData(T,S){let N=this.targets.get(S)||null;return dA.resolve(N)}addMatchingKeys(T,S,N){return this.references.addReferences(S,N),dA.resolve()}removeMatchingKeys(T,S,N){this.references.removeReferences(S,N);let R=this.persistence.referenceDelegate,O=[];return R&&S.forEach(S=>{O.push(R.markPotentiallyOrphaned(T,S))}),dA.waitFor(O)}removeMatchingKeysForTargetId(T,S){return this.references.removeReferencesForId(S),dA.resolve()}getMatchingKeysForTargetId(T,S){let N=this.references.referencesForId(S);return dA.resolve(N)}containsKey(T,S){return dA.resolve(this.references.containsKey(S))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wK="MemoryPersistence";class wQ{constructor(T,S){this.mutationQueues={},this.overlays={},this.listenSequence=new dQ(0),this._started=!1,this._started=!0,this.globalsCache=new wB,this.referenceDelegate=T(this),this.targetCache=new wW(this);let N=T=>this.referenceDelegate.documentSize(T);this.indexManager=new bW,this.remoteDocumentCache=wH(N),this.serializer=new vI(S),this.bundleCache=new wj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(T){return this.indexManager}getDocumentOverlayCache(T){let S=this.overlays[T.toKey()];return S||(S=new wF,this.overlays[T.toKey()]=S),S}getMutationQueue(T,S){let N=this.mutationQueues[T.toKey()];return N||(N=new wz(S,this.referenceDelegate),this.mutationQueues[T.toKey()]=N),N}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(T,S,N){cj(wK,"Starting transaction:",T);let R=new wY(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),N(R).next(T=>this.referenceDelegate.onTransactionCommitted(R).next(()=>T)).toPromise().then(T=>(R.raiseOnCommittedEvent(),T))}mutationQueuesContainKey(T,S){return dA.or(Object.values(this.mutationQueues).map(N=>()=>N.containsKey(T,S)))}}class wY extends dk{constructor(T){super(),this.currentSequenceNumber=T}}class wJ{constructor(T){this.persistence=T,this.localViewReferences=new wV,this._orphanedDocuments=null}static factory(T){return new wJ(T)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw cU()}addReference(T,S,N){return this.localViewReferences.addReference(N,S),this.orphanedDocuments.delete(N.toString()),dA.resolve()}removeReference(T,S,N){return this.localViewReferences.removeReference(N,S),this.orphanedDocuments.add(N.toString()),dA.resolve()}markPotentiallyOrphaned(T,S){return this.orphanedDocuments.add(S.toString()),dA.resolve()}removeTarget(T,S){this.localViewReferences.removeReferencesForId(S.targetId).forEach(T=>this.orphanedDocuments.add(T.toString()));let N=this.persistence.getTargetCache();return N.getMatchingKeysForTargetId(T,S.targetId).next(T=>{T.forEach(T=>this.orphanedDocuments.add(T.toString()))}).next(()=>N.removeTargetData(T,S))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(T){let S=this.persistence.getRemoteDocumentCache().newChangeBuffer();return dA.forEach(this.orphanedDocuments,N=>{let R=du.fromPath(N);return this.isReferenced(T,R).next(T=>{T||S.removeEntry(R,dr.min())})}).next(()=>(this._orphanedDocuments=null,S.apply(T)))}updateLimboDocument(T,S){return this.isReferenced(T,S).next(T=>{T?this.orphanedDocuments.delete(S.toString()):this.orphanedDocuments.add(S.toString())})}documentSize(T){return 0}isReferenced(T,S){return dA.or([()=>dA.resolve(this.localViewReferences.containsKey(S)),()=>this.persistence.getTargetCache().containsKey(T,S),()=>this.persistence.mutationQueuesContainKey(T,S)])}}class wX{constructor(T,S){this.persistence=T,this.orphanedSequenceNumbers=new mJ(T=>d0(T.path),(T,S)=>T.isEqual(S)),this.garbageCollector=wb(this,S)}static factory(T,S){return new wX(T,S)}onTransactionStarted(){}onTransactionCommitted(T){return dA.resolve()}forEachTarget(T,S){return this.persistence.getTargetCache().forEachTarget(T,S)}getSequenceNumberCount(T){let S=this.orphanedDocumentCount(T);return this.persistence.getTargetCache().getTargetCount(T).next(T=>S.next(S=>T+S))}orphanedDocumentCount(T){let S=0;return this.forEachOrphanedDocumentSequenceNumber(T,T=>{S++}).next(()=>S)}forEachOrphanedDocumentSequenceNumber(T,S){return dA.forEach(this.orphanedSequenceNumbers,(N,R)=>this.isPinned(T,N,R).next(T=>T?dA.resolve():S(R)))}removeTargets(T,S,N){return this.persistence.getTargetCache().removeTargets(T,S,N)}removeOrphanedDocuments(T,S){let N=0,R=this.persistence.getRemoteDocumentCache(),O=R.newChangeBuffer();return R.forEachDocumentKey(T,R=>this.isPinned(T,R,S).next(T=>{T||(N++,O.removeEntry(R,dr.min()))})).next(()=>O.apply(T)).next(()=>N)}markPotentiallyOrphaned(T,S){return this.orphanedSequenceNumbers.set(S,T.currentSequenceNumber),dA.resolve()}removeTarget(T,S){let N=S.withSequenceNumber(T.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(T,N)}addReference(T,S,N){return this.orphanedSequenceNumbers.set(N,T.currentSequenceNumber),dA.resolve()}removeReference(T,S,N){return this.orphanedSequenceNumbers.set(N,T.currentSequenceNumber),dA.resolve()}updateLimboDocument(T,S){return this.orphanedSequenceNumbers.set(S,T.currentSequenceNumber),dA.resolve()}documentSize(T){let S=T.key.toString().length;return T.isFoundDocument()&&(S+=fp(T.data.value)),S}isPinned(T,S,N){return dA.or([()=>this.persistence.mutationQueuesContainKey(T,S),()=>this.persistence.getTargetCache().containsKey(T,S),()=>{let T=this.orphanedSequenceNumbers.get(S);return dA.resolve(void 0!==T&&T>N)}])}getCacheSize(T){return this.persistence.getRemoteDocumentCache().getSize(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wZ{constructor(T){this.serializer=T}createOrUpgrade(T,S,N,R){let O=new dO("createOrUpgrade",S);N<1&&R>=1&&(w1(T),w2(T),w9(T),w4(T));let P=dA.resolve();return N<3&&R>=3&&(0!==N&&(w8(T),w9(T)),P=P.next(()=>Te(O))),N<4&&R>=4&&(0!==N&&(P=P.next(()=>w3(T,O))),P=P.next(()=>{Tt(T)})),N<5&&R>=5&&(P=P.next(()=>this.removeAcknowledgedMutations(O))),N<6&&R>=6&&(P=P.next(()=>(w5(T),this.addDocumentGlobal(O)))),N<7&&R>=7&&(P=P.next(()=>this.ensureSequenceNumbers(O))),N<8&&R>=8&&(P=P.next(()=>this.createCollectionParentIndex(T,O))),N<9&&R>=9&&(P=P.next(()=>{w7(T)})),N<10&&R>=10&&(P=P.next(()=>this.rewriteCanonicalIds(O))),N<11&&R>=11&&(P=P.next(()=>{Tr(T),Ti(T)})),N<12&&R>=12&&(P=P.next(()=>{Ts(T)})),N<13&&R>=13&&(P=P.next(()=>w6(T)).next(()=>this.rewriteRemoteDocumentCache(T,O)).next(()=>T.deleteObjectStore(d5))),N<14&&R>=14&&(P=P.next(()=>this.runOverlayMigration(T,O))),N<15&&R>=15&&(P=P.next(()=>Tn(T))),N<16&&R>=16&&(P=P.next(()=>{S.objectStore(hz).clear()}).next(()=>{S.objectStore(hG).clear()})),N<17&&R>=17&&(P=P.next(()=>{Ta(T)})),P}addDocumentGlobal(T){let S=0;return T.store(d5).iterate((T,N)=>{S+=b4(N)}).next(()=>{let N={byteSize:S};return T.store(hy).put(hv,N)})}removeAcknowledgedMutations(T){let S=T.store(d7),N=T.store(ht);return S.loadAll().next(S=>dA.forEach(S,S=>{let R=IDBKeyRange.bound([S.userId,pF],[S.userId,S.lastAcknowledgedBatchId]);return N.loadAll(hn,R).next(N=>dA.forEach(N,N=>{cz(N.userId===S.userId);let R=vM(this.serializer,N);return b3(T,S.userId,R).next(()=>{})}))}))}ensureSequenceNumbers(T){let S=T.store(hE),N=T.store(d5);return T.store(hN).get(hk).next(T=>{let R=N=>S.put({targetId:0,path:d0(N),sequenceNumber:T.highestListenSequenceNumber}),O=[];return N.iterate((T,N)=>{let P=new ds(T),M=w0(P);O.push(S.get(M).next(T=>T?dA.resolve():R(P)))}).next(()=>dA.waitFor(O))})}createCollectionParentIndex(T,S){T.createObjectStore(hA,{keyPath:hR});let N=S.store(hA),R=new bK,O=T=>{if(R.add(T)){let S=T.lastSegment(),R=T.popLast();return N.put({collectionId:S,parent:d0(R)})}};return S.store(d5).iterate({keysOnly:!0},(T,S)=>O(new ds(T).popLast())).next(()=>S.store(hc).iterate({keysOnly:!0},([T,S,N],R)=>O(d6(S).popLast())))}rewriteCanonicalIds(T){let S=T.store(hw);return S.iterate((T,N)=>{let R=vL(N),O=vj(this.serializer,R);return S.put(O)})}rewriteRemoteDocumentCache(T,S){let N=S.store(d5),R=[];return N.iterate((T,N)=>{let O=S.store(hd),P=To(N).path.toArray(),M={prefixPath:P.slice(0,P.length-2),collectionGroup:P[P.length-2],documentId:P[P.length-1],readTime:N.readTime||[0,0],unknownDocument:N.unknownDocument,noDocument:N.noDocument,document:N.document,hasCommittedMutations:!!N.hasCommittedMutations};R.push(O.put(M))}).next(()=>dA.waitFor(R))}runOverlayMigration(T,S){let N=S.store(ht),R=w_(this.serializer),O=new wQ(wJ.factory,this.serializer.remoteSerializer);return N.loadAll().next(T=>{let N=new Map;return T.forEach(T=>{var S;let R=null!==(S=N.get(T.userId))&&void 0!==S?S:ge();vM(this.serializer,T).keys().forEach(T=>R=R.add(T)),N.set(T.userId,R)}),dA.forEach(N,(T,N)=>{let P=new cR(N),M=v3.forUser(this.serializer,P),L=O.getIndexManager(P);return new wL(R,b6.forUser(P,this.serializer,L,O.referenceDelegate),M,L).recalculateAndSaveOverlaysForDocumentKeys(new pr(S,dQ.INVALID),T).next()})})}}function w0(T){return[0,d0(T)]}function w1(T){T.createObjectStore(d9)}function w2(T){T.createObjectStore(d7,{keyPath:he}),T.createObjectStore(ht,{keyPath:hr,autoIncrement:!0}).createIndex(hn,hs,{unique:!0}),T.createObjectStore(hc)}function w3(T,S){return S.store(ht).loadAll().next(N=>{T.deleteObjectStore(ht),T.createObjectStore(ht,{keyPath:hr,autoIncrement:!0}).createIndex(hn,hs,{unique:!0});let R=S.store(ht),O=N.map(T=>R.put(T));return dA.waitFor(O)})}function w4(T){T.createObjectStore(d5)}function w6(T){let S=T.createObjectStore(hd,{keyPath:hh});S.createIndex(hp,hf),S.createIndex(hm,hg)}function w5(T){T.createObjectStore(hy)}function w9(T){T.createObjectStore(hE,{keyPath:hC}).createIndex(h_,hI,{unique:!0}),T.createObjectStore(hw,{keyPath:hT}).createIndex(hS,hx,{unique:!0}),T.createObjectStore(hN)}function w8(T){T.deleteObjectStore(hE),T.deleteObjectStore(hw),T.deleteObjectStore(hN)}function w7(T){T.objectStoreNames.contains("remoteDocumentChanges")&&T.deleteObjectStore("remoteDocumentChanges")}function Te(T){let S=T.store(hN),N={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:dr.min().toTimestamp(),targetCount:0};return S.put(hk,N)}function Tt(T){T.createObjectStore(hD,{keyPath:hO})}function Tr(T){T.createObjectStore(hP,{keyPath:hM})}function Ti(T){T.createObjectStore(hL,{keyPath:hj})}function Tn(T){T.createObjectStore(hF,{keyPath:hB,autoIncrement:!0}).createIndex(hV,hU,{unique:!1}),T.createObjectStore(hz,{keyPath:hq}).createIndex(h$,hH,{unique:!1}),T.createObjectStore(hG,{keyPath:hW}).createIndex(hK,hQ,{unique:!1})}function Ts(T){let S=T.createObjectStore(hY,{keyPath:hJ});S.createIndex(hX,hZ,{unique:!1}),S.createIndex(h0,h1,{unique:!1})}function Ta(T){T.createObjectStore(h2,{keyPath:h3})}function To(T){return T.document?new du(ds.fromString(T.document.name).popFirst(5)):T.noDocument?du.fromSegments(T.noDocument.path):T.unknownDocument?du.fromSegments(T.unknownDocument.path):cU()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl="IndexedDbPersistence",Tu=null,Tc=5e3,Td=4e3,Th=null,Tp=null,Tf="firestore_zombie",Tm="main";class Tg{constructor(T,S,N,R,O,P,M,L,V,U,$=wP){if(this.allowTabSynchronization=T,this.persistenceKey=S,this.clientId=N,this.queue=O,this.window=P,this.document=M,this.sequenceNumberSyncer=V,this.forceOwningTab=U,this.schemaVersion=$,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=T=>Promise.resolve(),!Tg.isAvailable())throw new cH(c$.UNIMPLEMENTED,Tp);this.referenceDelegate=new ww(this,R),this.dbName=S+Tm,this.serializer=new vI(L),this.simpleDb=new dP(this.dbName,this.schemaVersion,new wZ(this.serializer)),this.globalsCache=new v6,this.targetCache=new wi(this.referenceDelegate,this.serializer),this.remoteDocumentCache=w_(this.serializer),this.bundleCache=new vX,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===U&&cF(Tl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new cH(c$.FAILED_PRECONDITION,Th);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",T=>this.targetCache.getHighestSequenceNumber(T))}).then(T=>{this.listenSequence=new dQ(T,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(T=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(T)))}setPrimaryStateListener(T){return this.primaryStateListener=async S=>{if(this.started)return T(S)},T(this.isPrimary)}setDatabaseDeletedListener(T){this.simpleDb.setVersionChangeListener(async S=>{null===S.newVersion&&await T()})}setNetworkEnabled(T){this.networkEnabled!==T&&(this.networkEnabled=T,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",T=>Tv(T).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(T).next(T=>{T||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(T)).next(S=>this.isPrimary&&!S?this.releasePrimaryLeaseIfHeld(T).next(()=>!1):!!S&&this.acquireOrExtendPrimaryLease(T).next(()=>!0))).catch(T=>{if(dF(T))return cj(Tl,"Failed to extend owner lease: ",T),this.isPrimary;if(!this.allowTabSynchronization)throw T;return cj(Tl,"Releasing owner lease after error during lease refresh",T),!1}).then(T=>{this.isPrimary!==T&&this.queue.enqueueRetryable(()=>this.primaryStateListener(T)),this.isPrimary=T})}verifyPrimaryLease(T){return Ty(T).get(d8).next(T=>dA.resolve(this.isLocalClient(T)))}removeClientMetadata(T){return Tv(T).delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,Tu)){this.lastGarbageCollectionTime=Date.now();let T=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",T=>{let S=pi(T,hD);return S.loadAll().next(T=>{let N=this.filterActiveClients(T,Tu),R=T.filter(T=>-1===N.indexOf(T));return dA.forEach(R,T=>S.delete(T.clientId)).next(()=>R)})}).catch(()=>[]);if(this.webStorage)for(let S of T)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(S.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",Td,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(T){return!!T&&T.ownerId===this.clientId}canActAsPrimary(T){return this.forceOwningTab?dA.resolve(!0):Ty(T).get(d8).next(S=>{if(null!==S&&this.isWithinAge(S.leaseTimestampMs,Tc)&&!this.isClientZombied(S.ownerId)){if(this.isLocalClient(S)&&this.networkEnabled)return!0;if(!this.isLocalClient(S)){if(!S.allowTabSynchronization)throw new cH(c$.FAILED_PRECONDITION,Th);return!1}}return!!this.networkEnabled&&!!this.inForeground||Tv(T).loadAll().next(T=>void 0===this.filterActiveClients(T,Tc).find(T=>{if(this.clientId!==T.clientId){let S=!this.networkEnabled&&T.networkEnabled,N=!this.inForeground&&T.inForeground,R=this.networkEnabled===T.networkEnabled;if(S||N&&R)return!0}return!1}))}).next(T=>(this.isPrimary!==T&&cj(Tl,`Client ${T?"is":"is not"} eligible for a primary lease.`),T))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[d9,hD],T=>{let S=new pr(T,dQ.INVALID);return this.releasePrimaryLeaseIfHeld(S).next(()=>this.removeClientMetadata(S))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(T,S){return T.filter(T=>this.isWithinAge(T.updateTimeMs,S)&&!this.isClientZombied(T.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",T=>Tv(T).loadAll().next(T=>this.filterActiveClients(T,Tu).map(T=>T.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(T,S){return b6.forUser(T,this.serializer,S,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(T){return new bJ(T,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(T){return v3.forUser(this.serializer,T)}getBundleCache(){return this.bundleCache}runTransaction(T,S,N){let R;cj(Tl,"Starting transaction:",T);let O="readonly"===S?"readonly":"readwrite",P=pt(this.schemaVersion);return this.simpleDb.runTransaction(T,O,P,O=>(R=new pr(O,this.listenSequence?this.listenSequence.next():dQ.INVALID),"readwrite-primary"===S)?this.verifyPrimaryLease(R).next(T=>!!T||this.canActAsPrimary(R)).next(S=>{if(!S)throw cF(`Failed to obtain primary lease for action '${T}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new cH(c$.FAILED_PRECONDITION,dI);return N(R)}).next(T=>this.acquireOrExtendPrimaryLease(R).next(()=>T)):this.verifyAllowTabSynchronization(R).next(()=>N(R))).then(T=>(R.raiseOnCommittedEvent(),T))}verifyAllowTabSynchronization(T){return Ty(T).get(d8).next(T=>{if(null!==T&&this.isWithinAge(T.leaseTimestampMs,Tc)&&!this.isClientZombied(T.ownerId)&&!this.isLocalClient(T)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!T.allowTabSynchronization))throw new cH(c$.FAILED_PRECONDITION,Th)})}acquireOrExtendPrimaryLease(T){let S={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ty(T).put(d8,S)}static isAvailable(){return dP.isAvailable()}releasePrimaryLeaseIfHeld(T){let S=Ty(T);return S.get(d8).next(T=>this.isLocalClient(T)?(cj(Tl,"Releasing primary lease."),S.delete(d8)):dA.resolve())}isWithinAge(T,S){let N=Date.now(),R=N-S,O=N;return!(T<R)&&(!(T>O)||(cF(`Detected an update time that is in the future: ${T} > ${O}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var T;"function"==typeof(null===(T=this.window)||void 0===T?void 0:T.addEventListener)&&(this.windowUnloadHandler=()=>{this.markClientZombied();let T=/(?:Version|Mobile)\/1[456]/;isSafari()&&(navigator.appVersion.match(T)||navigator.userAgent.match(T))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(T){var S;try{let N=(null===(S=this.webStorage)||void 0===S?void 0:S.getItem(this.zombiedClientLocalStorageKey(T)))!==null;return cj(Tl,`Client '${T}' ${N?"is":"is not"} zombied in LocalStorage`),N}catch(T){return cF(Tl,"Failed to get zombied client id.",T),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(T){cF("Failed to set zombie client id.",T)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(T){}}zombiedClientLocalStorageKey(T){return`${Tf}_${this.persistenceKey}_${T}`}}function Ty(T){return pi(T,d9)}function Tv(T){return pi(T,hD)}function Tb(T,S){let N=T.projectId;return T.isDefaultDatabase||(N+="."+T.database),"firestore/"+S+"/"+N+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(T,S,N,R,O){S=[...S],(T=[...T]).sort(N),S.sort(N);let P=T.length,M=S.length,L=0,V=0;for(;L<M&&V<P;){let P=N(T[V],S[L]);P<0?O(T[V++]):P>0?R(S[L++]):(L++,V++)}for(;L<M;)R(S[L++]);for(;V<P;)O(T[V++])}function TT(T,S){if(T.length!==S.length)return!1;for(let N=0;N<T.length;++N)if(T[N]!==S[N])return!1;return!0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TS="LocalStore",Tx=3e8;class TE{constructor(T,S,N,R){this.persistence=T,this.queryEngine=S,this.serializer=R,this.targetDataByTarget=new po(c5),this.targetIdByTarget=new mJ(T=>mu(T),mh),this.collectionGroupReadTime=new Map,this.remoteDocuments=T.getRemoteDocumentCache(),this.targetCache=T.getTargetCache(),this.bundleCache=T.getBundleCache(),this.initializeUserComponents(N)}initializeUserComponents(T){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(T),this.indexManager=this.persistence.getIndexManager(T),this.mutationQueue=this.persistence.getMutationQueue(T,this.indexManager),this.localDocuments=new wL(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(T){return this.persistence.runTransaction("Collect garbage","readwrite-primary",S=>T.collect(S,this.targetDataByTarget))}}function TC(T,S,N,R){return new TE(T,S,N,R)}async function T_(T,S){let N=cq(T);return await N.persistence.runTransaction("Handle user change","readonly",T=>{let R;return N.mutationQueue.getAllMutationBatches(T).next(O=>(R=O,N.initializeUserComponents(S),N.mutationQueue.getAllMutationBatches(T))).next(S=>{let O=[],P=[],M=ge();for(let T of R)for(let S of(O.push(T.batchId),T.mutations))M=M.add(S.key);for(let T of S)for(let S of(P.push(T.batchId),T.mutations))M=M.add(S.key);return N.localDocuments.getDocuments(T,M).next(T=>({affectedDocuments:T,removedBatchIds:O,addedBatchIds:P}))})})}function TI(T,S){let N,R;let O=cq(T),P=dt.now(),M=S.reduce((T,S)=>T.add(S.key),ge());return O.persistence.runTransaction("Locally write mutations","readwrite",T=>{let L=mZ(),V=ge();return O.remoteDocuments.getEntries(T,M).next(T=>{(L=T).forEach((T,S)=>{S.isValidDocument()||(V=V.add(T))})}).next(()=>O.localDocuments.getOverlayedDocuments(T,L)).next(R=>{N=R;let M=[];for(let T of S){let S=gA(T,N.get(T.key).overlayedDocument);null!=S&&M.push(new gM(T.key,S,fO(S.value.mapValue),gE.exists(!0)))}return O.mutationQueue.addMutationBatch(T,P,M,S)}).next(S=>{R=S;let P=S.applyToLocalDocumentSet(N,V);return O.documentOverlayCache.saveOverlays(T,S.batchId,P)})}).then(()=>({batchId:R.batchId,changes:m3(N)}))}function Tk(T,S){let N=cq(T);return N.persistence.runTransaction("Acknowledge batch","readwrite-primary",T=>{let R=S.batch.keys(),O=N.remoteDocuments.newChangeBuffer({trackRemovals:!0});return Tq(N,T,S,O).next(()=>O.apply(T)).next(()=>N.mutationQueue.performConsistencyCheck(T)).next(()=>N.documentOverlayCache.removeOverlaysForBatchId(T,R,S.batch.batchId)).next(()=>N.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(T,TN(S))).next(()=>N.localDocuments.getDocuments(T,R))})}function TN(T){let S=ge();for(let N=0;N<T.mutationResults.length;++N)T.mutationResults[N].transformResults.length>0&&(S=S.add(T.batch.mutations[N].key));return S}function TA(T,S){let N=cq(T);return N.persistence.runTransaction("Reject batch","readwrite-primary",T=>{let R;return N.mutationQueue.lookupMutationBatch(T,S).next(S=>(cz(null!==S),R=S.keys(),N.mutationQueue.removeMutationBatch(T,S))).next(()=>N.mutationQueue.performConsistencyCheck(T)).next(()=>N.documentOverlayCache.removeOverlaysForBatchId(T,R,S)).next(()=>N.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(T,R)).next(()=>N.localDocuments.getDocuments(T,R))})}function TR(T){let S=cq(T);return S.persistence.runTransaction("Get highest unacknowledged batch id","readonly",T=>S.mutationQueue.getHighestUnacknowledgedBatchId(T))}function TD(T){let S=cq(T);return S.persistence.runTransaction("Get last remote snapshot version","readonly",T=>S.targetCache.getLastRemoteSnapshotVersion(T))}function TO(T,S){let N=cq(T),R=S.snapshotVersion,O=N.targetDataByTarget;return N.persistence.runTransaction("Apply remote event","readwrite-primary",T=>{let P=N.remoteDocuments.newChangeBuffer({trackRemovals:!0});O=N.targetDataByTarget;let M=[];S.targetChanges.forEach((P,L)=>{let V=O.get(L);if(!V)return;M.push(N.targetCache.removeMatchingKeys(T,P.removedDocuments,L).next(()=>N.targetCache.addMatchingKeys(T,P.addedDocuments,L)));let U=V.withSequenceNumber(T.currentSequenceNumber);null!==S.targetMismatches.get(L)?U=U.withResumeToken(pv.EMPTY_BYTE_STRING,dr.min()).withLastLimboFreeSnapshotVersion(dr.min()):P.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(P.resumeToken,R)),O=O.insert(L,U),TM(V,U,P)&&M.push(N.targetCache.updateTargetData(T,U))});let L=mZ(),V=ge();if(S.documentUpdates.forEach(R=>{S.resolvedLimboDocuments.has(R)&&M.push(N.persistence.referenceDelegate.updateLimboDocument(T,R))}),M.push(TP(T,P,S.documentUpdates).next(T=>{L=T.changedDocuments,V=T.existenceChangedKeys})),!R.isEqual(dr.min())){let S=N.targetCache.getLastRemoteSnapshotVersion(T).next(S=>N.targetCache.setTargetsMetadata(T,T.currentSequenceNumber,R));M.push(S)}return dA.waitFor(M).next(()=>P.apply(T)).next(()=>N.localDocuments.getLocalViewOfDocuments(T,L,V)).next(()=>L)}).then(T=>(N.targetDataByTarget=O,T))}function TP(T,S,N){let R=ge(),O=ge();return N.forEach(T=>R=R.add(T)),S.getEntries(T,R).next(T=>{let R=mZ();return N.forEach((N,P)=>{let M=T.get(N);P.isFoundDocument()!==M.isFoundDocument()&&(O=O.add(N)),P.isNoDocument()&&P.version.isEqual(dr.min())?(S.removeEntry(N,P.readTime),R=R.insert(N,P)):!M.isValidDocument()||P.version.compareTo(M.version)>0||0===P.version.compareTo(M.version)&&M.hasPendingWrites?(S.addEntry(P),R=R.insert(N,P)):cj(TS,"Ignoring outdated watch update for ",N,". Current version:",M.version," Watch version:",P.version)}),{changedDocuments:R,existenceChangedKeys:O}})}function TM(T,S,N){return!!(0===T.resumeToken.approximateByteSize()||S.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=Tx)||N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}async function TL(T,S){let N=cq(T);try{await N.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>dA.forEach(S,S=>dA.forEach(S.addedKeys,R=>N.persistence.referenceDelegate.addReference(T,S.targetId,R)).next(()=>dA.forEach(S.removedKeys,R=>N.persistence.referenceDelegate.removeReference(T,S.targetId,R)))))}catch(T){if(dF(T))cj(TS,"Failed to update sequence numbers: "+T);else throw T}for(let T of S){let S=T.targetId;if(!T.fromCache){let T=N.targetDataByTarget.get(S),R=T.snapshotVersion,O=T.withLastLimboFreeSnapshotVersion(R);N.targetDataByTarget=N.targetDataByTarget.insert(S,O)}}}function Tj(T,S){let N=cq(T);return N.persistence.runTransaction("Get next mutation batch","readonly",T=>(void 0===S&&(S=pF),N.mutationQueue.getNextMutationBatchAfterBatchId(T,S)))}function TF(T,S){let N=cq(T);return N.persistence.runTransaction("read document","readonly",T=>N.localDocuments.getDocument(T,S))}function TB(T,S){let N=cq(T);return N.persistence.runTransaction("Allocate target","readwrite",T=>{let R;return N.targetCache.getTargetData(T,S).next(O=>O?(R=O,dA.resolve(R)):N.targetCache.allocateTargetId(T).next(O=>(R=new v_(S,O,"TargetPurposeListen",T.currentSequenceNumber),N.targetCache.addTargetData(T,R).next(()=>R))))}).then(T=>{let R=N.targetDataByTarget.get(T.targetId);return(null===R||T.snapshotVersion.compareTo(R.snapshotVersion)>0)&&(N.targetDataByTarget=N.targetDataByTarget.insert(T.targetId,T),N.targetIdByTarget.set(S,T.targetId)),T})}function TV(T,S,N){let R=cq(T),O=R.targetIdByTarget.get(N);return void 0!==O?dA.resolve(R.targetDataByTarget.get(O)):R.targetCache.getTargetData(S,N)}async function TU(T,S,N){let R=cq(T),O=R.targetDataByTarget.get(S),P=N?"readwrite":"readwrite-primary";try{N||await R.persistence.runTransaction("Release target",P,T=>R.persistence.referenceDelegate.removeTarget(T,O))}catch(T){if(dF(T))cj(TS,`Failed to update sequence numbers for target ${S}: ${T}`);else throw T}R.targetDataByTarget=R.targetDataByTarget.remove(S),R.targetIdByTarget.delete(O.target)}function Tz(T,S,N){let R=cq(T),O=dr.min(),P=ge();return R.persistence.runTransaction("Execute query","readwrite",T=>TV(R,T,mD(S)).next(S=>{if(S)return O=S.lastLimboFreeSnapshotVersion,R.targetCache.getMatchingKeysForTargetId(T,S.targetId).next(T=>{P=T})}).next(()=>R.queryEngine.getDocumentsMatchingQuery(T,S,N?O:dr.min(),N?P:ge())).next(T=>(TQ(R,mK(S),T),{documents:T,remoteKeys:P})))}function Tq(T,S,N,R){let O=N.batch,P=O.keys(),M=dA.resolve();return P.forEach(T=>{M=M.next(()=>R.getEntry(S,T)).next(S=>{let P=N.docVersions.get(T);cz(null!==P),0>S.version.compareTo(P)&&(O.applyToRemoteDocument(S,N),S.isValidDocument()&&(S.setReadTime(N.commitVersion),R.addEntry(S)))})}),M.next(()=>T.mutationQueue.removeMutationBatch(S,O))}function T$(T,S){let N=cq(T),R=cq(N.mutationQueue);return N.persistence.runTransaction("Lookup mutation documents","readonly",T=>R.lookupMutationKeys(T,S).next(S=>S?N.localDocuments.getDocuments(T,S):dA.resolve(null)))}function TH(T,S){cq(cq(T,TE).mutationQueue).removeCachedMutationKeys(S)}function TG(T){return cq(cq(T,TE).persistence).getActiveClients()}function TW(T,S){let N=cq(T),R=cq(N.targetCache),O=N.targetDataByTarget.get(S);return O?Promise.resolve(O.target):N.persistence.runTransaction("Get target data","readonly",T=>R.getTargetDataForTarget(T,S).next(T=>T?T.target:null))}function TK(T,S){let N=cq(T),R=N.collectionGroupReadTime.get(S)||dr.min();return N.persistence.runTransaction("Get new document changes","readonly",T=>N.remoteDocuments.getAllFromCollectionGroup(T,S,dx(R,dc),Number.MAX_SAFE_INTEGER)).then(T=>(TQ(N,S,T),T))}function TQ(T,S,N){let R=T.collectionGroupReadTime.get(S)||dr.min();N.forEach((T,S)=>{S.readTime.compareTo(R)>0&&(R=S.readTime)}),T.collectionGroupReadTime.set(S,R)}function TY(T){return mD(mC(ds.fromString(`__bundle__/docs/${T}`)))}async function TJ(T,S,N,R){let O=cq(T),P=ge(),M=mZ();for(let T of N){let N=S.toDocumentKey(T.metadata.name);T.document&&(P=P.add(N));let R=S.toMutableDocument(T);R.setReadTime(S.toSnapshotVersion(T.metadata.readTime)),M=M.insert(N,R)}let L=O.remoteDocuments.newChangeBuffer({trackRemovals:!0}),V=await TB(O,TY(R));return O.persistence.runTransaction("Apply bundle documents","readwrite",T=>TP(T,L,M).next(S=>(L.apply(T),S)).next(S=>O.targetCache.removeMatchingKeysForTargetId(T,V.targetId).next(()=>O.targetCache.addMatchingKeys(T,P,V.targetId)).next(()=>O.localDocuments.getLocalViewOfDocuments(T,S.changedDocuments,S.existenceChangedKeys)).next(()=>S.changedDocuments)))}function TX(T,S){let N=cq(T),R=yT(S.createTime);return N.persistence.runTransaction("hasNewerBundle","readonly",T=>N.bundleCache.getBundleMetadata(T,S.id)).then(T=>!!T&&T.createTime.compareTo(R)>=0)}function TZ(T,S){let N=cq(T);return N.persistence.runTransaction("Save bundle","readwrite",T=>N.bundleCache.saveBundleMetadata(T,S))}async function T0(T,S,N=ge()){let R=await TB(T,mD(vq(S.bundledQuery))),O=cq(T);return O.persistence.runTransaction("Save named query","readwrite",T=>{let P=yT(S.readTime);if(R.snapshotVersion.compareTo(P)>=0)return O.bundleCache.saveNamedQuery(T,S);let M=R.withResumeToken(pv.EMPTY_BYTE_STRING,P);return O.targetDataByTarget=O.targetDataByTarget.insert(M.targetId,M),O.targetCache.updateTargetData(T,M).next(()=>O.targetCache.removeMatchingKeysForTargetId(T,R.targetId)).next(()=>O.targetCache.addMatchingKeys(T,N,R.targetId)).next(()=>O.bundleCache.saveNamedQuery(T,S))})}function T1(T,S){cq(T).queryEngine.indexAutoCreationEnabled=S}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(T){this._documentReadCount+=T}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let T3=100;function T4(){return l2()?8:dM(lY())>0?6:4}class T6{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=T3,this.relativeIndexReadCostPerDocument=T4()}initialize(T,S){this.localDocumentsView=T,this.indexManager=S,this.initialized=!0}getDocumentsMatchingQuery(T,S,N,R){let O={result:null};return this.performQueryUsingIndex(T,S).next(T=>{O.result=T}).next(()=>{if(!O.result)return this.performQueryUsingRemoteKeys(T,S,R,N).next(T=>{O.result=T})}).next(()=>{if(O.result)return;let N=new T2;return this.executeFullCollectionScan(T,S,N).next(R=>{if(O.result=R,this.indexAutoCreationEnabled)return this.createCacheIndexes(T,S,N,R.size)})}).next(()=>O.result)}createCacheIndexes(T,S,N,R){return N.documentReadCount<this.indexAutoCreationMinCollectionSize?(cL()<=K.DEBUG&&cj("QueryEngine","SDK will not create cache indexes for query:",mz(S),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),dA.resolve()):(cL()<=K.DEBUG&&cj("QueryEngine","Query:",mz(S),"scans",N.documentReadCount,"local documents and returns",R,"documents as results."),N.documentReadCount>this.relativeIndexReadCostPerDocument*R)?(cL()<=K.DEBUG&&cj("QueryEngine","The SDK decides to create cache indexes for query:",mz(S),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(T,mD(S))):dA.resolve()}performQueryUsingIndex(T,S){if(mI(S))return dA.resolve(null);let N=mD(S);return this.indexManager.getIndexType(T,N).next(R=>0===R?null:(null!==S.limit&&1===R&&(N=mD(S=mj(S,null,"F"))),this.indexManager.getDocumentsMatchingTarget(T,N).next(R=>{let O=ge(...R);return this.localDocumentsView.getDocuments(T,O).next(R=>this.indexManager.getMinOffset(T,N).next(N=>{let P=this.applyQuery(S,R);return this.needsRefill(S,P,O,N.readTime)?this.performQueryUsingIndex(T,mj(S,null,"F")):this.appendRemainingResults(T,P,S,N)}))})))}performQueryUsingRemoteKeys(T,S,N,R){return mI(S)||R.isEqual(dr.min())?dA.resolve(null):this.localDocumentsView.getDocuments(T,N).next(O=>{let P=this.applyQuery(S,O);return this.needsRefill(S,P,N,R)?dA.resolve(null):(cL()<=K.DEBUG&&cj("QueryEngine","Re-using previous result from %s to execute query: %s",R.toString(),mz(S)),this.appendRemainingResults(T,P,S,dx(R,dc)).next(T=>T))})}applyQuery(T,S){let N=new pd(mQ(T));return S.forEach((S,R)=>{mq(T,R)&&(N=N.add(R))}),N}needsRefill(T,S,N,R){if(null===T.limit)return!1;if(N.size!==S.size)return!0;let O="F"===T.limitType?S.last():S.first();return!!O&&(O.hasPendingWrites||O.version.compareTo(R)>0)}executeFullCollectionScan(T,S,N){return cL()<=K.DEBUG&&cj("QueryEngine","Using full collection scan to execute query:",mz(S)),this.localDocumentsView.getDocumentsMatchingQuery(T,S,dC.min(),N)}appendRemainingResults(T,S,N,R){return this.localDocumentsView.getDocumentsMatchingQuery(T,N,R).next(T=>(S.forEach(S=>{T=T.insert(S.key,S)}),T))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let T5="firestore_clients";function T9(T,S){return`${T5}_${T}_${S}`}let T8="firestore_mutations";function T7(T,S,N){let R=`${T8}_${T}_${N}`;return S.isAuthenticated()&&(R+=`_${S.uid}`),R}let Se="firestore_targets";function St(T,S){return`${Se}_${T}_${S}`}let Sr="firestore_online_state";function Si(T){return`${Sr}_${T}`}let Sn="firestore_bundle_loaded_v2";function Ss(T){return`${Sn}_${T}`}let Sa="firestore_sequence_number";function So(T){return`${Sa}_${T}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sl="SharedClientState";class Su{constructor(T,S,N,R){this.user=T,this.batchId=S,this.state=N,this.error=R}static fromWebStorageEntry(T,S,N){let R;let O=JSON.parse(N),P="object"==typeof O&&-1!==["pending","acknowledged","rejected"].indexOf(O.state)&&(void 0===O.error||"object"==typeof O.error);return(P&&O.error&&(P="string"==typeof O.error.message&&"string"==typeof O.error.code)&&(R=new cH(O.error.code,O.error.message)),P)?new Su(T,S,O.state,R):(cF(Sl,`Failed to parse mutation state for ID '${S}': ${N}`),null)}toWebStorageJSON(){let T={state:this.state,updateTimeMs:Date.now()};return this.error&&(T.error={code:this.error.code,message:this.error.message}),JSON.stringify(T)}}class Sc{constructor(T,S,N){this.targetId=T,this.state=S,this.error=N}static fromWebStorageEntry(T,S){let N;let R=JSON.parse(S),O="object"==typeof R&&-1!==["not-current","current","rejected"].indexOf(R.state)&&(void 0===R.error||"object"==typeof R.error);return(O&&R.error&&(O="string"==typeof R.error.message&&"string"==typeof R.error.code)&&(N=new cH(R.error.code,R.error.message)),O)?new Sc(T,R.state,N):(cF(Sl,`Failed to parse target state for ID '${T}': ${S}`),null)}toWebStorageJSON(){let T={state:this.state,updateTimeMs:Date.now()};return this.error&&(T.error={code:this.error.code,message:this.error.message}),JSON.stringify(T)}}class Sd{constructor(T,S){this.clientId=T,this.activeTargetIds=S}static fromWebStorageEntry(T,S){let N=JSON.parse(S),R="object"==typeof N&&N.activeTargetIds instanceof Array,O=gr();for(let T=0;R&&T<N.activeTargetIds.length;++T)R=pU(N.activeTargetIds[T]),O=O.add(N.activeTargetIds[T]);return R?new Sd(T,O):(cF(Sl,`Failed to parse client data for instance '${T}': ${S}`),null)}}class Sh{constructor(T,S){this.clientId=T,this.onlineState=S}static fromWebStorageEntry(T){let S=JSON.parse(T);return"object"==typeof S&&-1!==["Unknown","Online","Offline"].indexOf(S.onlineState)&&"string"==typeof S.clientId?new Sh(S.clientId,S.onlineState):(cF(Sl,`Failed to parse online state: ${T}`),null)}}class Sp{constructor(){this.activeTargetIds=gr()}addQueryTarget(T){this.activeTargetIds=this.activeTargetIds.add(T)}removeQueryTarget(T){this.activeTargetIds=this.activeTargetIds.delete(T)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class Sf{constructor(T,S,N,R,O){this.window=T,this.queue=S,this.persistenceKey=N,this.localClientId=R,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new po(c5),this.started=!1,this.earlyEvents=[];let P=N.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=O,this.localClientStorageKey=T9(this.persistenceKey,this.localClientId),this.sequenceNumberKey=So(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new Sp),this.clientStateKeyRe=RegExp(`^${T5}_${P}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${T8}_${P}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${Se}_${P}_(\\d+)$`),this.onlineStateKey=Si(this.persistenceKey),this.bundleLoadedKey=Ss(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(T){return!!(T&&T.localStorage)}async start(){for(let T of(await this.syncEngine.getActiveClients())){if(T===this.localClientId)continue;let S=this.getItem(T9(this.persistenceKey,T));if(S){let N=Sd.fromWebStorageEntry(T,S);N&&(this.activeClients=this.activeClients.insert(N.clientId,N))}}this.persistClientState();let T=this.storage.getItem(this.onlineStateKey);if(T){let S=this.fromWebStorageOnlineState(T);S&&this.handleOnlineStateEvent(S)}for(let T of this.earlyEvents)this.handleWebStorageEvent(T);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(T){this.setItem(this.sequenceNumberKey,JSON.stringify(T))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(T){let S=!1;return this.activeClients.forEach((N,R)=>{R.activeTargetIds.has(T)&&(S=!0)}),S}addPendingMutation(T){this.persistMutationState(T,"pending")}updateMutationState(T,S,N){this.persistMutationState(T,S,N),this.removeMutationState(T)}addLocalQueryTarget(T,S=!0){let N="not-current";if(this.isActiveQueryTarget(T)){let S=this.storage.getItem(St(this.persistenceKey,T));if(S){let R=Sc.fromWebStorageEntry(T,S);R&&(N=R.state)}}return S&&this.localClientState.addQueryTarget(T),this.persistClientState(),N}removeLocalQueryTarget(T){this.localClientState.removeQueryTarget(T),this.persistClientState()}isLocalQueryTarget(T){return this.localClientState.activeTargetIds.has(T)}clearQueryState(T){this.removeItem(St(this.persistenceKey,T))}updateQueryState(T,S,N){this.persistQueryTargetState(T,S,N)}handleUserChange(T,S,N){S.forEach(T=>{this.removeMutationState(T)}),this.currentUser=T,N.forEach(T=>{this.addPendingMutation(T)})}setOnlineState(T){this.persistOnlineState(T)}notifyBundleLoaded(T){this.persistBundleLoadedState(T)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(T){let S=this.storage.getItem(T);return cj(Sl,"READ",T,S),S}setItem(T,S){cj(Sl,"SET",T,S),this.storage.setItem(T,S)}removeItem(T){cj(Sl,"REMOVE",T),this.storage.removeItem(T)}handleWebStorageEvent(T){let S=T;if(S.storageArea===this.storage){if(cj(Sl,"EVENT",S.key,S.newValue),S.key===this.localClientStorageKey){cF("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(async()=>{if(!this.started){this.earlyEvents.push(S);return}if(null!==S.key){if(this.clientStateKeyRe.test(S.key)){if(null!=S.newValue){let T=this.fromWebStorageClientState(S.key,S.newValue);if(T)return this.handleClientStateEvent(T.clientId,T)}else{let T=this.fromWebStorageClientStateKey(S.key);return this.handleClientStateEvent(T,null)}}else if(this.mutationBatchKeyRe.test(S.key)){if(null!==S.newValue){let T=this.fromWebStorageMutationMetadata(S.key,S.newValue);if(T)return this.handleMutationBatchEvent(T)}}else if(this.queryTargetKeyRe.test(S.key)){if(null!==S.newValue){let T=this.fromWebStorageQueryTargetMetadata(S.key,S.newValue);if(T)return this.handleQueryTargetEvent(T)}}else if(S.key===this.onlineStateKey){if(null!==S.newValue){let T=this.fromWebStorageOnlineState(S.newValue);if(T)return this.handleOnlineStateEvent(T)}}else if(S.key===this.sequenceNumberKey){let T=Sm(S.newValue);T!==dQ.INVALID&&this.sequenceNumberHandler(T)}else if(S.key===this.bundleLoadedKey){let T=this.fromWebStoreBundleLoadedState(S.newValue);await Promise.all(T.map(T=>this.syncEngine.synchronizeWithChangedDocuments(T)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(T,S,N){let R=new Su(this.currentUser,T,S,N),O=T7(this.persistenceKey,this.currentUser,T);this.setItem(O,R.toWebStorageJSON())}removeMutationState(T){let S=T7(this.persistenceKey,this.currentUser,T);this.removeItem(S)}persistOnlineState(T){let S={clientId:this.localClientId,onlineState:T};this.storage.setItem(this.onlineStateKey,JSON.stringify(S))}persistQueryTargetState(T,S,N){let R=St(this.persistenceKey,T),O=new Sc(T,S,N);this.setItem(R,O.toWebStorageJSON())}persistBundleLoadedState(T){let S=JSON.stringify(Array.from(T));this.setItem(this.bundleLoadedKey,S)}fromWebStorageClientStateKey(T){let S=this.clientStateKeyRe.exec(T);return S?S[1]:null}fromWebStorageClientState(T,S){let N=this.fromWebStorageClientStateKey(T);return Sd.fromWebStorageEntry(N,S)}fromWebStorageMutationMetadata(T,S){let N=this.mutationBatchKeyRe.exec(T),R=Number(N[1]),O=void 0!==N[2]?N[2]:null;return Su.fromWebStorageEntry(new cR(O),R,S)}fromWebStorageQueryTargetMetadata(T,S){let N=Number(this.queryTargetKeyRe.exec(T)[1]);return Sc.fromWebStorageEntry(N,S)}fromWebStorageOnlineState(T){return Sh.fromWebStorageEntry(T)}fromWebStoreBundleLoadedState(T){return JSON.parse(T)}async handleMutationBatchEvent(T){if(T.user.uid!==this.currentUser.uid){cj(Sl,`Ignoring mutation for non-active user ${T.user.uid}`);return}return this.syncEngine.applyBatchState(T.batchId,T.state,T.error)}handleQueryTargetEvent(T){return this.syncEngine.applyTargetState(T.targetId,T.state,T.error)}handleClientStateEvent(T,S){let N=S?this.activeClients.insert(T,S):this.activeClients.remove(T),R=this.extractActiveQueryTargets(this.activeClients),O=this.extractActiveQueryTargets(N),P=[],M=[];return O.forEach(T=>{R.has(T)||P.push(T)}),R.forEach(T=>{O.has(T)||M.push(T)}),this.syncEngine.applyActiveTargetsChange(P,M).then(()=>{this.activeClients=N})}handleOnlineStateEvent(T){this.activeClients.get(T.clientId)&&this.onlineStateHandler(T.onlineState)}extractActiveQueryTargets(T){let S=gr();return T.forEach((T,N)=>{S=S.unionWith(N.activeTargetIds)}),S}}function Sm(T){let S=dQ.INVALID;if(null!=T)try{let N=JSON.parse(T);cz("number"==typeof N),S=N}catch(T){cF(Sl,"Failed to read sequence number from WebStorage",T)}return S}class Sg{constructor(){this.localState=new Sp,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(T){}updateMutationState(T,S,N){}addLocalQueryTarget(T,S=!0){return S&&this.localState.addQueryTarget(T),this.queryState[T]||"not-current"}updateQueryState(T,S,N){this.queryState[T]=S}removeLocalQueryTarget(T){this.localState.removeQueryTarget(T)}isLocalQueryTarget(T){return this.localState.activeTargetIds.has(T)}clearQueryState(T){delete this.queryState[T]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(T){return this.localState.activeTargetIds.has(T)}start(){return this.localState=new Sp,Promise.resolve()}handleUserChange(T,S,N){}setOnlineState(T){}shutdown(){}writeSequenceNumber(T){}notifyBundleLoaded(T){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{addCallback(T){}shutdown(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(T){this.sendFn=T.sendFn,this.closeFn=T.closeFn}onConnected(T){this.wrappedOnConnected=T}onOpen(T){this.wrappedOnOpen=T}onClose(T){this.wrappedOnClose=T}onMessage(T){this.wrappedOnMessage=T}close(){this.closeFn()}send(T){this.sendFn(T)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(T){this.wrappedOnClose(T)}callOnMessage(T){this.wrappedOnMessage(T)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sb=null;function Sw(){return 268435456+Math.round(2147483648*Math.random())}function ST(){return null===Sb?Sb=Sw():Sb++,"0x"+Sb.toString(16)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(T){return new Promise((S,N)=>{T((T,R)=>{T?N(T):S(R)})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sx="1.9.1",SE="GrpcConnection",SC=`gl-node/${process.versions.node} fire/${cD} grpc/${Sx}`;function S_(T,S,N,R){cz(null===S||"OAuth"===S.type);let O=new cI.SF;return S&&S.headers.forEach((T,S)=>O.set(S,T)),N&&N.headers.forEach((T,S)=>O.set(S,T)),R&&O.set("X-Firebase-GMPID",R),O.set("X-Goog-Api-Client",SC),O.set("Google-Cloud-Resource-Prefix",T),O.set("x-goog-request-params",T),O}class SI{constructor(T,S){this.databaseInfo=S,this.cachedStub=null,this.firestore=T.google.firestore.v1,this.databasePath=`projects/${S.databaseId.projectId}/databases/${S.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){cj(SE,"Creating Firestore stub.");let T=this.databaseInfo.ssl?cI.K9.createSsl():cI.K9.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,T)}return this.cachedStub}invokeRPC(T,S,N,R,O){let P=ST(),M=this.ensureActiveStub(),L=S_(this.databasePath,R,O,this.databaseInfo.appId),V=Object.assign({database:this.databasePath},N);return SS(S=>(cj(SE,`RPC '${T}' ${P} invoked with request:`,N),M[T](V,L,(N,R)=>{N?(cj(SE,`RPC '${T}' ${P} failed with error:`,N),S(new cH(gJ(N.code),N.message))):(cj(SE,`RPC '${T}' ${P} completed with response:`,R),S(void 0,R))})))}invokeStreamingRPC(T,S,N,R,O,P){let M=ST(),L=[],V=new cG;cj(SE,`RPC '${T}' ${M} invoked (streaming) with request:`,N);let U=this.ensureActiveStub(),$=S_(this.databasePath,R,O,this.databaseInfo.appId),W=Object.assign(Object.assign({},N),{database:this.databasePath}),K=U[T](W,$),Q=!1;return K.on("data",S=>{cj(SE,`RPC ${T} ${M} received result:`,S),L.push(S),void 0!==P&&L.length===P&&(Q=!0,V.resolve(L))}),K.on("end",()=>{cj(SE,`RPC '${T}' ${M} completed.`),Q||(Q=!0,V.resolve(L))}),K.on("error",S=>{cj(SE,`RPC '${T}' ${M} failed with error:`,S);let N=gJ(S.code);V.reject(new cH(N,S.message))}),V.promise}openStream(T,S,N){let R=ST(),O=this.ensureActiveStub(),P=S_(this.databasePath,S,N,this.databaseInfo.appId),M=O[T](P),L=!1,V=T=>{L||(L=!0,U.callOnClose(T),M.end())},U=new Sv({sendFn:S=>{if(L)cj(SE,`RPC '${T}' stream ${R} not sending because gRPC stream is closed:`,S);else{cj(SE,`RPC '${T}' stream ${R} sending:`,S);try{M.write(S)}catch(T){throw cF("Failure sending:",S),cF("Error:",T),T}}},closeFn:()=>{cj(SE,`RPC '${T}' stream ${R} closed locally via close().`),V()}}),$=!1;return M.on("data",S=>{L||(cj(SE,`RPC '${T}' stream ${R} received:`,S),$||(U.callOnConnected(),$=!0),U.callOnMessage(S))}),M.on("end",()=>{cj(SE,`RPC '${T}' stream ${R} ended.`),V()}),M.on("error",S=>{L||(cB(SE,`RPC '${T}' stream ${R} error. Code:`,S.code,"Message:",S.message),V(new cH(gJ(S.code),S.message)))}),cj(SE,`Opening RPC '${T}' stream ${R} to ${this.databaseInfo.host}`),setTimeout(()=>{U.callOnOpen()},0),U}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let Sk={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var SN={nested:Sk},SA=Object.freeze({__proto__:null,nested:Sk,default:SN});/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SR={longs:String,enums:String,defaults:!0,oneofs:!1};function SD(){let T=ck.im(SA,SR);return cI.Rz(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SO(T){return new SI(SD(),T)}function SP(){return new Sy}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function SL(){return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sj(T){return new yh(T,!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SF="ExponentialBackoff",SB=1e3,SV=1.5,SU=6e4;class Sz{constructor(T,S,N=SB,R=SV,O=SU){this.queue=T,this.timerId=S,this.initialDelayMs=N,this.backoffFactor=R,this.maxDelayMs=O,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(T){this.cancel();let S=Math.floor(this.currentBaseMs+this.jitterDelayMs()),N=Math.max(0,Date.now()-this.lastAttemptTime),R=Math.max(0,S-N);R>0&&cj(SF,`Backing off for ${R} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${S} ms, last attempt: ${N} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,R,()=>(this.lastAttemptTime=Date.now(),T())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sq="PersistentStream",S$=6e4,SH=1e4;class SG{constructor(T,S,N,R,O,P,M,L){this.queue=T,this.idleTimerId=N,this.healthTimerId=R,this.connection=O,this.authCredentialsProvider=P,this.appCheckCredentialsProvider=M,this.listener=L,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new Sz(T,S)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state){this.performBackoff();return}this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,S$,()=>this.handleIdleCloseTimer()))}sendRequest(T){this.cancelIdleCheck(),this.stream.send(T)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(T,S){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==T?this.backoff.reset():S&&S.code===c$.RESOURCE_EXHAUSTED?(cF(S.toString()),cF("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):S&&S.code===c$.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=T,await this.listener.onClose(S)}tearDown(){}auth(){this.state=1;let T=this.getCloseGuardedDispatcher(this.closeCount),S=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([T,N])=>{this.closeCount===S&&this.startStream(T,N)},S=>{T(()=>{let T=new cH(c$.UNKNOWN,"Fetching auth token failed: "+S.message);return this.handleStreamClose(T)})})}startStream(T,S){let N=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(T,S),this.stream.onConnected(()=>{N(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{N(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,SH,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(T=>{N(()=>this.handleStreamClose(T))}),this.stream.onMessage(T=>{N(()=>1==++this.responseCount?this.onFirst(T):this.onNext(T))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(T){return cj(Sq,`close with error: ${T}`),this.stream=null,this.close(4,T)}getCloseGuardedDispatcher(T){return S=>{this.queue.enqueueAndForget(()=>this.closeCount===T?S():(cj(Sq,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SW extends SG{constructor(T,S,N,R,O,P){super(T,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",S,N,R,P),this.serializer=O}startRpc(T,S){return this.connection.openStream("Listen",T,S)}onFirst(T){return this.onNext(T)}onNext(T){this.backoff.reset();let S=yF(this.serializer,T),N=yV(T);return this.listener.onWatchChange(S,N)}watch(T){let S={};S.database=yN(this.serializer),S.addTarget=y6(this.serializer,T);let N=y3(this.serializer,T);N&&(S.labels=N),this.sendRequest(S)}unwatch(T){let S={};S.database=yN(this.serializer),S.removeTarget=T,this.sendRequest(S)}}class SK extends SG{constructor(T,S,N,R,O,P){super(T,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",S,N,R,P),this.serializer=O}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(T,S){return this.connection.openStream("Write",T,S)}onFirst(T){return cz(!!T.streamToken),this.lastStreamToken=T.streamToken,cz(!T.writeResults||0===T.writeResults.length),this.listener.onHandshakeComplete()}onNext(T){cz(!!T.streamToken),this.lastStreamToken=T.streamToken,this.backoff.reset();let S=yG(T.writeResults,T.commitTime),N=yT(T.commitTime);return this.listener.onMutationResult(N,S)}writeHandshake(){let T={};T.database=yN(this.serializer),this.sendRequest(T)}writeMutations(T){let S={streamToken:this.lastStreamToken,writes:T.map(T=>yU(this.serializer,T))};this.sendRequest(S)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SQ{}class SY extends SQ{constructor(T,S,N,R){super(),this.authCredentials=T,this.appCheckCredentials=S,this.connection=N,this.serializer=R,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new cH(c$.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(T,S,N,R){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([O,P])=>this.connection.invokeRPC(T,yx(S,N),R,O,P)).catch(T=>{if("FirebaseError"===T.name)throw T.code===c$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),T;throw new cH(c$.UNKNOWN,T.toString())})}invokeStreamingRPC(T,S,N,R,O){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([P,M])=>this.connection.invokeStreamingRPC(T,yx(S,N),R,P,M,O)).catch(T=>{if("FirebaseError"===T.name)throw T.code===c$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),T;throw new cH(c$.UNKNOWN,T.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function SJ(T,S,N,R){return new SY(T,S,N,R)}async function SX(T,S){let N=cq(T),R={writes:S.map(T=>yU(N.serializer,T))};await N.invokeRPC("Commit",N.serializer.databaseId,ds.emptyPath(),R)}async function SZ(T,S){let N=cq(T),R={documents:S.map(T=>yC(N.serializer,T))},O=await N.invokeStreamingRPC("BatchGetDocuments",N.serializer.databaseId,ds.emptyPath(),R,S.length),P=new Map;O.forEach(T=>{let S=yj(N.serializer,T);P.set(S.key.toString(),S)});let M=[];return S.forEach(T=>{let S=P.get(T.toString());cz(!!S),M.push(S)}),M}async function S0(T,S,N){var R;let O=cq(T),{request:P,aliasMap:M,parent:L}=yX(O.serializer,mO(S),N);O.connection.shouldResourcePathBeIncludedInRequest||delete P.parent;let V=(await O.invokeStreamingRPC("RunAggregationQuery",O.serializer.databaseId,L,P,1)).filter(T=>!!T.result);cz(1===V.length);let U=null===(R=V[0].result)||void 0===R?void 0:R.aggregateFields;return Object.keys(U).reduce((T,S)=>(T[M[S]]=U[S],T),{})}function S1(T,S,N){let R=cq(T);return R.verifyInitialized(),new SK(S,R.connection,R.authCredentials,R.appCheckCredentials,R.serializer,N)}function S2(T,S,N){let R=cq(T);return R.verifyInitialized(),new SW(S,R.connection,R.authCredentials,R.appCheckCredentials,R.serializer,N)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let S3="OnlineStateTracker",S4=1,S6=1e4;class S5{constructor(T,S){this.asyncQueue=T,this.onlineStateHandler=S,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",S6,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${S6/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(T){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=S4&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${S4} times. Most recent error: ${T.toString()}`),this.setAndBroadcast("Offline")))}set(T){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===T&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(T)}setAndBroadcast(T){T!==this.state&&(this.state=T,this.onlineStateHandler(T))}logClientOfflineWarningIfNecessary(T){let S=`Could not reach Cloud Firestore backend. ${T}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(cF(S),this.shouldWarnClientIsOffline=!1):cj(S3,S)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let S9="RemoteStore",S8=10;class S7{constructor(T,S,N,R,O){this.localStore=T,this.datastore=S,this.asyncQueue=N,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=O,this.connectivityMonitor.addCallback(T=>{N.enqueueAndForget(async()=>{xc(this)&&(cj(S9,"Restarting streams for network reachability change."),await xA(this))})}),this.onlineStateTracker=new S5(N,R)}}function xe(T,S,N,R,O){return new S7(T,S,N,R,O)}async function xt(T){if(xc(T))for(let S of T.onNetworkStatusChange)await S(!0)}async function xr(T){for(let S of T.onNetworkStatusChange)await S(!1)}async function xi(T){let S=cq(T);cj(S9,"RemoteStore shutting down."),S.offlineCauses.add(5),await xr(S),S.connectivityMonitor.shutdown(),S.onlineStateTracker.set("Unknown")}function xn(T,S){let N=cq(T);!N.listenTargets.has(S.targetId)&&(N.listenTargets.set(S.targetId,S),xu(N)?xl(N):xO(N).isOpen()&&xa(N,S))}function xs(T,S){let N=cq(T),R=xO(N);N.listenTargets.delete(S),R.isOpen()&&xo(N,S),0===N.listenTargets.size&&(R.isOpen()?R.markIdle():xc(N)&&N.onlineStateTracker.set("Unknown"))}function xa(T,S){if(T.watchChangeAggregator.recordPendingTargetRequest(S.targetId),S.resumeToken.approximateByteSize()>0||S.snapshotVersion.compareTo(dr.min())>0){let N=T.remoteSyncer.getRemoteKeysForTarget(S.targetId).size;S=S.withExpectedCount(N)}xO(T).watch(S)}function xo(T,S){T.watchChangeAggregator.recordPendingTargetRequest(S),xO(T).unwatch(S)}function xl(T){T.watchChangeAggregator=new ys({getRemoteKeysForTarget:S=>T.remoteSyncer.getRemoteKeysForTarget(S),getTargetDataForTarget:S=>T.listenTargets.get(S)||null,getDatabaseId:()=>T.datastore.serializer.databaseId}),xO(T).start(),T.onlineStateTracker.handleWatchStreamStart()}function xu(T){return xc(T)&&!xO(T).isStarted()&&T.listenTargets.size>0}function xc(T){return 0===cq(T).offlineCauses.size}function xd(T){T.watchChangeAggregator=void 0}async function xh(T){T.onlineStateTracker.set("Online")}async function xp(T){T.listenTargets.forEach((S,N)=>{xa(T,S)})}async function xf(T,S){xd(T),xu(T)?(T.onlineStateTracker.handleWatchStreamFailure(S),xl(T)):T.onlineStateTracker.set("Unknown")}async function xm(T,S,N){if(T.onlineStateTracker.set("Online"),S instanceof yr&&2===S.state&&S.cause){try{await xb(T,S)}catch(N){cj(S9,"Failed to remove targets %s: %s ",S.targetIds.join(","),N),await xg(T,N)}return}if(S instanceof ye?T.watchChangeAggregator.handleDocumentChange(S):S instanceof yt?T.watchChangeAggregator.handleExistenceFilter(S):T.watchChangeAggregator.handleTargetChange(S),!N.isEqual(dr.min()))try{let S=await TD(T.localStore);N.compareTo(S)>=0&&await xv(T,N)}catch(S){cj(S9,"Failed to raise snapshot:",S),await xg(T,S)}}async function xg(T,S,N){if(dF(S))T.offlineCauses.add(1),await xr(T),T.onlineStateTracker.set("Offline"),N||(N=()=>TD(T.localStore)),T.asyncQueue.enqueueRetryable(async()=>{cj(S9,"Retrying IndexedDB access"),await N(),T.offlineCauses.delete(1),await xt(T)});else throw S}function xy(T,S){return S().catch(N=>xg(T,N,S))}function xv(T,S){let N=T.watchChangeAggregator.createRemoteEvent(S);return N.targetChanges.forEach((N,R)=>{if(N.resumeToken.approximateByteSize()>0){let O=T.listenTargets.get(R);O&&T.listenTargets.set(R,O.withResumeToken(N.resumeToken,S))}}),N.targetMismatches.forEach((S,N)=>{let R=T.listenTargets.get(S);R&&(T.listenTargets.set(S,R.withResumeToken(pv.EMPTY_BYTE_STRING,R.snapshotVersion)),xo(T,S),xa(T,new v_(R.target,S,N,R.sequenceNumber)))}),T.remoteSyncer.applyRemoteEvent(N)}async function xb(T,S){let N=S.cause;for(let R of S.targetIds)T.listenTargets.has(R)&&(await T.remoteSyncer.rejectListen(R,N),T.listenTargets.delete(R),T.watchChangeAggregator.removeTarget(R))}async function xw(T){let S=cq(T),N=xP(S),R=S.writePipeline.length>0?S.writePipeline[S.writePipeline.length-1].batchId:pF;for(;xT(S);)try{let T=await Tj(S.localStore,R);if(null===T){0===S.writePipeline.length&&N.markIdle();break}R=T.batchId,xS(S,T)}catch(T){await xg(S,T)}xx(S)&&xE(S)}function xT(T){return xc(T)&&T.writePipeline.length<S8}function xS(T,S){T.writePipeline.push(S);let N=xP(T);N.isOpen()&&N.handshakeComplete&&N.writeMutations(S.mutations)}function xx(T){return xc(T)&&!xP(T).isStarted()&&T.writePipeline.length>0}function xE(T){xP(T).start()}async function xC(T){xP(T).writeHandshake()}async function x_(T){let S=xP(T);for(let N of T.writePipeline)S.writeMutations(N.mutations)}async function xI(T,S,N){let R=T.writePipeline.shift(),O=gG.from(R,S,N);await xy(T,()=>T.remoteSyncer.applySuccessfulWrite(O)),await xw(T)}async function xk(T,S){S&&xP(T).handshakeComplete&&await xN(T,S),xx(T)&&xE(T)}async function xN(T,S){if(gY(S.code)){let N=T.writePipeline.shift();xP(T).inhibitBackoff(),await xy(T,()=>T.remoteSyncer.rejectFailedWrite(N.batchId,S)),await xw(T)}}async function xA(T){let S=cq(T);S.offlineCauses.add(4),await xr(S),S.onlineStateTracker.set("Unknown"),S.offlineCauses.delete(4),await xt(S)}async function xR(T,S){let N=cq(T);N.asyncQueue.verifyOperationInProgress(),cj(S9,"RemoteStore received new credentials");let R=xc(N);N.offlineCauses.add(3),await xr(N),R&&N.onlineStateTracker.set("Unknown"),await N.remoteSyncer.handleCredentialChange(S),N.offlineCauses.delete(3),await xt(N)}async function xD(T,S){let N=cq(T);S?(N.offlineCauses.delete(2),await xt(N)):S||(N.offlineCauses.add(2),await xr(N),N.onlineStateTracker.set("Unknown"))}function xO(T){return T.watchStream||(T.watchStream=S2(T.datastore,T.asyncQueue,{onConnected:xh.bind(null,T),onOpen:xp.bind(null,T),onClose:xf.bind(null,T),onWatchChange:xm.bind(null,T)}),T.onNetworkStatusChange.push(async S=>{S?(T.watchStream.inhibitBackoff(),xu(T)?xl(T):T.onlineStateTracker.set("Unknown")):(await T.watchStream.stop(),xd(T))})),T.watchStream}function xP(T){return T.writeStream||(T.writeStream=S1(T.datastore,T.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:xC.bind(null,T),onClose:xk.bind(null,T),onHandshakeComplete:x_.bind(null,T),onMutationResult:xI.bind(null,T)}),T.onNetworkStatusChange.push(async S=>{S?(T.writeStream.inhibitBackoff(),await xw(T)):(await T.writeStream.stop(),T.writePipeline.length>0&&(cj(S9,`Stopping write stream with ${T.writePipeline.length} pending writes`),T.writePipeline=[]))})),T.writeStream}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xM="AsyncQueue";class xL{constructor(T,S,N,R,O){this.asyncQueue=T,this.timerId=S,this.targetTimeMs=N,this.op=R,this.removalCallback=O,this.deferred=new cG,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(T=>{})}get promise(){return this.deferred.promise}static createAndSchedule(T,S,N,R,O){let P=new xL(T,S,Date.now()+N,R,O);return P.start(N),P}start(T){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),T)}skipDelay(){return this.handleDelayElapsed()}cancel(T){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new cH(c$.CANCELLED,"Operation cancelled"+(T?": "+T:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(T=>this.deferred.resolve(T))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xj(T,S){if(cF(xM,`${S}: ${T}`),dF(T))return new cH(c$.UNAVAILABLE,`${S}: ${T}`);throw T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(T){T?this.comparator=(S,N)=>T(S,N)||du.comparator(S.key,N.key):this.comparator=(T,S)=>du.comparator(T.key,S.key),this.keyedMap=m1(),this.sortedSet=new po(this.comparator)}static emptySet(T){return new xF(T.comparator)}has(T){return null!=this.keyedMap.get(T)}get(T){return this.keyedMap.get(T)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(T){let S=this.keyedMap.get(T);return S?this.sortedSet.indexOf(S):-1}get size(){return this.sortedSet.size}forEach(T){this.sortedSet.inorderTraversal((S,N)=>(T(S),!1))}add(T){let S=this.delete(T.key);return S.copy(S.keyedMap.insert(T.key,T),S.sortedSet.insert(T,null))}delete(T){let S=this.get(T);return S?this.copy(this.keyedMap.remove(T),this.sortedSet.remove(S)):this}isEqual(T){if(!(T instanceof xF)||this.size!==T.size)return!1;let S=this.sortedSet.getIterator(),N=T.sortedSet.getIterator();for(;S.hasNext();){let T=S.getNext().key,R=N.getNext().key;if(!T.isEqual(R))return!1}return!0}toString(){let T=[];return(this.forEach(S=>{T.push(S.toString())}),0===T.length)?"DocumentSet ()":"DocumentSet (\n  "+T.join("  \n")+"\n)"}copy(T,S){let N=new xF;return N.comparator=this.comparator,N.keyedMap=T,N.sortedSet=S,N}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xB{constructor(){this.changeMap=new po(du.comparator)}track(T){let S=T.doc.key,N=this.changeMap.get(S);if(!N){this.changeMap=this.changeMap.insert(S,T);return}0!==T.type&&3===N.type?this.changeMap=this.changeMap.insert(S,T):3===T.type&&1!==N.type?this.changeMap=this.changeMap.insert(S,{type:N.type,doc:T.doc}):2===T.type&&2===N.type?this.changeMap=this.changeMap.insert(S,{type:2,doc:T.doc}):2===T.type&&0===N.type?this.changeMap=this.changeMap.insert(S,{type:0,doc:T.doc}):1===T.type&&0===N.type?this.changeMap=this.changeMap.remove(S):1===T.type&&2===N.type?this.changeMap=this.changeMap.insert(S,{type:1,doc:N.doc}):0===T.type&&1===N.type?this.changeMap=this.changeMap.insert(S,{type:2,doc:T.doc}):cU()}getChanges(){let T=[];return this.changeMap.inorderTraversal((S,N)=>{T.push(N)}),T}}class xV{constructor(T,S,N,R,O,P,M,L,V){this.query=T,this.docs=S,this.oldDocs=N,this.docChanges=R,this.mutatedKeys=O,this.fromCache=P,this.syncStateChanged=M,this.excludesMetadataChanges=L,this.hasCachedResults=V}static fromInitialDocuments(T,S,N,R,O){let P=[];return S.forEach(T=>{P.push({type:0,doc:T})}),new xV(T,S,xF.emptySet(S),P,N,R,!0,!1,O)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(T){if(this.fromCache!==T.fromCache||this.hasCachedResults!==T.hasCachedResults||this.syncStateChanged!==T.syncStateChanged||!this.mutatedKeys.isEqual(T.mutatedKeys)||!mV(this.query,T.query)||!this.docs.isEqual(T.docs)||!this.oldDocs.isEqual(T.oldDocs))return!1;let S=this.docChanges,N=T.docChanges;if(S.length!==N.length)return!1;for(let T=0;T<S.length;T++)if(S[T].type!==N[T].type||!S[T].doc.isEqual(N[T].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(T=>T.listensToRemoteStore())}}function xz(){return new xq}class xq{constructor(){this.queries=x$(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){xY(this,new cH(c$.ABORTED,"Firestore shutting down"))}}function x$(){return new mJ(T=>mU(T),mV)}async function xH(T,S){let N=cq(T),R=3,O=S.query,P=N.queries.get(O);P?!P.hasRemoteListeners()&&S.listensToRemoteStore()&&(R=2):(P=new xU,R=S.listensToRemoteStore()?0:1);try{switch(R){case 0:P.viewSnap=await N.onListen(O,!0);break;case 1:P.viewSnap=await N.onListen(O,!1);break;case 2:await N.onFirstRemoteStoreListen(O)}}catch(N){let T=xj(N,`Initialization of query '${mz(S.query)}' failed`);S.onError(T);return}N.queries.set(O,P),P.listeners.push(S),S.applyOnlineStateChange(N.onlineState),P.viewSnap&&S.onViewSnapshot(P.viewSnap)&&xJ(N)}async function xG(T,S){let N=cq(T),R=S.query,O=3,P=N.queries.get(R);if(P){let T=P.listeners.indexOf(S);T>=0&&(P.listeners.splice(T,1),0===P.listeners.length?O=S.listensToRemoteStore()?0:1:!P.hasRemoteListeners()&&S.listensToRemoteStore()&&(O=2))}switch(O){case 0:return N.queries.delete(R),N.onUnlisten(R,!0);case 1:return N.queries.delete(R),N.onUnlisten(R,!1);case 2:return N.onLastRemoteStoreUnlisten(R);default:return}}function xW(T,S){let N=cq(T),R=!1;for(let T of S){let S=T.query,O=N.queries.get(S);if(O){for(let S of O.listeners)S.onViewSnapshot(T)&&(R=!0);O.viewSnap=T}}R&&xJ(N)}function xK(T,S,N){let R=cq(T),O=R.queries.get(S);if(O)for(let T of O.listeners)T.onError(N);R.queries.delete(S)}function xQ(T,S){let N=cq(T);N.onlineState=S;let R=!1;N.queries.forEach((T,N)=>{for(let T of N.listeners)T.applyOnlineStateChange(S)&&(R=!0)}),R&&xJ(N)}function xY(T,S){let N=cq(T),R=N.queries;N.queries=x$(),R.forEach((T,N)=>{for(let T of N.listeners)T.onError(S)})}function xJ(T){T.snapshotsInSyncListeners.forEach(T=>{T.next()})}!function(T){T.Default="default",T.Cache="cache"}(ee||(ee={}));class xX{constructor(T,S,N){this.query=T,this.queryObserver=S,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=N||{}}onViewSnapshot(T){if(!this.options.includeMetadataChanges){let S=[];for(let N of T.docChanges)3!==N.type&&S.push(N);T=new xV(T.query,T.docs,T.oldDocs,S,T.mutatedKeys,T.fromCache,T.syncStateChanged,!0,T.hasCachedResults)}let S=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(T)&&(this.queryObserver.next(T),S=!0):this.shouldRaiseInitialEvent(T,this.onlineState)&&(this.raiseInitialEvent(T),S=!0),this.snap=T,S}onError(T){this.queryObserver.error(T)}applyOnlineStateChange(T){this.onlineState=T;let S=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,T)&&(this.raiseInitialEvent(this.snap),S=!0),S}shouldRaiseInitialEvent(T,S){if(!T.fromCache||!this.listensToRemoteStore())return!0;let N="Offline"!==S;return(!this.options.waitForSyncWhenOnline||!N)&&(!T.docs.isEmpty()||T.hasCachedResults||"Offline"===S)}shouldRaiseEvent(T){if(T.docChanges.length>0)return!0;let S=this.snap&&this.snap.hasPendingWrites!==T.hasPendingWrites;return(!!T.syncStateChanged||!!S)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(T){T=xV.fromInitialDocuments(T.query,T.docs,T.mutatedKeys,T.fromCache,T.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(T)}listensToRemoteStore(){return this.options.source!==ee.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xZ{constructor(T,S,N,R){this.targetId=T,this.fromCache=S,this.addedKeys=N,this.removedKeys=R}static fromSnapshot(T,S){let N=ge(),R=ge();for(let T of S.docChanges)switch(T.type){case 0:N=N.add(T.doc.key);break;case 1:R=R.add(T.doc.key)}return new xZ(T,S.fromCache,N,R)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(T){this.serializer=T}toDocumentKey(T){return y_(this.serializer,T)}toMutableDocument(T){return T.metadata.exists?yP(this.serializer,T.document,!1):fP.newNoDocument(this.toDocumentKey(T.metadata.name),this.toSnapshotVersion(T.metadata.readTime))}toSnapshotVersion(T){return yT(T)}}class x3{constructor(T,S,N){this.bundleMetadata=T,this.localStore=S,this.serializer=N,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=x4(T)}addSizedElement(T){this.progress.bytesLoaded+=T.byteLength;let S=this.progress.documentsLoaded;if(T.payload.namedQuery)this.queries.push(T.payload.namedQuery);else if(T.payload.documentMetadata){this.documents.push({metadata:T.payload.documentMetadata}),!T.payload.documentMetadata.exists&&++S;let N=ds.fromString(T.payload.documentMetadata.name);this.collectionGroups.add(N.get(N.length-2))}else T.payload.document&&(this.documents[this.documents.length-1].document=T.payload.document,++S);return S!==this.progress.documentsLoaded?(this.progress.documentsLoaded=S,Object.assign({},this.progress)):null}getQueryDocumentMapping(T){let S=new Map,N=new x0(this.serializer);for(let R of T)if(R.metadata.queries){let T=N.toDocumentKey(R.metadata.name);for(let N of R.metadata.queries){let R=(S.get(N)||ge()).add(T);S.set(N,R)}}return S}async complete(){let T=await TJ(this.localStore,new x0(this.serializer),this.documents,this.bundleMetadata.id),S=this.getQueryDocumentMapping(this.documents);for(let T of this.queries)await T0(this.localStore,T,S.get(T.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:T}}}function x4(T){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:T.totalDocuments,totalBytes:T.totalBytes}}function x6(T){return{taskState:"Success",documentsLoaded:T.totalDocuments,bytesLoaded:T.totalBytes,totalDocuments:T.totalDocuments,totalBytes:T.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(T){this.key=T}}class x9{constructor(T){this.key=T}}class x8{constructor(T,S){this.query=T,this._syncedDocuments=S,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=ge(),this.mutatedKeys=ge(),this.docComparator=mQ(T),this.documentSet=new xF(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(T,S){let N=S?S.changeSet:new xB,R=S?S.documentSet:this.documentSet,O=S?S.mutatedKeys:this.mutatedKeys,P=R,M=!1,L="F"===this.query.limitType&&R.size===this.query.limit?R.last():null,V="L"===this.query.limitType&&R.size===this.query.limit?R.first():null;if(T.inorderTraversal((T,S)=>{let U=R.get(T),$=mq(this.query,S)?S:null,W=!!U&&this.mutatedKeys.has(U.key),K=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations),Q=!1;U&&$?U.data.isEqual($.data)?W!==K&&(N.track({type:3,doc:$}),Q=!0):!this.shouldWaitForSyncedDocument(U,$)&&(N.track({type:2,doc:$}),Q=!0,(L&&this.docComparator($,L)>0||V&&0>this.docComparator($,V))&&(M=!0)):!U&&$?(N.track({type:0,doc:$}),Q=!0):U&&!$&&(N.track({type:1,doc:U}),Q=!0,(L||V)&&(M=!0)),Q&&($?(P=P.add($),O=K?O.add(T):O.delete(T)):(P=P.delete(T),O=O.delete(T)))}),null!==this.query.limit)for(;P.size>this.query.limit;){let T="F"===this.query.limitType?P.last():P.first();P=P.delete(T.key),O=O.delete(T.key),N.track({type:1,doc:T})}return{documentSet:P,changeSet:N,needsRefill:M,mutatedKeys:O}}shouldWaitForSyncedDocument(T,S){return T.hasLocalMutations&&S.hasCommittedMutations&&!S.hasLocalMutations}applyChanges(T,S,N,R){let O=this.documentSet;this.documentSet=T.documentSet,this.mutatedKeys=T.mutatedKeys;let P=T.changeSet.getChanges();P.sort((T,S)=>x7(T.type,S.type)||this.docComparator(T.doc,S.doc)),this.applyTargetChange(N),R=null!=R&&R;let M=S&&!R?this.updateLimboDocuments():[],L=0===this.limboDocuments.size&&this.current&&!R?1:0,V=L!==this.syncState;return(this.syncState=L,0!==P.length||V)?{snapshot:new xV(this.query,T.documentSet,O,P,T.mutatedKeys,0===L,V,!1,!!N&&N.resumeToken.approximateByteSize()>0),limboChanges:M}:{limboChanges:M}}applyOnlineStateChange(T){return this.current&&"Offline"===T?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new xB,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(T){return!this._syncedDocuments.has(T)&&!!this.documentSet.has(T)&&!this.documentSet.get(T).hasLocalMutations}applyTargetChange(T){T&&(T.addedDocuments.forEach(T=>this._syncedDocuments=this._syncedDocuments.add(T)),T.modifiedDocuments.forEach(T=>{}),T.removedDocuments.forEach(T=>this._syncedDocuments=this._syncedDocuments.delete(T)),this.current=T.current)}updateLimboDocuments(){if(!this.current)return[];let T=this.limboDocuments;this.limboDocuments=ge(),this.documentSet.forEach(T=>{this.shouldBeInLimbo(T.key)&&(this.limboDocuments=this.limboDocuments.add(T.key))});let S=[];return T.forEach(T=>{this.limboDocuments.has(T)||S.push(new x9(T))}),this.limboDocuments.forEach(N=>{T.has(N)||S.push(new x5(N))}),S}synchronizeWithPersistedState(T){this._syncedDocuments=T.remoteKeys,this.limboDocuments=ge();let S=this.computeDocChanges(T.documents);return this.applyChanges(S,!0)}computeInitialSnapshot(){return xV.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function x7(T,S){let N=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cU()}};return N(T)-N(S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ee="SyncEngine";class Et{constructor(T,S,N){this.query=T,this.targetId=S,this.view=N}}class Er{constructor(T){this.key=T,this.receivedDocument=!1}}class Ei{constructor(T,S,N,R,O,P){this.localStore=T,this.remoteStore=S,this.eventManager=N,this.sharedClientState=R,this.currentUser=O,this.maxConcurrentLimboResolutions=P,this.syncEngineListener={},this.queryViewsByQuery=new mJ(T=>mU(T),mV),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new po(du.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new wV,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=wr.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function En(T,S,N,R,O,P,M){let L=new Ei(T,S,N,R,O,P);return M&&(L._isPrimaryClient=!0),L}async function Es(T,S,N=!0){let R;let O=EV(T),P=O.queryViewsByQuery.get(S);return P?(O.sharedClientState.addLocalQueryTarget(P.targetId),R=P.view.computeInitialSnapshot()):R=await Eo(O,S,N,!0),R}async function Ea(T,S){let N=EV(T);await Eo(N,S,!0,!1)}async function Eo(T,S,N,R){let O;let P=await TB(T.localStore,mD(S)),M=P.targetId,L=T.sharedClientState.addLocalQueryTarget(M,N);return R&&(O=await El(T,S,M,"current"===L,P.resumeToken)),T.isPrimaryClient&&N&&xn(T.remoteStore,P),O}async function El(T,S,N,R,O){T.applyDocChanges=(S,N,R)=>EI(T,S,N,R);let P=await Tz(T.localStore,S,!0),M=new x8(S,P.remoteKeys),L=M.computeDocChanges(P.documents),V=g7.createSynthesizedTargetChangeForCurrentChange(N,R&&"Offline"!==T.onlineState,O),U=M.applyChanges(L,T.isPrimaryClient,V);Ex(T,N,U.limboChanges);let $=new Et(S,N,M);return T.queryViewsByQuery.set(S,$),T.queriesByTarget.has(N)?T.queriesByTarget.get(N).push(S):T.queriesByTarget.set(N,[S]),U.snapshot}async function Eu(T,S,N){let R=cq(T),O=R.queryViewsByQuery.get(S),P=R.queriesByTarget.get(O.targetId);if(P.length>1){R.queriesByTarget.set(O.targetId,P.filter(T=>!mV(T,S))),R.queryViewsByQuery.delete(S);return}R.isPrimaryClient?(R.sharedClientState.removeLocalQueryTarget(O.targetId),R.sharedClientState.isActiveQueryTarget(O.targetId)||await TU(R.localStore,O.targetId,!1).then(()=>{R.sharedClientState.clearQueryState(O.targetId),N&&xs(R.remoteStore,O.targetId),ET(R,O.targetId)}).catch(dN)):(ET(R,O.targetId),await TU(R.localStore,O.targetId,!0))}async function Ec(T,S){let N=cq(T),R=N.queryViewsByQuery.get(S),O=N.queriesByTarget.get(R.targetId);N.isPrimaryClient&&1===O.length&&(N.sharedClientState.removeLocalQueryTarget(R.targetId),xs(N.remoteStore,R.targetId))}async function Ed(T,S,N){let R=EU(T);try{let T=await TI(R.localStore,S);R.sharedClientState.addPendingMutation(T.batchId),Eb(R,T.batchId,N),await E_(R,T.changes),await xw(R.remoteStore)}catch(S){let T=xj(S,"Failed to persist write");N.reject(T)}}async function Eh(T,S){let N=cq(T);try{let T=await TO(N.localStore,S);S.targetChanges.forEach((T,S)=>{let R=N.activeLimboResolutionsByTarget.get(S);R&&(cz(T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size<=1),T.addedDocuments.size>0?R.receivedDocument=!0:T.modifiedDocuments.size>0?cz(R.receivedDocument):T.removedDocuments.size>0&&(cz(R.receivedDocument),R.receivedDocument=!1))}),await E_(N,T,S)}catch(T){await dN(T)}}function Ep(T,S,N){let R=cq(T);if(R.isPrimaryClient&&0===N||!R.isPrimaryClient&&1===N){let T=[];R.queryViewsByQuery.forEach((N,R)=>{let O=R.view.applyOnlineStateChange(S);O.snapshot&&T.push(O.snapshot)}),xQ(R.eventManager,S),T.length&&R.syncEngineListener.onWatchChange(T),R.onlineState=S,R.isPrimaryClient&&R.sharedClientState.setOnlineState(S)}}async function Ef(T,S,N){let R=cq(T);R.sharedClientState.updateQueryState(S,"rejected",N);let O=R.activeLimboResolutionsByTarget.get(S),P=O&&O.key;if(P){let T=new po(du.comparator);T=T.insert(P,fP.newNoDocument(P,dr.min()));let N=ge().add(P),O=new g8(dr.min(),new Map,new po(c5),T,N);await Eh(R,O),R.activeLimboTargetsByKey=R.activeLimboTargetsByKey.remove(P),R.activeLimboResolutionsByTarget.delete(S),EC(R)}else await TU(R.localStore,S,!1).then(()=>ET(R,S,N)).catch(dN)}async function Em(T,S){let N=cq(T),R=S.batch.batchId;try{let T=await Tk(N.localStore,S);Ew(N,R,null),Ey(N,R),N.sharedClientState.updateMutationState(R,"acknowledged"),await E_(N,T)}catch(T){await dN(T)}}async function Eg(T,S,N){let R=cq(T);try{let T=await TA(R.localStore,S);Ew(R,S,N),Ey(R,S),R.sharedClientState.updateMutationState(S,"rejected",N),await E_(R,T)}catch(T){await dN(T)}}function Ey(T,S){(T.pendingWritesCallbacks.get(S)||[]).forEach(T=>{T.resolve()}),T.pendingWritesCallbacks.delete(S)}function Ev(T,S){T.pendingWritesCallbacks.forEach(T=>{T.forEach(T=>{T.reject(new cH(c$.CANCELLED,S))})}),T.pendingWritesCallbacks.clear()}function Eb(T,S,N){let R=T.mutationUserCallbacks[T.currentUser.toKey()];R||(R=new po(c5)),R=R.insert(S,N),T.mutationUserCallbacks[T.currentUser.toKey()]=R}function Ew(T,S,N){let R=cq(T),O=R.mutationUserCallbacks[R.currentUser.toKey()];if(O){let T=O.get(S);T&&(N?T.reject(N):T.resolve(),O=O.remove(S)),R.mutationUserCallbacks[R.currentUser.toKey()]=O}}function ET(T,S,N=null){for(let R of(T.sharedClientState.removeLocalQueryTarget(S),T.queriesByTarget.get(S)))T.queryViewsByQuery.delete(R),N&&T.syncEngineListener.onWatchError(R,N);T.queriesByTarget.delete(S),T.isPrimaryClient&&T.limboDocumentRefs.removeReferencesForId(S).forEach(S=>{T.limboDocumentRefs.containsKey(S)||ES(T,S)})}function ES(T,S){T.enqueuedLimboResolutions.delete(S.path.canonicalString());let N=T.activeLimboTargetsByKey.get(S);null!==N&&(xs(T.remoteStore,N),T.activeLimboTargetsByKey=T.activeLimboTargetsByKey.remove(S),T.activeLimboResolutionsByTarget.delete(N),EC(T))}function Ex(T,S,N){for(let R of N)R instanceof x5?(T.limboDocumentRefs.addReference(R.key,S),EE(T,R)):R instanceof x9?(cj(Ee,"Document no longer in limbo: "+R.key),T.limboDocumentRefs.removeReference(R.key,S),T.limboDocumentRefs.containsKey(R.key)||ES(T,R.key)):cU()}function EE(T,S){let N=S.key,R=N.path.canonicalString();T.activeLimboTargetsByKey.get(N)||T.enqueuedLimboResolutions.has(R)||(cj(Ee,"New document in limbo: "+N),T.enqueuedLimboResolutions.add(R),EC(T))}function EC(T){for(;T.enqueuedLimboResolutions.size>0&&T.activeLimboTargetsByKey.size<T.maxConcurrentLimboResolutions;){let S=T.enqueuedLimboResolutions.values().next().value;T.enqueuedLimboResolutions.delete(S);let N=new du(ds.fromString(S)),R=T.limboTargetIdGenerator.next();T.activeLimboResolutionsByTarget.set(R,new Er(N)),T.activeLimboTargetsByKey=T.activeLimboTargetsByKey.insert(N,R),xn(T.remoteStore,new v_(mD(mC(N.path)),R,"TargetPurposeLimboResolution",dQ.INVALID))}}async function E_(T,S,N){let R=cq(T),O=[],P=[],M=[];R.queryViewsByQuery.isEmpty()||(R.queryViewsByQuery.forEach((T,L)=>{M.push(R.applyDocChanges(L,S,N).then(T=>{var S;if((T||N)&&R.isPrimaryClient){let O=T?!T.fromCache:null===(S=null==N?void 0:N.targetChanges.get(L.targetId))||void 0===S?void 0:S.current;R.sharedClientState.updateQueryState(L.targetId,O?"current":"not-current")}if(T){O.push(T);let S=xZ.fromSnapshot(L.targetId,T);P.push(S)}}))}),await Promise.all(M),R.syncEngineListener.onWatchChange(O),await TL(R.localStore,P))}async function EI(T,S,N,R){let O=S.view.computeDocChanges(N);O.needsRefill&&(O=await Tz(T.localStore,S.query,!1).then(({documents:T})=>S.view.computeDocChanges(T,O)));let P=R&&R.targetChanges.get(S.targetId),M=R&&null!=R.targetMismatches.get(S.targetId),L=S.view.applyChanges(O,T.isPrimaryClient,P,M);return Ex(T,S.targetId,L.limboChanges),L.snapshot}async function Ek(T,S){let N=cq(T);if(!N.currentUser.isEqual(S)){cj(Ee,"User change. New user:",S.toKey());let T=await T_(N.localStore,S);N.currentUser=S,Ev(N,"'waitForPendingWrites' promise is rejected due to a user change."),N.sharedClientState.handleUserChange(S,T.removedBatchIds,T.addedBatchIds),await E_(N,T.affectedDocuments)}}function EN(T,S){let N=cq(T),R=N.activeLimboResolutionsByTarget.get(S);if(R&&R.receivedDocument)return ge().add(R.key);{let T=ge(),R=N.queriesByTarget.get(S);if(!R)return T;for(let S of R){let R=N.queryViewsByQuery.get(S);T=T.unionWith(R.view.syncedDocuments)}return T}}async function EA(T,S){let N=cq(T),R=await Tz(N.localStore,S.query,!0),O=S.view.synchronizeWithPersistedState(R);return N.isPrimaryClient&&Ex(N,S.targetId,O.limboChanges),O}async function ER(T,S){let N=cq(T);return TK(N.localStore,S).then(T=>E_(N,T))}async function ED(T,S,N,R){let O=cq(T),P=await T$(O.localStore,S);if(null===P){cj(Ee,"Cannot apply mutation batch with id: "+S);return}"pending"===N?await xw(O.remoteStore):"acknowledged"===N||"rejected"===N?(Ew(O,S,R||null),Ey(O,S),TH(O.localStore,S)):cU(),await E_(O,P)}async function EO(T,S){let N=cq(T);if(EV(N),EU(N),!0===S&&!0!==N._isPrimaryClient){let T=N.sharedClientState.getAllActiveQueryTargets(),S=await EM(N,T.toArray());for(let T of(N._isPrimaryClient=!0,await xD(N.remoteStore,!0),S))xn(N.remoteStore,T)}else if(!1===S&&!1!==N._isPrimaryClient){let T=[],S=Promise.resolve();N.queriesByTarget.forEach((R,O)=>{N.sharedClientState.isLocalQueryTarget(O)?T.push(O):S=S.then(()=>(ET(N,O),TU(N.localStore,O,!0))),xs(N.remoteStore,O)}),await S,await EM(N,T),EP(N),N._isPrimaryClient=!1,await xD(N.remoteStore,!1)}}function EP(T){let S=cq(T);S.activeLimboResolutionsByTarget.forEach((T,N)=>{xs(S.remoteStore,N)}),S.limboDocumentRefs.removeAllReferences(),S.activeLimboResolutionsByTarget=new Map,S.activeLimboTargetsByKey=new po(du.comparator)}async function EM(T,S,N){let R=cq(T),O=[],P=[];for(let T of S){let S;let N=R.queriesByTarget.get(T);if(N&&0!==N.length)for(let T of(S=await TB(R.localStore,mD(N[0])),N)){let S=R.queryViewsByQuery.get(T),N=await EA(R,S);N.snapshot&&P.push(N.snapshot)}else{let N=await TW(R.localStore,T);S=await TB(R.localStore,N),await El(R,EL(N),T,!1,S.resumeToken)}O.push(S)}return R.syncEngineListener.onWatchChange(P),O}function EL(T){return mE(T.path,T.collectionGroup,T.orderBy,T.filters,T.limit,"F",T.startAt,T.endAt)}function Ej(T){return TG(cq(T).localStore)}async function EF(T,S,N,R){let O=cq(T);if(O._isPrimaryClient){cj(Ee,"Ignoring unexpected query state notification.");return}let P=O.queriesByTarget.get(S);if(P&&P.length>0)switch(N){case"current":case"not-current":{let T=await TK(O.localStore,mK(P[0])),R=g8.createSynthesizedRemoteEventForCurrentChange(S,"current"===N,pv.EMPTY_BYTE_STRING);await E_(O,T,R);break}case"rejected":await TU(O.localStore,S,!0),ET(O,S,R);break;default:cU()}}async function EB(T,S,N){let R=EV(T);if(R._isPrimaryClient){for(let T of S){if(R.queriesByTarget.has(T)&&R.sharedClientState.isActiveQueryTarget(T)){cj(Ee,"Adding an already active target "+T);continue}let S=await TW(R.localStore,T),N=await TB(R.localStore,S);await El(R,EL(S),N.targetId,!1,N.resumeToken),xn(R.remoteStore,N)}for(let T of N)R.queriesByTarget.has(T)&&await TU(R.localStore,T,!1).then(()=>{xs(R.remoteStore,T),ET(R,T)}).catch(dN)}}function EV(T){let S=cq(T);return S.remoteStore.remoteSyncer.applyRemoteEvent=Eh.bind(null,S),S.remoteStore.remoteSyncer.getRemoteKeysForTarget=EN.bind(null,S),S.remoteStore.remoteSyncer.rejectListen=Ef.bind(null,S),S.syncEngineListener.onWatchChange=xW.bind(null,S.eventManager),S.syncEngineListener.onWatchError=xK.bind(null,S.eventManager),S}function EU(T){let S=cq(T);return S.remoteStore.remoteSyncer.applySuccessfulWrite=Em.bind(null,S),S.remoteStore.remoteSyncer.rejectFailedWrite=Eg.bind(null,S),S}async function Ez(T,S,N){try{let R=await S.getMetadata();if(await TX(T.localStore,R))return await S.close(),N._completeWith(x6(R)),Promise.resolve(new Set);N._updateProgress(x4(R));let O=new x3(R,T.localStore,S.serializer),P=await S.nextElement();for(;P;){let T=await O.addSizedElement(P);T&&N._updateProgress(T),P=await S.nextElement()}let M=await O.complete();return await E_(T,M.changedDocs,void 0),await TZ(T.localStore,R),N._completeWith(M.progress),Promise.resolve(M.changedCollectionGroups)}catch(T){return cB(Ee,`Loading bundle failed with ${T}`),N._failWith(T),Promise.resolve(new Set)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eq{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(T){this.serializer=Sj(T.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(T),this.persistence=this.createPersistence(T),await this.persistence.start(),this.localStore=this.createLocalStore(T),this.gcScheduler=this.createGarbageCollectionScheduler(T,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(T,this.localStore)}createGarbageCollectionScheduler(T,S){return null}createIndexBackfillerScheduler(T,S){return null}createLocalStore(T){return TC(this.persistence,new T6,T.initialUser,this.serializer)}createPersistence(T){return new wQ(wJ.factory,this.serializer)}createSharedClientState(T){return new Sg}async terminate(){var T,S;null===(T=this.gcScheduler)||void 0===T||T.stop(),null===(S=this.indexBackfillerScheduler)||void 0===S||S.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Eq.provider={build:()=>new Eq};class E$ extends null{constructor(T,S,N){super(),this.onlineComponentProvider=T,this.cacheSizeBytes=S,this.forceOwnership=N,this.kind="persistent",this.synchronizeTabs=!1}async initialize(T){await super.initialize(T),await this.onlineComponentProvider.initialize(this,T),await EU(this.onlineComponentProvider.syncEngine),await xw(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(T){return TC(this.persistence,new T6,T.initialUser,this.serializer)}createGarbageCollectionScheduler(T,S){return new wy(this.persistence.referenceDelegate.garbageCollector,T.asyncQueue,S)}createIndexBackfillerScheduler(T,S){let N=new dK(S,this.persistence);return new dW(T.asyncQueue,N)}createPersistence(T){let S=Tb(T.databaseInfo.databaseId,T.databaseInfo.persistenceKey),N=void 0!==this.cacheSizeBytes?wc.withCacheSize(this.cacheSizeBytes):wc.DEFAULT;return new Tg(this.synchronizeTabs,S,T.clientId,N,T.asyncQueue,SM(),SL(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(T){return new Sg}}class EH{async initialize(T,S){this.localStore||(this.localStore=T.localStore,this.sharedClientState=T.sharedClientState,this.datastore=this.createDatastore(S),this.remoteStore=this.createRemoteStore(S),this.eventManager=this.createEventManager(S),this.syncEngine=this.createSyncEngine(S,!T.synchronizeTabs),this.sharedClientState.onlineStateHandler=T=>Ep(this.syncEngine,T,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ek.bind(null,this.syncEngine),await xD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(T){return xz()}createDatastore(T){let S=Sj(T.databaseInfo.databaseId),N=SO(T.databaseInfo);return SJ(T.authCredentials,T.appCheckCredentials,N,S)}createRemoteStore(T){return xe(this.localStore,this.datastore,T.asyncQueue,T=>Ep(this.syncEngine,T,0),SP())}createSyncEngine(T,S){return En(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,T.initialUser,T.maxConcurrentLimboResolutions,S)}async terminate(){var T,S;await xi(this.remoteStore),null===(T=this.datastore)||void 0===T||T.terminate(),null===(S=this.eventManager)||void 0===S||S.terminate()}}EH.provider={build:()=>new EH};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EG=10240;function EW(T,S=EG){let N=0;return{async read(){if(N<T.byteLength){let R={value:T.slice(N,N+S),done:!1};return N+=S,R}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EK(T,S,N){if(!N)throw new cH(c$.INVALID_ARGUMENT,`Function ${T}() cannot be called with an empty ${S}.`)}function EQ(T,S,N,R){if(!0===S&&!0===R)throw new cH(c$.INVALID_ARGUMENT,`${T} and ${N} cannot be used together.`)}function EY(T){if(!du.isDocumentKey(T))throw new cH(c$.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${T} has ${T.length}.`)}function EJ(T){if(du.isDocumentKey(T))throw new cH(c$.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${T} has ${T.length}.`)}function EX(T){return"object"==typeof T&&null!==T&&(Object.getPrototypeOf(T)===Object.prototype||null===Object.getPrototypeOf(T))}function EZ(T){if(void 0===T)return"undefined";if(null===T)return"null";if("string"==typeof T)return T.length>20&&(T=`${T.substring(0,20)}...`),JSON.stringify(T);if("number"==typeof T||"boolean"==typeof T)return""+T;if("object"==typeof T){if(T instanceof Array)return"an array";{let S=E0(T);return S?`a custom ${S} object`:"an object"}}if("function"==typeof T)return"a function";return cU()}function E0(T){return T.constructor?T.constructor.name:null}function E1(T,S){if("_delegate"in T&&(T=T._delegate),!(T instanceof S)){if(S.name===T.constructor.name)throw new cH(c$.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let N=EZ(T);throw new cH(c$.INVALID_ARGUMENT,`Expected type '${S.name}', but it was: ${N}`)}}return T}function E2(T,S){if(S<=0)throw new cH(c$.INVALID_ARGUMENT,`Function ${T}() requires a positive number, but it was: ${S}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E3(T,S){if(!(T instanceof Uint8Array))throw new cH(c$.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${EZ(T)}`);return EW(T,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(T){this.observer=T,this.muted=!1}next(T){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,T)}error(T){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,T):cF("Uncaught Error in snapshot listener:",T.toString()))}mute(){this.muted=!0}scheduleEvent(T,S){setTimeout(()=>{this.muted||T(S)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(T,S){this.payload=T,this.byteLength=S}isBundleMetadata(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(T,S){this.reader=T,this.serializer=S,this.metadata=new cG,this.buffer=new Uint8Array,this.textDecoder=g2(),this.nextElementImpl().then(T=>{T&&T.isBundleMetadata()?this.metadata.resolve(T.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==T?void 0:T.payload)}`))},T=>this.metadata.reject(T))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let T=await this.readLength();if(null===T)return null;let S=this.textDecoder.decode(T),N=Number(S);return isNaN(N)&&this.raiseError(`length string (${S}) is not valid number`),new E6(JSON.parse(await this.readJsonString(N)),T.length+N)}indexOfOpenBracket(){return this.buffer.findIndex(T=>123===T)}async readLength(){for(;0>this.indexOfOpenBracket()&&!await this.pullMoreDataToBuffer(););if(0===this.buffer.length)return null;let T=this.indexOfOpenBracket();T<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let S=this.buffer.slice(0,T);return this.buffer=this.buffer.slice(T),S}async readJsonString(T){for(;this.buffer.length<T;)await this.pullMoreDataToBuffer()&&this.raiseError("Reached the end of bundle when more is expected.");let S=this.textDecoder.decode(this.buffer.slice(0,T));return this.buffer=this.buffer.slice(T),S}raiseError(T){throw this.reader.cancel(),Error(`Invalid bundle format: ${T}`)}async pullMoreDataToBuffer(){let T=await this.reader.read();if(!T.done){let S=new Uint8Array(this.buffer.length+T.value.length);S.set(this.buffer),S.set(T.value,this.buffer.length),this.buffer=S}return T.done}}function E9(T,S){return new E5(T,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E8{constructor(T){this.datastore=T,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(T){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new cH(c$.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let S=await SZ(this.datastore,T);return S.forEach(T=>this.recordVersion(T)),S}set(T,S){this.write(S.toMutation(T,this.precondition(T))),this.writtenDocs.add(T.toString())}update(T,S){try{this.write(S.toMutation(T,this.preconditionForUpdate(T)))}catch(T){this.lastTransactionError=T}this.writtenDocs.add(T.toString())}delete(T){this.write(new gU(T,this.precondition(T))),this.writtenDocs.add(T.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let T=this.readVersions;this.mutations.forEach(S=>{T.delete(S.key.toString())}),T.forEach((T,S)=>{let N=du.fromPath(S);this.mutations.push(new g$(N,this.precondition(N)))}),await SX(this.datastore,this.mutations),this.committed=!0}recordVersion(T){let S;if(T.isFoundDocument())S=T.version;else if(T.isNoDocument())S=dr.min();else throw cU();let N=this.readVersions.get(T.key.toString());if(N){if(!S.isEqual(N))throw new cH(c$.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(T.key.toString(),S)}precondition(T){let S=this.readVersions.get(T.toString());return this.writtenDocs.has(T.toString())||!S?gE.none():S.isEqual(dr.min())?gE.exists(!1):gE.updateTime(S)}preconditionForUpdate(T){let S=this.readVersions.get(T.toString());if(this.writtenDocs.has(T.toString())||!S)return gE.exists(!0);if(S.isEqual(dr.min()))throw new cH(c$.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gE.updateTime(S)}write(T){this.ensureCommitNotCalled(),this.mutations.push(T)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E7="FirestoreClient",Ce=100,Ct=11,Cr=20,Ci=22;class Cn{constructor(T,S,N,R,O){this.authCredentials=T,this.appCheckCredentials=S,this.asyncQueue=N,this.databaseInfo=R,this.user=cR.UNAUTHENTICATED,this.clientId=c6.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=O,this.authCredentials.start(N,async T=>{cj(E7,"Received user=",T.uid),await this.authCredentialListener(T),this.user=T}),this.appCheckCredentials.start(N,T=>(cj(E7,"Received new app check token=",T),this.appCheckCredentialListener(T,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:Ce}}setCredentialChangeListener(T){this.authCredentialListener=T}setAppCheckTokenChangeListener(T){this.appCheckCredentialListener=T}terminate(){this.asyncQueue.enterRestrictedMode();let T=new cG;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),T.resolve()}catch(N){let S=xj(N,"Failed to shutdown persistence");T.reject(S)}}),T.promise}}async function Cs(T,S){T.asyncQueue.verifyOperationInProgress(),cj(E7,"Initializing OfflineComponentProvider");let N=T.configuration;await S.initialize(N);let R=N.initialUser;T.setCredentialChangeListener(async T=>{R.isEqual(T)||(await T_(S.localStore,T),R=T)}),S.persistence.setDatabaseDeletedListener(()=>T.terminate()),T._offlineComponents=S}async function Ca(T,S){T.asyncQueue.verifyOperationInProgress();let N=await Cl(T);cj(E7,"Initializing OnlineComponentProvider"),await S.initialize(N,T.configuration),T.setCredentialChangeListener(T=>xR(S.remoteStore,T)),T.setAppCheckTokenChangeListener((T,N)=>xR(S.remoteStore,N)),T._onlineComponents=S}function Co(T){return"FirebaseError"===T.name?T.code===c$.FAILED_PRECONDITION||T.code===c$.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&T instanceof DOMException)||T.code===Ci||T.code===Cr||T.code===Ct}async function Cl(T){if(!T._offlineComponents){if(T._uninitializedComponentsProvider){cj(E7,"Using user provided OfflineComponentProvider");try{await Cs(T,T._uninitializedComponentsProvider._offline)}catch(N){let S=N;if(!Co(S))throw S;cB("Error using user provided cache. Falling back to memory cache: "+S),await Cs(T,new Eq)}}else cj(E7,"Using default OfflineComponentProvider"),await Cs(T,new Eq)}return T._offlineComponents}async function Cu(T){return T._onlineComponents||(T._uninitializedComponentsProvider?(cj(E7,"Using user provided OnlineComponentProvider"),await Ca(T,T._uninitializedComponentsProvider._online)):(cj(E7,"Using default OnlineComponentProvider"),await Ca(T,new EH))),T._onlineComponents}function Cc(T){return Cl(T).then(T=>T.localStore)}function Cd(T){return Cu(T).then(T=>T.syncEngine)}function Ch(T){return Cu(T).then(T=>T.datastore)}async function Cp(T){let S=await Cu(T),N=S.eventManager;return N.onListen=Es.bind(null,S.syncEngine),N.onUnlisten=Eu.bind(null,S.syncEngine),N.onFirstRemoteStoreListen=Ea.bind(null,S.syncEngine),N.onLastRemoteStoreUnlisten=Ec.bind(null,S.syncEngine),N}function Cf(T,S,N={}){let R=new cG;return T.asyncQueue.enqueueAndForget(async()=>Cg(await Cp(T),T.asyncQueue,S,N,R)),R.promise}function Cm(T,S){let N=new cG;return T.asyncQueue.enqueueAndForget(async()=>Ed(await Cd(T),S,N)),N.promise}function Cg(T,S,N,R,O){let P=new E4({next:N=>{P.mute(),S.enqueueAndForget(()=>xG(T,M)),N.fromCache&&"server"===R.source?O.reject(new cH(c$.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):O.resolve(N)},error:T=>O.reject(T)}),M=new xX(N,P,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return xH(T,M)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(T,S){return T.timeoutSeconds===S.timeoutSeconds}function Cv(T){let S={};return void 0!==T.timeoutSeconds&&(S.timeoutSeconds=T.timeoutSeconds),S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cb="ComponentProvider",Cw=new Map;function CT(T){let S=Cw.get(T);S&&(cj(Cb,"Removing Datastore"),Cw.delete(T),S.terminate())}function CS(T,S,N,R){return new pP(T,S,N,R.host,R.ssl,R.experimentalForceLongPolling,R.experimentalAutoDetectLongPolling,Cv(R.experimentalLongPollingOptions),R.useFetchStreams)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cx="firestore.googleapis.com",CE=!0,CC=5,C_=30,CI=!0;class Ck{constructor(T){var S,N;if(void 0===T.host){if(void 0!==T.ssl)throw new cH(c$.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cx,this.ssl=CE}else this.host=T.host,this.ssl=null!==(S=T.ssl)&&void 0!==S?S:CE;if(this.credentials=T.credentials,this.ignoreUndefinedProperties=!!T.ignoreUndefinedProperties,this.localCache=T.localCache,void 0===T.cacheSizeBytes)this.cacheSizeBytes=wu;else{if(T.cacheSizeBytes!==wl&&T.cacheSizeBytes<wh)throw new cH(c$.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${wh}`);this.cacheSizeBytes=T.cacheSizeBytes}EQ("experimentalForceLongPolling",T.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",T.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!T.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===T.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=CI:this.experimentalAutoDetectLongPolling=!!T.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cv(null!==(N=T.experimentalLongPollingOptions)&&void 0!==N?N:{}),CN(this.experimentalLongPollingOptions),this.useFetchStreams=!!T.useFetchStreams}isEqual(T){return this.host===T.host&&this.ssl===T.ssl&&this.credentials===T.credentials&&this.cacheSizeBytes===T.cacheSizeBytes&&this.experimentalForceLongPolling===T.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===T.experimentalAutoDetectLongPolling&&Cy(this.experimentalLongPollingOptions,T.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===T.ignoreUndefinedProperties&&this.useFetchStreams===T.useFetchStreams}}function CN(T){if(void 0!==T.timeoutSeconds){if(isNaN(T.timeoutSeconds))throw new cH(c$.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (must not be NaN)`);if(T.timeoutSeconds<CC)throw new cH(c$.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (minimum allowed value is ${CC})`);if(T.timeoutSeconds>C_)throw new cH(c$.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (maximum allowed value is ${C_})`)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(T,S,N,R){this._authCredentials=T,this._appCheckCredentials=S,this._databaseId=N,this._app=R,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ck({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new cH(c$.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(T){if(this._settingsFrozen)throw new cH(c$.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ck(T),void 0!==T.credentials&&(this._authCredentials=c0(T.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return CT(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(T,S,N){this.converter=S,this._query=N,this.type="query",this.firestore=T}withConverter(T){return new CR(this.firestore,T,this._query)}}class CD{constructor(T,S,N){this.converter=S,this._key=N,this.type="document",this.firestore=T}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CO(this.firestore,this.converter,this._key.path.popLast())}withConverter(T){return new CD(this.firestore,T,this._key)}}class CO extends CR{constructor(T,S,N){super(T,S,mC(N)),this._path=N,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let T=this._path.popLast();return T.isEmpty()?null:new CD(this.firestore,null,new du(T))}withConverter(T){return new CO(this.firestore,T,this._path)}}function CP(T,S,...N){if(T=ug(T),EK("collection","path",S),T instanceof CA){let R=ds.fromString(S,...N);return EJ(R),new CO(T,null,R)}{if(!(T instanceof CD)&&!(T instanceof CO))throw new cH(c$.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let R=T._path.child(ds.fromString(S,...N));return EJ(R),new CO(T.firestore,null,R)}}function CM(T,S,...N){if(T=ug(T),1==arguments.length&&(S=c6.newId()),EK("doc","path",S),T instanceof CA){let R=ds.fromString(S,...N);return EY(R),new CD(T,null,new du(R))}{if(!(T instanceof CD)&&!(T instanceof CO))throw new cH(c$.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let R=T._path.child(ds.fromString(S,...N));return EY(R),new CD(T.firestore,T instanceof CO?T.converter:null,new du(R))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CL="AsyncQueue";class Cj{constructor(T=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new Sz(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=T}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(T){this.enqueue(T)}enqueueAndForgetEvenWhileRestricted(T){this.verifyNotFailed(),this.enqueueInternal(T)}enterRestrictedMode(T){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=T||!1)}enqueue(T){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let S=new cG;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(T().then(S.resolve,S.reject),S.promise)).then(()=>S.promise)}enqueueRetryable(T){this.enqueueAndForget(()=>(this.retryableOps.push(T),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(T){if(dF(T))cj(CL,"Operation failed with retryable error: "+T);else throw T}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(T){let S=this.tail.then(()=>(this.operationInProgress=!0,T().catch(T=>{throw this.failure=T,this.operationInProgress=!1,cF("INTERNAL UNHANDLED ERROR: ",CF(T)),T}).then(T=>(this.operationInProgress=!1,T))));return this.tail=S,S}enqueueAfterDelay(T,S,N){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(T)>-1&&(S=0);let R=xL.createAndSchedule(this,T,S,N,T=>this.removeDelayedOperation(T));return this.delayedOperations.push(R),R}verifyNotFailed(){this.failure&&cU()}verifyOperationInProgress(){}async drain(){let T;do T=this.tail,await T;while(T!==this.tail)}containsDelayedOperation(T){for(let S of this.delayedOperations)if(S.timerId===T)return!0;return!1}runAllDelayedOperationsUntil(T){return this.drain().then(()=>{for(let S of(this.delayedOperations.sort((T,S)=>T.targetTimeMs-S.targetTimeMs),this.delayedOperations))if(S.skipDelay(),"all"!==T&&S.timerId===T)break;return this.drain()})}skipDelaysForTimerId(T){this.timerIdsToSkip.push(T)}removeDelayedOperation(T){let S=this.delayedOperations.indexOf(T);this.delayedOperations.splice(S,1)}}function CF(T){let S=T.message||"";return T.stack&&(S=T.stack.includes(T.message)?T.stack:T.message+"\n"+T.stack),S}class CB extends CA{constructor(T,S,N,R){super(T,S,N,R),this.type="firestore",this._queue=new Cj,this._persistenceKey=(null==R?void 0:R.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let T=this._firestoreClient.terminate();this._queue=new Cj(T),this._firestoreClient=void 0,await T}}}function CV(T){if(T._terminated)throw new cH(c$.FAILED_PRECONDITION,"The client has already been terminated.");return T._firestoreClient||CU(T),T._firestoreClient}function CU(T){var S,N,R;let O=T._freezeSettings(),P=CS(T._databaseId,(null===(S=T._app)||void 0===S?void 0:S.options.appId)||"",T._persistenceKey,O);!T._componentsProvider&&(null===(N=O.localCache)||void 0===N?void 0:N._offlineComponentProvider)&&(null===(R=O.localCache)||void 0===R?void 0:R._onlineComponentProvider)&&(T._componentsProvider={_offline:O.localCache._offlineComponentProvider,_online:O.localCache._onlineComponentProvider}),T._firestoreClient=new Cn(T._authCredentials,T._appCheckCredentials,T._queue,P,T._componentsProvider&&Cz(T._componentsProvider))}function Cz(T){let S=null==T?void 0:T._online.build();return{_offline:null==T?void 0:T._offline.build(S),_online:S}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cq(T,S=!0){cO(ci),u8(new uy("firestore",(T,{instanceIdentifier:N,options:R})=>{let O=T.getProvider("app").getImmediate(),P=new CB(new cQ(T.getProvider("auth-internal")),new cZ(T.getProvider("app-check-internal")),pj(O,N),O);return R=Object.assign({useFetchStreams:S},R),P._setSettings(R),P},"PUBLIC").setMultipleInstances(!0)),cs(cN,cA,T),cs(cN,cA,"esm2017")}class C${constructor(T,S,N){this._userDataWriter=S,this._data=N,this.type="AggregateQuerySnapshot",this.query=T}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CH{constructor(T){this._byteString=T}static fromBase64String(T){try{return new CH(pv.fromBase64String(T))}catch(T){throw new cH(c$.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+T)}}static fromUint8Array(T){return new CH(pv.fromUint8Array(T))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(T){return this._byteString.isEqual(T._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CG{constructor(...T){for(let S=0;S<T.length;++S)if(0===T[S].length)throw new cH(c$.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dl(T)}isEqual(T){return this._internalPath.isEqual(T._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CW{constructor(T){this._methodName=T}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CK{constructor(T,S){if(!isFinite(T)||T<-90||T>90)throw new cH(c$.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+T);if(!isFinite(S)||S<-180||S>180)throw new cH(c$.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+S);this._lat=T,this._long=S}get latitude(){return this._lat}get longitude(){return this._long}isEqual(T){return this._lat===T._lat&&this._long===T._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(T){return c5(this._lat,T._lat)||c5(this._long,T._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CQ{constructor(T){this._values=(T||[]).map(T=>T)}toArray(){return this._values.map(T=>T)}isEqual(T){return TT(this._values,T._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CY=/^__.*__$/;class CJ{constructor(T,S,N){this.data=T,this.fieldMask=S,this.fieldTransforms=N}toMutation(T,S){return null!==this.fieldMask?new gM(T,this.data,this.fieldMask,S,this.fieldTransforms):new gD(T,this.data,S,this.fieldTransforms)}}class CX{constructor(T,S,N){this.data=T,this.fieldMask=S,this.fieldTransforms=N}toMutation(T,S){return new gM(T,this.data,this.fieldMask,S,this.fieldTransforms)}}function CZ(T){switch(T){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cU()}}class C0{constructor(T,S,N,R,O,P){this.settings=T,this.databaseId=S,this.serializer=N,this.ignoreUndefinedProperties=R,void 0===O&&this.validatePath(),this.fieldTransforms=O||[],this.fieldMask=P||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(T){return new C0(Object.assign(Object.assign({},this.settings),T),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(T){var S;let N=null===(S=this.path)||void 0===S?void 0:S.child(T),R=this.contextWith({path:N,arrayElement:!1});return R.validatePathSegment(T),R}childContextForFieldPath(T){var S;let N=null===(S=this.path)||void 0===S?void 0:S.child(T),R=this.contextWith({path:N,arrayElement:!1});return R.validatePath(),R}childContextForArray(T){return this.contextWith({path:void 0,arrayElement:!0})}createError(T){return _S(T,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(T){return void 0!==this.fieldMask.find(S=>T.isPrefixOf(S))||void 0!==this.fieldTransforms.find(S=>T.isPrefixOf(S.field))}validatePath(){if(this.path)for(let T=0;T<this.path.length;T++)this.validatePathSegment(this.path.get(T))}validatePathSegment(T){if(0===T.length)throw this.createError("Document fields must not be empty");if(CZ(this.dataSource)&&CY.test(T))throw this.createError('Document fields cannot begin and end with "__"')}}class C1{constructor(T,S,N){this.databaseId=T,this.ignoreUndefinedProperties=S,this.serializer=N||Sj(T)}createContext(T,S,N,R=!1){return new C0({dataSource:T,methodName:S,targetDoc:N,path:dl.emptyPath(),arrayElement:!1,hasConverter:R},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function C2(T){let S=T._freezeSettings(),N=Sj(T._databaseId);return new C1(T._databaseId,!!S.ignoreUndefinedProperties,N)}function C3(T,S,N,R,O,P={}){let M,L;let V=T.createContext(P.merge||P.mergeFields?2:0,S,N,O);_y("Data must be an object, but it was:",V,R);let U=_s(R,V);if(P.merge)M=new pm(V.fieldMask),L=V.fieldTransforms;else if(P.mergeFields){let T=[];for(let R of P.mergeFields){let O=_v(S,R,N);if(!V.contains(O))throw new cH(c$.INVALID_ARGUMENT,`Field '${O}' is specified in your field mask but missing from your input data.`);_x(T,O)||T.push(O)}M=new pm(T),L=V.fieldTransforms.filter(T=>M.covers(T.field))}else M=null,L=V.fieldTransforms;return new CJ(new fD(U),M,L)}class C4 extends CW{_toFieldTransform(T){if(2===T.dataSource)T.fieldMask.push(T.path);else if(1===T.dataSource)throw T.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw T.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(T){return T instanceof C4}}function C6(T,S,N){return new C0({dataSource:3,targetDoc:S.settings.targetDoc,methodName:T._methodName,arrayElement:N},S.databaseId,S.serializer,S.ignoreUndefinedProperties)}class C5 extends null{_toFieldTransform(T){return new gw(T.path,new gd)}isEqual(T){return T instanceof C5}}class C9 extends null{constructor(T,S){super(T),this._elements=S}_toFieldTransform(T){let S=C6(this,T,!0),N=new gh(this._elements.map(T=>_n(T,S)));return new gw(T.path,N)}isEqual(T){return T instanceof C9&&deepEqual(this._elements,T._elements)}}class C8 extends null{constructor(T,S){super(T),this._elements=S}_toFieldTransform(T){let S=C6(this,T,!0),N=new gf(this._elements.map(T=>_n(T,S)));return new gw(T.path,N)}isEqual(T){return T instanceof C8&&deepEqual(this._elements,T._elements)}}class C7 extends null{constructor(T,S){super(T),this._operand=S}_toFieldTransform(T){let S=new gg(T.serializer,gs(T.serializer,this._operand));return new gw(T.path,S)}isEqual(T){return T instanceof C7&&this._operand===T._operand}}function _t(T,S,N,R){let O=T.createContext(1,S,N);_y("Data must be an object, but it was:",O,R);let P=[],M=fD.empty();return ps(R,(T,R)=>{let L=_T(S,T,N);R=ug(R);let V=O.childContextForFieldPath(L);if(R instanceof C4)P.push(L);else{let T=_n(R,V);null!=T&&(P.push(L),M.set(L,T))}}),new CX(M,new pm(P),O.fieldTransforms)}function _r(T,S,N,R,O,P){let M=T.createContext(1,S,N),L=[_v(S,R,N)],V=[O];if(P.length%2!=0)throw new cH(c$.INVALID_ARGUMENT,`Function ${S}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<P.length;T+=2)L.push(_v(S,P[T])),V.push(P[T+1]);let U=[],$=fD.empty();for(let T=L.length-1;T>=0;--T)if(!_x(U,L[T])){let S=L[T],N=V[T];N=ug(N);let R=M.childContextForFieldPath(S);if(N instanceof C4)U.push(S);else{let T=_n(N,R);null!=T&&(U.push(S),$.set(S,T))}}return new CX($,new pm(U),M.fieldTransforms)}function _i(T,S,N,R=!1){return _n(N,T.createContext(R?4:3,S))}function _n(T,S){if(_m(T=ug(T)))return _y("Unsupported field value:",S,T),_s(T,S);if(T instanceof CW)return _l(T,S),null;if(void 0===T&&S.ignoreUndefinedProperties)return null;if(S.path&&S.fieldMask.push(S.path),!(T instanceof Array))return _u(T,S);if(S.settings.arrayElement&&4!==S.dataSource)throw S.createError("Nested arrays are not supported");return _o(T,S)}function _s(T,S){let N={};return pa(T)?S.path&&S.path.length>0&&S.fieldMask.push(S.path):ps(T,(T,R)=>{let O=_n(R,S.childContextForField(T));null!=O&&(N[T]=O)}),{mapValue:{fields:N}}}function _o(T,S){let N=[],R=0;for(let O of T){let T=_n(O,S.childContextForArray(R));null==T&&(T={nullValue:"NULL_VALUE"}),N.push(T),R++}return{arrayValue:{values:N}}}function _l(T,S){if(!CZ(S.dataSource))throw S.createError(`${T._methodName}() can only be used with update() and set()`);if(!S.path)throw S.createError(`${T._methodName}() is not currently supported inside arrays`);let N=T._toFieldTransform(S);N&&S.fieldTransforms.push(N)}function _u(T,S){if(null===(T=ug(T)))return{nullValue:"NULL_VALUE"};if("number"==typeof T)return gs(S.serializer,T);if("boolean"==typeof T)return{booleanValue:T};if("string"==typeof T)return{stringValue:T};if(T instanceof Date){let N=dt.fromDate(T);return{timestampValue:yg(S.serializer,N)}}if(T instanceof dt){let N=new dt(T.seconds,1e3*Math.floor(T.nanoseconds/1e3));return{timestampValue:yg(S.serializer,N)}}if(T instanceof CK)return{geoPointValue:{latitude:T.latitude,longitude:T.longitude}};else if(T instanceof CH)return{bytesValue:yv(S.serializer,T._byteString)};else if(T instanceof CD){let N=S.databaseId,R=T.firestore._databaseId;if(!R.isEqual(N))throw S.createError(`Document reference is for database ${R.projectId}/${R.database} but should be for database ${N.projectId}/${N.database}`);return{referenceValue:yS(T.firestore._databaseId||S.databaseId,T._key.path)}}else if(T instanceof CQ)return _p(T,S);else throw S.createError(`Unsupported field value: ${EZ(T)}`)}function _p(T,S){return{mapValue:{fields:{[pz]:{stringValue:pH},[pG]:{arrayValue:{values:T.toArray().map(T=>{if("number"!=typeof T)throw S.createError("VectorValues must only contain numeric values.");return gi(S.serializer,T)})}}}}}}function _m(T){return"object"==typeof T&&null!==T&&!(T instanceof Array)&&!(T instanceof Date)&&!(T instanceof dt)&&!(T instanceof CK)&&!(T instanceof CH)&&!(T instanceof CD)&&!(T instanceof CW)&&!(T instanceof CQ)}function _y(T,S,N){if(!_m(N)||!EX(N)){let R=EZ(N);if("an object"===R)throw S.createError(T+" a custom object");throw S.createError(T+" "+R)}}function _v(T,S,N){if((S=ug(S))instanceof CG)return S._internalPath;if("string"==typeof S)return _T(T,S);throw _S("Field path arguments must be of type string or ",T,!1,void 0,N)}let _w=RegExp("[~\\*/\\[\\]]");function _T(T,S,N){if(S.search(_w)>=0)throw _S(`Invalid field path (${S}). Paths must not contain '~', '*', '/', '[', or ']'`,T,!1,void 0,N);try{return new CG(...S.split("."))._internalPath}catch(R){throw _S(`Invalid field path (${S}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,T,!1,void 0,N)}}function _S(T,S,N,R,O){let P=R&&!R.isEmpty(),M=void 0!==O,L=`Function ${S}() called with invalid data`;N&&(L+=" (via `toFirestore()`)"),L+=". ";let V="";return(P||M)&&(V+=" (found",P&&(V+=` in field ${R}`),M&&(V+=` in document ${O}`),V+=")"),new cH(c$.INVALID_ARGUMENT,L+T+V)}function _x(T,S){return T.some(T=>T.isEqual(S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(T,S,N,R,O){this._firestore=T,this._userDataWriter=S,this._key=N,this._document=R,this._converter=O}get id(){return this._key.path.lastSegment()}get ref(){return new CD(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let T=new _C(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(T)}}}get(T){if(this._document){let S=this._document.data.field(__("DocumentSnapshot.get",T));if(null!==S)return this._userDataWriter.convertValue(S)}}}class _C extends _E{data(){return super.data()}}function __(T,S){return"string"==typeof S?_T(T,S):S instanceof CG?S._internalPath:S._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(T){if("L"===T.limitType&&0===T.explicitOrderBy.length)throw new cH(c$.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _N{}class _A extends _N{}function _R(T,S,...N){let R=[];for(let O of(S instanceof _N&&R.push(S),_Z(R=R.concat(N)),R))T=O._apply(T);return T}class _D extends _A{constructor(T,S,N){super(),this._field=T,this._op=S,this._value=N,this.type="where"}static _create(T,S,N){return new _D(T,S,N)}_apply(T){let S=this._parse(T);return _Y(T._query,S),new CR(T.firestore,T.converter,mM(T._query,S))}_parse(T){let S=C2(T.firestore);return _q(T._query,"where",S,T.firestore._databaseId,this._field,this._op,this._value)}}function _O(T,S,N){let R=S,O=__("where",T);return _D._create(O,R,N)}class _P extends _N{constructor(T,S){super(),this.type=T,this._queryConstraints=S}static _create(T,S){return new _P(T,S)}_parse(T){let S=this._queryConstraints.map(S=>S._parse(T)).filter(T=>T.getFilters().length>0);return 1===S.length?S[0]:fW.create(S,this._getOperator())}_apply(T){let S=this._parse(T);return 0===S.getFilters().length?T:(_J(T._query,S),new CR(T.firestore,T.converter,mM(T._query,S)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class _M extends _A{constructor(T,S){super(),this._field=T,this._direction=S,this.type="orderBy"}static _create(T,S){return new _M(T,S)}_apply(T){let S=_$(T._query,this._field,this._direction);return new CR(T.firestore,T.converter,mL(T._query,S))}}function _L(T,S="asc"){let N=S,R=__("orderBy",T);return _M._create(R,N)}class _F extends _A{constructor(T,S,N){super(),this.type=T,this._limit=S,this._limitType=N}static _create(T,S,N){return new _F(T,S,N)}_apply(T){return new CR(T.firestore,T.converter,mj(T._query,this._limit,this._limitType))}}function _B(T){return E2("limit",T),_F._create("limit",T,"F")}class _V extends null{constructor(T,S,N){super(),this.type=T,this._docOrFields=S,this._inclusive=N}static _create(T,S,N){return new _V(T,S,N)}_apply(T){let S=_z(T,this.type,this._docOrFields,this._inclusive);return new CR(T.firestore,T.converter,mF(T._query,S))}}class _U extends null{constructor(T,S,N){super(),this.type=T,this._docOrFields=S,this._inclusive=N}static _create(T,S,N){return new _U(T,S,N)}_apply(T){let S=_z(T,this.type,this._docOrFields,this._inclusive);return new CR(T.firestore,T.converter,mB(T._query,S))}}function _z(T,S,N,R){if(N[0]=getModularInstance(N[0]),N[0]instanceof _E)return _H(T._query,T.firestore._databaseId,S,N[0]._document,R);{let O=C2(T.firestore);return _G(T._query,T.firestore._databaseId,O,S,N,R)}}function _q(T,S,N,R,O,P,M){let L;if(O.isKeyField()){if("array-contains"===P||"array-contains-any"===P)throw new cH(c$.INVALID_ARGUMENT,`Invalid Query. You can't perform '${P}' queries on documentId().`);if("in"===P||"not-in"===P){_K(M,P);let S=[];for(let N of M)S.push(_W(R,T,N));L={arrayValue:{values:S}}}else L=_W(R,T,M)}else("in"===P||"not-in"===P||"array-contains-any"===P)&&_K(M,P),L=_i(N,S,M,"in"===P||"not-in"===P);return fG.create(O,P,L)}function _$(T,S,N){if(null!==T.startAt)throw new cH(c$.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==T.endAt)throw new cH(c$.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fU(S,N)}function _H(T,S,N,R,O){if(!R)throw new cH(c$.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${N}().`);let P=[];for(let N of mR(T))if(N.field.isKeyField())P.push(fg(S,R.key));else{let T=R.data.field(N.field);if(pA(T))throw new cH(c$.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+N.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==T)P.push(T);else{let T=N.field.canonicalString();throw new cH(c$.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${T}' (used as the orderBy) does not exist.`)}}return new fL(P,O)}function _G(T,S,N,R,O,P){let M=T.explicitOrderBy;if(O.length>M.length)throw new cH(c$.INVALID_ARGUMENT,`Too many arguments provided to ${R}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let L=[];for(let P=0;P<O.length;P++){let V=O[P];if(M[P].field.isKeyField()){if("string"!=typeof V)throw new cH(c$.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${R}(), but got a ${typeof V}`);if(!mA(T)&&-1!==V.indexOf("/"))throw new cH(c$.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${R}() must be a plain document ID, but '${V}' contains a slash.`);let N=T.path.child(ds.fromString(V));if(!du.isDocumentKey(N))throw new cH(c$.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${R}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let O=new du(N);L.push(fg(S,O))}else{let T=_i(N,R,V);L.push(T)}}return new fL(L,P)}function _W(T,S,N){if("string"==typeof(N=ug(N))){if(""===N)throw new cH(c$.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mA(S)&&-1!==N.indexOf("/"))throw new cH(c$.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${N}' contains a '/' character.`);let R=S.path.child(ds.fromString(N));if(!du.isDocumentKey(R))throw new cH(c$.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${R}' is not because it has an odd number of segments (${R.length}).`);return fg(T,new du(R))}if(N instanceof CD)return fg(T,N._key);throw new cH(c$.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${EZ(N)}.`)}function _K(T,S){if(!Array.isArray(T)||0===T.length)throw new cH(c$.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${S.toString()}' filters.`)}function _Q(T){switch(T){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function _Y(T,S){let N=_X(T.filters,_Q(S.op));if(null!==N){if(N===S.op)throw new cH(c$.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${S.op.toString()}' filter.`);throw new cH(c$.INVALID_ARGUMENT,`Invalid query. You cannot use '${S.op.toString()}' filters with '${N.toString()}' filters.`)}}function _J(T,S){let N=T;for(let T of S.getFlattenedFilters())_Y(N,T),N=mM(N,T)}function _X(T,S){for(let N of T)for(let T of N.getFlattenedFilters())if(S.indexOf(T.op)>=0)return T.op;return null}function _Z(T){let S=T.filter(T=>T instanceof _P).length,N=T.filter(T=>T instanceof _D).length;if(S>1||S>0&&N>0)throw new cH(c$.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{convertValue(T,S="none"){switch(pK(T)){case 0:return null;case 1:return T.booleanValue;case 2:return pE(T.integerValue||T.doubleValue);case 3:return this.convertTimestamp(T.timestampValue);case 4:return this.convertServerTimestamp(T,S);case 5:return T.stringValue;case 6:return this.convertBytes(pC(T.bytesValue));case 7:return this.convertReference(T.referenceValue);case 8:return this.convertGeoPoint(T.geoPointValue);case 9:return this.convertArray(T.arrayValue,S);case 11:return this.convertObject(T.mapValue,S);case 10:return this.convertVectorValue(T.mapValue);default:throw cU()}}convertObject(T,S){return this.convertObjectMap(T.fields,S)}convertObjectMap(T,S="none"){let N={};return ps(T,(T,R)=>{N[T]=this.convertValue(R,S)}),N}convertVectorValue(T){var S,N,R;return new CQ(null===(R=null===(N=null===(S=T.fields)||void 0===S?void 0:S[pG].arrayValue)||void 0===N?void 0:N.values)||void 0===R?void 0:R.map(T=>pE(T.doubleValue)))}convertGeoPoint(T){return new CK(pE(T.latitude),pE(T.longitude))}convertArray(T,S){return(T.values||[]).map(T=>this.convertValue(T,S))}convertServerTimestamp(T,S){switch(S){case"previous":let N=pD(T);if(null==N)return null;return this.convertValue(N,S);case"estimate":return this.convertTimestamp(pO(T));default:return null}}convertTimestamp(T){let S=pS(T);return new dt(S.seconds,S.nanos)}convertDocumentKey(T,S){let N=ds.fromString(T);cz(vC(N));let R=new pL(N.get(1),N.get(3)),O=new du(N.popFirst(5));return R.isEqual(S)||cF(`Document ${O} contains a document reference within a different database (${R.projectId}/${R.database}) which is not supported. It will be treated as a reference in the current database (${S.projectId}/${S.database}) instead.`),O}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(T,S,N){return T?N&&(N.merge||N.mergeFields)?T.toFirestore(S,N):T.toFirestore(S):S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(T,S){this.hasPendingWrites=T,this.fromCache=S}isEqual(T){return this.hasPendingWrites===T.hasPendingWrites&&this.fromCache===T.fromCache}}class _3 extends _E{constructor(T,S,N,R,O,P){super(T,S,N,R,P),this._firestore=T,this._firestoreImpl=T,this.metadata=O}exists(){return super.exists()}data(T={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,T.serverTimestamps);{let S=new _4(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(S,T)}}}get(T,S={}){if(this._document){let N=this._document.data.field(__("DocumentSnapshot.get",T));if(null!==N)return this._userDataWriter.convertValue(N,S.serverTimestamps)}}}class _4 extends _3{data(T={}){return super.data(T)}}class _6{constructor(T,S,N,R){this._firestore=T,this._userDataWriter=S,this._snapshot=R,this.metadata=new _2(R.hasPendingWrites,R.fromCache),this.query=N}get docs(){let T=[];return this.forEach(S=>T.push(S)),T}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(T,S){this._snapshot.docs.forEach(N=>{T.call(S,new _4(this._firestore,this._userDataWriter,N.key,N,new _2(this._snapshot.mutatedKeys.has(N.key),this._snapshot.fromCache),this.query.converter))})}docChanges(T={}){let S=!!T.includeMetadataChanges;if(S&&this._snapshot.excludesMetadataChanges)throw new cH(c$.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===S||(this._cachedChanges=_5(this,S),this._cachedChangesIncludeMetadataChanges=S),this._cachedChanges}}function _5(T,S){if(T._snapshot.oldDocs.isEmpty()){let S=0;return T._snapshot.docChanges.map(N=>{let R=new _4(T._firestore,T._userDataWriter,N.doc.key,N.doc,new _2(T._snapshot.mutatedKeys.has(N.doc.key),T._snapshot.fromCache),T.query.converter);return N.doc,{type:"added",doc:R,oldIndex:-1,newIndex:S++}})}{let N=T._snapshot.oldDocs;return T._snapshot.docChanges.filter(T=>S||3!==T.type).map(S=>{let R=new _4(T._firestore,T._userDataWriter,S.doc.key,S.doc,new _2(T._snapshot.mutatedKeys.has(S.doc.key),T._snapshot.fromCache),T.query.converter),O=-1,P=-1;return 0!==S.type&&(O=N.indexOf(S.doc.key),N=N.delete(S.doc.key)),1!==S.type&&(P=(N=N.add(S.doc)).indexOf(S.doc.key)),{type:_9(S.type),doc:R,oldIndex:O,newIndex:P}})}}function _9(T){switch(T){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cU()}}class _8 extends _0{constructor(T){super(),this.firestore=T}convertBytes(T){return new CH(T)}convertReference(T){let S=this.convertDocumentKey(T,this.firestore._databaseId);return new CD(this.firestore,null,S)}}function _7(T){T=E1(T,CR);let S=E1(T.firestore,CB),N=CV(S),R=new _8(S);return _I(T._query),Cf(N,T._query).then(N=>new _6(S,R,T,N))}function Ie(T,S,N,...R){let O;T=E1(T,CD);let P=E1(T.firestore,CB),M=C2(P);return Ii(P,[(O="string"==typeof(S=ug(S))||S instanceof CG?_r(M,"updateDoc",T._key,S,N,R):_t(M,"updateDoc",T._key,S)).toMutation(T._key,gE.exists(!0))])}function It(T){return Ii(E1(T.firestore,CB),[new gU(T._key,gE.none())])}function Ir(T,S){let N=E1(T.firestore,CB),R=CM(T),O=_1(T.converter,S);return Ii(N,[C3(C2(T.firestore),"addDoc",R._key,O,null!==T.converter,{}).toMutation(R._key,gE.exists(!1))]).then(()=>R)}function Ii(T,S){return Cm(CV(T),S)}class In{constructor(T){this.forceOwnership=T,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(T){this._onlineComponentProvider=EH.provider,this._offlineComponentProvider={build:S=>new E$(S,null==T?void 0:T.cacheSizeBytes,this.forceOwnership)}}}new WeakMap;class Is{constructor(){this.existenceFilterMismatchCallbacksById=new Map}static get instance(){return Ia||g0(Ia=new Is),Ia}notifyOnExistenceFilterMismatch(T){this.existenceFilterMismatchCallbacksById.forEach(S=>S(T))}onExistenceFilterMismatch(T){let S=Symbol(),N=this.existenceFilterMismatchCallbacksById;return N.set(S,T),()=>N.delete(S)}}let Ia=null;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cq("node");let Io=require("undici"),Il="firebasestorage.googleapis.com",Iu="storageBucket",Ic=12e4,Id=6e5,Ih=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip extends l9{constructor(T,S,N=0){super(If(T),`Firebase Storage: ${S} (${If(T)})`),this.status_=N,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ip.prototype)}get status(){return this.status_}set status(T){this.status_=T}_codeEquals(T){return If(T)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(T){this.customData.serverResponse=T,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function If(T){return"storage/"+T}function Im(){let T="An unknown error occurred, please check the error payload for server response.";return new Ip(et.UNKNOWN,T)}function Ig(T){return new Ip(et.OBJECT_NOT_FOUND,"Object '"+T+"' does not exist.")}function Iy(T){return new Ip(et.QUOTA_EXCEEDED,"Quota for bucket '"+T+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Iv(){let T="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ip(et.UNAUTHENTICATED,T)}function Ib(){return new Ip(et.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Iw(T){return new Ip(et.UNAUTHORIZED,"User does not have permission to access '"+T+"'.")}function IT(){return new Ip(et.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function IS(){return new Ip(et.CANCELED,"User canceled the upload/download.")}function Ix(T){return new Ip(et.INVALID_URL,"Invalid URL '"+T+"'.")}function IE(T){return new Ip(et.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+T+"'.")}function IC(){return new Ip(et.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Iu+"' property when initializing the app?")}function I_(){return new Ip(et.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function II(){return new Ip(et.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function Ik(){return new Ip(et.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function IN(T){return new Ip(et.INVALID_ARGUMENT,T)}function IA(){return new Ip(et.APP_DELETED,"The Firebase app was deleted.")}function IR(T){return new Ip(et.INVALID_ROOT_OPERATION,"The operation '"+T+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ID(T,S){return new Ip(et.INVALID_FORMAT,"String does not match format '"+T+"': "+S)}function IO(T){throw new Ip(et.INTERNAL_ERROR,"Internal error: "+T)}!function(T){T.UNKNOWN="unknown",T.OBJECT_NOT_FOUND="object-not-found",T.BUCKET_NOT_FOUND="bucket-not-found",T.PROJECT_NOT_FOUND="project-not-found",T.QUOTA_EXCEEDED="quota-exceeded",T.UNAUTHENTICATED="unauthenticated",T.UNAUTHORIZED="unauthorized",T.UNAUTHORIZED_APP="unauthorized-app",T.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",T.INVALID_CHECKSUM="invalid-checksum",T.CANCELED="canceled",T.INVALID_EVENT_NAME="invalid-event-name",T.INVALID_URL="invalid-url",T.INVALID_DEFAULT_BUCKET="invalid-default-bucket",T.NO_DEFAULT_BUCKET="no-default-bucket",T.CANNOT_SLICE_BLOB="cannot-slice-blob",T.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",T.NO_DOWNLOAD_URL="no-download-url",T.INVALID_ARGUMENT="invalid-argument",T.INVALID_ARGUMENT_COUNT="invalid-argument-count",T.APP_DELETED="app-deleted",T.INVALID_ROOT_OPERATION="invalid-root-operation",T.INVALID_FORMAT="invalid-format",T.INTERNAL_ERROR="internal-error",T.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(et||(et={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(T,S){this.bucket=T,this.path_=S}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let T=encodeURIComponent;return"/b/"+T(this.bucket)+"/o/"+T(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(T,S){let N;try{N=IP.makeFromUrl(T,S)}catch(S){return new IP(T,"")}if(""===N.path)return N;throw IE(T)}static makeFromUrl(T,S){let N=null,R="([A-Za-z0-9.\\-_]+)";function O(T){"/"===T.path.charAt(T.path.length-1)&&(T.path_=T.path_.slice(0,-1))}let P=RegExp("^gs://"+R+"(/(.*))?$","i"),M={bucket:1,path:3};function L(T){T.path_=decodeURIComponent(T.path)}let V="v[A-Za-z0-9_]+",U=S.replace(/[.]/g,"\\."),$="(/([^?#]*).*)?$",W=RegExp(`^https?://${U}/${V}/b/${R}/o${$}`,"i"),K=S===Il?"(?:storage.googleapis.com|storage.cloud.google.com)":S,Q="([^?#]*)",Y=[{regex:P,indices:M,postModify:O},{regex:W,indices:{bucket:1,path:3},postModify:L},{regex:RegExp(`^https?://${K}/${R}/${Q}`,"i"),indices:{bucket:1,path:2},postModify:L}];for(let S=0;S<Y.length;S++){let R=Y[S],O=R.regex.exec(T);if(O){let T=O[R.indices.bucket],S=O[R.indices.path];S||(S=""),N=new IP(T,S),R.postModify(N);break}}if(null==N)throw Ix(T);return N}}class IM{constructor(T){this.promise_=Promise.reject(T)}getPromise(){return this.promise_}cancel(T=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(T,S,N){let R=1,O=null,P=null,M=!1,L=0;function V(){return 2===L}let U=!1;function $(...T){U||(U=!0,S.apply(null,T))}function W(S){O=setTimeout(()=>{O=null,T(Q,V())},S)}function K(){P&&clearTimeout(P)}function Q(T,...S){let N;if(U){K();return}if(T||V()||M){K(),$.call(null,T,...S);return}R<64&&(R*=2),1===L?(L=2,N=0):N=(R+Math.random())*1e3,W(N)}let Y=!1;function Z(T){!Y&&(Y=!0,K(),!U&&(null!==O?(T||(L=2),clearTimeout(O),W(0)):T||(L=1)))}return W(0),P=setTimeout(()=>{M=!0,Z(!0)},N),Z}function Ij(T){T(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(T){return void 0!==T}function IB(T){return"function"==typeof T}function IV(T){return"object"==typeof T&&!Array.isArray(T)}function IU(T){return"string"==typeof T||T instanceof String}function Iz(T){return Iq()&&T instanceof Blob}function Iq(){return"undefined"!=typeof Blob}function I$(T,S,N,R){if(R<S)throw IN(`Invalid value for '${T}'. Expected ${S} or greater.`);if(R>N)throw IN(`Invalid value for '${T}'. Expected ${N} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IH(T,S,N){let R=S;return null==N&&(R=`https://${S}`),`${N}://${R}/v0${T}`}function IG(T){let S=encodeURIComponent,N="?";for(let R in T)T.hasOwnProperty(R)&&(N=N+(S(R)+"=")+S(T[R])+"&");return N.slice(0,-1)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IW(T,S){let N=T>=500&&T<600,R=-1!==[408,429].indexOf(T),O=-1!==S.indexOf(T);return N||R||O}!function(T){T[T.NO_ERROR=0]="NO_ERROR",T[T.NETWORK_ERROR=1]="NETWORK_ERROR",T[T.ABORT=2]="ABORT"}(er||(er={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IK{constructor(T,S,N,R,O,P,M,L,V,U,$,W=!0){this.url_=T,this.method_=S,this.headers_=N,this.body_=R,this.successCodes_=O,this.additionalRetryCodes_=P,this.callback_=M,this.errorCallback_=L,this.timeout_=V,this.progressCallback_=U,this.connectionFactory_=$,this.retry=W,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,S)=>{this.resolve_=T,this.reject_=S,this.start_()})}start_(){let T=(T,S)=>{if(S){T(!1,new IQ(!1,null,!0));return}let N=this.connectionFactory_();this.pendingConnection_=N;let R=T=>{let S=T.loaded,N=T.lengthComputable?T.total:-1;null!==this.progressCallback_&&this.progressCallback_(S,N)};null!==this.progressCallback_&&N.addUploadProgressListener(R),N.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&N.removeUploadProgressListener(R),this.pendingConnection_=null;let S=N.getErrorCode()===er.NO_ERROR,O=N.getStatus();if(!S||IW(O,this.additionalRetryCodes_)&&this.retry){T(!1,new IQ(!1,null,N.getErrorCode()===er.ABORT));return}T(!0,new IQ(-1!==this.successCodes_.indexOf(O),N))})},S=(T,S)=>{let N=this.resolve_,R=this.reject_,O=S.connection;if(S.wasSuccessCode)try{let T=this.callback_(O,O.getResponse());IF(T)?N(T):N()}catch(T){R(T)}else if(null!==O){let T=Im();T.serverResponse=O.getErrorText(),R(this.errorCallback_?this.errorCallback_(O,T):T)}else R(S.canceled?this.appDelete_?IA():IS():IT())};this.canceled_?S(!1,new IQ(!1,null,!0)):this.backoffId_=IL(T,S,this.timeout_)}getPromise(){return this.promise_}cancel(T){this.canceled_=!0,this.appDelete_=T||!1,null!==this.backoffId_&&Ij(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class IQ{constructor(T,S,N){this.wasSuccessCode=T,this.connection=S,this.canceled=!!N}}function IY(T,S){null!==S&&S.length>0&&(T.Authorization="Firebase "+S)}function IJ(T,S){T["X-Firebase-Storage-Version"]="webjs/"+(null!=S?S:"AppManager")}function IX(T,S){S&&(T["X-Firebase-GMPID"]=S)}function IZ(T,S){null!==S&&(T["X-Firebase-AppCheck"]=S)}function I0(T,S,N,R,O,P,M=!0){let L=IG(T.urlParams),V=T.url+L,U=Object.assign({},T.headers);return IX(U,S),IY(U,N),IJ(U,P),IZ(U,R),new IK(V,T.method,U,T.body,T.successCodes,T.additionalRetryCodes,T.handler,T.errorHandler,T.timeout,T.progressCallback,O,M)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function I2(...T){let S=I1();if(void 0!==S){let N=new S;for(let S=0;S<T.length;S++)N.append(T[S]);return N.getBlob()}if(Iq())return new Blob(T);throw new Ip(et.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function I3(T,S,N){return T.webkitSlice?T.webkitSlice(S,N):T.mozSlice?T.mozSlice(S,N):T.slice?T.slice(S,N):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(T){if(/[^-A-Za-z0-9+/=]/.test(T))throw ID("base64","Invalid character found");return Buffer.from(T,"base64").toString("binary")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I6={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class I5{constructor(T,S){this.data=T,this.contentType=S||null}}function I9(T,S){switch(T){case I6.RAW:return new I5(I8(S));case I6.BASE64:case I6.BASE64URL:return new I5(ke(T,S));case I6.DATA_URL:return new I5(kr(S),ki(S))}throw Im()}function I8(T){let S=[];for(let N=0;N<T.length;N++){let R=T.charCodeAt(N);R<=127?S.push(R):R<=2047?S.push(192|R>>6,128|63&R):(64512&R)==55296?N<T.length-1&&(64512&T.charCodeAt(N+1))==56320?(R=65536|(1023&R)<<10|1023&T.charCodeAt(++N),S.push(240|R>>18,128|R>>12&63,128|R>>6&63,128|63&R)):S.push(239,191,189):(64512&R)==56320?S.push(239,191,189):S.push(224|R>>12,128|R>>6&63,128|63&R)}return new Uint8Array(S)}function I7(T){let S;try{S=decodeURIComponent(T)}catch(T){throw ID(I6.DATA_URL,"Malformed data URL.")}return I8(S)}function ke(T,S){let N;switch(T){case I6.BASE64:{let N=-1!==S.indexOf("-"),R=-1!==S.indexOf("_");if(N||R)throw ID(T,"Invalid character '"+(N?"-":"_")+"' found: is it base64url encoded?");break}case I6.BASE64URL:{let N=-1!==S.indexOf("+"),R=-1!==S.indexOf("/");if(N||R)throw ID(T,"Invalid character '"+(N?"+":"/")+"' found: is it base64 encoded?");S=S.replace(/-/g,"+").replace(/_/g,"/")}}try{N=I4(S)}catch(S){if(S.message.includes("polyfill"))throw S;throw ID(T,"Invalid character found")}let R=new Uint8Array(N.length);for(let T=0;T<N.length;T++)R[T]=N.charCodeAt(T);return R}class kt{constructor(T){this.base64=!1,this.contentType=null;let S=T.match(/^data:([^,]+)?,/);if(null===S)throw ID(I6.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let N=S[1]||null;null!=N&&(this.base64=kn(N,";base64"),this.contentType=this.base64?N.substring(0,N.length-7):N),this.rest=T.substring(T.indexOf(",")+1)}}function kr(T){let S=new kt(T);return S.base64?ke(I6.BASE64,S.rest):I7(S.rest)}function ki(T){return new kt(T).contentType}function kn(T,S){return T.length>=S.length&&T.substring(T.length-S.length)===S}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(T,S){let N=0,R="";Iz(T)?(this.data_=T,N=T.size,R=T.type):T instanceof ArrayBuffer?(S?this.data_=new Uint8Array(T):(this.data_=new Uint8Array(T.byteLength),this.data_.set(new Uint8Array(T))),N=this.data_.length):T instanceof Uint8Array&&(S?this.data_=T:(this.data_=new Uint8Array(T.length),this.data_.set(T)),N=T.length),this.size_=N,this.type_=R}size(){return this.size_}type(){return this.type_}slice(T,S){if(!Iz(this.data_))return new ka(new Uint8Array(this.data_.buffer,T,S-T),!0);{let N=I3(this.data_,T,S);return null===N?null:new ka(N)}}static getBlob(...T){if(Iq()){let S=T.map(T=>T instanceof ka?T.data_:T);return new ka(I2.apply(null,S))}{let S=T.map(T=>IU(T)?I9(I6.RAW,T).data:T.data_),N=0;S.forEach(T=>{N+=T.byteLength});let R=new Uint8Array(N),O=0;return S.forEach(T=>{for(let S=0;S<T.length;S++)R[O++]=T[S]}),new ka(R,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ko(T){let S;try{S=JSON.parse(T)}catch(T){return null}return IV(S)?S:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(T){if(0===T.length)return null;let S=T.lastIndexOf("/");return -1===S?"":T.slice(0,S)}function ku(T,S){let N=S.split("/").filter(T=>T.length>0).join("/");return 0===T.length?N:T+"/"+N}function kc(T){let S=T.lastIndexOf("/",T.length-2);return -1===S?T:T.slice(S+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(T,S){return S}class kh{constructor(T,S,N,R){this.server=T,this.local=S||T,this.writable=!!N,this.xform=R||kd}}let kp=null;function kf(T){return!IU(T)||T.length<2?T:kc(T)}function km(){if(kp)return kp;let T=[];function S(T,S){return kf(S)}T.push(new kh("bucket")),T.push(new kh("generation")),T.push(new kh("metageneration")),T.push(new kh("name","fullPath",!0));let N=new kh("name");function R(T,S){return void 0!==S?Number(S):S}N.xform=S,T.push(N);let O=new kh("size");return O.xform=R,T.push(O),T.push(new kh("timeCreated")),T.push(new kh("updated")),T.push(new kh("md5Hash",null,!0)),T.push(new kh("cacheControl",null,!0)),T.push(new kh("contentDisposition",null,!0)),T.push(new kh("contentEncoding",null,!0)),T.push(new kh("contentLanguage",null,!0)),T.push(new kh("contentType",null,!0)),T.push(new kh("metadata","customMetadata",!0)),kp=T}function kg(T,S){function N(){let N=new IP(T.bucket,T.fullPath);return S._makeStorageReference(N)}Object.defineProperty(T,"ref",{get:N})}function ky(T,S,N){let R={};R.type="file";let O=N.length;for(let T=0;T<O;T++){let O=N[T];R[O.local]=O.xform(R,S[O.server])}return kg(R,T),R}function kv(T,S,N){let R=ko(S);return null===R?null:ky(T,R,N)}function kb(T,S,N,R){let O=ko(S);if(null===O||!IU(O.downloadTokens))return null;let P=O.downloadTokens;if(0===P.length)return null;let M=encodeURIComponent;return P.split(",").map(S=>{let O=T.bucket,P=T.fullPath;return IH("/b/"+M(O)+"/o/"+M(P),N,R)+IG({alt:"media",token:S})})[0]}function kw(T,S){let N={},R=S.length;for(let O=0;O<R;O++){let R=S[O];R.writable&&(N[R.server]=T[R.local])}return JSON.stringify(N)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kT="prefixes",kS="items";function kx(T,S,N){let R={prefixes:[],items:[],nextPageToken:N.nextPageToken};if(N[kT])for(let O of N[kT]){let N=O.replace(/\/$/,""),P=T._makeStorageReference(new IP(S,N));R.prefixes.push(P)}if(N[kS])for(let O of N[kS]){let N=T._makeStorageReference(new IP(S,O.name));R.items.push(N)}return R}function kE(T,S,N){let R=ko(N);return null===R?null:kx(T,S,R)}class kC{constructor(T,S,N,R){this.url=T,this.method=S,this.handler=N,this.timeout=R,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(T){if(!T)throw Im()}function kI(T,S){return function(N,R){let O=kv(T,R,S);return k_(null!==O),O}}function kk(T,S){return function(N,R){let O=kE(T,S,R);return k_(null!==O),O}}function kN(T,S){return function(N,R){let O=kv(T,R,S);return k_(null!==O),kb(O,R,T.host,T._protocol)}}function kA(T){return function(S,N){let R;return(R=401===S.getStatus()?S.getErrorText().includes("Firebase App Check token is invalid")?Ib():Iv():402===S.getStatus()?Iy(T.bucket):403===S.getStatus()?Iw(T.path):N).status=S.getStatus(),R.serverResponse=N.serverResponse,R}}function kR(T){let S=kA(T);return function(N,R){let O=S(N,R);return 404===N.getStatus()&&(O=Ig(T.path)),O.serverResponse=R.serverResponse,O}}function kD(T,S,N){let R=IH(S.fullServerUrl(),T.host,T._protocol),O="GET",P=T.maxOperationRetryTime,M=new kC(R,O,kI(T,N),P);return M.errorHandler=kR(S),M}function kO(T,S,N,R,O){let P={};S.isRoot?P.prefix="":P.prefix=S.path+"/",N&&N.length>0&&(P.delimiter=N),R&&(P.pageToken=R),O&&(P.maxResults=O);let M=IH(S.bucketOnlyServerUrl(),T.host,T._protocol),L="GET",V=T.maxOperationRetryTime,U=new kC(M,L,kk(T,S.bucket),V);return U.urlParams=P,U.errorHandler=kA(S),U}function kP(T,S,N){let R=IH(S.fullServerUrl(),T.host,T._protocol),O="GET",P=T.maxOperationRetryTime,M=new kC(R,O,kN(T,N),P);return M.errorHandler=kR(S),M}function kM(T,S){let N=new kC(IH(S.fullServerUrl(),T.host,T._protocol),"DELETE",function(T,S){},T.maxOperationRetryTime);return N.successCodes=[200,204],N.errorHandler=kR(S),N}function kL(T,S){return T&&T.contentType||S&&S.type()||"application/octet-stream"}function kj(T,S,N){let R=Object.assign({},N);return R.fullPath=T.path,R.size=S.size(),R.contentType||(R.contentType=kL(null,S)),R}function kF(T,S,N,R,O){let P=S.bucketOnlyServerUrl(),M={"X-Goog-Upload-Protocol":"multipart"},L=function(){let T="";for(let S=0;S<2;S++)T+=Math.random().toString().slice(2);return T}();M["Content-Type"]="multipart/related; boundary="+L;let V=kj(S,R,O),U="--"+L+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+kw(V,N)+"\r\n--"+L+"\r\nContent-Type: "+V.contentType+"\r\n\r\n",$="\r\n--"+L+"--",W=ka.getBlob(U,R,$);if(null===W)throw I_();let K={name:V.fullPath},Q=IH(P,T.host,T._protocol),Y="POST",Z=T.maxUploadRetryTime,ee=new kC(Q,Y,kI(T,N),Z);return ee.urlParams=K,ee.headers=M,ee.body=W.uploadData(),ee.errorHandler=kA(S),ee}class kB{constructor(T,S,N,R){this.current=T,this.total=S,this.finalized=!!N,this.metadata=R||null}}function kV(T,S){let N=null;try{N=T.getResponseHeader("X-Goog-Upload-Status")}catch(T){k_(!1)}let R=S||["active"];return k_(!!N&&-1!==R.indexOf(N)),N}function kU(T,S,N,R,O){let P=S.bucketOnlyServerUrl(),M=kj(S,R,O),L={name:M.fullPath},V=IH(P,T.host,T._protocol),U="POST",$={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${R.size()}`,"X-Goog-Upload-Header-Content-Type":M.contentType,"Content-Type":"application/json; charset=utf-8"},W=kw(M,N),K=new kC(V,U,function(T){let S;kV(T);try{S=T.getResponseHeader("X-Goog-Upload-URL")}catch(T){k_(!1)}return k_(IU(S)),S},T.maxUploadRetryTime);return K.urlParams=L,K.headers=$,K.body=W,K.errorHandler=kA(S),K}function kz(T,S,N,R){let O={"X-Goog-Upload-Command":"query"},P=new kC(N,"POST",function(T){let S=kV(T,["active","final"]),N=null;try{N=T.getResponseHeader("X-Goog-Upload-Size-Received")}catch(T){k_(!1)}N||k_(!1);let O=Number(N);return k_(!isNaN(O)),new kB(O,R.size(),"final"===S)},T.maxUploadRetryTime);return P.headers=O,P.errorHandler=kA(S),P}let kq=null;function k$(T,S,N,R,O,P,M,L){let V=new kB(0,0);if(M?(V.current=M.current,V.total=M.total):(V.current=0,V.total=R.size()),R.size()!==V.total)throw II();let U=V.total-V.current,$=U;O>0&&($=Math.min($,O));let W=V.current,K=W+$,Q="",Y={"X-Goog-Upload-Command":Q=0===$?"finalize":U===$?"upload, finalize":"upload","X-Goog-Upload-Offset":`${V.current}`},Z=R.slice(W,K);if(null===Z)throw I_();let ee=new kC(N,"POST",function(T,N){let O;let M=kV(T,["active","final"]),L=V.current+$,U=R.size();return O="final"===M?kI(S,P)(T,N):null,new kB(L,U,"final"===M,O)},S.maxUploadRetryTime);return ee.headers=Y,ee.body=Z.uploadData(),ee.progressCallback=L||null,ee.errorHandler=kA(T),ee}let kH={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function kG(T){switch(T){case"running":case"pausing":case"canceling":return kH.RUNNING;case"paused":return kH.PAUSED;case"success":return kH.SUCCESS;case"canceled":return kH.CANCELED;default:return kH.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kW{constructor(T,S,N){if(IB(T)||null!=S||null!=N)this.next=T,this.error=null!=S?S:void 0,this.complete=null!=N?N:void 0;else{let S=T;this.next=S.next,this.error=S.error,this.complete=S.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kK(T){return(...S)=>{Promise.resolve().then(()=>T(...S))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kQ=null;class kY{constructor(){this.errorText_="",this.sent_=!1,this.fetch_=Io.fetch,this.errorCode_=er.NO_ERROR}async send(T,S,N,R){if(this.sent_)throw IO("cannot .send() more than once");this.sent_=!0;try{let O=await this.fetch_(T,{method:S,headers:R||{},body:N});this.headers_=O.headers,this.statusCode_=O.status,this.errorCode_=er.NO_ERROR,this.body_=await O.arrayBuffer()}catch(T){this.errorText_=null==T?void 0:T.message,this.statusCode_=0,this.errorCode_=er.NETWORK_ERROR}}getErrorCode(){if(void 0===this.errorCode_)throw IO("cannot .getErrorCode() before receiving response");return this.errorCode_}getStatus(){if(void 0===this.statusCode_)throw IO("cannot .getStatus() before receiving response");return this.statusCode_}getErrorText(){return this.errorText_}abort(){}getResponseHeader(T){if(!this.headers_)throw IO("cannot .getResponseHeader() before receiving response");return this.headers_.get(T)}addUploadProgressListener(T){}removeUploadProgressListener(T){}}class kJ extends kY{getResponse(){if(!this.body_)throw IO("cannot .getResponse() before receiving response");return Buffer.from(this.body_).toString("utf-8")}}function kX(){return kQ?kQ():new kJ}class kZ extends null{getResponse(){if(!this.body_)throw IO("cannot .getResponse() before sending");return this.body_}}class k0 extends null{constructor(){super(...arguments),this.stream_=null}async send(T,S,N,R){if(this.sent_)throw IO("cannot .send() more than once");this.sent_=!0;try{let O=await this.fetch_(T,{method:S,headers:R||{},body:N});this.headers_=O.headers,this.statusCode_=O.status,this.errorCode_=er.NO_ERROR,this.stream_=O.body}catch(T){this.errorText_=null==T?void 0:T.message,this.statusCode_=0,this.errorCode_=er.NETWORK_ERROR}}getResponse(){if(!this.stream_)throw IO("cannot .getResponse() before sending");return this.stream_}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(T,S){this._service=T,S instanceof IP?this._location=S:this._location=IP.makeFromUrl(S,T.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(T,S){return new k3(T,S)}get root(){let T=new IP(this._location.bucket,"");return this._newRef(this._service,T)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kc(this._location.path)}get storage(){return this._service}get parent(){let T=kl(this._location.path);if(null===T)return null;let S=new IP(this._location.bucket,T);return new k3(this._service,S)}_throwIfRoot(T){if(""===this._location.path)throw IR(T)}}function k4(T,S,N){T._throwIfRoot("uploadBytes");let R=kF(T.storage,T._location,km(),new ka(S,!0),N);return T.storage.makeRequestWithTokens(R,kX).then(S=>({metadata:S,ref:T}))}function k6(T,S){null!=S&&"number"==typeof S.maxResults&&I$("options.maxResults",1,1e3,S.maxResults);let N=S||{},R=kO(T.storage,T._location,"/",N.pageToken,N.maxResults);return T.storage.makeRequestWithTokens(R,kX)}function k5(T){T._throwIfRoot("getDownloadURL");let S=kP(T.storage,T._location,km());return T.storage.makeRequestWithTokens(S,kX).then(T=>{if(null===T)throw Ik();return T})}function k9(T){T._throwIfRoot("deleteObject");let S=kM(T.storage,T._location);return T.storage.makeRequestWithTokens(S,kX)}function k8(T,S){let N=ku(T._location.path,S),R=new IP(T._location.bucket,N);return new k3(T.storage,R)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k7(T){return/^[A-Za-z]+:\/\//.test(T)}function Ne(T,S){return new k3(T,S)}function Nt(T,S){if(T instanceof Nn){let N=T;if(null==N._bucket)throw IC();let R=new k3(N,N._bucket);return null!=S?Nt(R,S):R}return void 0!==S?k8(T,S):T}function Nr(T,S){if(!(S&&k7(S)))return Nt(T,S);if(T instanceof Nn)return Ne(T,S);throw IN("To use ref(service, url), the first argument must be a Storage instance.")}function Ni(T,S){let N=null==S?void 0:S[Iu];return null==N?null:IP.makeFromBucketSpec(N,T)}class Nn{constructor(T,S,N,R,O){this.app=T,this._authProvider=S,this._appCheckProvider=N,this._url=R,this._firebaseVersion=O,this._bucket=null,this._host=Il,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Ic,this._maxUploadRetryTime=Id,this._requests=new Set,null!=R?this._bucket=IP.makeFromBucketSpec(R,this._host):this._bucket=Ni(this._host,this.app.options)}get host(){return this._host}set host(T){this._host=T,null!=this._url?this._bucket=IP.makeFromBucketSpec(this._url,T):this._bucket=Ni(T,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(T){I$("time",0,Number.POSITIVE_INFINITY,T),this._maxUploadRetryTime=T}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(T){I$("time",0,Number.POSITIVE_INFINITY,T),this._maxOperationRetryTime=T}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let T=this._authProvider.getImmediate({optional:!0});if(T){let S=await T.getToken();if(null!==S)return S.accessToken}return null}async _getAppCheckToken(){let T=this._appCheckProvider.getImmediate({optional:!0});return T?(await T.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(T=>T.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(T){return new k3(this,T)}_makeRequest(T,S,N,R,O=!0){if(this._deleted)return new IM(IA());{let P=I0(T,this._appId,N,R,S,this._firebaseVersion,O);return this._requests.add(P),P.getPromise().then(()=>this._requests.delete(P),()=>this._requests.delete(P)),P}}async makeRequestWithTokens(T,S){let[N,R]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(T,S,N,R).getPromise()}}let Ns="@firebase/storage",Na="0.13.2",No="storage";function Nl(T,S,N){return k4(T=ug(T),S,N)}function Nu(T){return k5(T=ug(T))}function Nc(T){return k9(T=ug(T))}function Nd(T,S){return Nr(T=ug(T),S)}function Nh(T,{instanceIdentifier:S}){return new Nn(T.getProvider("app").getImmediate(),T.getProvider("auth-internal"),T.getProvider("app-check-internal"),S,ci)}(function(){u8(new uy(No,Nh,"PUBLIC").setMultipleInstances(!0)),cs(Ns,Na)})(),/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cs("firebase","10.14.1","app");function Np(T,S){var N={};for(var R in T)Object.prototype.hasOwnProperty.call(T,R)&&0>S.indexOf(R)&&(N[R]=T[R]);if(null!=T&&"function"==typeof Object.getOwnPropertySymbols)for(var O=0,R=Object.getOwnPropertySymbols(T);O<R.length;O++)0>S.indexOf(R[O])&&Object.prototype.propertyIsEnumerable.call(T,R[O])&&(N[R[O]]=T[R[O]]);return N}Object.create;function Nf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}Object.create,"function"==typeof SuppressedError&&SuppressedError;let Nm=Nf,Ng=new l8("auth","Firebase",Nf()),Ny=new uk("@firebase/auth");function Nv(T,...S){Ny.logLevel<=K.WARN&&Ny.warn(`Auth (${ci}): ${T}`,...S)}function Nb(T,...S){Ny.logLevel<=K.ERROR&&Ny.error(`Auth (${ci}): ${T}`,...S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(T,...S){throw NE(T,...S)}function NT(T,...S){return NE(T,...S)}function NS(T,S,N){return new l8("auth","Firebase",Object.assign(Object.assign({},Nm()),{[S]:N})).create(S,{appName:T.name})}function Nx(T){return NS(T,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function NE(T,...S){if("string"!=typeof T){let N=S[0],R=[...S.slice(1)];return R[0]&&(R[0].appName=T.name),T._errorFactory.create(N,...R)}return Ng.create(T,...S)}function NC(T,S,...N){if(!T)throw NE(S,...N)}function N_(T){let S="INTERNAL ASSERTION FAILED: "+T;throw Nb(S),Error(S)}function NI(T,S){T||N_(S)}function Nk(){return"http:"===NN()||"https:"===NN()}function NN(){var T;return"undefined"!=typeof self&&(null===(T=self.location)||void 0===T?void 0:T.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Nk()||l0()||"connection"in navigator))||navigator.onLine}function NR(){if("undefined"==typeof navigator)return null;let T=navigator;return T.languages&&T.languages[0]||T.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(T,S){this.shortDelay=T,this.longDelay=S,NI(S>T,"Short delay should be less than long delay!"),this.isMobile=lJ()||l1()}get(){return NA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(T,S){NI(T.emulator,"Emulator should always be set here");let{url:N}=T.emulator;return S?`${N}${S.startsWith("/")?S.slice(1):S}`:N}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{static initialize(T,S,N){this.fetchImpl=T,S&&(this.headersImpl=S),N&&(this.responseImpl=N)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void N_("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void N_("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void N_("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},NL=new ND(3e4,6e4);function Nj(T,S){return T.tenantId&&!S.tenantId?Object.assign(Object.assign({},S),{tenantId:T.tenantId}):S}async function NF(T,S,N,R,O={}){return NB(T,O,async()=>{let O={},P={};R&&("GET"===S?P=R:O={body:JSON.stringify(R)});let M=ui(Object.assign({key:T.config.apiKey},P)).slice(1),L=await T._getAdditionalHeaders();L["Content-Type"]="application/json",T.languageCode&&(L["X-Firebase-Locale"]=T.languageCode);let V=Object.assign({method:S,headers:L},O);return lZ()||(V.referrerPolicy="no-referrer"),NP.fetch()(NU(T,T.config.apiHost,N,M),V)})}async function NB(T,S,N){T._canInitEmulator=!1;let R=Object.assign(Object.assign({},NM),S);try{let S=new Nq(T),O=await Promise.race([N(),S.promise]);S.clearNetworkTimeout();let P=await O.json();if("needConfirmation"in P)throw N$(T,"account-exists-with-different-credential",P);if(O.ok&&!("errorMessage"in P))return P;{let[S,N]=(O.ok?P.errorMessage:P.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===S)throw N$(T,"credential-already-in-use",P);if("EMAIL_EXISTS"===S)throw N$(T,"email-already-in-use",P);if("USER_DISABLED"===S)throw N$(T,"user-disabled",P);let M=R[S]||S.toLowerCase().replace(/[_\s]+/g,"-");if(N)throw NS(T,M,N);Nw(T,M)}}catch(S){if(S instanceof l9)throw S;Nw(T,"network-request-failed",{message:String(S)})}}async function NV(T,S,N,R,O={}){let P=await NF(T,S,N,R,O);return"mfaPendingCredential"in P&&Nw(T,"multi-factor-auth-required",{_serverResponse:P}),P}function NU(T,S,N,R){let O=`${S}${N}?${R}`;return T.config.emulator?NO(T.config,O):`${T.config.apiScheme}://${O}`}function Nz(T){switch(T){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Nq{constructor(T){this.auth=T,this.timer=null,this.promise=new Promise((T,S)=>{this.timer=setTimeout(()=>S(NT(this.auth,"network-request-failed")),NL.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function N$(T,S,N){let R={appName:T.name};N.email&&(R.email=N.email),N.phoneNumber&&(R.phoneNumber=N.phoneNumber);let O=NT(T,S,R);return O.customData._tokenResponse=N,O}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NH(T){return void 0!==T&&void 0!==T.enterprise}class NG{constructor(T){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===T.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=T.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=T.recaptchaEnforcementState}getProviderEnforcementState(T){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let S of this.recaptchaEnforcementState)if(S.provider&&S.provider===T)return Nz(S.enforcementState);return null}isProviderEnabled(T){return"ENFORCE"===this.getProviderEnforcementState(T)||"AUDIT"===this.getProviderEnforcementState(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NW(T,S){return NF(T,"GET","/v2/recaptchaConfig",Nj(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NK(T,S){return NF(T,"POST","/v1/accounts:delete",S)}async function NQ(T,S){return NF(T,"POST","/v1/accounts:lookup",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NY(T){if(T)try{let S=new Date(Number(T));if(!isNaN(S.getTime()))return S.toUTCString()}catch(T){}}async function NJ(T,S=!1){let N=ug(T),R=await N.getIdToken(S),O=NZ(R);NC(O&&O.exp&&O.auth_time&&O.iat,N.auth,"internal-error");let P="object"==typeof O.firebase?O.firebase:void 0,M=null==P?void 0:P.sign_in_provider;return{claims:O,token:R,authTime:NY(NX(O.auth_time)),issuedAtTime:NY(NX(O.iat)),expirationTime:NY(NX(O.exp)),signInProvider:M||null,signInSecondFactor:(null==P?void 0:P.sign_in_second_factor)||null}}function NX(T){return 1e3*Number(T)}function NZ(T){let[S,N,R]=T.split(".");if(void 0===S||void 0===N||void 0===R)return Nb("JWT malformed, contained fewer than 3 sections"),null;try{let T=lz(N);if(!T)return Nb("Failed to decode base64 JWT payload"),null;return JSON.parse(T)}catch(T){return Nb("Caught error parsing JWT payload as JSON",null==T?void 0:T.toString()),null}}function N0(T){let S=NZ(T);return NC(S,"internal-error"),NC(void 0!==S.exp,"internal-error"),NC(void 0!==S.iat,"internal-error"),Number(S.exp)-Number(S.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N1(T,S,N=!1){if(N)return S;try{return await S}catch(S){throw S instanceof l9&&N2(S)&&T.auth.currentUser===T&&await T.auth.signOut(),S}}function N2({code:T}){return"auth/user-disabled"===T||"auth/user-token-expired"===T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(T){this.user=T,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(T){var S;if(!T)return this.errorBackoff=3e4,Math.max(0,(null!==(S=this.user.stsTokenManager.expirationTime)&&void 0!==S?S:0)-Date.now()-3e5);{let T=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),T}}schedule(T=!1){if(!this.isRunning)return;let S=this.getInterval(T);this.timerId=setTimeout(async()=>{await this.iteration()},S)}async iteration(){try{await this.user.getIdToken(!0)}catch(T){(null==T?void 0:T.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(T,S){this.createdAt=T,this.lastLoginAt=S,this._initializeTime()}_initializeTime(){this.lastSignInTime=NY(this.lastLoginAt),this.creationTime=NY(this.createdAt)}_copy(T){this.createdAt=T.createdAt,this.lastLoginAt=T.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N6(T){var S;let N=T.auth,R=await T.getIdToken(),O=await N1(T,NQ(N,{idToken:R}));NC(null==O?void 0:O.users.length,N,"internal-error");let P=O.users[0];T._notifyReloadListener(P);let M=(null===(S=P.providerUserInfo)||void 0===S?void 0:S.length)?N8(P.providerUserInfo):[],L=N9(T.providerData,M),V=T.isAnonymous,U=!(T.email&&P.passwordHash)&&!(null==L?void 0:L.length),$=!!V&&U;Object.assign(T,{uid:P.localId,displayName:P.displayName||null,photoURL:P.photoUrl||null,email:P.email||null,emailVerified:P.emailVerified||!1,phoneNumber:P.phoneNumber||null,tenantId:P.tenantId||null,providerData:L,metadata:new N4(P.createdAt,P.lastLoginAt),isAnonymous:$})}async function N5(T){let S=ug(T);await N6(S),await S.auth._persistUserIfCurrent(S),S.auth._notifyListenersIfCurrent(S)}function N9(T,S){return[...T.filter(T=>!S.some(S=>S.providerId===T.providerId)),...S]}function N8(T){return T.map(T=>{var{providerId:S}=T,N=Np(T,["providerId"]);return{providerId:S,uid:N.rawId||"",displayName:N.displayName||null,email:N.email||null,phoneNumber:N.phoneNumber||null,photoURL:N.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N7(T,S){let N=await NB(T,{},async()=>{let N=ui({grant_type:"refresh_token",refresh_token:S}).slice(1),{tokenApiHost:R,apiKey:O}=T.config,P=NU(T,R,"/v1/token",`key=${O}`),M=await T._getAdditionalHeaders();return M["Content-Type"]="application/x-www-form-urlencoded",NP.fetch()(P,{method:"POST",headers:M,body:N})});return{accessToken:N.access_token,expiresIn:N.expires_in,refreshToken:N.refresh_token}}async function Ae(T,S){return NF(T,"POST","/v2/accounts:revokeToken",Nj(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(T){NC(T.idToken,"internal-error"),NC(void 0!==T.idToken,"internal-error"),NC(void 0!==T.refreshToken,"internal-error");let S="expiresIn"in T&&void 0!==T.expiresIn?Number(T.expiresIn):N0(T.idToken);this.updateTokensAndExpiration(T.idToken,T.refreshToken,S)}updateFromIdToken(T){NC(0!==T.length,"internal-error");let S=N0(T);this.updateTokensAndExpiration(T,null,S)}async getToken(T,S=!1){return S||!this.accessToken||this.isExpired?(NC(this.refreshToken,T,"user-token-expired"),this.refreshToken)?(await this.refresh(T,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(T,S){let{accessToken:N,refreshToken:R,expiresIn:O}=await N7(T,S);this.updateTokensAndExpiration(N,R,Number(O))}updateTokensAndExpiration(T,S,N){this.refreshToken=S||null,this.accessToken=T||null,this.expirationTime=Date.now()+1e3*N}static fromJSON(T,S){let{refreshToken:N,accessToken:R,expirationTime:O}=S,P=new At;return N&&(NC("string"==typeof N,"internal-error",{appName:T}),P.refreshToken=N),R&&(NC("string"==typeof R,"internal-error",{appName:T}),P.accessToken=R),O&&(NC("number"==typeof O,"internal-error",{appName:T}),P.expirationTime=O),P}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(T){this.accessToken=T.accessToken,this.refreshToken=T.refreshToken,this.expirationTime=T.expirationTime}_clone(){return Object.assign(new At,this.toJSON())}_performRefresh(){return N_("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(T,S){NC("string"==typeof T||void 0===T,"internal-error",{appName:S})}class Ai{constructor(T){var{uid:S,auth:N,stsTokenManager:R}=T,O=Np(T,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new N3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=S,this.auth=N,this.stsTokenManager=R,this.accessToken=R.accessToken,this.displayName=O.displayName||null,this.email=O.email||null,this.emailVerified=O.emailVerified||!1,this.phoneNumber=O.phoneNumber||null,this.photoURL=O.photoURL||null,this.isAnonymous=O.isAnonymous||!1,this.tenantId=O.tenantId||null,this.providerData=O.providerData?[...O.providerData]:[],this.metadata=new N4(O.createdAt||void 0,O.lastLoginAt||void 0)}async getIdToken(T){let S=await N1(this,this.stsTokenManager.getToken(this.auth,T));return NC(S,this.auth,"internal-error"),this.accessToken!==S&&(this.accessToken=S,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),S}getIdTokenResult(T){return NJ(this,T)}reload(){return N5(this)}_assign(T){this!==T&&(NC(this.uid===T.uid,this.auth,"internal-error"),this.displayName=T.displayName,this.photoURL=T.photoURL,this.email=T.email,this.emailVerified=T.emailVerified,this.phoneNumber=T.phoneNumber,this.isAnonymous=T.isAnonymous,this.tenantId=T.tenantId,this.providerData=T.providerData.map(T=>Object.assign({},T)),this.metadata._copy(T.metadata),this.stsTokenManager._assign(T.stsTokenManager))}_clone(T){let S=new Ai(Object.assign(Object.assign({},this),{auth:T,stsTokenManager:this.stsTokenManager._clone()}));return S.metadata._copy(this.metadata),S}_onReload(T){NC(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=T,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(T){this.reloadListener?this.reloadListener(T):this.reloadUserInfo=T}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(T,S=!1){let N=!1;T.idToken&&T.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(T),N=!0),S&&await N6(this),await this.auth._persistUserIfCurrent(this),N&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ce(this.auth.app))return Promise.reject(Nx(this.auth));let T=await this.getIdToken();return await N1(this,NK(this.auth,{idToken:T})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(T=>Object.assign({},T)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(T,S){var N,R,O,P,M,L,V,U;let $=null!==(N=S.displayName)&&void 0!==N?N:void 0,W=null!==(R=S.email)&&void 0!==R?R:void 0,K=null!==(O=S.phoneNumber)&&void 0!==O?O:void 0,Q=null!==(P=S.photoURL)&&void 0!==P?P:void 0,Y=null!==(M=S.tenantId)&&void 0!==M?M:void 0,Z=null!==(L=S._redirectEventId)&&void 0!==L?L:void 0,ee=null!==(V=S.createdAt)&&void 0!==V?V:void 0,et=null!==(U=S.lastLoginAt)&&void 0!==U?U:void 0,{uid:er,emailVerified:ei,isAnonymous:en,providerData:es,stsTokenManager:ea}=S;NC(er&&ea,T,"internal-error");let eo=At.fromJSON(this.name,ea);NC("string"==typeof er,T,"internal-error"),Ar($,T.name),Ar(W,T.name),NC("boolean"==typeof ei,T,"internal-error"),NC("boolean"==typeof en,T,"internal-error"),Ar(K,T.name),Ar(Q,T.name),Ar(Y,T.name),Ar(Z,T.name),Ar(ee,T.name),Ar(et,T.name);let eu=new Ai({uid:er,auth:T,email:W,emailVerified:ei,displayName:$,isAnonymous:en,photoURL:Q,phoneNumber:K,tenantId:Y,stsTokenManager:eo,createdAt:ee,lastLoginAt:et});return es&&Array.isArray(es)&&(eu.providerData=es.map(T=>Object.assign({},T))),Z&&(eu._redirectEventId=Z),eu}static async _fromIdTokenResponse(T,S,N=!1){let R=new At;R.updateFromServerResponse(S);let O=new Ai({uid:S.localId,auth:T,stsTokenManager:R,isAnonymous:N});return await N6(O),O}static async _fromGetAccountInfoResponse(T,S,N){let R=S.users[0];NC(void 0!==R.localId,"internal-error");let O=void 0!==R.providerUserInfo?N8(R.providerUserInfo):[],P=!(R.email&&R.passwordHash)&&!(null==O?void 0:O.length),M=new At;M.updateFromIdToken(N);let L=new Ai({uid:R.localId,auth:T,stsTokenManager:M,isAnonymous:P});return Object.assign(L,{uid:R.localId,displayName:R.displayName||null,photoURL:R.photoUrl||null,email:R.email||null,emailVerified:R.emailVerified||!1,phoneNumber:R.phoneNumber||null,tenantId:R.tenantId||null,providerData:O,metadata:new N4(R.createdAt,R.lastLoginAt),isAnonymous:!(R.email&&R.passwordHash)&&!(null==O?void 0:O.length)}),L}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let An=new Map;function As(T){NI(T instanceof Function,"Expected a class definition");let S=An.get(T);return S?NI(S instanceof T,"Instance stored in cache mismatched with class"):(S=new T,An.set(T,S)),S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(T,S){this.storage[T]=S}async _get(T){let S=this.storage[T];return void 0===S?null:S}async _remove(T){delete this.storage[T]}_addListener(T,S){}_removeListener(T,S){}}Aa.type="NONE";let Ao=Aa;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(T,S,N){return`firebase:${T}:${S}:${N}`}class Au{constructor(T,S,N){this.persistence=T,this.auth=S,this.userKey=N;let{config:R,name:O}=this.auth;this.fullUserKey=Al(this.userKey,R.apiKey,O),this.fullPersistenceKey=Al("persistence",R.apiKey,O),this.boundEventHandler=S._onStorageEvent.bind(S),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(T){return this.persistence._set(this.fullUserKey,T.toJSON())}async getCurrentUser(){let T=await this.persistence._get(this.fullUserKey);return T?Ai._fromJSON(this.auth,T):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(T){if(this.persistence===T)return;let S=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=T,S)return this.setCurrentUser(S)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(T,S,N="authUser"){if(!S.length)return new Au(As(Ao),T,N);let R=(await Promise.all(S.map(async T=>{if(await T._isAvailable())return T}))).filter(T=>T),O=R[0]||As(Ao),P=Al(N,T.config.apiKey,T.name),M=null;for(let N of S)try{let S=await N._get(P);if(S){let R=Ai._fromJSON(T,S);N!==O&&(M=R),O=N;break}}catch(T){}let L=R.filter(T=>T._shouldAllowMigration);return O._shouldAllowMigration&&L.length&&(O=L[0],M&&await O._set(P,M.toJSON()),await Promise.all(S.map(async T=>{if(T!==O)try{await T._remove(P)}catch(T){}}))),new Au(O,T,N)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(T){let S=T.toLowerCase();if(S.includes("opera/")||S.includes("opr/")||S.includes("opios/"))return"Opera";if(Af(S))return"IEMobile";if(S.includes("msie")||S.includes("trident/"))return"IE";{if(S.includes("edge/"))return"Edge";if(Ad(S))return"Firefox";if(S.includes("silk/"))return"Silk";if(Ag(S))return"Blackberry";if(Ay(S))return"Webos";if(Ah(S))return"Safari";if((S.includes("chrome/")||Ap(S))&&!S.includes("edge/"))return"Chrome";if(Am(S))return"Android";let N=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,R=T.match(N);if((null==R?void 0:R.length)===2)return R[1]}return"Other"}function Ad(T=lY()){return/firefox\//i.test(T)}function Ah(T=lY()){let S=T.toLowerCase();return S.includes("safari/")&&!S.includes("chrome/")&&!S.includes("crios/")&&!S.includes("android")}function Ap(T=lY()){return/crios\//i.test(T)}function Af(T=lY()){return/iemobile/i.test(T)}function Am(T=lY()){return/android/i.test(T)}function Ag(T=lY()){return/blackberry/i.test(T)}function Ay(T=lY()){return/webos/i.test(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(T,S=[]){let N;switch(T){case"Browser":N=Ac(lY());break;case"Worker":N=`${Ac(lY())}-${T}`;break;default:N=T}let R=S.length?S.join(","):"FirebaseCore-web";return`${N}/JsCore/${ci}/${R}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(T){this.auth=T,this.queue=[]}pushCallback(T,S){let N=S=>new Promise((N,R)=>{try{let R=T(S);N(R)}catch(T){R(T)}});N.onAbort=S,this.queue.push(N);let R=this.queue.length-1;return()=>{this.queue[R]=()=>Promise.resolve()}}async runMiddleware(T){if(this.auth.currentUser===T)return;let S=[];try{for(let N of this.queue)await N(T),N.onAbort&&S.push(N.onAbort)}catch(T){for(let T of(S.reverse(),S))try{T()}catch(T){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==T?void 0:T.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aw(T,S={}){return NF(T,"GET","/v2/passwordPolicy",Nj(T,S))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AT=6;class AS{constructor(T){var S,N,R,O;let P=T.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(S=P.minPasswordLength)&&void 0!==S?S:AT,P.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=P.maxPasswordLength),void 0!==P.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=P.containsLowercaseCharacter),void 0!==P.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=P.containsUppercaseCharacter),void 0!==P.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=P.containsNumericCharacter),void 0!==P.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=P.containsNonAlphanumericCharacter),this.enforcementState=T.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(R=null===(N=T.allowedNonAlphanumericCharacters)||void 0===N?void 0:N.join(""))&&void 0!==R?R:"",this.forceUpgradeOnSignin=null!==(O=T.forceUpgradeOnSignin)&&void 0!==O&&O,this.schemaVersion=T.schemaVersion}validatePassword(T){var S,N,R,O,P,M;let L={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(T,L),this.validatePasswordCharacterOptions(T,L),L.isValid&&(L.isValid=null===(S=L.meetsMinPasswordLength)||void 0===S||S),L.isValid&&(L.isValid=null===(N=L.meetsMaxPasswordLength)||void 0===N||N),L.isValid&&(L.isValid=null===(R=L.containsLowercaseLetter)||void 0===R||R),L.isValid&&(L.isValid=null===(O=L.containsUppercaseLetter)||void 0===O||O),L.isValid&&(L.isValid=null===(P=L.containsNumericCharacter)||void 0===P||P),L.isValid&&(L.isValid=null===(M=L.containsNonAlphanumericCharacter)||void 0===M||M),L}validatePasswordLengthOptions(T,S){let N=this.customStrengthOptions.minPasswordLength,R=this.customStrengthOptions.maxPasswordLength;N&&(S.meetsMinPasswordLength=T.length>=N),R&&(S.meetsMaxPasswordLength=T.length<=R)}validatePasswordCharacterOptions(T,S){let N;this.updatePasswordCharacterOptionsStatuses(S,!1,!1,!1,!1);for(let R=0;R<T.length;R++)N=T.charAt(R),this.updatePasswordCharacterOptionsStatuses(S,N>="a"&&N<="z",N>="A"&&N<="Z",N>="0"&&N<="9",this.allowedNonAlphanumericCharacters.includes(N))}updatePasswordCharacterOptionsStatuses(T,S,N,R,O){this.customStrengthOptions.containsLowercaseLetter&&(T.containsLowercaseLetter||(T.containsLowercaseLetter=S)),this.customStrengthOptions.containsUppercaseLetter&&(T.containsUppercaseLetter||(T.containsUppercaseLetter=N)),this.customStrengthOptions.containsNumericCharacter&&(T.containsNumericCharacter||(T.containsNumericCharacter=R)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(T.containsNonAlphanumericCharacter||(T.containsNonAlphanumericCharacter=O))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(T,S,N,R){this.app=T,this.heartbeatServiceProvider=S,this.appCheckServiceProvider=N,this.config=R,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new AC(this),this.idTokenSubscription=new AC(this),this.beforeStateQueue=new Ab(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ng,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=T.name,this.clientVersion=R.sdkClientVersion}_initializeWithPersistence(T,S){return S&&(this._popupRedirectResolver=As(S)),this._initializationPromise=this.queue(async()=>{var N,R;if(!this._deleted&&(this.persistenceManager=await Au.create(this,T),!this._deleted)){if(null===(N=this._popupRedirectResolver)||void 0===N?void 0:N._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(T){}await this.initializeCurrentUser(S),this.lastNotifiedUid=(null===(R=this.currentUser)||void 0===R?void 0:R.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let T=await this.assertedPersistence.getCurrentUser();if(this.currentUser||T){if(this.currentUser&&T&&this.currentUser.uid===T.uid){this._currentUser._assign(T),await this.currentUser.getIdToken();return}await this._updateCurrentUser(T,!0)}}async initializeCurrentUserFromIdToken(T){try{let S=await NQ(this,{idToken:T}),N=await Ai._fromGetAccountInfoResponse(this,S,T);await this.directlySetCurrentUser(N)}catch(T){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",T),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(T){var S;if(ce(this.app)){let T=this.app.settings.authIdToken;return T?new Promise(S=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(T).then(S,S))}):this.directlySetCurrentUser(null)}let N=await this.assertedPersistence.getCurrentUser(),R=N,O=!1;if(T&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let N=null===(S=this.redirectUser)||void 0===S?void 0:S._redirectEventId,P=null==R?void 0:R._redirectEventId,M=await this.tryRedirectSignIn(T);(!N||N===P)&&(null==M?void 0:M.user)&&(R=M.user,O=!0)}if(!R)return this.directlySetCurrentUser(null);if(!R._redirectEventId){if(O)try{await this.beforeStateQueue.runMiddleware(R)}catch(T){R=N,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(T))}return R?this.reloadAndSetCurrentUserOrClear(R):this.directlySetCurrentUser(null)}return(NC(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===R._redirectEventId)?this.directlySetCurrentUser(R):this.reloadAndSetCurrentUserOrClear(R)}async tryRedirectSignIn(T){let S=null;try{S=await this._popupRedirectResolver._completeRedirectFn(this,T,!0)}catch(T){await this._setRedirectUser(null)}return S}async reloadAndSetCurrentUserOrClear(T){try{await N6(T)}catch(T){if((null==T?void 0:T.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(T)}useDeviceLanguage(){this.languageCode=NR()}async _delete(){this._deleted=!0}async updateCurrentUser(T){if(ce(this.app))return Promise.reject(Nx(this));let S=T?ug(T):null;return S&&NC(S.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(S&&S._clone(this))}async _updateCurrentUser(T,S=!1){if(!this._deleted)return T&&NC(this.tenantId===T.tenantId,this,"tenant-id-mismatch"),S||await this.beforeStateQueue.runMiddleware(T),this.queue(async()=>{await this.directlySetCurrentUser(T),this.notifyAuthListeners()})}async signOut(){return ce(this.app)?Promise.reject(Nx(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(T){return ce(this.app)?Promise.reject(Nx(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(As(T))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(T){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let S=this._getPasswordPolicyInternal();return S.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):S.validatePassword(T)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let T=new AS(await Aw(this));null===this.tenantId?this._projectPasswordPolicy=T:this._tenantPasswordPolicies[this.tenantId]=T}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(T){this._errorFactory=new l8("auth","Firebase",T())}onAuthStateChanged(T,S,N){return this.registerStateListener(this.authStateSubscription,T,S,N)}beforeAuthStateChanged(T,S){return this.beforeStateQueue.pushCallback(T,S)}onIdTokenChanged(T,S,N){return this.registerStateListener(this.idTokenSubscription,T,S,N)}authStateReady(){return new Promise((T,S)=>{if(this.currentUser)T();else{let N=this.onAuthStateChanged(()=>{N(),T()},S)}})}async revokeAccessToken(T){if(this.currentUser){let S={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:T,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(S.tenantId=this.tenantId),await Ae(this,S)}}toJSON(){var T;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(T=this._currentUser)||void 0===T?void 0:T.toJSON()}}async _setRedirectUser(T,S){let N=await this.getOrInitRedirectPersistenceManager(S);return null===T?N.removeCurrentUser():N.setCurrentUser(T)}async getOrInitRedirectPersistenceManager(T){if(!this.redirectPersistenceManager){let S=T&&As(T)||this._popupRedirectResolver;NC(S,this,"argument-error"),this.redirectPersistenceManager=await Au.create(this,[As(S._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(T){var S,N;return(this._isInitialized&&await this.queue(async()=>{}),(null===(S=this._currentUser)||void 0===S?void 0:S._redirectEventId)===T)?this._currentUser:(null===(N=this.redirectUser)||void 0===N?void 0:N._redirectEventId)===T?this.redirectUser:null}async _persistUserIfCurrent(T){if(T===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(T))}_notifyListenersIfCurrent(T){T===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var T,S;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let N=null!==(S=null===(T=this.currentUser)||void 0===T?void 0:T.uid)&&void 0!==S?S:null;this.lastNotifiedUid!==N&&(this.lastNotifiedUid=N,this.authStateSubscription.next(this.currentUser))}registerStateListener(T,S,N,R){if(this._deleted)return()=>{};let O="function"==typeof S?S:S.next.bind(S),P=!1,M=this._isInitialized?Promise.resolve():this._initializationPromise;if(NC(M,this,"internal-error"),M.then(()=>{P||O(this.currentUser)}),"function"==typeof S){let O=T.addObserver(S,N,R);return()=>{P=!0,O()}}{let N=T.addObserver(S);return()=>{P=!0,N()}}}async directlySetCurrentUser(T){this.currentUser&&this.currentUser!==T&&this._currentUser._stopProactiveRefresh(),T&&this.isProactiveRefreshEnabled&&T._startProactiveRefresh(),this.currentUser=T,T?await this.assertedPersistence.setCurrentUser(T):await this.assertedPersistence.removeCurrentUser()}queue(T){return this.operations=this.operations.then(T,T),this.operations}get assertedPersistence(){return NC(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(T){!T||this.frameworks.includes(T)||(this.frameworks.push(T),this.frameworks.sort(),this.clientVersion=Av(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var T;let S={"X-Client-Version":this.clientVersion};this.app.options.appId&&(S["X-Firebase-gmpid"]=this.app.options.appId);let N=await (null===(T=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===T?void 0:T.getHeartbeatsHeader());N&&(S["X-Firebase-Client"]=N);let R=await this._getAppCheckToken();return R&&(S["X-Firebase-AppCheck"]=R),S}async _getAppCheckToken(){var T;let S=await (null===(T=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===T?void 0:T.getToken());return(null==S?void 0:S.error)&&Nv(`Error while retrieving App Check token: ${S.error}`),null==S?void 0:S.token}}function AE(T){return ug(T)}class AC{constructor(T){this.auth=T,this.observer=null,this.addObserver=uo(T=>this.observer=T)}get next(){return NC(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let A_="recaptcha-enterprise",AI="NO_RECAPTCHA";class Ak{constructor(T){this.type=A_,this.auth=AE(T)}async verify(T="verify",S=!1){async function N(T){if(!S){if(null==T.tenantId&&null!=T._agentRecaptchaConfig)return T._agentRecaptchaConfig.siteKey;if(null!=T.tenantId&&void 0!==T._tenantRecaptchaConfigs[T.tenantId])return T._tenantRecaptchaConfigs[T.tenantId].siteKey}return new Promise(async(S,N)=>{NW(T,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(R=>{if(void 0===R.recaptchaKey)N(Error("recaptcha Enterprise site key undefined"));else{let N=new NG(R);return null==T.tenantId?T._agentRecaptchaConfig=N:T._tenantRecaptchaConfigs[T.tenantId]=N,S(N.siteKey)}}).catch(T=>{N(T)})})}function R(S,N,R){let O=window.grecaptcha;NH(O)?O.enterprise.ready(()=>{O.enterprise.execute(S,{action:T}).then(T=>{N(T)}).catch(()=>{N(AI)})}):R(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((T,O)=>{N(this.auth).then(N=>{if(!S&&NH(window.grecaptcha))R(N,T,O);else{O(Error("RecaptchaVerifier is only supported in browser"));return}}).catch(T=>{O(T)})})}}async function AN(T,S,N,R=!1){let O;let P=new Ak(T);try{O=await P.verify(N)}catch(T){O=await P.verify(N,!0)}let M=Object.assign({},S);return R?Object.assign(M,{captchaResp:O}):Object.assign(M,{captchaResponse:O}),Object.assign(M,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(M,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),M}async function AA(T,S,N,R){var O;if(null===(O=T._getRecaptchaConfig())||void 0===O||!O.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return R(T,S).catch(async O=>{if("auth/missing-recaptcha-token"!==O.code)return Promise.reject(O);{console.log(`${N} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let O=await AN(T,S,N,"getOobCode"===N);return R(T,O)}});{let O=await AN(T,S,N,"getOobCode"===N);return R(T,O)}}function AR(T,S){let N=(null==S?void 0:S.persistence)||[],R=(Array.isArray(N)?N:[N]).map(As);(null==S?void 0:S.errorMap)&&T._updateErrorMap(S.errorMap),T._initializeWithPersistence(R,null==S?void 0:S.popupRedirectResolver)}function AD(T){let S=T.indexOf(":");return S<0?"":T.substr(0,S+1)}function AO(T){if(!T)return null;let S=Number(T);return isNaN(S)?null:S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(T,S){this.providerId=T,this.signInMethod=S}toJSON(){return N_("not implemented")}_getIdTokenResponse(T){return N_("not implemented")}_linkToIdToken(T,S){return N_("not implemented")}_getReauthenticationResolver(T){return N_("not implemented")}}async function AM(T,S){return NF(T,"POST","/v1/accounts:signUp",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AL(T,S){return NV(T,"POST","/v1/accounts:signInWithPassword",Nj(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aj(T,S){return NV(T,"POST","/v1/accounts:signInWithEmailLink",Nj(T,S))}async function AF(T,S){return NV(T,"POST","/v1/accounts:signInWithEmailLink",Nj(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB extends AP{constructor(T,S,N,R=null){super("password",N),this._email=T,this._password=S,this._tenantId=R}static _fromEmailAndPassword(T,S){return new AB(T,S,"password")}static _fromEmailAndCode(T,S,N=null){return new AB(T,S,"emailLink",N)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T;if((null==S?void 0:S.email)&&(null==S?void 0:S.password)){if("password"===S.signInMethod)return this._fromEmailAndPassword(S.email,S.password);if("emailLink"===S.signInMethod)return this._fromEmailAndCode(S.email,S.password,S.tenantId)}return null}async _getIdTokenResponse(T){switch(this.signInMethod){case"password":return AA(T,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",AL);case"emailLink":return Aj(T,{email:this._email,oobCode:this._password});default:Nw(T,"internal-error")}}async _linkToIdToken(T,S){switch(this.signInMethod){case"password":return AA(T,{idToken:S,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",AM);case"emailLink":return AF(T,{idToken:S,email:this._email,oobCode:this._password});default:Nw(T,"internal-error")}}_getReauthenticationResolver(T){return this._getIdTokenResponse(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AV(T,S){return NV(T,"POST","/v1/accounts:signInWithIdp",Nj(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AU="http://localhost";class Az extends AP{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(T){let S=new Az(T.providerId,T.signInMethod);return T.idToken||T.accessToken?(T.idToken&&(S.idToken=T.idToken),T.accessToken&&(S.accessToken=T.accessToken),T.nonce&&!T.pendingToken&&(S.nonce=T.nonce),T.pendingToken&&(S.pendingToken=T.pendingToken)):T.oauthToken&&T.oauthTokenSecret?(S.accessToken=T.oauthToken,S.secret=T.oauthTokenSecret):Nw("argument-error"),S}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T,{providerId:N,signInMethod:R}=S,O=Np(S,["providerId","signInMethod"]);if(!N||!R)return null;let P=new Az(N,R);return P.idToken=O.idToken||void 0,P.accessToken=O.accessToken||void 0,P.secret=O.secret,P.nonce=O.nonce,P.pendingToken=O.pendingToken||null,P}_getIdTokenResponse(T){return AV(T,this.buildRequest())}_linkToIdToken(T,S){let N=this.buildRequest();return N.idToken=S,AV(T,N)}_getReauthenticationResolver(T){let S=this.buildRequest();return S.autoCreate=!1,AV(T,S)}buildRequest(){let T={requestUri:AU,returnSecureToken:!0};if(this.pendingToken)T.pendingToken=this.pendingToken;else{let S={};this.idToken&&(S.id_token=this.idToken),this.accessToken&&(S.access_token=this.accessToken),this.secret&&(S.oauth_token_secret=this.secret),S.providerId=this.providerId,this.nonce&&!this.pendingToken&&(S.nonce=this.nonce),T.postBody=ui(S)}return T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aq(T,S){return NV(T,"POST","/v1/accounts:signInWithPhoneNumber",Nj(T,S))}async function A$(T,S){let N=await NV(T,"POST","/v1/accounts:signInWithPhoneNumber",Nj(T,S));if(N.temporaryProof)throw N$(T,"account-exists-with-different-credential",N);return N}let AH={USER_NOT_FOUND:"user-not-found"};async function AG(T,S){return NV(T,"POST","/v1/accounts:signInWithPhoneNumber",Nj(T,Object.assign(Object.assign({},S),{operation:"REAUTH"})),AH)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AW extends null{constructor(T){super("phone","phone"),this.params=T}static _fromVerification(T,S){return new AW({verificationId:T,verificationCode:S})}static _fromTokenResponse(T,S){return new AW({phoneNumber:T,temporaryProof:S})}_getIdTokenResponse(T){return Aq(T,this._makeVerificationRequest())}_linkToIdToken(T,S){return A$(T,Object.assign({idToken:S},this._makeVerificationRequest()))}_getReauthenticationResolver(T){return AG(T,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:T,phoneNumber:S,verificationId:N,verificationCode:R}=this.params;return T&&S?{temporaryProof:T,phoneNumber:S}:{sessionInfo:N,code:R}}toJSON(){let T={providerId:this.providerId};return this.params.phoneNumber&&(T.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(T.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(T.verificationCode=this.params.verificationCode),this.params.verificationId&&(T.verificationId=this.params.verificationId),T}static fromJSON(T){"string"==typeof T&&(T=JSON.parse(T));let{verificationId:S,verificationCode:N,phoneNumber:R,temporaryProof:O}=T;return N||S||R||O?new AW({verificationId:S,verificationCode:N,phoneNumber:R,temporaryProof:O}):null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AK(T){switch(T){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function AQ(T){let S=un(us(T)).link,N=S?un(us(S)).deep_link_id:null,R=un(us(T)).deep_link_id;return(R?un(us(R)).link:null)||R||N||S||T}class AY{constructor(T){var S,N,R,O,P,M;let L=un(us(T)),V=null!==(S=L.apiKey)&&void 0!==S?S:null,U=null!==(N=L.oobCode)&&void 0!==N?N:null,$=AK(null!==(R=L.mode)&&void 0!==R?R:null);NC(V&&U&&$,"argument-error"),this.apiKey=V,this.operation=$,this.code=U,this.continueUrl=null!==(O=L.continueUrl)&&void 0!==O?O:null,this.languageCode=null!==(P=L.languageCode)&&void 0!==P?P:null,this.tenantId=null!==(M=L.tenantId)&&void 0!==M?M:null}static parseLink(T){let S=AQ(T);try{return new AY(S)}catch(T){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AJ{constructor(){this.providerId=AJ.PROVIDER_ID}static credential(T,S){return AB._fromEmailAndPassword(T,S)}static credentialWithLink(T,S){let N=AY.parseLink(S);return NC(N,"argument-error"),AB._fromEmailAndCode(T,N.code,N.tenantId)}}AJ.PROVIDER_ID="password",AJ.EMAIL_PASSWORD_SIGN_IN_METHOD="password",AJ.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AX{constructor(T){this.providerId=T,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(T){this.defaultLanguageCode=T}setCustomParameters(T){return this.customParameters=T,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AZ extends AX{constructor(){super(...arguments),this.scopes=[]}addScope(T){return this.scopes.includes(T)||this.scopes.push(T),this}getScopes(){return[...this.scopes]}}class A0 extends null{static credentialFromJSON(T){let S="string"==typeof T?JSON.parse(T):T;return NC("providerId"in S&&"signInMethod"in S,"argument-error"),Az._fromParams(S)}credential(T){return this._credential(Object.assign(Object.assign({},T),{nonce:T.rawNonce}))}_credential(T){return NC(T.idToken||T.accessToken,"argument-error"),Az._fromParams(Object.assign(Object.assign({},T),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(T){return A0.oauthCredentialFromTaggedObject(T)}static credentialFromError(T){return A0.oauthCredentialFromTaggedObject(T.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthIdToken:S,oauthAccessToken:N,oauthTokenSecret:R,pendingToken:O,nonce:P,providerId:M}=T;if(!N&&!R&&!S&&!O||!M)return null;try{return new A0(M)._credential({idToken:S,accessToken:N,nonce:P,pendingToken:O})}catch(T){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1 extends AZ{constructor(){super("facebook.com")}static credential(T){return Az._fromParams({providerId:A1.PROVIDER_ID,signInMethod:A1.FACEBOOK_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return A1.credentialFromTaggedObject(T)}static credentialFromError(T){return A1.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return A1.credential(T.oauthAccessToken)}catch(T){return null}}}A1.FACEBOOK_SIGN_IN_METHOD="facebook.com",A1.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2 extends AZ{constructor(){super("google.com"),this.addScope("profile")}static credential(T,S){return Az._fromParams({providerId:A2.PROVIDER_ID,signInMethod:A2.GOOGLE_SIGN_IN_METHOD,idToken:T,accessToken:S})}static credentialFromResult(T){return A2.credentialFromTaggedObject(T)}static credentialFromError(T){return A2.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthIdToken:S,oauthAccessToken:N}=T;if(!S&&!N)return null;try{return A2.credential(S,N)}catch(T){return null}}}A2.GOOGLE_SIGN_IN_METHOD="google.com",A2.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3 extends AZ{constructor(){super("github.com")}static credential(T){return Az._fromParams({providerId:A3.PROVIDER_ID,signInMethod:A3.GITHUB_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return A3.credentialFromTaggedObject(T)}static credentialFromError(T){return A3.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return A3.credential(T.oauthAccessToken)}catch(T){return null}}}A3.GITHUB_SIGN_IN_METHOD="github.com",A3.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A4="http://localhost";class A6 extends null{constructor(T,S){super(T,T),this.pendingToken=S}_getIdTokenResponse(T){return AV(T,this.buildRequest())}_linkToIdToken(T,S){let N=this.buildRequest();return N.idToken=S,AV(T,N)}_getReauthenticationResolver(T){let S=this.buildRequest();return S.autoCreate=!1,AV(T,S)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(T){let{providerId:S,signInMethod:N,pendingToken:R}="string"==typeof T?JSON.parse(T):T;return S&&N&&R&&S===N?new A6(S,R):null}static _create(T,S){return new A6(T,S)}buildRequest(){return{requestUri:A4,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A5="saml.";class A9 extends null{constructor(T){NC(T.startsWith(A5),"argument-error"),super(T)}static credentialFromResult(T){return A9.samlCredentialFromTaggedObject(T)}static credentialFromError(T){return A9.samlCredentialFromTaggedObject(T.customData||{})}static credentialFromJSON(T){let S=A6.fromJSON(T);return NC(S,"argument-error"),S}static samlCredentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{pendingToken:S,providerId:N}=T;if(!S||!N)return null;try{return A6._create(N,S)}catch(T){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A8 extends AZ{constructor(){super("twitter.com")}static credential(T,S){return Az._fromParams({providerId:A8.PROVIDER_ID,signInMethod:A8.TWITTER_SIGN_IN_METHOD,oauthToken:T,oauthTokenSecret:S})}static credentialFromResult(T){return A8.credentialFromTaggedObject(T)}static credentialFromError(T){return A8.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthAccessToken:S,oauthTokenSecret:N}=T;if(!S||!N)return null;try{return A8.credential(S,N)}catch(T){return null}}}A8.TWITTER_SIGN_IN_METHOD="twitter.com",A8.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(T){this.user=T.user,this.providerId=T.providerId,this._tokenResponse=T._tokenResponse,this.operationType=T.operationType}static async _fromIdTokenResponse(T,S,N,R=!1){return new A7({user:await Ai._fromIdTokenResponse(T,N,R),providerId:Re(N),_tokenResponse:N,operationType:S})}static async _forOperation(T,S,N){return await T._updateTokensIfNecessary(N,!0),new A7({user:T,providerId:Re(N),_tokenResponse:N,operationType:S})}}function Re(T){return T.providerId?T.providerId:"phoneNumber"in T?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt extends null{constructor(T,S,N,R){var O;super(S.code,S.message),this.operationType=N,this.user=R,Object.setPrototypeOf(this,Rt.prototype),this.customData={appName:T.name,tenantId:null!==(O=T.tenantId)&&void 0!==O?O:void 0,_serverResponse:S.customData._serverResponse,operationType:N}}static _fromErrorAndOperation(T,S,N,R){return new Rt(T,S,N,R)}}function Rr(T,S,N,R){return("reauthenticate"===S?N._getReauthenticationResolver(T):N._getIdTokenResponse(T)).catch(N=>{if("auth/multi-factor-auth-required"===N.code)throw Rt._fromErrorAndOperation(T,N,S,R);throw N})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(T,S){this.factorId=T,this.uid=S.mfaEnrollmentId,this.enrollmentTime=new Date(S.enrolledAt).toUTCString(),this.displayName=S.displayName}static _fromServerResponse(T,S){return"phoneInfo"in S?Rn._fromServerResponse(T,S):"totpInfo"in S?Rs._fromServerResponse(T,S):Nw(T,"internal-error")}}class Rn extends null{constructor(T){super("phone",T),this.phoneNumber=T.phoneInfo}static _fromServerResponse(T,S){return new Rn(S)}}class Rs extends null{constructor(T){super("totp",T)}static _fromServerResponse(T,S){return new Rs(S)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(T,S,N){this.type=T,this.credential=S,this.user=N}static _fromIdtoken(T,S){return new Ra("enroll",T,S)}static _fromMfaPendingCredential(T){return new Ra("signin",T)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(T){var S,N;if(null==T?void 0:T.multiFactorSession){if(null===(S=T.multiFactorSession)||void 0===S?void 0:S.pendingCredential)return Ra._fromMfaPendingCredential(T.multiFactorSession.pendingCredential);if(null===(N=T.multiFactorSession)||void 0===N?void 0:N.idToken)return Ra._fromIdtoken(T.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(T,S,N){this.session=T,this.hints=S,this.signInResolver=N}static _fromError(T,S){let N=AE(T),R=S.customData._serverResponse,O=(R.mfaInfo||[]).map(T=>Ri._fromServerResponse(N,T));NC(R.mfaPendingCredential,N,"internal-error");let P=Ra._fromMfaPendingCredential(R.mfaPendingCredential);return new Ro(P,O,async T=>{let O=await T._process(N,P);delete R.mfaInfo,delete R.mfaPendingCredential;let M=Object.assign(Object.assign({},R),{idToken:O.idToken,refreshToken:O.refreshToken});switch(S.operationType){case"signIn":let L=await A7._fromIdTokenResponse(N,S.operationType,M);return await N._updateCurrentUser(L.user),L;case"reauthenticate":return NC(S.user,N,"internal-error"),A7._forOperation(S.user,S.operationType,M);default:Nw(N,"internal-error")}})}async resolveSignIn(T){let S=T;return this.signInResolver(S)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(T,S){return NF(T,"POST","/v2/accounts/mfaEnrollment:start",Nj(T,S))}function Ru(T,S){return NF(T,"POST","/v2/accounts/mfaEnrollment:finalize",Nj(T,S))}function Rc(T,S){return NF(T,"POST","/v2/accounts/mfaEnrollment:withdraw",Nj(T,S))}class Rd{constructor(T){this.user=T,this.enrolledFactors=[],T._onReload(S=>{S.mfaInfo&&(this.enrolledFactors=S.mfaInfo.map(S=>Ri._fromServerResponse(T.auth,S)))})}static _fromUser(T){return new Rd(T)}async getSession(){return Ra._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(T,S){let N=T,R=await this.getSession(),O=await N1(this.user,N._process(this.user.auth,R,S));return await this.user._updateTokensIfNecessary(O),this.user.reload()}async unenroll(T){let S="string"==typeof T?T:T.uid,N=await this.user.getIdToken();try{let T=await N1(this.user,Rc(this.user.auth,{idToken:N,mfaEnrollmentId:S}));this.enrolledFactors=this.enrolledFactors.filter(({uid:T})=>T!==S),await this.user._updateTokensIfNecessary(T),await this.user.reload()}catch(T){throw T}}}new WeakMap;var Rh="@firebase/auth",Rp="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(T){this.auth=T,this.internalListeners=new Map}getUid(){var T;return this.assertAuthConfigured(),(null===(T=this.auth.currentUser)||void 0===T?void 0:T.uid)||null}async getToken(T){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(T)}:null}addAuthTokenListener(T){if(this.assertAuthConfigured(),this.internalListeners.has(T))return;let S=this.auth.onIdTokenChanged(S=>{T((null==S?void 0:S.stsTokenManager.accessToken)||null)});this.internalListeners.set(T,S),this.updateProactiveRefresh()}removeAuthTokenListener(T){this.assertAuthConfigured();let S=this.internalListeners.get(T);S&&(this.internalListeners.delete(T),S(),this.updateProactiveRefresh())}assertAuthConfigured(){NC(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(T){switch(T){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Rg(T){u8(new uy("auth",(S,{options:N})=>{let R=S.getProvider("app").getImmediate(),O=S.getProvider("heartbeat"),P=S.getProvider("app-check-internal"),{apiKey:M,authDomain:L}=R.options;NC(M&&!M.includes(":"),"invalid-api-key",{appName:R.name});let V=new Ax(R,O,P,{apiKey:M,authDomain:L,clientPlatform:T,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Av(T)});return AR(V,N),V},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((T,S,N)=>{T.getProvider("auth-internal").initialize()})),u8(new uy("auth-internal",T=>new Rf(AE(T.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),cs(Rh,Rp,Rm(T)),cs(Rh,Rp,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(T,S){return NF(T,"POST","/v2/accounts/mfaSignIn:finalize",Nj(T,S))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */NP.initialize(Io.fetch,Io.Headers,Io.Response),Rg("Node"),NT("operation-not-supported-in-this-environment"),Ax.prototype.setPersistence=async()=>{};class Rv{constructor(T){this.factorId=T}_process(T,S,N){switch(S.type){case"enroll":return this._finalizeEnroll(T,S.credential,N);case"signin":return this._finalizeSignIn(T,S.credential);default:return N_("unexpected MultiFactorSessionType")}}}class Rb{static assertionForEnrollment(T,S){return Rw._fromSecret(T,S)}static assertionForSignIn(T,S){return Rw._fromEnrollmentId(T,S)}static async generateSecret(T){var S;let N=T;NC(void 0!==(null===(S=N.user)||void 0===S?void 0:S.auth),"internal-error");let R=await Rl(N.user.auth,{idToken:N.credential,totpEnrollmentInfo:{}});return RT._fromStartTotpMfaEnrollmentResponse(R,N.user.auth)}}Rb.FACTOR_ID="totp";class Rw extends Rv{constructor(T,S,N){super("totp"),this.otp=T,this.enrollmentId=S,this.secret=N}static _fromSecret(T,S){return new Rw(S,void 0,T)}static _fromEnrollmentId(T,S){return new Rw(S,T)}async _finalizeEnroll(T,S,N){return NC(void 0!==this.secret,T,"argument-error"),Ru(T,{idToken:S,displayName:N,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(T,S){NC(void 0!==this.enrollmentId&&void 0!==this.otp,T,"argument-error");let N={verificationCode:this.otp};return Ry(T,{mfaPendingCredential:S,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:N})}}class RT{constructor(T,S,N,R,O,P,M){this.sessionInfo=P,this.auth=M,this.secretKey=T,this.hashingAlgorithm=S,this.codeLength=N,this.codeIntervalSeconds=R,this.enrollmentCompletionDeadline=O}static _fromStartTotpMfaEnrollmentResponse(T,S){return new RT(T.totpSessionInfo.sharedSecretKey,T.totpSessionInfo.hashingAlgorithm,T.totpSessionInfo.verificationCodeLength,T.totpSessionInfo.periodSec,new Date(T.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),T.totpSessionInfo.sessionInfo,S)}_makeTotpVerificationInfo(T){return{sessionInfo:this.sessionInfo,verificationCode:T}}generateQrCodeUrl(T,S){var N;let R=!1;return(RS(T)||RS(S))&&(R=!0),R&&(RS(T)&&(T=(null===(N=this.auth.currentUser)||void 0===N?void 0:N.email)||"unknownuser"),RS(S)&&(S=this.auth.name)),`otpauth://totp/${S}:${T}?secret=${this.secretKey}&issuer=${S}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function RS(T){return void 0===T||(null==T?void 0:T.length)===0}let Rx="@firebase/installations",RE="0.6.9",RC=1e4,R_=`w:${RE}`,RI="FIS_v2",Rk="https://firebaseinstallations.googleapis.com/v1",RN=36e5,RA=new l8("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function RR(T){return T instanceof l9&&T.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD({projectId:T}){return`${Rk}/projects/${T}/installations`}function RO(T){return{token:T.token,requestStatus:2,expiresIn:RF(T.expiresIn),creationTime:Date.now()}}async function RP(T,S){let N=(await S.json()).error;return RA.create("request-failed",{requestName:T,serverCode:N.code,serverMessage:N.message,serverStatus:N.status})}function RM({apiKey:T}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":T})}function RL(T,{refreshToken:S}){let N=RM(T);return N.append("Authorization",RB(S)),N}async function Rj(T){let S=await T();return S.status>=500&&S.status<600?T():S}function RF(T){return Number(T.replace("s","000"))}function RB(T){return`${RI} ${T}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RV({appConfig:T,heartbeatServiceProvider:S},{fid:N}){let R=RD(T),O=RM(T),P=S.getImmediate({optional:!0});if(P){let T=await P.getHeartbeatsHeader();T&&O.append("x-firebase-client",T)}let M={method:"POST",headers:O,body:JSON.stringify({fid:N,authVersion:RI,appId:T.appId,sdkVersion:R_})},L=await Rj(()=>fetch(R,M));if(L.ok){let T=await L.json();return{fid:T.fid||N,registrationStatus:2,refreshToken:T.refreshToken,authToken:RO(T.authToken)}}throw await RP("Create Installation",L)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RU(T){return new Promise(S=>{setTimeout(S,T)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rz(T){return btoa(String.fromCharCode(...T)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rq=/^[cdef][\w-]{21}$/,R$="";function RH(){try{let T=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(T),T[0]=112+T[0]%16;let S=RG(T);return Rq.test(S)?S:R$}catch(T){return R$}}function RG(T){return Rz(T).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RW(T){return`${T.appName}!${T.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RK=new Map;function RQ(T,S){let N=RW(T);RY(N,S),RJ(N,S)}function RY(T,S){let N=RK.get(T);if(N)for(let T of N)T(S)}function RJ(T,S){let N=RZ();N&&N.postMessage({key:T,fid:S}),R0()}let RX=null;function RZ(){return!RX&&"BroadcastChannel"in self&&((RX=new BroadcastChannel("[Firebase] FID Change")).onmessage=T=>{RY(T.data.key,T.data.fid)}),RX}function R0(){0===RK.size&&RX&&(RX.close(),RX=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R1="firebase-installations-database",R2=1,R3="firebase-installations-store",R4=null;function R6(){return R4||(R4=uH(R1,R2,{upgrade:(T,S)=>{0===S&&T.createObjectStore(R3)}})),R4}async function R5(T,S){let N=RW(T),R=(await R6()).transaction(R3,"readwrite"),O=R.objectStore(R3),P=await O.get(N);return await O.put(S,N),await R.done,P&&P.fid===S.fid||RQ(T,S.fid),S}async function R9(T){let S=RW(T),N=(await R6()).transaction(R3,"readwrite");await N.objectStore(R3).delete(S),await N.done}async function R8(T,S){let N=RW(T),R=(await R6()).transaction(R3,"readwrite"),O=R.objectStore(R3),P=await O.get(N),M=S(P);return void 0===M?await O.delete(N):await O.put(M,N),await R.done,M&&(!P||P.fid!==M.fid)&&RQ(T,M.fid),M}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R7(T){let S;let N=await R8(T.appConfig,N=>{let R=Dt(T,De(N));return S=R.registrationPromise,R.installationEntry});return N.fid===R$?{installationEntry:await S}:{installationEntry:N,registrationPromise:S}}function De(T){return Ds(T||{fid:RH(),registrationStatus:0})}function Dt(T,S){if(0===S.registrationStatus){if(!navigator.onLine)return{installationEntry:S,registrationPromise:Promise.reject(RA.create("app-offline"))};let N={fid:S.fid,registrationStatus:1,registrationTime:Date.now()},R=Dr(T,N);return{installationEntry:N,registrationPromise:R}}return 1===S.registrationStatus?{installationEntry:S,registrationPromise:Di(T)}:{installationEntry:S}}async function Dr(T,S){try{let N=await RV(T,S);return R5(T.appConfig,N)}catch(N){throw RR(N)&&409===N.customData.serverCode?await R9(T.appConfig):await R5(T.appConfig,{fid:S.fid,registrationStatus:0}),N}}async function Di(T){let S=await Dn(T.appConfig);for(;1===S.registrationStatus;)await RU(100),S=await Dn(T.appConfig);if(0===S.registrationStatus){let{installationEntry:S,registrationPromise:N}=await R7(T);return N||S}return S}function Dn(T){return R8(T,T=>{if(!T)throw RA.create("installation-not-found");return Ds(T)})}function Ds(T){return Da(T)?{fid:T.fid,registrationStatus:0}:T}function Da(T){return 1===T.registrationStatus&&T.registrationTime+RC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Do({appConfig:T,heartbeatServiceProvider:S},N){let R=Dl(T,N),O=RL(T,N),P=S.getImmediate({optional:!0});if(P){let T=await P.getHeartbeatsHeader();T&&O.append("x-firebase-client",T)}let M={method:"POST",headers:O,body:JSON.stringify({installation:{sdkVersion:R_,appId:T.appId}})},L=await Rj(()=>fetch(R,M));if(L.ok)return RO(await L.json());throw await RP("Generate Auth Token",L)}function Dl(T,{fid:S}){return`${RD(T)}/${S}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Du(T,S=!1){let N;let R=await R8(T.appConfig,R=>{if(!Dp(R))throw RA.create("not-registered");let O=R.authToken;if(!S&&Df(O))return R;if(1===O.requestStatus)return N=Dc(T,S),R;{if(!navigator.onLine)throw RA.create("app-offline");let S=Dg(R);return N=Dh(T,S),S}});return N?await N:R.authToken}async function Dc(T,S){let N=await Dd(T.appConfig);for(;1===N.authToken.requestStatus;)await RU(100),N=await Dd(T.appConfig);let R=N.authToken;return 0===R.requestStatus?Du(T,S):R}function Dd(T){return R8(T,T=>{if(!Dp(T))throw RA.create("not-registered");return Dy(T.authToken)?Object.assign(Object.assign({},T),{authToken:{requestStatus:0}}):T})}async function Dh(T,S){try{let N=await Do(T,S),R=Object.assign(Object.assign({},S),{authToken:N});return await R5(T.appConfig,R),N}catch(N){if(RR(N)&&(401===N.customData.serverCode||404===N.customData.serverCode))await R9(T.appConfig);else{let N=Object.assign(Object.assign({},S),{authToken:{requestStatus:0}});await R5(T.appConfig,N)}throw N}}function Dp(T){return void 0!==T&&2===T.registrationStatus}function Df(T){return 2===T.requestStatus&&!Dm(T)}function Dm(T){let S=Date.now();return S<T.creationTime||T.creationTime+T.expiresIn<S+RN}function Dg(T){let S={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},T),{authToken:S})}function Dy(T){return 1===T.requestStatus&&T.requestTime+RC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dv(T){let S=T,{installationEntry:N,registrationPromise:R}=await R7(S);return R?R.catch(console.error):Du(S).catch(console.error),N.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Db(T,S=!1){let N=T;return await Dw(N),(await Du(N,S)).token}async function Dw(T){let{registrationPromise:S}=await R7(T);S&&await S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(T){if(!T||!T.options)throw DS("App Configuration");if(!T.name)throw DS("App Name");for(let S of["projectId","apiKey","appId"])if(!T.options[S])throw DS(S);return{appName:T.name,projectId:T.options.projectId,apiKey:T.options.apiKey,appId:T.options.appId}}function DS(T){return RA.create("missing-app-config-values",{valueName:T})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dx="installations",DE="installations-internal",DC=T=>{let S=T.getProvider("app").getImmediate(),N=DT(S),R=u7(S,"heartbeat");return{app:S,appConfig:N,heartbeatServiceProvider:R,_delete:()=>Promise.resolve()}},D_=T=>{let S=u7(T.getProvider("app").getImmediate(),Dx).getImmediate();return{getId:()=>Dv(S),getToken:T=>Db(S,T)}};(function(){u8(new uy(Dx,DC,"PUBLIC")),u8(new uy(DE,D_,"PRIVATE"))})(),cs(Rx,RE),cs(Rx,RE,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DI="analytics",Dk="firebase_id",DN="origin",DA=6e4,DR="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",DD="https://www.googletagmanager.com/gtag/js",DO=new uk("@firebase/analytics"),DP=new l8("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(T){if(!T.startsWith(DD)){let S=DP.create("invalid-gtag-resource",{gtagURL:T});return DO.warn(S.message),""}return T}function DL(T){return Promise.all(T.map(T=>T.catch(T=>T)))}function Dj(T,S){let N;return window.trustedTypes&&(N=window.trustedTypes.createPolicy(T,S)),N}function DF(T,S){let N=Dj("firebase-js-sdk-policy",{createScriptURL:DM}),R=document.createElement("script"),O=`${DD}?l=${T}&id=${S}`;R.src=N?null==N?void 0:N.createScriptURL(O):O,R.async=!0,document.head.appendChild(R)}function DB(T){let S=[];return Array.isArray(window[T])?S=window[T]:window[T]=S,S}async function DV(T,S,N,R,O,P){let M=R[O];try{if(M)await S[M];else{let T=(await DL(N)).find(T=>T.measurementId===O);T&&await S[T.appId]}}catch(T){DO.error(T)}T("config",O,P)}async function DU(T,S,N,R,O){try{let P=[];if(O&&O.send_to){let T=O.send_to;Array.isArray(T)||(T=[T]);let R=await DL(N);for(let N of T){let T=R.find(T=>T.measurementId===N),O=T&&S[T.appId];if(O)P.push(O);else{P=[];break}}}0===P.length&&(P=Object.values(S)),await Promise.all(P),T("event",R,O||{})}catch(T){DO.error(T)}}function Dz(T,S,N,R){return async function(O,...P){try{if("event"===O){let[R,O]=P;await DU(T,S,N,R,O)}else if("config"===O){let[O,M]=P;await DV(T,S,N,R,O,M)}else if("consent"===O){let[S,N]=P;T("consent",S,N)}else if("get"===O){let[S,N,R]=P;T("get",S,N,R)}else if("set"===O){let[S]=P;T("set",S)}else T(O,...P)}catch(T){DO.error(T)}}}function Dq(T,S,N,R,O){let P=function(...T){window[R].push(arguments)};return window[O]&&"function"==typeof window[O]&&(P=window[O]),window[O]=Dz(P,T,S,N),{gtagCore:P,wrappedGtag:window[O]}}function D$(T){for(let S of Object.values(window.document.getElementsByTagName("script")))if(S.src&&S.src.includes(DD)&&S.src.includes(T))return S;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DH=30,DG=1e3;class DW{constructor(T={},S=DG){this.throttleMetadata=T,this.intervalMillis=S}getThrottleMetadata(T){return this.throttleMetadata[T]}setThrottleMetadata(T,S){this.throttleMetadata[T]=S}deleteThrottleMetadata(T){delete this.throttleMetadata[T]}}let DK=new DW;function DQ(T){return new Headers({Accept:"application/json","x-goog-api-key":T})}async function DY(T){var S;let{appId:N,apiKey:R}=T,O={method:"GET",headers:DQ(R)},P=DR.replace("{app-id}",N),M=await fetch(P,O);if(200!==M.status&&304!==M.status){let T="";try{let N=await M.json();(null===(S=N.error)||void 0===S?void 0:S.message)&&(T=N.error.message)}catch(T){}throw DP.create("config-fetch-failed",{httpStatus:M.status,responseMessage:T})}return M.json()}async function DJ(T,S=DK,N){let{appId:R,apiKey:O,measurementId:P}=T.options;if(!R)throw DP.create("no-app-id");if(!O){if(P)return{measurementId:P,appId:R};throw DP.create("no-api-key")}let M=S.getThrottleMetadata(R)||{backoffCount:0,throttleEndTimeMillis:Date.now()},L=new D1;return setTimeout(async()=>{L.abort()},void 0!==N?N:DA),DX({appId:R,apiKey:O,measurementId:P},M,L,S)}async function DX(T,{throttleEndTimeMillis:S,backoffCount:N},R,O=DK){var P;let{appId:M,measurementId:L}=T;try{await DZ(R,S)}catch(T){if(L)return DO.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${L} provided in the "measurementId" field in the local Firebase config. [${null==T?void 0:T.message}]`),{appId:M,measurementId:L};throw T}try{let S=await DY(T);return O.deleteThrottleMetadata(M),S}catch($){let S=$;if(!D0(S)){if(O.deleteThrottleMetadata(M),L)return DO.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${L} provided in the "measurementId" field in the local Firebase config. [${null==S?void 0:S.message}]`),{appId:M,measurementId:L};throw $}let V=503===Number(null===(P=null==S?void 0:S.customData)||void 0===P?void 0:P.httpStatus)?um(N,O.intervalMillis,DH):um(N,O.intervalMillis),U={throttleEndTimeMillis:Date.now()+V,backoffCount:N+1};return O.setThrottleMetadata(M,U),DO.debug(`Calling attemptFetch again in ${V} millis`),DX(T,U,R,O)}}function DZ(T,S){return new Promise((N,R)=>{let O=setTimeout(N,Math.max(S-Date.now(),0));T.addEventListener(()=>{clearTimeout(O),R(DP.create("fetch-throttle",{throttleEndTimeMillis:S}))})})}function D0(T){if(!(T instanceof l9)||!T.customData)return!1;let S=Number(T.customData.httpStatus);return 429===S||500===S||503===S||504===S}class D1{constructor(){this.listeners=[]}addEventListener(T){this.listeners.push(T)}abort(){this.listeners.forEach(T=>T())}}async function D2(T,S,N,R,O){if(O&&O.global){T("event",N,R);return}{let O=await S;T("event",N,Object.assign(Object.assign({},R),{send_to:O}))}}function D3(T){M=T}function D4(T){P=T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D6(){if(!l3())return DO.warn(DP.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await l4()}catch(T){return DO.warn(DP.create("indexeddb-unavailable",{errorInfo:null==T?void 0:T.toString()}).message),!1}return!0}async function D5(T,S,N,R,O,L,V){var U;let $=DJ(T);$.then(S=>{N[S.measurementId]=S.appId,T.options.measurementId&&S.measurementId!==T.options.measurementId&&DO.warn(`The measurement ID in the local Firebase config (${T.options.measurementId}) does not match the measurement ID fetched from the server (${S.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(T=>DO.error(T)),S.push($);let W=D6().then(T=>T?R.getId():void 0),[K,Q]=await Promise.all([$,W]);D$(L)||DF(L,K.measurementId),M&&(O("consent","default",M),D3(void 0)),O("js",new Date);let Y=null!==(U=null==V?void 0:V.config)&&void 0!==U?U:{};return Y[DN]="firebase",Y.update=!0,null!=Q&&(Y[Dk]=Q),O("config",K.measurementId,Y),P&&(O("set",P),D4(void 0)),K.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(T){this.app=T}_delete(){return delete D8[this.app.options.appId],Promise.resolve()}}let D8={},D7=[],Oe={},Ot="dataLayer",Or="gtag",Oi=!1;function On(){let T=[];if(l0()&&T.push("This is a browser extension environment."),l6()||T.push("Cookies are not available."),T.length>0){let S=T.map((T,S)=>`(${S+1}) ${T}`).join(" "),N=DP.create("invalid-analytics-context",{errorInfo:S});DO.warn(N.message)}}function Os(T,S,N){On();let R=T.options.appId;if(!R)throw DP.create("no-app-id");if(!T.options.apiKey){if(T.options.measurementId)DO.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${T.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw DP.create("no-api-key")}if(null!=D8[R])throw DP.create("already-exists",{id:R});if(!Oi){DB(Ot);let{wrappedGtag:T,gtagCore:S}=Dq(D8,D7,Oe,Ot,Or);V=T,L=S,Oi=!0}return D8[R]=D5(T,D7,Oe,S,L,Ot,N),new D9(T)}function Oa(T,S,N,R){T=ug(T),D2(V,D8[T.app.options.appId],S,N,R).catch(T=>DO.error(T))}let Oo="@firebase/analytics",Ol="0.10.8";(function(){function T(T){try{let S=T.getProvider(DI).getImmediate();return{logEvent:(T,N,R)=>Oa(S,T,N,R)}}catch(T){throw DP.create("interop-component-reg-failed",{reason:T})}}u8(new uy(DI,(T,{options:S})=>Os(T.getProvider("app").getImmediate(),T.getProvider("installations-internal").getImmediate(),S),"PUBLIC")),u8(new uy("analytics-internal",T,"PRIVATE")),cs(Oo,Ol),cs(Oo,Ol,"esm2017")})(),cn({apiKey:"AIzaSyB4IqX2Hd_tdLv2_qes_TdKvWczlqMvqNQ",authDomain:"keshwala-mvp.firebaseapp.com",projectId:"keshwala-mvp",storageBucket:"keshwala-mvp.firebasestorage.app",messagingSenderId:"84416955059",appId:"1:84416955059:web:db71f5972624a46113e6c6",measurementId:"G-500BJCEZFF"});let Ou=null,Oc=null,Od=()=>{let[T,S]=(0,en.useState)(!1),N=async(T,N)=>{try{S(!0);let R=await Ir(CP(Ou,T),{...N,createdAt:dt.now(),updatedAt:dt.now()});return{success:!0,id:R.id}}catch(T){return{success:!1,error:T.message}}finally{S(!1)}},R=async(T,N)=>{try{S(!0);let R=CP(Ou,T),O=N?_R(R,...N):R,P=(await _7(O)).docs.map(T=>({id:T.id,...T.data()}));return{success:!0,data:P}}catch(T){return{success:!1,error:T.message}}finally{S(!1)}},O=async T=>await N("bookings",T),P=async T=>{let S=T?[_O("userId","==",T)]:[];return await R("bookings",S)},M=async T=>await N("contactMessages",T),L=async()=>await R("services",[_L("createdAt","desc")]),V=async()=>await R("wigs",[_L("createdAt","desc")]),U=async()=>await R("testimonials",[_L("rating","desc"),_B(10)]),$=async()=>await R("blogPosts",[_L("createdAt","desc")]),W=async(T,N)=>{try{if(S(!0),!Oc)throw Error("Storage not initialized");let R=Nd(Oc,N),O=await Nl(R,T),P=await Nu(O.ref);return{success:!0,url:P,path:O.ref.fullPath}}catch(T){return{success:!1,error:T.message}}finally{S(!1)}},K=async(T,S="images")=>{let N=Date.now(),R=`${S}/${N}_${T.name}`;return await W(T,R)};return{loading:T,addDocument:N,getDocuments:R,updateDocument:async(T,N,R)=>{try{S(!0);let O=CM(Ou,T,N);return await Ie(O,{...R,updatedAt:dt.now()}),{success:!0}}catch(T){return{success:!1,error:T.message}}finally{S(!1)}},deleteDocument:async(T,N)=>{try{return S(!0),await It(CM(Ou,T,N)),{success:!0}}catch(T){return{success:!1,error:T.message}}finally{S(!1)}},addBooking:O,getBookings:P,addContactMessage:M,getServices:L,getWigs:V,getTestimonials:U,getBlogPosts:$,uploadFile:W,deleteFile:async T=>{try{if(S(!0),!Oc)throw Error("Storage not initialized");let N=Nd(Oc,T);return await Nc(N),{success:!0}}catch(T){return{success:!1,error:T.message}}finally{S(!1)}},uploadImage:K}},Oh=()=>{let[T,S]=(0,en.useState)("all"),[N,R]=(0,en.useState)([]),[O,P]=(0,en.useState)(!0),{getServices:M}=Od(),[L,V]=lk({triggerOnce:!0,threshold:.1}),U=[{id:"all",name:"All Services"},{id:"haircare",name:"Haircare"},{id:"wigs",name:"Wigs"},{id:"event",name:"Event Styling"},{id:"subscription",name:"Subscriptions"}],$=[{id:1,title:"Hair Cut & Styling",description:"Professional haircuts and styling tailored to your face shape and lifestyle.",price:"₹800",category:"haircare",icon:lA,image:"/api/placeholder/300/200",features:["Expert Consultation","Modern Techniques","Home Service"]},{id:2,title:"Hair Coloring",description:"Beautiful hair coloring services with premium products and expert application.",price:"₹1,500",category:"haircare",icon:lR,image:"/api/placeholder/300/200",features:["Color Consultation","Premium Products","Aftercare Tips"]},{id:3,title:"Wig Fitting & Styling",description:"Professional wig fitting, cutting, and styling for the perfect look.",price:"₹1,200",category:"wigs",icon:lD,image:"/api/placeholder/300/200",features:["Custom Fitting","Professional Styling","Maintenance Tips"]},{id:4,title:"Bridal Hair & Makeup",description:"Complete bridal hair and makeup services for your special day.",price:"₹5,000",category:"event",icon:lO,image:"/api/placeholder/300/200",features:["Trial Session","Wedding Day Service","Touch-up Kit"]},{id:5,title:"Monthly Hair Care",description:"Regular hair care subscription with personalized treatments and maintenance.",price:"₹2,500/mo",category:"subscription",icon:lP,image:"/api/placeholder/300/200",features:["Monthly Visits","Personalized Care","Priority Booking"]},{id:6,title:"Wig Maintenance",description:"Regular wig cleaning, styling, and maintenance services.",price:"₹600",category:"wigs",icon:lg,image:"/api/placeholder/300/200",features:["Deep Cleaning","Restyling","Storage Tips"]}];(0,en.useEffect)(()=>{(async()=>{try{let T=await M();if(T.success&&T.data){let S=T.data.map(T=>({id:T.id,title:T.title||T.name||"Service",description:T.description||T.desc||"",price:T.price||"Contact for pricing",category:T.category||"haircare",icon:lA,image:T.image||"/api/placeholder/300/200",features:T.features||[]}));R(S)}else console.error("Failed to load services:",T.error),R($)}catch(T){console.error("Error loading services:",T),R($)}finally{P(!1)}})()},[M]);let W="all"===T?N:N.filter(S=>S.category===T);return O?ei.jsx("section",{id:"services",className:"py-20 bg-white",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)("div",{className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"Our Services"}),ei.jsx("p",{className:"text-lg text-gray max-w-2xl mx-auto",children:"Professional hair and wig services tailored to your needs"})]}),ei.jsx("div",{className:"flex justify-center",children:ei.jsx("div",{className:"w-8 h-8 border-4 border-maroon border-t-transparent rounded-full animate-spin"})})]})}):ei.jsx("section",{id:"services",className:"py-20 bg-white",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:L,initial:{opacity:0,y:50},animate:V?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"Our Services"}),ei.jsx("p",{className:"text-lg text-gray max-w-2xl mx-auto",children:"Professional hair and wig services tailored to your needs"})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.8,delay:.2},className:"flex flex-wrap justify-center gap-4 mb-12",children:U.map(N=>ei.jsx("button",{onClick:()=>S(N.id),className:`px-6 py-3 rounded-full font-medium transition-all duration-300 ${T===N.id?"bg-maroon text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:N.name},N.id))}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.8,delay:.4},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:W.map((T,S)=>{let N=T.icon;return(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.6,delay:.1*S},className:"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden group",children:[(0,ei.jsxs)("div",{className:"relative h-48 bg-gradient-to-br from-pink to-maroon",children:[ei.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20"}),ei.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:ei.jsx(N,{className:"w-16 h-16 text-white"})}),ei.jsx("div",{className:"absolute top-4 right-4 bg-white bg-opacity-90 rounded-full px-3 py-1",children:ei.jsx("span",{className:"text-maroon font-bold text-lg",children:T.price})})]}),(0,ei.jsxs)("div",{className:"p-6",children:[ei.jsx("h3",{className:"text-xl font-montserrat font-bold text-maroon mb-3",children:T.title}),ei.jsx("p",{className:"text-gray mb-4 leading-relaxed",children:T.description}),ei.jsx("div",{className:"space-y-2 mb-6",children:T.features.map((T,S)=>(0,ei.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[ei.jsx("div",{className:"w-1.5 h-1.5 bg-maroon rounded-full mr-3"}),T]},S))}),ei.jsx("button",{className:"w-full bg-gradient-to-r from-pink to-maroon text-white py-3 rounded-lg font-medium hover:shadow-lg transition-all duration-300 group-hover:scale-105",children:"Book Now"})]})]},T.id)})}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.8,delay:.6},className:"text-center mt-16",children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold text-maroon mb-4",children:"Don't see what you're looking for?"}),ei.jsx("p",{className:"text-gray mb-6 max-w-2xl mx-auto",children:"We offer custom services tailored to your specific needs. Contact us to discuss your requirements."}),ei.jsx("button",{className:"bg-maroon text-white px-8 py-3 rounded-lg font-medium hover:bg-opacity-90 transition-all duration-300",children:"Contact Us"})]})]})})},Of=ep("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Om=ep("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Og=ep("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Oy=ep("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Ov=()=>{let[T,S]=(0,en.useState)(0),[N,R]=lk({triggerOnce:!0,threshold:.1}),O=[{id:1,name:"Silky Straight Wig",type:"Synthetic",price:"₹3,500",image:"/api/placeholder/300/400",description:"Luxurious straight hair with natural shine and movement",features:["Heat Resistant","Easy Maintenance","Natural Look"],rating:4.9,reviews:127},{id:2,name:"Curly Bob Wig",type:"Human Hair",price:"₹8,500",image:"/api/placeholder/300/400",description:"Beautiful curly bob with bounce and volume",features:["100% Human Hair","Stylable","Long Lasting"],rating:4.8,reviews:89},{id:3,name:"Wavy Long Wig",type:"Synthetic",price:"₹4,200",image:"/api/placeholder/300/400",description:"Elegant wavy hair perfect for special occasions",features:["Tangle Free","Color Safe","Comfortable Cap"],rating:4.7,reviews:156},{id:4,name:"Pixie Cut Wig",type:"Human Hair",price:"₹6,800",image:"/api/placeholder/300/400",description:"Modern pixie cut with texture and style",features:["Professional Grade","Easy Styling","Natural Hairline"],rating:4.9,reviews:73},{id:5,name:"Bridal Wig",type:"Human Hair",price:"₹12,000",image:"/api/placeholder/300/400",description:"Special bridal collection with premium quality",features:["Wedding Ready","Luxury Quality","Custom Styling"],rating:5,reviews:45},{id:6,name:"Hair Patch",type:"Hair Extension",price:"₹2,500",image:"/api/placeholder/300/400",description:"Hair patches for thinning areas and volume",features:["Natural Blend","Easy Application","Comfortable"],rating:4.6,reviews:98}],P=()=>{S(T=>(T+1)%Math.ceil(O.length/3))},M=()=>{S(T=>(T-1+Math.ceil(O.length/3))%Math.ceil(O.length/3))},L=O.slice(3*T,(T+1)*3);return ei.jsx("section",{id:"wigs",className:"py-20 bg-cream",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:N,initial:{opacity:0,y:50},animate:R?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"Wigs & Hair Solutions"}),ei.jsx("p",{className:"text-xl text-gray max-w-3xl mx-auto",children:"Discover our premium collection of wigs and hair solutions, designed to boost your confidence and style"})]}),(0,ei.jsxs)("div",{className:"relative",children:[ei.jsx("button",{onClick:M,className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 z-10 w-12 h-12 bg-white rounded-full shadow-lg flex items-center justify-center text-maroon hover:bg-pink transition-colors duration-300",children:ei.jsx(Of,{className:"w-6 h-6"})}),ei.jsx("button",{onClick:P,className:"absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 z-10 w-12 h-12 bg-white rounded-full shadow-lg flex items-center justify-center text-maroon hover:bg-pink transition-colors duration-300",children:ei.jsx(Om,{className:"w-6 h-6"})}),ei.jsx(lt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:L.map((T,S)=>(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:50},animate:R?{opacity:1,y:0}:{},transition:{duration:.6,delay:.1*S},whileHover:{y:-10,scale:1.02},className:"bg-white rounded-2xl shadow-lg overflow-hidden card-hover group",children:[(0,ei.jsxs)("div",{className:"relative h-64 bg-gradient-to-br from-maroon/10 to-pink/10 flex items-center justify-center",children:[ei.jsx("div",{className:"w-20 h-20 bg-maroon/20 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:ei.jsx("span",{className:"text-3xl",children:"\uD83D\uDC87‍♀️"})}),ei.jsx("div",{className:"absolute top-4 left-4 bg-maroon text-white px-3 py-1 rounded-full text-sm font-semibold",children:T.type}),ei.jsx("div",{className:"absolute top-4 right-4 bg-pink text-maroon px-3 py-1 rounded-full text-sm font-semibold",children:T.price})]}),(0,ei.jsxs)("div",{className:"p-6",children:[ei.jsx("h3",{className:"text-xl font-montserrat font-semibold text-maroon mb-2",children:T.name}),ei.jsx("p",{className:"text-gray mb-4 text-sm leading-relaxed",children:T.description}),(0,ei.jsxs)("div",{className:"flex items-center mb-4",children:[ei.jsx("div",{className:"flex items-center",children:[void 0,void 0,void 0,void 0,void 0].map((S,N)=>ei.jsx(lg,{className:`w-4 h-4 ${N<Math.floor(T.rating)?"text-yellow-400 fill-current":"text-gray-300"}`},N))}),(0,ei.jsxs)("span",{className:"ml-2 text-sm text-gray",children:[T.rating," (",T.reviews," reviews)"]})]}),ei.jsx("div",{className:"space-y-2 mb-6",children:T.features.map((T,S)=>(0,ei.jsxs)("div",{className:"flex items-center text-sm text-gray",children:[ei.jsx("div",{className:"w-2 h-2 bg-pink rounded-full mr-3"}),T]},S))}),(0,ei.jsxs)("div",{className:"flex gap-3",children:[ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex-1 btn-primary text-sm",children:"Book Now"}),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 border border-maroon text-maroon rounded-lg text-sm hover:bg-maroon hover:text-white transition-colors duration-300",children:"View Details"})]})]})]},T.id))},T),ei.jsx("div",{className:"flex justify-center mt-8 space-x-2",children:[...Array(Math.ceil(O.length/3))].map((N,R)=>ei.jsx("button",{onClick:()=>S(R),className:`w-3 h-3 rounded-full transition-colors duration-300 ${T===R?"bg-maroon":"bg-gray-300"}`},R))})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:R?{opacity:1,y:0}:{},transition:{duration:.8,delay:.4},className:"mt-16",children:(0,ei.jsxs)("div",{className:"bg-gradient-to-r from-maroon to-pink rounded-2xl p-8 text-white",children:[(0,ei.jsxs)("div",{className:"text-center mb-8",children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold mb-4",children:"Wig Care Subscription Plans"}),ei.jsx("p",{className:"text-lg opacity-90",children:"Keep your wigs looking perfect with our maintenance plans"})]}),ei.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{name:"Basic Care",price:"₹500/mo",features:["Monthly Cleaning","Basic Styling","Storage Tips"],icon:Og},{name:"Premium Care",price:"₹1,200/mo",features:["Bi-weekly Maintenance","Professional Styling","Deep Cleaning"],icon:lg},{name:"Luxury Care",price:"₹2,000/mo",features:["Weekly Maintenance","Custom Styling","Priority Service"],icon:Oy}].map((T,S)=>(0,ei.jsxs)("div",{className:"bg-white/10 rounded-xl p-6 text-center",children:[ei.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:ei.jsx(T.icon,{className:"w-6 h-6 text-white"})}),ei.jsx("h4",{className:"text-xl font-semibold mb-2",children:T.name}),ei.jsx("div",{className:"text-2xl font-bold mb-4",children:T.price}),ei.jsx("ul",{className:"space-y-2 text-sm",children:T.features.map((T,S)=>(0,ei.jsxs)("li",{className:"flex items-center",children:[ei.jsx("div",{className:"w-2 h-2 bg-pink rounded-full mr-3"}),T]},S))})]},S))})]})})]})})},Ob=ep("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Ow=ep("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),OT=()=>{let[T,S]=lk({triggerOnce:!0,threshold:.1}),N=[{number:"01",title:"Choose Service",description:"Browse our services and select what you need - haircut, styling, wig care, or special event services.",icon:Ob,color:"from-maroon to-pink"},{number:"02",title:"Pick Date & Time",description:"Select your preferred date and time slot. We offer flexible scheduling to fit your busy lifestyle.",icon:lP,color:"from-pink to-maroon"},{number:"03",title:"Professional Visits You",description:"Our expert stylist arrives at your doorstep with all necessary tools and premium products.",icon:Ow,color:"from-maroon to-pink"},{number:"04",title:"Enjoy Your New Look",description:"Relax and enjoy your transformation. We ensure you leave feeling confident and beautiful.",icon:lO,color:"from-pink to-maroon"}];return ei.jsx("section",{className:"py-20 bg-white",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:T,initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"How It Works"}),ei.jsx("p",{className:"text-xl text-gray max-w-3xl mx-auto",children:"Getting your dream hair has never been easier. Follow these simple steps to book your appointment."})]}),ei.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:N.map((T,R)=>(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.6,delay:.2*R},className:"relative",children:[ei.jsx("div",{className:"absolute -top-4 -left-4 w-12 h-12 bg-maroon text-white rounded-full flex items-center justify-center font-bold text-lg z-10",children:T.number}),(0,ei.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 h-full card-hover group",children:[ei.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${T.color} rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300`,children:ei.jsx(T.icon,{className:"w-8 h-8 text-white"})}),ei.jsx("h3",{className:"text-xl font-montserrat font-semibold text-maroon mb-4 text-center",children:T.title}),ei.jsx("p",{className:"text-gray text-center leading-relaxed",children:T.description})]}),R<N.length-1&&ei.jsx("div",{className:"hidden lg:block absolute top-1/2 -right-4 w-8 h-0.5 bg-gradient-to-r from-maroon to-pink transform -translate-y-1/2 z-0"})]},R))}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.8},className:"text-center mt-16",children:(0,ei.jsxs)("div",{className:"bg-gradient-to-r from-maroon to-pink rounded-2xl p-8 text-white",children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold mb-4",children:"Ready to Get Started?"}),ei.jsx("p",{className:"text-lg mb-6 opacity-90",children:"Book your appointment today and experience professional hair care at home"}),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-white text-maroon px-8 py-3 rounded-lg font-semibold hover:bg-pink transition-colors duration-300",children:"Book Now"})]})})]})})};var OS=T=>"checkbox"===T.type,Ox=T=>T instanceof Date,OE=T=>null==T;let OC=T=>"object"==typeof T;var O_=T=>!OE(T)&&!Array.isArray(T)&&OC(T)&&!Ox(T),OI=T=>O_(T)&&T.target?OS(T.target)?T.target.checked:T.target.value:T,Ok=T=>T.substring(0,T.search(/\.\d+(\.|$)/))||T,ON=(T,S)=>T.has(Ok(S)),OA=T=>{let S=T.constructor&&T.constructor.prototype;return O_(S)&&S.hasOwnProperty("isPrototypeOf")},OR=!1;function OD(T){let S;let N=Array.isArray(T),R="undefined"!=typeof FileList&&T instanceof FileList;if(T instanceof Date)S=new Date(T);else if(!(!(OR&&(T instanceof Blob||R))&&(N||O_(T))))return T;else if(S=N?[]:Object.create(Object.getPrototypeOf(T)),N||OA(T))for(let N in T)T.hasOwnProperty(N)&&(S[N]=OD(T[N]));else S=T;return S}var OO=T=>/^\w*$/.test(T),OP=T=>void 0===T,OM=T=>Array.isArray(T)?T.filter(Boolean):[],OL=T=>OM(T.replace(/["|']|\]/g,"").split(/\.|\[/)),Oj=(T,S,N)=>{if(!S||!O_(T))return N;let R=(OO(S)?[S]:OL(S)).reduce((T,S)=>OE(T)?T:T[S],T);return OP(R)||R===T?OP(T[S])?N:T[S]:R},OF=T=>"boolean"==typeof T,OB=(T,S,N)=>{let R=-1,O=OO(S)?[S]:OL(S),P=O.length,M=P-1;for(;++R<P;){let S=O[R],P=N;if(R!==M){let N=T[S];P=O_(N)||Array.isArray(N)?N:isNaN(+O[R+1])?{}:[]}if("__proto__"===S||"constructor"===S||"prototype"===S)return;T[S]=P,T=T[S]}};let OV={BLUR:"blur",FOCUS_OUT:"focusout"},OU={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Oz={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Oq=en.createContext(null);Oq.displayName="HookFormContext";let O$=()=>React.useContext(Oq);var OH=(T,S,N,R=!0)=>{let O={defaultValues:S._defaultValues};for(let P in T)Object.defineProperty(O,P,{get:()=>{let O=P;return S._proxyFormState[O]!==OU.all&&(S._proxyFormState[O]=!R||OU.all),N&&(N[O]=!0),T[O]}});return O};let OG=en.useEffect;var OW=T=>"string"==typeof T,OK=(T,S,N,R,O)=>OW(T)?(R&&S.watch.add(T),Oj(N,T,O)):Array.isArray(T)?T.map(T=>(R&&S.watch.add(T),Oj(N,T))):(R&&(S.watchAll=!0),N),OQ=T=>OE(T)||!OC(T);function OY(T,S,N=new WeakSet){if(OQ(T)||OQ(S))return T===S;if(Ox(T)&&Ox(S))return T.getTime()===S.getTime();let R=Object.keys(T),O=Object.keys(S);if(R.length!==O.length)return!1;if(N.has(T)||N.has(S))return!0;for(let P of(N.add(T),N.add(S),R)){let R=T[P];if(!O.includes(P))return!1;if("ref"!==P){let T=S[P];if(Ox(R)&&Ox(T)||O_(R)&&O_(T)||Array.isArray(R)&&Array.isArray(T)?!OY(R,T,N):R!==T)return!1}}return!0}var OJ=(T,S,N,R,O)=>S?{...N[T],types:{...N[T]&&N[T].types?N[T].types:{},[R]:O||!0}}:{},OX=T=>Array.isArray(T)?T:[T],OZ=()=>{let T=[];return{get observers(){return T},next:S=>{for(let N of T)N.next&&N.next(S)},subscribe:S=>(T.push(S),{unsubscribe:()=>{T=T.filter(T=>T!==S)}}),unsubscribe:()=>{T=[]}}},O0=T=>O_(T)&&!Object.keys(T).length,O1=T=>"file"===T.type,O2=T=>"function"==typeof T,O3=T=>{if(!OR)return!1;let S=T?T.ownerDocument:0;return T instanceof(S&&S.defaultView?S.defaultView.HTMLElement:HTMLElement)},O4=T=>"select-multiple"===T.type,O6=T=>"radio"===T.type,O5=T=>O6(T)||OS(T),O9=T=>O3(T)&&T.isConnected;function O8(T,S){let N=S.slice(0,-1).length,R=0;for(;R<N;)T=OP(T)?R++:T[S[R++]];return T}function O7(T){for(let S in T)if(T.hasOwnProperty(S)&&!OP(T[S]))return!1;return!0}function Pe(T,S){let N=Array.isArray(S)?S:OO(S)?[S]:OL(S),R=1===N.length?T:O8(T,N),O=N.length-1,P=N[O];return R&&delete R[P],0!==O&&(O_(R)&&O0(R)||Array.isArray(R)&&O7(R))&&Pe(T,N.slice(0,-1)),T}var Pt=T=>{for(let S in T)if(O2(T[S]))return!0;return!1};function Pr(T,S={}){let N=Array.isArray(T);if(O_(T)||N)for(let N in T)Array.isArray(T[N])||O_(T[N])&&!Pt(T[N])?(S[N]=Array.isArray(T[N])?[]:{},Pr(T[N],S[N])):OE(T[N])||(S[N]=!0);return S}function Pi(T,S,N){let R=Array.isArray(T);if(O_(T)||R)for(let R in T)Array.isArray(T[R])||O_(T[R])&&!Pt(T[R])?OP(S)||OQ(N[R])?N[R]=Array.isArray(T[R])?Pr(T[R],[]):{...Pr(T[R])}:Pi(T[R],OE(S)?{}:S[R],N[R]):N[R]=!OY(T[R],S[R]);return N}var Pn=(T,S)=>Pi(T,S,Pr(S));let Ps={value:!1,isValid:!1},Pa={value:!0,isValid:!0};var Po=T=>{if(Array.isArray(T)){if(T.length>1){let S=T.filter(T=>T&&T.checked&&!T.disabled).map(T=>T.value);return{value:S,isValid:!!S.length}}return T[0].checked&&!T[0].disabled?T[0].attributes&&!OP(T[0].attributes.value)?OP(T[0].value)||""===T[0].value?Pa:{value:T[0].value,isValid:!0}:Pa:Ps}return Ps},Pl=(T,{valueAsNumber:S,valueAsDate:N,setValueAs:R})=>OP(T)?T:S?""===T?NaN:T?+T:T:N&&OW(T)?new Date(T):R?R(T):T;let Pu={isValid:!1,value:null};var Pc=T=>Array.isArray(T)?T.reduce((T,S)=>S&&S.checked&&!S.disabled?{isValid:!0,value:S.value}:T,Pu):Pu;function Pd(T){let S=T.ref;return O1(S)?S.files:O6(S)?Pc(T.refs).value:O4(S)?[...S.selectedOptions].map(({value:T})=>T):OS(S)?Po(T.refs).value:Pl(OP(S.value)?T.ref.value:S.value,T)}var Ph=(T,S,N,R)=>{let O={};for(let N of T){let T=Oj(S,N);T&&OB(O,N,T._f)}return{criteriaMode:N,names:[...T],fields:O,shouldUseNativeValidation:R}},Pp=T=>T instanceof RegExp,Pf=T=>OP(T)?T:Pp(T)?T.source:O_(T)?Pp(T.value)?T.value.source:T.value:T,Pm=T=>({isOnSubmit:!T||T===OU.onSubmit,isOnBlur:T===OU.onBlur,isOnChange:T===OU.onChange,isOnAll:T===OU.all,isOnTouch:T===OU.onTouched});let Pg="AsyncFunction";var Py=T=>!!T&&!!T.validate&&!!(O2(T.validate)&&T.validate.constructor.name===Pg||O_(T.validate)&&Object.values(T.validate).find(T=>T.constructor.name===Pg)),Pv=T=>T.mount&&(T.required||T.min||T.max||T.maxLength||T.minLength||T.pattern||T.validate),Pb=(T,S,N)=>!N&&(S.watchAll||S.watch.has(T)||[...S.watch].some(S=>T.startsWith(S)&&/^\.\w+/.test(T.slice(S.length))));let Pw=(T,S,N,R)=>{for(let O of N||Object.keys(T)){let N=Oj(T,O);if(N){let{_f:T,...P}=N;if(T){if(T.refs&&T.refs[0]&&S(T.refs[0],O)&&!R||T.ref&&S(T.ref,T.name)&&!R)return!0;if(Pw(P,S))break}else if(O_(P)&&Pw(P,S))break}}};function PT(T,S,N){let R=Oj(T,N);if(R||OO(N))return{error:R,name:N};let O=N.split(".");for(;O.length;){let R=O.join("."),P=Oj(S,R),M=Oj(T,R);if(P&&!Array.isArray(P)&&N!==R)break;if(M&&M.type)return{name:R,error:M};if(M&&M.root&&M.root.type)return{name:`${R}.root`,error:M.root};O.pop()}return{name:N}}var PS=(T,S,N,R)=>{N(T);let{name:O,...P}=T;return O0(P)||Object.keys(P).length>=Object.keys(S).length||Object.keys(P).find(T=>S[T]===(!R||OU.all))},Px=(T,S,N)=>!T||!S||T===S||OX(T).some(T=>T&&(N?T===S:T.startsWith(S)||S.startsWith(T))),PE=(T,S,N,R,O)=>!O.isOnAll&&(!N&&O.isOnTouch?!(S||T):(N?R.isOnBlur:O.isOnBlur)?!T:(N?!R.isOnChange:!O.isOnChange)||T),PC=(T,S)=>!OM(Oj(T,S)).length&&Pe(T,S),P_=(T,S,N)=>{let R=OX(Oj(T,N));return OB(R,"root",S[N]),OB(T,N,R),T},PI=T=>OW(T);function Pk(T,S,N="validate"){if(PI(T)||Array.isArray(T)&&T.every(PI)||OF(T)&&!T)return{type:N,message:PI(T)?T:"",ref:S}}var PN=T=>O_(T)&&!Pp(T)?T:{value:T,message:""},PA=async(T,S,N,R,O,P)=>{let{ref:M,refs:L,required:V,maxLength:U,minLength:$,min:W,max:K,pattern:Q,validate:Y,name:Z,valueAsNumber:ee,mount:et}=T._f,er=Oj(N,Z);if(!et||S.has(Z))return{};let ei=L?L[0]:M,en=T=>{O&&ei.reportValidity&&(ei.setCustomValidity(OF(T)?"":T||""),ei.reportValidity())},es={},ea=O6(M),eo=OS(M),eu=ea||eo,ec=(ee||O1(M))&&OP(M.value)&&OP(er)||O3(M)&&""===M.value||""===er||Array.isArray(er)&&!er.length,ed=OJ.bind(null,Z,R,es),eh=(T,S,N,R=Oz.maxLength,O=Oz.minLength)=>{let P=T?S:N;es[Z]={type:T?R:O,message:P,ref:M,...ed(T?R:O,P)}};if(P?!Array.isArray(er)||!er.length:V&&(!eu&&(ec||OE(er))||OF(er)&&!er||eo&&!Po(L).isValid||ea&&!Pc(L).isValid)){let{value:T,message:S}=PI(V)?{value:!!V,message:V}:PN(V);if(T&&(es[Z]={type:Oz.required,message:S,ref:ei,...ed(Oz.required,S)},!R))return en(S),es}if(!ec&&(!OE(W)||!OE(K))){let T,S;let N=PN(K),O=PN(W);if(OE(er)||isNaN(er)){let R=M.valueAsDate||new Date(er),P=T=>new Date(new Date().toDateString()+" "+T),L="time"==M.type,V="week"==M.type;OW(N.value)&&er&&(T=L?P(er)>P(N.value):V?er>N.value:R>new Date(N.value)),OW(O.value)&&er&&(S=L?P(er)<P(O.value):V?er<O.value:R<new Date(O.value))}else{let R=M.valueAsNumber||(er?+er:er);OE(N.value)||(T=R>N.value),OE(O.value)||(S=R<O.value)}if((T||S)&&(eh(!!T,N.message,O.message,Oz.max,Oz.min),!R))return en(es[Z].message),es}if((U||$)&&!ec&&(OW(er)||P&&Array.isArray(er))){let T=PN(U),S=PN($),N=!OE(T.value)&&er.length>+T.value,O=!OE(S.value)&&er.length<+S.value;if((N||O)&&(eh(N,T.message,S.message),!R))return en(es[Z].message),es}if(Q&&!ec&&OW(er)){let{value:T,message:S}=PN(Q);if(Pp(T)&&!er.match(T)&&(es[Z]={type:Oz.pattern,message:S,ref:M,...ed(Oz.pattern,S)},!R))return en(S),es}if(Y){if(O2(Y)){let T=Pk(await Y(er,N),ei);if(T&&(es[Z]={...T,...ed(Oz.validate,T.message)},!R))return en(T.message),es}else if(O_(Y)){let T={};for(let S in Y){if(!O0(T)&&!R)break;let O=Pk(await Y[S](er,N),ei,S);O&&(T={...O,...ed(S,O.message)},en(O.message),R&&(es[Z]=T))}if(!O0(T)&&(es[Z]={ref:ei,...T},!R))return es}}return en(!0),es};let PR={mode:OU.onSubmit,reValidateMode:OU.onChange,shouldFocusError:!0};function PD(T={}){let S,N={...PR,...T},R={submitCount:0,isDirty:!1,isReady:!1,isLoading:O2(N.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:N.errors||{},disabled:N.disabled||!1},O={},P=(O_(N.defaultValues)||O_(N.values))&&OD(N.defaultValues||N.values)||{},M=N.shouldUnregister?{}:OD(P),L={action:!1,mount:!1,watch:!1},V={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},U=0,$={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},W={...$},K={array:OZ(),state:OZ()},Q=N.criteriaMode===OU.all,Y=T=>S=>{clearTimeout(U),U=setTimeout(T,S)},Z=async T=>{if(!N.disabled&&($.isValid||W.isValid||T)){let T=N.resolver?O0((await ea()).errors):await eu(O,!0);T!==R.isValid&&K.state.next({isValid:T})}},ee=(T,S)=>{!N.disabled&&($.isValidating||$.validatingFields||W.isValidating||W.validatingFields)&&((T||Array.from(V.mount)).forEach(T=>{T&&(S?OB(R.validatingFields,T,S):Pe(R.validatingFields,T))}),K.state.next({validatingFields:R.validatingFields,isValidating:!O0(R.validatingFields)}))},et=(T,S=[],V,U,Q=!0,Y=!0)=>{if(U&&V&&!N.disabled){if(L.action=!0,Y&&Array.isArray(Oj(O,T))){let S=V(Oj(O,T),U.argA,U.argB);Q&&OB(O,T,S)}if(Y&&Array.isArray(Oj(R.errors,T))){let S=V(Oj(R.errors,T),U.argA,U.argB);Q&&OB(R.errors,T,S),PC(R.errors,T)}if(($.touchedFields||W.touchedFields)&&Y&&Array.isArray(Oj(R.touchedFields,T))){let S=V(Oj(R.touchedFields,T),U.argA,U.argB);Q&&OB(R.touchedFields,T,S)}($.dirtyFields||W.dirtyFields)&&(R.dirtyFields=Pn(P,M)),K.state.next({name:T,isDirty:ed(T,S),dirtyFields:R.dirtyFields,errors:R.errors,isValid:R.isValid})}else OB(M,T,S)},er=(T,S)=>{OB(R.errors,T,S),K.state.next({errors:R.errors})},ei=(T,S,N,R)=>{let V=Oj(O,T);if(V){let O=Oj(M,T,OP(N)?Oj(P,T):N);OP(O)||R&&R.defaultChecked||S?OB(M,T,S?O:Pd(V._f)):ep(T,O),L.mount&&Z()}},en=(T,S,O,M,L)=>{let V=!1,U=!1,Q={name:T};if(!N.disabled){if(!O||M){($.isDirty||W.isDirty)&&(U=R.isDirty,R.isDirty=Q.isDirty=ed(),V=U!==Q.isDirty);let N=OY(Oj(P,T),S);U=!!Oj(R.dirtyFields,T),N?Pe(R.dirtyFields,T):OB(R.dirtyFields,T,!0),Q.dirtyFields=R.dirtyFields,V=V||($.dirtyFields||W.dirtyFields)&&!N!==U}if(O){let S=Oj(R.touchedFields,T);S||(OB(R.touchedFields,T,O),Q.touchedFields=R.touchedFields,V=V||($.touchedFields||W.touchedFields)&&S!==O)}V&&L&&K.state.next(Q)}return V?Q:{}},es=(T,O,P,M)=>{let L=Oj(R.errors,T),V=($.isValid||W.isValid)&&OF(O)&&R.isValid!==O;if(N.delayError&&P?(S=Y(()=>er(T,P)))(N.delayError):(clearTimeout(U),S=null,P?OB(R.errors,T,P):Pe(R.errors,T)),(P?!OY(L,P):L)||!O0(M)||V){let S={...M,...V&&OF(O)?{isValid:O}:{},errors:R.errors,name:T};R={...R,...S},K.state.next(S)}},ea=async T=>{ee(T,!0);let S=await N.resolver(M,N.context,Ph(T||V.mount,O,N.criteriaMode,N.shouldUseNativeValidation));return ee(T),S},eo=async T=>{let{errors:S}=await ea(T);if(T)for(let N of T){let T=Oj(S,N);T?OB(R.errors,N,T):Pe(R.errors,N)}else R.errors=S;return S},eu=async(T,S,O={valid:!0})=>{for(let P in T){let L=T[P];if(L){let{_f:T,...U}=L;if(T){let U=V.array.has(T.name),W=L._f&&Py(L._f);W&&$.validatingFields&&ee([P],!0);let K=await PA(L,V.disabled,M,Q,N.shouldUseNativeValidation&&!S,U);if(W&&$.validatingFields&&ee([P]),K[T.name]&&(O.valid=!1,S))break;S||(Oj(K,T.name)?U?P_(R.errors,K,T.name):OB(R.errors,T.name,K[T.name]):Pe(R.errors,T.name))}O0(U)||await eu(U,S,O)}}return O.valid},ec=()=>{for(let T of V.unMount){let S=Oj(O,T);S&&(S._f.refs?S._f.refs.every(T=>!O9(T)):!O9(S._f.ref))&&e_(T)}V.unMount=new Set},ed=(T,S)=>!N.disabled&&(T&&S&&OB(M,T,S),!OY(eb(),P)),eh=(T,S,N)=>OK(T,V,{...L.mount?M:OP(S)?P:OW(T)?{[T]:S}:S},N,S),ep=(T,S,N={})=>{let R=Oj(O,T),P=S;if(R){let N=R._f;N&&(N.disabled||OB(M,T,Pl(S,N)),P=O3(N.ref)&&OE(S)?"":S,O4(N.ref)?[...N.ref.options].forEach(T=>T.selected=P.includes(T.value)):N.refs?OS(N.ref)?N.refs.forEach(T=>{T.defaultChecked&&T.disabled||(Array.isArray(P)?T.checked=!!P.find(S=>S===T.value):T.checked=P===T.value||!!P)}):N.refs.forEach(T=>T.checked=T.value===P):O1(N.ref)?N.ref.value="":(N.ref.value=P,N.ref.type||K.state.next({name:T,values:OD(M)})))}(N.shouldDirty||N.shouldTouch)&&en(T,P,N.shouldTouch,N.shouldDirty,!0),N.shouldValidate&&ev(T)},ef=(T,S,N)=>{for(let R in S){if(!S.hasOwnProperty(R))return;let P=S[R],M=T+"."+R,L=Oj(O,M);(V.array.has(T)||O_(P)||L&&!L._f)&&!Ox(P)?ef(M,P,N):ep(M,P,N)}},em=(T,S,N={})=>{let U=Oj(O,T),Q=V.array.has(T),Y=OD(S);OB(M,T,Y),Q?(K.array.next({name:T,values:OD(M)}),($.isDirty||$.dirtyFields||W.isDirty||W.dirtyFields)&&N.shouldDirty&&K.state.next({name:T,dirtyFields:Pn(P,M),isDirty:ed(T,Y)})):!U||U._f||OE(Y)?ep(T,Y,N):ef(T,Y,N),Pb(T,V)&&K.state.next({...R,name:T}),K.state.next({name:L.mount?T:void 0,values:OD(M)})},eg=async T=>{L.mount=!0;let P=T.target,U=P.name,Y=!0,et=Oj(O,U),er=T=>{Y=Number.isNaN(T)||Ox(T)&&isNaN(T.getTime())||OY(T,Oj(M,U,T))},ei=Pm(N.mode),eo=Pm(N.reValidateMode);if(et){let L,ec;let ed=P.type?Pd(et._f):OI(T),eh=T.type===OV.BLUR||T.type===OV.FOCUS_OUT,ep=!Pv(et._f)&&!N.resolver&&!Oj(R.errors,U)&&!et._f.deps||PE(eh,Oj(R.touchedFields,U),R.isSubmitted,eo,ei),ef=Pb(U,V,eh);OB(M,U,ed),eh?P&&P.readOnly||(et._f.onBlur&&et._f.onBlur(T),S&&S(0)):et._f.onChange&&et._f.onChange(T);let em=en(U,ed,eh),eg=!O0(em)||ef;if(eh||K.state.next({name:U,type:T.type,values:OD(M)}),ep)return($.isValid||W.isValid)&&("onBlur"===N.mode?eh&&Z():eh||Z()),eg&&K.state.next({name:U,...ef?{}:em});if(!eh&&ef&&K.state.next({...R}),N.resolver){let{errors:T}=await ea([U]);if(er(ed),Y){let S=PT(R.errors,O,U),N=PT(T,O,S.name||U);L=N.error,U=N.name,ec=O0(T)}}else ee([U],!0),L=(await PA(et,V.disabled,M,Q,N.shouldUseNativeValidation))[U],ee([U]),er(ed),Y&&(L?ec=!1:($.isValid||W.isValid)&&(ec=await eu(O,!0)));Y&&(et._f.deps&&ev(et._f.deps),es(U,ec,L,em))}},ey=(T,S)=>{if(Oj(R.errors,S)&&T.focus)return T.focus(),1},ev=async(T,S={})=>{let P,M;let L=OX(T);if(N.resolver){let S=await eo(OP(T)?T:L);P=O0(S),M=T?!L.some(T=>Oj(S,T)):P}else T?((M=(await Promise.all(L.map(async T=>{let S=Oj(O,T);return await eu(S&&S._f?{[T]:S}:S)}))).every(Boolean))||R.isValid)&&Z():M=P=await eu(O);return K.state.next({...!OW(T)||($.isValid||W.isValid)&&P!==R.isValid?{}:{name:T},...N.resolver||!T?{isValid:P}:{},errors:R.errors}),S.shouldFocus&&!M&&Pw(O,ey,T?L:V.mount),M},eb=T=>{let S={...L.mount?M:P};return OP(T)?S:OW(T)?Oj(S,T):T.map(T=>Oj(S,T))},ew=(T,S)=>({invalid:!!Oj((S||R).errors,T),isDirty:!!Oj((S||R).dirtyFields,T),error:Oj((S||R).errors,T),isValidating:!!Oj(R.validatingFields,T),isTouched:!!Oj((S||R).touchedFields,T)}),eT=T=>{T&&OX(T).forEach(T=>Pe(R.errors,T)),K.state.next({errors:T?R.errors:{}})},eS=(T,S,N)=>{let P=(Oj(O,T,{_f:{}})._f||{}).ref,{ref:M,message:L,type:V,...U}=Oj(R.errors,T)||{};OB(R.errors,T,{...U,...S,ref:P}),K.state.next({name:T,errors:R.errors,isValid:!1}),N&&N.shouldFocus&&P&&P.focus&&P.focus()},ex=(T,S)=>O2(T)?K.state.subscribe({next:N=>"values"in N&&T(eh(void 0,S),N)}):eh(T,S,!0),eE=T=>K.state.subscribe({next:S=>{Px(T.name,S.name,T.exact)&&PS(S,T.formState||$,eM,T.reRenderRoot)&&T.callback({values:{...M},...R,...S,defaultValues:P})}}).unsubscribe,eC=T=>(L.mount=!0,W={...W,...T.formState},eE({...T,formState:W})),e_=(T,S={})=>{for(let L of T?OX(T):V.mount)V.mount.delete(L),V.array.delete(L),S.keepValue||(Pe(O,L),Pe(M,L)),S.keepError||Pe(R.errors,L),S.keepDirty||Pe(R.dirtyFields,L),S.keepTouched||Pe(R.touchedFields,L),S.keepIsValidating||Pe(R.validatingFields,L),N.shouldUnregister||S.keepDefaultValue||Pe(P,L);K.state.next({values:OD(M)}),K.state.next({...R,...S.keepDirty?{isDirty:ed()}:{}}),S.keepIsValid||Z()},eI=({disabled:T,name:S})=>{(OF(T)&&L.mount||T||V.disabled.has(S))&&(T?V.disabled.add(S):V.disabled.delete(S))},ek=(T,S={})=>{let R=Oj(O,T),M=OF(S.disabled)||OF(N.disabled);return OB(O,T,{...R||{},_f:{...R&&R._f?R._f:{ref:{name:T}},name:T,mount:!0,...S}}),V.mount.add(T),R?eI({disabled:OF(S.disabled)?S.disabled:N.disabled,name:T}):ei(T,!0,S.value),{...M?{disabled:S.disabled||N.disabled}:{},...N.progressive?{required:!!S.required,min:Pf(S.min),max:Pf(S.max),minLength:Pf(S.minLength),maxLength:Pf(S.maxLength),pattern:Pf(S.pattern)}:{},name:T,onChange:eg,onBlur:eg,ref:M=>{if(M){ek(T,S),R=Oj(O,T);let N=OP(M.value)&&M.querySelectorAll&&M.querySelectorAll("input,select,textarea")[0]||M,L=O5(N),V=R._f.refs||[];(L?V.find(T=>T===N):N===R._f.ref)||(OB(O,T,{_f:{...R._f,...L?{refs:[...V.filter(O9),N,...Array.isArray(Oj(P,T))?[{}]:[]],ref:{type:N.type,name:T}}:{ref:N}}}),ei(T,!1,void 0,N))}else(R=Oj(O,T,{}))._f&&(R._f.mount=!1),(N.shouldUnregister||S.shouldUnregister)&&!(ON(V.array,T)&&L.action)&&V.unMount.add(T)}}},eN=()=>N.shouldFocusError&&Pw(O,ey,V.mount),eA=(T,S)=>async P=>{let L;P&&(P.preventDefault&&P.preventDefault(),P.persist&&P.persist());let U=OD(M);if(K.state.next({isSubmitting:!0}),N.resolver){let{errors:T,values:S}=await ea();R.errors=T,U=OD(S)}else await eu(O);if(V.disabled.size)for(let T of V.disabled)Pe(U,T);if(Pe(R.errors,"root"),O0(R.errors)){K.state.next({errors:{}});try{await T(U,P)}catch(T){L=T}}else S&&await S({...R.errors},P),eN(),setTimeout(eN);if(K.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:O0(R.errors)&&!L,submitCount:R.submitCount+1,errors:R.errors}),L)throw L},eR=(T,S={})=>{Oj(O,T)&&(OP(S.defaultValue)?em(T,OD(Oj(P,T))):(em(T,S.defaultValue),OB(P,T,OD(S.defaultValue))),S.keepTouched||Pe(R.touchedFields,T),S.keepDirty||(Pe(R.dirtyFields,T),R.isDirty=S.defaultValue?ed(T,OD(Oj(P,T))):ed()),!S.keepError&&(Pe(R.errors,T),$.isValid&&Z()),K.state.next({...R}))},eD=(T,S={})=>{let U=T?OD(T):P,W=OD(U),Q=O0(T),Y=Q?P:W;if(S.keepDefaultValues||(P=U),!S.keepValues){if(S.keepDirtyValues)for(let T of Array.from(new Set([...V.mount,...Object.keys(Pn(P,M))])))Oj(R.dirtyFields,T)?OB(Y,T,Oj(M,T)):em(T,Oj(Y,T));else{if(OR&&OP(T))for(let T of V.mount){let S=Oj(O,T);if(S&&S._f){let T=Array.isArray(S._f.refs)?S._f.refs[0]:S._f.ref;if(O3(T)){let S=T.closest("form");if(S){S.reset();break}}}}if(S.keepFieldsRef)for(let T of V.mount)em(T,Oj(Y,T));else O={}}M=N.shouldUnregister?S.keepDefaultValues?OD(P):{}:OD(Y),K.array.next({values:{...Y}}),K.state.next({values:{...Y}})}V={mount:S.keepDirtyValues?V.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},L.mount=!$.isValid||!!S.keepIsValid||!!S.keepDirtyValues,L.watch=!!N.shouldUnregister,K.state.next({submitCount:S.keepSubmitCount?R.submitCount:0,isDirty:!Q&&(S.keepDirty?R.isDirty:!!(S.keepDefaultValues&&!OY(T,P))),isSubmitted:!!S.keepIsSubmitted&&R.isSubmitted,dirtyFields:Q?{}:S.keepDirtyValues?S.keepDefaultValues&&M?Pn(P,M):R.dirtyFields:S.keepDefaultValues&&T?Pn(P,T):S.keepDirty?R.dirtyFields:{},touchedFields:S.keepTouched?R.touchedFields:{},errors:S.keepErrors?R.errors:{},isSubmitSuccessful:!!S.keepIsSubmitSuccessful&&R.isSubmitSuccessful,isSubmitting:!1,defaultValues:P})},eO=(T,S)=>eD(O2(T)?T(M):T,S),eP=(T,S={})=>{let N=Oj(O,T),R=N&&N._f;if(R){let T=R.refs?R.refs[0]:R.ref;T.focus&&(T.focus(),S.shouldSelect&&O2(T.select)&&T.select())}},eM=T=>{R={...R,...T}},eL={control:{register:ek,unregister:e_,getFieldState:ew,handleSubmit:eA,setError:eS,_subscribe:eE,_runSchema:ea,_focusError:eN,_getWatch:eh,_getDirty:ed,_setValid:Z,_setFieldArray:et,_setDisabledField:eI,_setErrors:T=>{R.errors=T,K.state.next({errors:R.errors,isValid:!1})},_getFieldArray:T=>OM(Oj(L.mount?M:P,T,N.shouldUnregister?Oj(P,T,[]):[])),_reset:eD,_resetDefaultValues:()=>O2(N.defaultValues)&&N.defaultValues().then(T=>{eO(T,N.resetOptions),K.state.next({isLoading:!1})}),_removeUnmounted:ec,_disableForm:T=>{OF(T)&&(K.state.next({disabled:T}),Pw(O,(S,N)=>{let R=Oj(O,N);R&&(S.disabled=R._f.disabled||T,Array.isArray(R._f.refs)&&R._f.refs.forEach(S=>{S.disabled=R._f.disabled||T}))},0,!1))},_subjects:K,_proxyFormState:$,get _fields(){return O},get _formValues(){return M},get _state(){return L},set _state(value){L=value},get _defaultValues(){return P},get _names(){return V},set _names(value){V=value},get _formState(){return R},get _options(){return N},set _options(value){N={...N,...value}}},subscribe:eC,trigger:ev,register:ek,handleSubmit:eA,watch:ex,setValue:em,getValues:eb,reset:eO,resetField:eR,clearErrors:eT,unregister:e_,setError:eS,setFocus:eP,getFieldState:ew};return{...eL,formControl:eL}}function PO(T={}){let S=en.useRef(void 0),N=en.useRef(void 0),[R,O]=en.useState({isDirty:!1,isValidating:!1,isLoading:O2(T.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:T.errors||{},disabled:T.disabled||!1,isReady:!1,defaultValues:O2(T.defaultValues)?void 0:T.defaultValues});if(!S.current){if(T.formControl)S.current={...T.formControl,formState:R},T.defaultValues&&!O2(T.defaultValues)&&T.formControl.reset(T.defaultValues,T.resetOptions);else{let{formControl:N,...O}=PD(T);S.current={...O,formState:R}}}let P=S.current.control;return P._options=T,OG(()=>{let T=P._subscribe({formState:P._proxyFormState,callback:()=>O({...P._formState}),reRenderRoot:!0});return O(T=>({...T,isReady:!0})),P._formState.isReady=!0,T},[P]),en.useEffect(()=>P._disableForm(T.disabled),[P,T.disabled]),en.useEffect(()=>{T.mode&&(P._options.mode=T.mode),T.reValidateMode&&(P._options.reValidateMode=T.reValidateMode)},[P,T.mode,T.reValidateMode]),en.useEffect(()=>{T.errors&&(P._setErrors(T.errors),P._focusError())},[P,T.errors]),en.useEffect(()=>{T.shouldUnregister&&P._subjects.state.next({values:P._getWatch()})},[P,T.shouldUnregister]),en.useEffect(()=>{if(P._proxyFormState.isDirty){let T=P._getDirty();T!==R.isDirty&&P._subjects.state.next({isDirty:T})}},[P,R.isDirty]),en.useEffect(()=>{T.values&&!OY(T.values,N.current)?(P._reset(T.values,{keepFieldsRef:!0,...P._options.resetOptions}),N.current=T.values,O(T=>({...T}))):P._resetDefaultValues()},[P,T.values]),en.useEffect(()=>{P._state.mount||(P._setValid(),P._state.mount=!0),P._state.watch&&(P._state.watch=!1,P._subjects.state.next({...P._formState})),P._removeUnmounted()}),S.current.formState=OH(R,P),S.current}let PP=(T,S,N)=>{if(T&&"reportValidity"in T){let R=Oj(N,S);T.setCustomValidity(R&&R.message||""),T.reportValidity()}},PM=(T,S)=>{for(let N in S.fields){let R=S.fields[N];R&&R.ref&&"reportValidity"in R.ref?PP(R.ref,N,T):R.refs&&R.refs.forEach(S=>PP(S,N,T))}},PL=(T,S)=>{S.shouldUseNativeValidation&&PM(T,S);let N={};for(let R in T){let O=Oj(S.fields,R),P=Object.assign(T[R]||{},{ref:O&&O.ref});if(Pj(S.names||Object.keys(T),R)){let T=Object.assign({},Oj(N,R));OB(T,"root",P),OB(N,R,T)}else OB(N,R,P)}return N},Pj=(T,S)=>T.some(T=>T.startsWith(S+"."));function PF(T,S,N){return void 0===S&&(S={}),void 0===N&&(N={}),function(R,O,P){try{return Promise.resolve(function(M,L){try{var V=(S.context,Promise.resolve(T["sync"===N.mode?"validateSync":"validate"](R,Object.assign({abortEarly:!1},S,{context:O}))).then(function(T){return P.shouldUseNativeValidation&&PM({},P),{values:N.raw?R:T,errors:{}}}))}catch(T){return L(T)}return V&&V.then?V.then(void 0,L):V}(0,function(T){var S,N;if(!T.inner)throw T;return{values:{},errors:PL((S=T,N=!P.shouldUseNativeValidation&&"all"===P.criteriaMode,(S.inner||[]).reduce(function(T,S){if(T[S.path]||(T[S.path]={message:S.message,type:S.type}),N){var R=T[S.path].types,O=R&&R[S.type];T[S.path]=OJ(S.path,N,T,S.type,O?[].concat(O,S.message):S.message)}return T},{})),P)}}))}catch(T){return Promise.reject(T)}}}var PB=N(681),PV=N(7585),PU=N(6980),Pz=N.n(PU);let Pq=Object.prototype.toString,P$=Error.prototype.toString,PH=RegExp.prototype.toString,PG="undefined"!=typeof Symbol?Symbol.prototype.toString:()=>"",PW=/^Symbol\((.*)\)(.*)$/;function PK(T){return T!=+T?"NaN":0===T&&1/T<0?"-0":""+T}function PQ(T,S=!1){if(null==T||!0===T||!1===T)return""+T;let N=typeof T;if("number"===N)return PK(T);if("string"===N)return S?`"${T}"`:T;if("function"===N)return"[Function "+(T.name||"anonymous")+"]";if("symbol"===N)return PG.call(T).replace(PW,"Symbol($1)");let R=Pq.call(T).slice(8,-1);return"Date"===R?isNaN(T.getTime())?""+T:T.toISOString(T):"Error"===R||T instanceof Error?"["+P$.call(T)+"]":"RegExp"===R?PH.call(T):null}function PY(T,S){let N=PQ(T,S);return null!==N?N:JSON.stringify(T,function(T,N){let R=PQ(this[T],S);return null!==R?R:N},2)}function PJ(T){return null==T?[]:[].concat(T)}let PX=/\$\{\s*(\w+)\s*\}/g;U=Symbol.toStringTag;class PZ{constructor(T,S,N,R){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[U]="Error",this.name="ValidationError",this.value=S,this.path=N,this.type=R,this.errors=[],this.inner=[],PJ(T).forEach(T=>{if(P0.isError(T)){this.errors.push(...T.errors);let S=T.inner.length?T.inner:[T];this.inner.push(...S)}else this.errors.push(T)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}$=Symbol.hasInstance,W=Symbol.toStringTag;class P0 extends Error{static formatError(T,S){let N=S.label||S.path||"this";return(S=Object.assign({},S,{path:N,originalPath:S.path}),"string"==typeof T)?T.replace(PX,(T,N)=>PY(S[N])):"function"==typeof T?T(S):T}static isError(T){return T&&"ValidationError"===T.name}constructor(T,S,N,R,O){let P=new PZ(T,S,N,R);if(O)return P;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[W]="Error",this.name=P.name,this.message=P.message,this.type=P.type,this.value=P.value,this.path=P.path,this.errors=P.errors,this.inner=P.inner,Error.captureStackTrace&&Error.captureStackTrace(this,P0)}static[$](T){return PZ[Symbol.hasInstance](T)||super[Symbol.hasInstance](T)}}let P1={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:T,type:S,value:N,originalValue:R})=>{let O=null!=R&&R!==N?` (cast from the value \`${PY(R,!0)}\`).`:".";return"mixed"!==S?`${T} must be a \`${S}\` type, but the final value was: \`${PY(N,!0)}\``+O:`${T} must match the configured type. The validated value was: \`${PY(N,!0)}\``+O}},P2={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},P3={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},P4={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},P6={isValue:"${path} field must be ${value}"},P5={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},P9={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},P8={notType:T=>{let{path:S,value:N,spec:R}=T,O=R.types.length;if(Array.isArray(N)){if(N.length<O)return`${S} tuple value has too few items, expected a length of ${O} but got ${N.length} for value: \`${PY(N,!0)}\``;if(N.length>O)return`${S} tuple value has too many items, expected a length of ${O} but got ${N.length} for value: \`${PY(N,!0)}\``}return P0.formatError(P1.notType,T)}};Object.assign(Object.create(null),{mixed:P1,string:P2,number:P3,date:P4,object:P5,array:P9,boolean:P6,tuple:P8});let P7=T=>T&&T.__isYupSchema__;class Me{static fromOptions(T,S){if(!S.then&&!S.otherwise)throw TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:N,then:R,otherwise:O}=S,P="function"==typeof N?N:(...T)=>T.every(T=>T===N);return new Me(T,(T,S)=>{var N;let M=P(...T)?R:O;return null!=(N=null==M?void 0:M(S))?N:S})}constructor(T,S){this.fn=void 0,this.refs=T,this.refs=T,this.fn=S}resolve(T,S){let N=this.refs.map(T=>T.getValue(null==S?void 0:S.value,null==S?void 0:S.parent,null==S?void 0:S.context)),R=this.fn(N,T,S);if(void 0===R||R===T)return T;if(!P7(R))throw TypeError("conditions must return a schema object");return R.resolve(S)}}let Mt={context:"$",value:"."};class Mr{constructor(T,S={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,"string"!=typeof T)throw TypeError("ref must be a string, got: "+T);if(this.key=T.trim(),""===T)throw TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Mt.context,this.isValue=this.key[0]===Mt.value,this.isSibling=!this.isContext&&!this.isValue;let N=this.isContext?Mt.context:this.isValue?Mt.value:"";this.path=this.key.slice(N.length),this.getter=this.path&&(0,PB.getter)(this.path,!0),this.map=S.map}getValue(T,S,N){let R=this.isContext?N:this.isValue?T:S;return this.getter&&(R=this.getter(R||{})),this.map&&(R=this.map(R)),R}cast(T,S){return this.getValue(T,null==S?void 0:S.parent,null==S?void 0:S.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(T){return T&&T.__isYupRef}}Mr.prototype.__isYupRef=!0;let Mi=T=>null==T;function Mn(T){function S({value:S,path:N="",options:R,originalValue:O,schema:P},M,L){let V;let{name:U,test:$,params:W,message:K,skipAbsent:Q}=T,{parent:Y,context:Z,abortEarly:ee=P.spec.abortEarly,disableStackTrace:et=P.spec.disableStackTrace}=R,er={value:S,parent:Y,context:Z};function ei(T={}){let R=Ms(Object.assign({value:S,originalValue:O,label:P.spec.label,path:T.path||N,spec:P.spec,disableStackTrace:T.disableStackTrace||et},W,T.params),er),M=new P0(P0.formatError(T.message||K,R),S,R.path,T.type||U,R.disableStackTrace);return M.params=R,M}let en=ee?M:L,es={path:N,parent:Y,type:U,from:R.from,createError:ei,resolve:T=>Ma(T,er),options:R,originalValue:O,schema:P},ea=T=>{P0.isError(T)?en(T):T?L(null):en(ei())},eo=T=>{P0.isError(T)?en(T):M(T)};if(Q&&Mi(S))return ea(!0);try{var eu;if(V=$.call(es,S,es),"function"==typeof(null==(eu=V)?void 0:eu.then)){if(R.sync)throw Error(`Validation test of type: "${es.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(V).then(ea,eo)}}catch(T){eo(T);return}ea(V)}return S.OPTIONS=T,S}function Ms(T,S){if(!T)return T;for(let N of Object.keys(T))T[N]=Ma(T[N],S);return T}function Ma(T,S){return Mr.isRef(T)?T.getValue(S.value,S.parent,S.context):T}function Mo(T,S,N,R=N){let O,P,M;return S?((0,PB.forEach)(S,(L,V,U)=>{let $=V?L.slice(1,L.length-1):L,W="tuple"===(T=T.resolve({context:R,parent:O,value:N})).type,K=U?parseInt($,10):0;if(T.innerType||W){if(W&&!U)throw Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${M}" must contain an index to the tuple element, e.g. "${M}[0]"`);if(N&&K>=N.length)throw Error(`Yup.reach cannot resolve an array item at index: ${L}, in the path: ${S}. because there is no value at that index. `);O=N,N=N&&N[K],T=W?T.spec.types[K]:T.innerType}if(!U){if(!T.fields||!T.fields[$])throw Error(`The schema does not contain the path: ${S}. (failed at: ${M} which is a type: "${T.type}")`);O=N,N=N&&N[$],T=T.fields[$]}P=$,M=V?"["+L+"]":"."+L}),{schema:T,parent:O,parentPath:P}):{parent:O,parentPath:S,schema:T}}class Ml extends Set{describe(){let T=[];for(let S of this.values())T.push(Mr.isRef(S)?S.describe():S);return T}resolveAll(T){let S=[];for(let N of this.values())S.push(T(N));return S}clone(){return new Ml(this.values())}merge(T,S){let N=this.clone();return T.forEach(T=>N.add(T)),S.forEach(T=>N.delete(T)),N}}function Mu(T,S=new Map){let N;if(P7(T)||!T||"object"!=typeof T)return T;if(S.has(T))return S.get(T);if(T instanceof Date)N=new Date(T.getTime()),S.set(T,N);else if(T instanceof RegExp)N=new RegExp(T),S.set(T,N);else if(Array.isArray(T)){N=Array(T.length),S.set(T,N);for(let R=0;R<T.length;R++)N[R]=Mu(T[R],S)}else if(T instanceof Map)for(let[R,O]of(N=new Map,S.set(T,N),T.entries()))N.set(R,Mu(O,S));else if(T instanceof Set)for(let R of(N=new Set,S.set(T,N),T))N.add(Mu(R,S));else if(T instanceof Object)for(let[R,O]of(N={},S.set(T,N),Object.entries(T)))N[R]=Mu(O,S);else throw Error(`Unable to clone ${T}`);return N}function Mc(T){if(!(null!=T&&T.length))return;let S=[],N="",R=!1,O=!1;for(let P=0;P<T.length;P++){let M=T[P];if("["===M&&!O){N&&(S.push(...N.split(".").filter(Boolean)),N=""),R=!0;continue}if("]"===M&&!O){N&&(/^\d+$/.test(N)?S.push(N):S.push(N.replace(/^"|"$/g,"")),N=""),R=!1;continue}if('"'===M){O=!O;continue}if("."===M&&!R&&!O){N&&(S.push(N),N="");continue}N+=M}return N&&S.push(...N.split(".").filter(Boolean)),S}function Md(T,S){let N=S?`${S}.${T.path}`:T.path;return T.errors.map(T=>({message:T,path:Mc(N)}))}function Mh(T,S){var N;if(!(null!=(N=T.inner)&&N.length)&&T.errors.length)return Md(T,S);let R=S?`${S}.${T.path}`:T.path;return T.inner.flatMap(T=>Mh(T,R))}class Mp{constructor(T){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Ml,this._blacklist=new Ml,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(P1.notType)}),this.type=T.type,this._typeCheck=T.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},null==T?void 0:T.spec),this.withMutation(T=>{T.nonNullable()})}get _type(){return this.type}clone(T){if(this._mutate)return T&&Object.assign(this.spec,T),this;let S=Object.create(Object.getPrototypeOf(this));return S.type=this.type,S._typeCheck=this._typeCheck,S._whitelist=this._whitelist.clone(),S._blacklist=this._blacklist.clone(),S.internalTests=Object.assign({},this.internalTests),S.exclusiveTests=Object.assign({},this.exclusiveTests),S.deps=[...this.deps],S.conditions=[...this.conditions],S.tests=[...this.tests],S.transforms=[...this.transforms],S.spec=Mu(Object.assign({},this.spec,T)),S}label(T){let S=this.clone();return S.spec.label=T,S}meta(...T){if(0===T.length)return this.spec.meta;let S=this.clone();return S.spec.meta=Object.assign(S.spec.meta||{},T[0]),S}withMutation(T){let S=this._mutate;this._mutate=!0;let N=T(this);return this._mutate=S,N}concat(T){if(!T||T===this)return this;if(T.type!==this.type&&"mixed"!==this.type)throw TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${T.type}`);let S=this,N=T.clone(),R=Object.assign({},S.spec,N.spec);return N.spec=R,N.internalTests=Object.assign({},S.internalTests,N.internalTests),N._whitelist=S._whitelist.merge(T._whitelist,T._blacklist),N._blacklist=S._blacklist.merge(T._blacklist,T._whitelist),N.tests=S.tests,N.exclusiveTests=S.exclusiveTests,N.withMutation(S=>{T.tests.forEach(T=>{S.test(T.OPTIONS)})}),N.transforms=[...S.transforms,...N.transforms],N}isType(T){return null==T?!!this.spec.nullable&&null===T||!!this.spec.optional&&void 0===T:this._typeCheck(T)}resolve(T){let S=this;if(S.conditions.length){let N=S.conditions;(S=S.clone()).conditions=[],S=(S=N.reduce((S,N)=>N.resolve(S,T),S)).resolve(T)}return S}resolveOptions(T){var S,N,R,O;return Object.assign({},T,{from:T.from||[],strict:null!=(S=T.strict)?S:this.spec.strict,abortEarly:null!=(N=T.abortEarly)?N:this.spec.abortEarly,recursive:null!=(R=T.recursive)?R:this.spec.recursive,disableStackTrace:null!=(O=T.disableStackTrace)?O:this.spec.disableStackTrace})}cast(T,S={}){let N=this.resolve(Object.assign({value:T},S)),R="ignore-optionality"===S.assert,O=N._cast(T,S);if(!1!==S.assert&&!N.isType(O)){if(R&&Mi(O))return O;let P=PY(T),M=PY(O);throw TypeError(`The value of ${S.path||"field"} could not be cast to a value that satisfies the schema type: "${N.type}". 

attempted value: ${P} 
`+(M!==P?`result of cast: ${M}`:""))}return O}_cast(T,S){let N=void 0===T?T:this.transforms.reduce((S,N)=>N.call(this,S,T,this),T);return void 0===N&&(N=this.getDefault(S)),N}_validate(T,S={},N,R){let{path:O,originalValue:P=T,strict:M=this.spec.strict}=S,L=T;M||(L=this._cast(L,Object.assign({assert:!1},S)));let V=[];for(let T of Object.values(this.internalTests))T&&V.push(T);this.runTests({path:O,value:L,originalValue:P,options:S,tests:V},N,T=>{if(T.length)return R(T,L);this.runTests({path:O,value:L,originalValue:P,options:S,tests:this.tests},N,R)})}runTests(T,S,N){let R=!1,{tests:O,value:P,originalValue:M,path:L,options:V}=T,U=T=>{R||(R=!0,S(T,P))},$=T=>{R||(R=!0,N(T,P))},W=O.length,K=[];if(!W)return $([]);let Q={value:P,originalValue:M,path:L,options:V,schema:this};for(let T=0;T<O.length;T++)(0,O[T])(Q,U,function(T){T&&(Array.isArray(T)?K.push(...T):K.push(T)),--W<=0&&$(K)})}asNestedTest({key:T,index:S,parent:N,parentPath:R,originalParent:O,options:P}){let M=null!=T?T:S;if(null==M)throw TypeError("Must include `key` or `index` for nested validations");let L="number"==typeof M,V=N[M],U=Object.assign({},P,{strict:!0,parent:N,value:V,originalValue:O[M],key:void 0,[L?"index":"key"]:M,path:L||M.includes(".")?`${R||""}[${L?M:`"${M}"`}]`:(R?`${R}.`:"")+T});return(T,S,N)=>this.resolve(U)._validate(V,U,S,N)}validate(T,S){var N;let R=this.resolve(Object.assign({},S,{value:T})),O=null!=(N=null==S?void 0:S.disableStackTrace)?N:R.spec.disableStackTrace;return new Promise((N,P)=>R._validate(T,S,(T,S)=>{P0.isError(T)&&(T.value=S),P(T)},(T,S)=>{T.length?P(new P0(T,S,void 0,void 0,O)):N(S)}))}validateSync(T,S){var N;let R;let O=this.resolve(Object.assign({},S,{value:T})),P=null!=(N=null==S?void 0:S.disableStackTrace)?N:O.spec.disableStackTrace;return O._validate(T,Object.assign({},S,{sync:!0}),(T,S)=>{throw P0.isError(T)&&(T.value=S),T},(S,N)=>{if(S.length)throw new P0(S,T,void 0,void 0,P);R=N}),R}isValid(T,S){return this.validate(T,S).then(()=>!0,T=>{if(P0.isError(T))return!1;throw T})}isValidSync(T,S){try{return this.validateSync(T,S),!0}catch(T){if(P0.isError(T))return!1;throw T}}_getDefault(T){let S=this.spec.default;return null==S?S:"function"==typeof S?S.call(this,T):Mu(S)}getDefault(T){return this.resolve(T||{})._getDefault(T)}default(T){return 0==arguments.length?this._getDefault():this.clone({default:T})}strict(T=!0){return this.clone({strict:T})}nullability(T,S){let N=this.clone({nullable:T});return N.internalTests.nullable=Mn({message:S,name:"nullable",test(T){return null!==T||this.schema.spec.nullable}}),N}optionality(T,S){let N=this.clone({optional:T});return N.internalTests.optionality=Mn({message:S,name:"optionality",test(T){return void 0!==T||this.schema.spec.optional}}),N}optional(){return this.optionality(!0)}defined(T=P1.defined){return this.optionality(!1,T)}nullable(){return this.nullability(!0)}nonNullable(T=P1.notNull){return this.nullability(!1,T)}required(T=P1.required){return this.clone().withMutation(S=>S.nonNullable(T).defined(T))}notRequired(){return this.clone().withMutation(T=>T.nullable().optional())}transform(T){let S=this.clone();return S.transforms.push(T),S}test(...T){let S;if(void 0===(S=1===T.length?"function"==typeof T[0]?{test:T[0]}:T[0]:2===T.length?{name:T[0],test:T[1]}:{name:T[0],message:T[1],test:T[2]}).message&&(S.message=P1.default),"function"!=typeof S.test)throw TypeError("`test` is a required parameters");let N=this.clone(),R=Mn(S),O=S.exclusive||S.name&&!0===N.exclusiveTests[S.name];if(S.exclusive&&!S.name)throw TypeError("Exclusive tests must provide a unique `name` identifying the test");return S.name&&(N.exclusiveTests[S.name]=!!S.exclusive),N.tests=N.tests.filter(T=>T.OPTIONS.name!==S.name||!O&&T.OPTIONS.test!==R.OPTIONS.test),N.tests.push(R),N}when(T,S){Array.isArray(T)||"string"==typeof T||(S=T,T=".");let N=this.clone(),R=PJ(T).map(T=>new Mr(T));return R.forEach(T=>{T.isSibling&&N.deps.push(T.key)}),N.conditions.push("function"==typeof S?new Me(R,S):Me.fromOptions(R,S)),N}typeError(T){let S=this.clone();return S.internalTests.typeError=Mn({message:T,name:"typeError",skipAbsent:!0,test(T){return!!this.schema._typeCheck(T)||this.createError({params:{type:this.schema.type}})}}),S}oneOf(T,S=P1.oneOf){let N=this.clone();return T.forEach(T=>{N._whitelist.add(T),N._blacklist.delete(T)}),N.internalTests.whiteList=Mn({message:S,name:"oneOf",skipAbsent:!0,test(T){let S=this.schema._whitelist,N=S.resolveAll(this.resolve);return!!N.includes(T)||this.createError({params:{values:Array.from(S).join(", "),resolved:N}})}}),N}notOneOf(T,S=P1.notOneOf){let N=this.clone();return T.forEach(T=>{N._blacklist.add(T),N._whitelist.delete(T)}),N.internalTests.blacklist=Mn({message:S,name:"notOneOf",test(T){let S=this.schema._blacklist,N=S.resolveAll(this.resolve);return!N.includes(T)||this.createError({params:{values:Array.from(S).join(", "),resolved:N}})}}),N}strip(T=!0){let S=this.clone();return S.spec.strip=T,S}describe(T){let S=(T?this.resolve(T):this).clone(),{label:N,meta:R,optional:O,nullable:P}=S.spec;return{meta:R,label:N,optional:O,nullable:P,default:S.getDefault(T),type:S.type,oneOf:S._whitelist.describe(),notOneOf:S._blacklist.describe(),tests:S.tests.filter((T,S,N)=>N.findIndex(S=>S.OPTIONS.name===T.OPTIONS.name)===S).map(S=>{let N=S.OPTIONS.params&&T?Ms(Object.assign({},S.OPTIONS.params),T):S.OPTIONS.params;return{name:S.OPTIONS.name,params:N}})}}get"~standard"(){let T=this;return{version:1,vendor:"yup",async validate(S){try{return{value:await T.validate(S,{abortEarly:!1})}}catch(T){if(T instanceof P0)return{issues:Mh(T)};throw T}}}}}for(let T of(Mp.prototype.__isYupSchema__=!0,["validate","validateSync"]))Mp.prototype[`${T}At`]=function(S,N,R={}){let{parent:O,parentPath:P,schema:M}=Mo(this,S,N,R.context);return M[T](O&&O[P],Object.assign({},R,{parent:O,path:S}))};for(let T of["equals","is"])Mp.prototype[T]=Mp.prototype.oneOf;for(let T of["not","nope"])Mp.prototype[T]=Mp.prototype.notOneOf;let Mf=()=>!0;function Mm(T){return new Mg(T)}class Mg extends Mp{constructor(T){super("function"==typeof T?{type:"mixed",check:T}:Object.assign({type:"mixed",check:Mf},T))}}function My(){return new Mv}Mm.prototype=Mg.prototype;class Mv extends Mp{constructor(){super({type:"boolean",check:T=>(T instanceof Boolean&&(T=T.valueOf()),"boolean"==typeof T)}),this.withMutation(()=>{this.transform((T,S,N)=>{if(N.spec.coerce&&!N.isType(T)){if(/^(true|1)$/i.test(String(T)))return!0;if(/^(false|0)$/i.test(String(T)))return!1}return T})})}isTrue(T=P6.isValue){return this.test({message:T,name:"is-value",exclusive:!0,params:{value:"true"},test:T=>Mi(T)||!0===T})}isFalse(T=P6.isValue){return this.test({message:T,name:"is-value",exclusive:!0,params:{value:"false"},test:T=>Mi(T)||!1===T})}default(T){return super.default(T)}defined(T){return super.defined(T)}optional(){return super.optional()}required(T){return super.required(T)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(T){return super.nonNullable(T)}strip(T){return super.strip(T)}}My.prototype=Mv.prototype;let Mb=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function Mw(T){let S=MT(T);if(!S)return Date.parse?Date.parse(T):Number.NaN;if(void 0===S.z&&void 0===S.plusMinus)return new Date(S.year,S.month,S.day,S.hour,S.minute,S.second,S.millisecond).valueOf();let N=0;return"Z"!==S.z&&void 0!==S.plusMinus&&(N=60*S.hourOffset+S.minuteOffset,"+"===S.plusMinus&&(N=0-N)),Date.UTC(S.year,S.month,S.day,S.hour,S.minute+N,S.second,S.millisecond)}function MT(T){var S,N;let R=Mb.exec(T);return R?{year:MS(R[1]),month:MS(R[2],1)-1,day:MS(R[3],1),hour:MS(R[4]),minute:MS(R[5]),second:MS(R[6]),millisecond:R[7]?MS(R[7].substring(0,3)):0,precision:null!=(S=null==(N=R[7])?void 0:N.length)?S:void 0,z:R[8]||void 0,plusMinus:R[9]||void 0,hourOffset:MS(R[10]),minuteOffset:MS(R[11])}:null}function MS(T,S=0){return Number(T)||S}let Mx=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ME=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,MC=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,M_="^\\d{4}-\\d{2}-\\d{2}",MI="\\d{2}:\\d{2}:\\d{2}",Mk="(([+-]\\d{2}(:?\\d{2})?)|Z)",MN=RegExp(`${M_}T${MI}(\\.\\d+)?${Mk}$`),MA=T=>Mi(T)||T===T.trim(),MR=({}).toString();function MD(){return new MO}class MO extends Mp{constructor(){super({type:"string",check:T=>(T instanceof String&&(T=T.valueOf()),"string"==typeof T)}),this.withMutation(()=>{this.transform((T,S,N)=>{if(!N.spec.coerce||N.isType(T)||Array.isArray(T))return T;let R=null!=T&&T.toString?T.toString():T;return R===MR?T:R})})}required(T){return super.required(T).withMutation(S=>S.test({message:T||P1.required,name:"required",skipAbsent:!0,test:T=>!!T.length}))}notRequired(){return super.notRequired().withMutation(T=>(T.tests=T.tests.filter(T=>"required"!==T.OPTIONS.name),T))}length(T,S=P2.length){return this.test({message:S,name:"length",exclusive:!0,params:{length:T},skipAbsent:!0,test(S){return S.length===this.resolve(T)}})}min(T,S=P2.min){return this.test({message:S,name:"min",exclusive:!0,params:{min:T},skipAbsent:!0,test(S){return S.length>=this.resolve(T)}})}max(T,S=P2.max){return this.test({name:"max",exclusive:!0,message:S,params:{max:T},skipAbsent:!0,test(S){return S.length<=this.resolve(T)}})}matches(T,S){let N,R,O=!1;return S&&("object"==typeof S?{excludeEmptyString:O=!1,message:N,name:R}=S:N=S),this.test({name:R||"matches",message:N||P2.matches,params:{regex:T},skipAbsent:!0,test:S=>""===S&&O||-1!==S.search(T)})}email(T=P2.email){return this.matches(Mx,{name:"email",message:T,excludeEmptyString:!0})}url(T=P2.url){return this.matches(ME,{name:"url",message:T,excludeEmptyString:!0})}uuid(T=P2.uuid){return this.matches(MC,{name:"uuid",message:T,excludeEmptyString:!1})}datetime(T){let S,N,R="";return T&&("object"==typeof T?{message:R="",allowOffset:S=!1,precision:N}=T:R=T),this.matches(MN,{name:"datetime",message:R||P2.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:R||P2.datetime_offset,params:{allowOffset:S},skipAbsent:!0,test:T=>{if(!T||S)return!0;let N=MT(T);return!!N&&!!N.z}}).test({name:"datetime_precision",message:R||P2.datetime_precision,params:{precision:N},skipAbsent:!0,test:T=>{if(!T||void 0==N)return!0;let S=MT(T);return!!S&&S.precision===N}})}ensure(){return this.default("").transform(T=>null===T?"":T)}trim(T=P2.trim){return this.transform(T=>null!=T?T.trim():T).test({message:T,name:"trim",test:MA})}lowercase(T=P2.lowercase){return this.transform(T=>Mi(T)?T:T.toLowerCase()).test({message:T,name:"string_case",exclusive:!0,skipAbsent:!0,test:T=>Mi(T)||T===T.toLowerCase()})}uppercase(T=P2.uppercase){return this.transform(T=>Mi(T)?T:T.toUpperCase()).test({message:T,name:"string_case",exclusive:!0,skipAbsent:!0,test:T=>Mi(T)||T===T.toUpperCase()})}}MD.prototype=MO.prototype;let MP=T=>T!=+T;function MM(){return new ML}class ML extends Mp{constructor(){super({type:"number",check:T=>(T instanceof Number&&(T=T.valueOf()),"number"==typeof T&&!MP(T))}),this.withMutation(()=>{this.transform((T,S,N)=>{if(!N.spec.coerce)return T;let R=T;if("string"==typeof R){if(""===(R=R.replace(/\s/g,"")))return NaN;R=+R}return N.isType(R)||null===R?R:parseFloat(R)})})}min(T,S=P3.min){return this.test({message:S,name:"min",exclusive:!0,params:{min:T},skipAbsent:!0,test(S){return S>=this.resolve(T)}})}max(T,S=P3.max){return this.test({message:S,name:"max",exclusive:!0,params:{max:T},skipAbsent:!0,test(S){return S<=this.resolve(T)}})}lessThan(T,S=P3.lessThan){return this.test({message:S,name:"max",exclusive:!0,params:{less:T},skipAbsent:!0,test(S){return S<this.resolve(T)}})}moreThan(T,S=P3.moreThan){return this.test({message:S,name:"min",exclusive:!0,params:{more:T},skipAbsent:!0,test(S){return S>this.resolve(T)}})}positive(T=P3.positive){return this.moreThan(0,T)}negative(T=P3.negative){return this.lessThan(0,T)}integer(T=P3.integer){return this.test({name:"integer",message:T,skipAbsent:!0,test:T=>Number.isInteger(T)})}truncate(){return this.transform(T=>Mi(T)?T:0|T)}round(T){var S;let N=["ceil","floor","round","trunc"];if("trunc"===(T=(null==(S=T)?void 0:S.toLowerCase())||"round"))return this.truncate();if(-1===N.indexOf(T.toLowerCase()))throw TypeError("Only valid options for round() are: "+N.join(", "));return this.transform(S=>Mi(S)?S:Math[T](S))}}MM.prototype=ML.prototype;let Mj=new Date(""),MF=T=>"[object Date]"===Object.prototype.toString.call(T);function MB(){return new MV}class MV extends Mp{constructor(){super({type:"date",check:T=>MF(T)&&!isNaN(T.getTime())}),this.withMutation(()=>{this.transform((T,S,N)=>!N.spec.coerce||N.isType(T)||null===T?T:isNaN(T=Mw(T))?MV.INVALID_DATE:new Date(T))})}prepareParam(T,S){let N;if(Mr.isRef(T))N=T;else{let R=this.cast(T);if(!this._typeCheck(R))throw TypeError(`\`${S}\` must be a Date or a value that can be \`cast()\` to a Date`);N=R}return N}min(T,S=P4.min){let N=this.prepareParam(T,"min");return this.test({message:S,name:"min",exclusive:!0,params:{min:T},skipAbsent:!0,test(T){return T>=this.resolve(N)}})}max(T,S=P4.max){let N=this.prepareParam(T,"max");return this.test({message:S,name:"max",exclusive:!0,params:{max:T},skipAbsent:!0,test(T){return T<=this.resolve(N)}})}}function MU(T,S=[]){let N=[],R=new Set,O=new Set(S.map(([T,S])=>`${T}-${S}`));function P(T,S){let P=(0,PB.split)(T)[0];R.add(P),O.has(`${S}-${P}`)||N.push([S,P])}for(let S of Object.keys(T)){let N=T[S];R.add(S),Mr.isRef(N)&&N.isSibling?P(N.path,S):P7(N)&&"deps"in N&&N.deps.forEach(T=>P(T,S))}return Pz().array(Array.from(R),N).reverse()}function Mz(T,S){let N=1/0;return T.some((T,R)=>{var O;if(null!=(O=S.path)&&O.includes(T))return N=R,!0}),N}function Mq(T){return(S,N)=>Mz(T,S)-Mz(T,N)}MV.INVALID_DATE=Mj,MB.prototype=MV.prototype,MB.INVALID_DATE=Mj;let M$=(T,S,N)=>{if("string"!=typeof T)return T;let R=T;try{R=JSON.parse(T)}catch(T){}return N.isType(R)?R:T};function MH(T){if("fields"in T){let S={};for(let[N,R]of Object.entries(T.fields))S[N]=MH(R);return T.setFields(S)}if("array"===T.type){let S=T.optional();return S.innerType&&(S.innerType=MH(S.innerType)),S}return"tuple"===T.type?T.optional().clone({types:T.spec.types.map(MH)}):"optional"in T?T.optional():T}let MG=(T,S)=>{let N=[...(0,PB.normalizePath)(S)];if(1===N.length)return N[0]in T;let R=N.pop(),O=(0,PB.getter)((0,PB.join)(N),!0)(T);return!!(O&&R in O)},MW=T=>"[object Object]"===Object.prototype.toString.call(T);function MK(T,S){let N=Object.keys(T.fields);return Object.keys(S).filter(T=>-1===N.indexOf(T))}let MQ=Mq([]);function MY(T){return new MJ(T)}class MJ extends Mp{constructor(T){super({type:"object",check:T=>MW(T)||"function"==typeof T}),this.fields=Object.create(null),this._sortErrors=MQ,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{T&&this.shape(T)})}_cast(T,S={}){var N;let R=super._cast(T,S);if(void 0===R)return this.getDefault(S);if(!this._typeCheck(R))return R;let O=this.fields,P=null!=(N=S.stripUnknown)?N:this.spec.noUnknown,M=[].concat(this._nodes,Object.keys(R).filter(T=>!this._nodes.includes(T))),L={},V=Object.assign({},S,{parent:L,__validating:S.__validating||!1}),U=!1;for(let T of M){let N=O[T],M=T in R;if(N){let O;let P=R[T];V.path=(S.path?`${S.path}.`:"")+T;let M=(N=N.resolve({value:P,context:S.context,parent:L}))instanceof Mp?N.spec:void 0,$=null==M?void 0:M.strict;if(null!=M&&M.strip){U=U||T in R;continue}void 0!==(O=S.__validating&&$?R[T]:N.cast(R[T],V))&&(L[T]=O)}else M&&!P&&(L[T]=R[T]);(M!==T in L||L[T]!==R[T])&&(U=!0)}return U?L:R}_validate(T,S={},N,R){let{from:O=[],originalValue:P=T,recursive:M=this.spec.recursive}=S;S.from=[{schema:this,value:P},...O],S.__validating=!0,S.originalValue=P,super._validate(T,S,N,(T,O)=>{if(!M||!MW(O)){R(T,O);return}P=P||O;let L=[];for(let T of this._nodes){let N=this.fields[T];!N||Mr.isRef(N)||L.push(N.asNestedTest({options:S,key:T,parent:O,parentPath:S.path,originalParent:P}))}this.runTests({tests:L,value:O,originalValue:P,options:S},N,S=>{R(S.sort(this._sortErrors).concat(T),O)})})}clone(T){let S=super.clone(T);return S.fields=Object.assign({},this.fields),S._nodes=this._nodes,S._excludedEdges=this._excludedEdges,S._sortErrors=this._sortErrors,S}concat(T){let S=super.concat(T),N=S.fields;for(let[T,S]of Object.entries(this.fields)){let R=N[T];N[T]=void 0===R?S:R}return S.withMutation(S=>S.setFields(N,[...this._excludedEdges,...T._excludedEdges]))}_getDefault(T){if("default"in this.spec)return super._getDefault(T);if(!this._nodes.length)return;let S={};return this._nodes.forEach(N=>{var R;let O=this.fields[N],P=T;null!=(R=P)&&R.value&&(P=Object.assign({},P,{parent:P.value,value:P.value[N]})),S[N]=O&&"getDefault"in O?O.getDefault(P):void 0}),S}setFields(T,S){let N=this.clone();return N.fields=T,N._nodes=MU(T,S),N._sortErrors=Mq(Object.keys(T)),S&&(N._excludedEdges=S),N}shape(T,S=[]){return this.clone().withMutation(N=>{let R=N._excludedEdges;return S.length&&(Array.isArray(S[0])||(S=[S]),R=[...N._excludedEdges,...S]),N.setFields(Object.assign(N.fields,T),R)})}partial(){let T={};for(let[S,N]of Object.entries(this.fields))T[S]="optional"in N&&N.optional instanceof Function?N.optional():N;return this.setFields(T)}deepPartial(){return MH(this)}pick(T){let S={};for(let N of T)this.fields[N]&&(S[N]=this.fields[N]);return this.setFields(S,this._excludedEdges.filter(([S,N])=>T.includes(S)&&T.includes(N)))}omit(T){let S=[];for(let N of Object.keys(this.fields))T.includes(N)||S.push(N);return this.pick(S)}from(T,S,N){let R=(0,PB.getter)(T,!0);return this.transform(O=>{if(!O)return O;let P=O;return MG(O,T)&&(P=Object.assign({},O),N||delete P[T],P[S]=R(O)),P})}json(){return this.transform(M$)}exact(T){return this.test({name:"exact",exclusive:!0,message:T||P5.exact,test(T){if(null==T)return!0;let S=MK(this.schema,T);return 0===S.length||this.createError({params:{properties:S.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(T=!0,S=P5.noUnknown){"boolean"!=typeof T&&(S=T,T=!0);let N=this.test({name:"noUnknown",exclusive:!0,message:S,test(S){if(null==S)return!0;let N=MK(this.schema,S);return!T||0===N.length||this.createError({params:{unknown:N.join(", ")}})}});return N.spec.noUnknown=T,N}unknown(T=!0,S=P5.noUnknown){return this.noUnknown(!T,S)}transformKeys(T){return this.transform(S=>{if(!S)return S;let N={};for(let R of Object.keys(S))N[T(R)]=S[R];return N})}camelCase(){return this.transformKeys(PV.camelCase)}snakeCase(){return this.transformKeys(PV.snakeCase)}constantCase(){return this.transformKeys(T=>(0,PV.snakeCase)(T).toUpperCase())}describe(T){let S=(T?this.resolve(T):this).clone(),N=super.describe(T);for(let[O,P]of(N.fields={},Object.entries(S.fields))){var R;let S=T;null!=(R=S)&&R.value&&(S=Object.assign({},S,{parent:S.value,value:S.value[O]})),N.fields[O]=P.describe(S)}return N}}function MX(T){return new MZ(T)}MY.prototype=MJ.prototype;class MZ extends Mp{constructor(T){super({type:"array",spec:{types:T},check:T=>Array.isArray(T)}),this.innerType=void 0,this.innerType=T}_cast(T,S){let N=super._cast(T,S);if(!this._typeCheck(N)||!this.innerType)return N;let R=!1,O=N.map((T,N)=>{let O=this.innerType.cast(T,Object.assign({},S,{path:`${S.path||""}[${N}]`}));return O!==T&&(R=!0),O});return R?O:N}_validate(T,S={},N,R){var O;let P=this.innerType,M=null!=(O=S.recursive)?O:this.spec.recursive;null!=S.originalValue&&S.originalValue,super._validate(T,S,N,(O,L)=>{var V,U;if(!M||!P||!this._typeCheck(L)){R(O,L);return}let $=Array(L.length);for(let N=0;N<L.length;N++)$[N]=P.asNestedTest({options:S,index:N,parent:L,parentPath:S.path,originalParent:null!=(U=S.originalValue)?U:T});this.runTests({value:L,tests:$,originalValue:null!=(V=S.originalValue)?V:T,options:S},N,T=>R(T.concat(O),L))})}clone(T){let S=super.clone(T);return S.innerType=this.innerType,S}json(){return this.transform(M$)}concat(T){let S=super.concat(T);return S.innerType=this.innerType,T.innerType&&(S.innerType=S.innerType?S.innerType.concat(T.innerType):T.innerType),S}of(T){let S=this.clone();if(!P7(T))throw TypeError("`array.of()` sub-schema must be a valid yup schema not: "+PY(T));return S.innerType=T,S.spec=Object.assign({},S.spec,{types:T}),S}length(T,S=P9.length){return this.test({message:S,name:"length",exclusive:!0,params:{length:T},skipAbsent:!0,test(S){return S.length===this.resolve(T)}})}min(T,S){return S=S||P9.min,this.test({message:S,name:"min",exclusive:!0,params:{min:T},skipAbsent:!0,test(S){return S.length>=this.resolve(T)}})}max(T,S){return S=S||P9.max,this.test({message:S,name:"max",exclusive:!0,params:{max:T},skipAbsent:!0,test(S){return S.length<=this.resolve(T)}})}ensure(){return this.default(()=>[]).transform((T,S)=>this._typeCheck(T)?T:null==S?[]:[].concat(S))}compact(T){let S=T?(S,N,R)=>!T(S,N,R):T=>!!T;return this.transform(T=>null!=T?T.filter(S):T)}describe(T){let S=(T?this.resolve(T):this).clone(),N=super.describe(T);if(S.innerType){var R;let O=T;null!=(R=O)&&R.value&&(O=Object.assign({},O,{parent:O.value,value:O.value[0]})),N.innerType=S.innerType.describe(O)}return N}}function M0(T){return new M1(T)}MX.prototype=MZ.prototype;class M1 extends Mp{constructor(T){super({type:"tuple",spec:{types:T},check(T){let S=this.spec.types;return Array.isArray(T)&&T.length===S.length}}),this.withMutation(()=>{this.typeError(P8.notType)})}_cast(T,S){let{types:N}=this.spec,R=super._cast(T,S);if(!this._typeCheck(R))return R;let O=!1,P=N.map((T,N)=>{let P=T.cast(R[N],Object.assign({},S,{path:`${S.path||""}[${N}]`}));return P!==R[N]&&(O=!0),P});return O?P:R}_validate(T,S={},N,R){let O=this.spec.types;super._validate(T,S,N,(P,M)=>{var L,V;if(!this._typeCheck(M)){R(P,M);return}let U=[];for(let[N,R]of O.entries())U[N]=R.asNestedTest({options:S,index:N,parent:M,parentPath:S.path,originalParent:null!=(V=S.originalValue)?V:T});this.runTests({value:M,tests:U,originalValue:null!=(L=S.originalValue)?L:T,options:S},N,T=>R(T.concat(P),M))})}describe(T){let S=(T?this.resolve(T):this).clone(),N=super.describe(T);return N.innerType=S.spec.types.map((S,N)=>{var R;let O=T;return null!=(R=O)&&R.value&&(O=Object.assign({},O,{parent:O.value,value:O.value[N]})),S.describe(O)}),N}}function M2(T){try{return T()}catch(T){if(P0.isError(T))return Promise.reject(T);throw T}}M0.prototype=M1.prototype;class M3{constructor(T){this.type="lazy",this.__isYupSchema__=!0,this.spec=void 0,this._resolve=(T,S={})=>{let N=this.builder(T,S);if(!P7(N))throw TypeError("lazy() functions must return a valid schema");return this.spec.optional&&(N=N.optional()),N.resolve(S)},this.builder=T,this.spec={meta:void 0,optional:!1}}clone(T){let S=new M3(this.builder);return S.spec=Object.assign({},this.spec,T),S}optionality(T){return this.clone({optional:T})}optional(){return this.optionality(!0)}resolve(T){return this._resolve(T.value,T)}cast(T,S){return this._resolve(T,S).cast(T,S)}asNestedTest(T){let{key:S,index:N,parent:R,options:O}=T,P=R[null!=N?N:S];return this._resolve(P,Object.assign({},O,{value:P,parent:R})).asNestedTest(T)}validate(T,S){return M2(()=>this._resolve(T,S).validate(T,S))}validateSync(T,S){return this._resolve(T,S).validateSync(T,S)}validateAt(T,S,N){return M2(()=>this._resolve(S,N).validateAt(T,S,N))}validateSyncAt(T,S,N){return this._resolve(S,N).validateSyncAt(T,S,N)}isValid(T,S){try{return this._resolve(T,S).isValid(T,S)}catch(T){if(P0.isError(T))return Promise.resolve(!1);throw T}}isValidSync(T,S){return this._resolve(T,S).isValidSync(T,S)}describe(T){return T?this.resolve(T).describe(T):{type:"lazy",meta:this.spec.meta,label:void 0}}meta(...T){if(0===T.length)return this.spec.meta;let S=this.clone();return S.spec.meta=Object.assign(S.spec.meta||{},T[0]),S}get"~standard"(){let T=this;return{version:1,vendor:"yup",async validate(S){try{return{value:await T.validate(S,{abortEarly:!1})}}catch(T){if(P0.isError(T))return{issues:Mh(T)};throw T}}}}}let M4=ep("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),M6=ep("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),M5=ep("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),M9=ep("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),M8=()=>{let[T,S]=(0,en.useState)(!1),[N,R]=(0,en.useState)(!1),[O,P]=(0,en.useState)(""),{addBooking:M}=Od(),[L,V]=lk({triggerOnce:!0,threshold:.1}),{register:U,handleSubmit:$,formState:{errors:W},reset:K}=PO({resolver:PF(MY({name:MD().required("Name is required"),phone:MD().required("Phone number is required").matches(/^[0-9]{10}$/,"Invalid phone number"),email:MD().email("Invalid email").required("Email is required"),address:MD().required("Address is required"),serviceType:MD().required("Please select a service"),date:MD().required("Date is required"),time:MD().required("Time is required"),notes:MD()}))}),Q=["Hair Cut & Styling","Hair Coloring","Wig Fitting & Styling","Bridal Hair & Makeup","Monthly Hair Care","Wig Maintenance","Custom Service"],Y=["9:00 AM","10:00 AM","11:00 AM","12:00 PM","2:00 PM","3:00 PM","4:00 PM","5:00 PM","6:00 PM"],Z=async T=>{S(!0),P("");try{let S=await M({...T,status:"pending",createdAt:new Date().toISOString()});S.success?(R(!0),K(),setTimeout(()=>R(!1),5e3)):P(S.error||"Failed to submit booking. Please try again.")}catch(T){P("An unexpected error occurred. Please try again."),console.error("Booking submission error:",T)}finally{S(!1)}};return N?ei.jsx("section",{id:"booking",className:"py-20 bg-cream",children:ei.jsx("div",{className:"max-w-2xl mx-auto px-4 text-center",children:(0,ei.jsxs)(lt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-8",children:[ei.jsx(M4,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),ei.jsx("h3",{className:"text-2xl font-montserrat font-bold text-maroon mb-4",children:"Booking Confirmed!"}),ei.jsx("p",{className:"text-gray mb-6",children:"Thank you for choosing Keshwala. We'll contact you shortly to confirm your appointment details."}),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>R(!1),className:"btn-primary",children:"Book Another Appointment"})]})})}):ei.jsx("section",{id:"booking",className:"py-20 bg-cream",children:(0,ei.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:L,initial:{opacity:0,y:50},animate:V?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-12",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"Book Your Appointment"}),ei.jsx("p",{className:"text-xl text-gray max-w-3xl mx-auto",children:"Fill out the form below and we'll get back to you within 24 hours to confirm your appointment"})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.8,delay:.2},className:"bg-white rounded-2xl shadow-lg p-8",children:(0,ei.jsxs)("form",{onSubmit:$(Z),className:"space-y-6",children:[O&&ei.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:O}),(0,ei.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("label",{className:"block text-sm font-medium text-maroon mb-2",children:[ei.jsx(M6,{className:"w-4 h-4 inline mr-2"}),"Full Name *"]}),ei.jsx("input",{...U("name"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"Enter your full name"}),W.name&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.name.message})]}),(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("label",{className:"block text-sm font-medium text-maroon mb-2",children:[ei.jsx(ef,{className:"w-4 h-4 inline mr-2"}),"Phone Number *"]}),ei.jsx("input",{...U("phone"),type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"Enter your phone number"}),W.phone&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.phone.message})]})]}),(0,ei.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("label",{className:"block text-sm font-medium text-maroon mb-2",children:[ei.jsx(em,{className:"w-4 h-4 inline mr-2"}),"Email Address *"]}),ei.jsx("input",{...U("email"),type:"email",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"Enter your email address"}),W.email&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.email.message})]}),(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("label",{className:"block text-sm font-medium text-maroon mb-2",children:[ei.jsx(M5,{className:"w-4 h-4 inline mr-2"}),"Service Address *"]}),ei.jsx("input",{...U("address"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"Enter your complete address"}),W.address&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.address.message})]})]}),(0,ei.jsxs)("div",{children:[ei.jsx("label",{className:"block text-sm font-medium text-maroon mb-2",children:"Service Type *"}),(0,ei.jsxs)("select",{...U("serviceType"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",children:[ei.jsx("option",{value:"",children:"Select a service"}),Q.map(T=>ei.jsx("option",{value:T,children:T},T))]}),W.serviceType&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.serviceType.message})]}),(0,ei.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("label",{className:"block text-sm font-medium text-maroon mb-2",children:[ei.jsx(lP,{className:"w-4 h-4 inline mr-2"}),"Preferred Date *"]}),ei.jsx("input",{...U("date"),type:"date",min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors"}),W.date&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.date.message})]}),(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("label",{className:"block text-sm font-medium text-maroon mb-2",children:[ei.jsx(Og,{className:"w-4 h-4 inline mr-2"}),"Preferred Time *"]}),(0,ei.jsxs)("select",{...U("time"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",children:[ei.jsx("option",{value:"",children:"Select time"}),Y.map(T=>ei.jsx("option",{value:T,children:T},T))]}),W.time&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.time.message})]})]}),(0,ei.jsxs)("div",{children:[(0,ei.jsxs)("label",{className:"block text-sm font-medium text-maroon mb-2",children:[ei.jsx(M9,{className:"w-4 h-4 inline mr-2"}),"Additional Notes"]}),ei.jsx("textarea",{...U("notes"),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors resize-none",placeholder:"Any specific requirements or notes for your appointment..."})]}),ei.jsx(lt.button,{type:"submit",disabled:T,whileHover:{scale:T?1:1.05},whileTap:{scale:T?1:.95},className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:T?(0,ei.jsxs)("div",{className:"flex items-center justify-center",children:[ei.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Submitting..."]}):"Confirm Booking"})]})})]})})},M7=ep("quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]),Le=()=>{let[T,S]=lk({triggerOnce:!0,threshold:.1}),N=[{name:"Priya Sharma",role:"Founder & Lead Stylist",image:"/api/placeholder/200/200",experience:"8+ years",specialty:"Bridal Hair & Wig Styling",description:"Passionate about making every client feel beautiful and confident."},{name:"Anita Patel",role:"Senior Hair Stylist",image:"/api/placeholder/200/200",experience:"6+ years",specialty:"Hair Coloring & Cutting",description:"Expert in modern hair techniques and color trends."},{name:"Rekha Singh",role:"Wig Specialist",image:"/api/placeholder/200/200",experience:"5+ years",specialty:"Wig Fitting & Maintenance",description:"Dedicated to helping clients find their perfect wig solution."}],R=[{icon:lm,value:"500+",label:"Happy Clients"},{icon:ly,value:"50+",label:"Expert Stylists"},{icon:lg,value:"4.9",label:"Average Rating"},{icon:lO,value:"1000+",label:"Services Delivered"}];return ei.jsx("section",{id:"about",className:"py-20 bg-white",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:T,initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"About Keshwala"}),ei.jsx("p",{className:"text-xl text-gray max-w-3xl mx-auto mb-12",children:"We believe that everyone deserves to feel confident and beautiful. Our mission is to bring professional hair and wig care services directly to your doorstep."}),(0,ei.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 mb-16",children:[(0,ei.jsxs)(lt.div,{initial:{opacity:0,x:-50},animate:S?{opacity:1,x:0}:{},transition:{duration:.8,delay:.2},className:"bg-gradient-to-br from-maroon to-pink rounded-2xl p-8 text-white",children:[ei.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-6",children:ei.jsx(lO,{className:"w-8 h-8 text-white"})}),ei.jsx("h3",{className:"text-2xl font-montserrat font-bold mb-4",children:"Our Mission"}),ei.jsx("p",{className:"text-lg leading-relaxed",children:"To provide accessible, professional hair and wig care services that boost confidence and bring out the natural beauty in every client, all from the comfort of their own home."})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,x:50},animate:S?{opacity:1,x:0}:{},transition:{duration:.8,delay:.4},className:"bg-gradient-to-br from-pink to-maroon rounded-2xl p-8 text-white",children:[ei.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-6",children:ei.jsx(lg,{className:"w-8 h-8 text-white"})}),ei.jsx("h3",{className:"text-2xl font-montserrat font-bold mb-4",children:"Our Vision"}),ei.jsx("p",{className:"text-lg leading-relaxed",children:"To become the leading at-home beauty service provider, revolutionizing how people access professional hair and wig care while maintaining the highest standards of quality and customer satisfaction."})]})]})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.6},className:"grid grid-cols-2 md:grid-cols-4 gap-8 mb-16",children:R.map((T,S)=>(0,ei.jsxs)("div",{className:"text-center",children:[ei.jsx("div",{className:"w-16 h-16 bg-maroon/10 rounded-2xl flex items-center justify-center mx-auto mb-4",children:ei.jsx(T.icon,{className:"w-8 h-8 text-maroon"})}),ei.jsx("div",{className:"text-3xl font-bold font-montserrat text-maroon mb-2",children:T.value}),ei.jsx("div",{className:"text-gray",children:T.label})]},S))}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.8},className:"mb-16",children:[ei.jsx("h3",{className:"text-3xl font-montserrat font-bold text-maroon text-center mb-12",children:"Meet Our Team"}),ei.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:N.map((T,N)=>(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.6,delay:.2*N},whileHover:{y:-10,scale:1.02},className:"bg-white rounded-2xl shadow-lg p-6 text-center card-hover group",children:[ei.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-maroon/20 to-pink/20 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300",children:ei.jsx("span",{className:"text-4xl",children:"\uD83D\uDC69‍\uD83D\uDCBC"})}),ei.jsx("h4",{className:"text-xl font-montserrat font-semibold text-maroon mb-2",children:T.name}),ei.jsx("p",{className:"text-pink font-medium mb-2",children:T.role}),(0,ei.jsxs)("p",{className:"text-sm text-gray mb-3",children:[T.experience," experience"]}),ei.jsx("p",{className:"text-sm font-medium text-maroon mb-3",children:T.specialty}),ei.jsx("p",{className:"text-sm text-gray leading-relaxed",children:T.description})]},N))})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:1},className:"bg-gradient-to-r from-maroon to-pink rounded-2xl p-8 text-white",children:[(0,ei.jsxs)("div",{className:"text-center mb-8",children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold mb-4",children:"Our Values"}),ei.jsx("p",{className:"text-lg opacity-90",children:"The principles that guide everything we do"})]}),ei.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{title:"Quality",description:"We use only the finest products and techniques to ensure exceptional results."},{title:"Comfort",description:"Your comfort and convenience are our top priorities in every service."},{title:"Trust",description:"We build lasting relationships based on trust, reliability, and transparency."}].map((T,S)=>(0,ei.jsxs)("div",{className:"text-center",children:[ei.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:ei.jsx(M7,{className:"w-6 h-6 text-white"})}),ei.jsx("h4",{className:"text-xl font-semibold mb-3",children:T.title}),ei.jsx("p",{className:"text-sm opacity-90 leading-relaxed",children:T.description})]},S))})]})]})})},Lt=()=>{let[T,S]=lk({triggerOnce:!0,threshold:.1}),N=[{id:1,title:"5 Essential Hair Care Tips for Winter",excerpt:"Keep your hair healthy and beautiful during the cold winter months with these expert tips.",image:"/api/placeholder/400/250",category:"Hair Care",date:"Dec 15, 2023",readTime:"5 min read",author:"Priya Sharma"},{id:2,title:"How to Choose the Perfect Wig for Your Face Shape",excerpt:"Find the ideal wig style that complements your face shape and enhances your natural beauty.",image:"/api/placeholder/400/250",category:"Wig Care",date:"Dec 10, 2023",readTime:"7 min read",author:"Rekha Singh"},{id:3,title:"Bridal Hair Trends for 2024",excerpt:"Discover the latest bridal hair trends and styles that will make you look stunning on your special day.",image:"/api/placeholder/400/250",category:"Bridal",date:"Dec 5, 2023",readTime:"6 min read",author:"Anita Patel"},{id:4,title:"At-Home Hair Color Maintenance Guide",excerpt:"Learn how to maintain your hair color at home and keep it looking fresh between salon visits.",image:"/api/placeholder/400/250",category:"Hair Care",date:"Nov 28, 2023",readTime:"8 min read",author:"Priya Sharma"},{id:5,title:"Wig Styling Techniques for Beginners",excerpt:"Master the basics of wig styling with these simple techniques that anyone can learn.",image:"/api/placeholder/400/250",category:"Wig Care",date:"Nov 20, 2023",readTime:"4 min read",author:"Rekha Singh"},{id:6,title:"The Science Behind Hair Growth",excerpt:"Understand the biology of hair growth and learn natural ways to promote healthy hair growth.",image:"/api/placeholder/400/250",category:"Hair Care",date:"Nov 15, 2023",readTime:"9 min read",author:"Anita Patel"}],R=["All","Hair Care","Wig Care","Bridal","Tips"];return ei.jsx("section",{id:"blog",className:"py-20 bg-cream",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:T,initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"Beauty Tips & Blog"}),ei.jsx("p",{className:"text-xl text-gray max-w-3xl mx-auto",children:"Stay updated with the latest hair care tips, styling techniques, and beauty trends from our experts"})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.2},className:"flex flex-wrap justify-center gap-4 mb-12",children:R.map(T=>ei.jsx("button",{className:"px-6 py-3 rounded-full font-medium transition-all duration-300 bg-white text-maroon hover:bg-maroon hover:text-white shadow-md hover:shadow-lg",children:T},T))}),ei.jsx(lt.div,{initial:{opacity:0},animate:S?{opacity:1}:{},transition:{duration:.8,delay:.4},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:N.map((T,N)=>(0,ei.jsxs)(lt.article,{initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.6,delay:.1*N},whileHover:{y:-10,scale:1.02},className:"bg-white rounded-2xl shadow-lg overflow-hidden card-hover group",children:[(0,ei.jsxs)("div",{className:"relative h-48 bg-gradient-to-br from-maroon/20 to-pink/20 flex items-center justify-center",children:[ei.jsx("div",{className:"w-16 h-16 bg-maroon/20 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:ei.jsx("span",{className:"text-2xl",children:"\uD83D\uDCDD"})}),ei.jsx("div",{className:"absolute top-4 left-4 bg-maroon text-white px-3 py-1 rounded-full text-sm font-semibold",children:T.category})]}),(0,ei.jsxs)("div",{className:"p-6",children:[ei.jsx("h3",{className:"text-xl font-montserrat font-semibold text-maroon mb-3 group-hover:text-pink transition-colors",children:T.title}),ei.jsx("p",{className:"text-gray mb-4 leading-relaxed text-sm",children:T.excerpt}),(0,ei.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray mb-4",children:[(0,ei.jsxs)("div",{className:"flex items-center",children:[ei.jsx(lP,{className:"w-4 h-4 mr-1"}),T.date]}),(0,ei.jsxs)("div",{className:"flex items-center",children:[ei.jsx(Og,{className:"w-4 h-4 mr-1"}),T.readTime]})]}),(0,ei.jsxs)("div",{className:"text-sm text-maroon font-medium mb-4",children:["By ",T.author]}),(0,ei.jsxs)(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center text-maroon font-medium group-hover:text-pink transition-colors",children:["Read More",ei.jsx(lv,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})]})]},T.id))}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.8,delay:.6},className:"text-center mt-16",children:(0,ei.jsxs)("div",{className:"bg-gradient-to-r from-maroon to-pink rounded-2xl p-8 text-white",children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold mb-4",children:"Stay Updated with Our Latest Tips"}),ei.jsx("p",{className:"text-lg mb-6 opacity-90",children:"Subscribe to our newsletter and get expert beauty tips delivered to your inbox"}),(0,ei.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 max-w-md mx-auto",children:[ei.jsx("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-4 py-3 rounded-lg text-maroon placeholder-gray-500 focus:ring-2 focus:ring-white focus:outline-none"}),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-white text-maroon px-6 py-3 rounded-lg font-semibold hover:bg-pink transition-colors duration-300",children:"Subscribe"})]})]})})]})})},Lr=()=>{let[T,S]=(0,en.useState)(0),[N,R]=lk({triggerOnce:!0,threshold:.1}),O=[{id:1,name:"Priya Mehta",location:"Mumbai",rating:5,text:"Keshwala transformed my hair completely! The stylist was so professional and made me feel comfortable throughout the entire process. I love my new look!",service:"Hair Cut & Styling",image:"/api/placeholder/80/80"},{id:2,name:"Anita Sharma",location:"Delhi",rating:5,text:"The wig fitting service was exceptional. They helped me find the perfect wig that looks so natural. I feel confident and beautiful again.",service:"Wig Fitting",image:"/api/placeholder/80/80"},{id:3,name:"Rekha Patel",location:"Bangalore",rating:5,text:"I was skeptical about at-home services, but Keshwala exceeded my expectations. The quality is amazing and the convenience is unbeatable.",service:"Hair Coloring",image:"/api/placeholder/80/80"},{id:4,name:"Sunita Singh",location:"Pune",rating:5,text:"The bridal hair service was perfect! They understood exactly what I wanted and delivered beyond my expectations. Highly recommended!",service:"Bridal Hair & Makeup",image:"/api/placeholder/80/80"},{id:5,name:"Meera Joshi",location:"Chennai",rating:5,text:"Professional, punctual, and amazing results. The monthly hair care subscription has been a game-changer for me.",service:"Monthly Hair Care",image:"/api/placeholder/80/80"},{id:6,name:"Kavita Reddy",location:"Hyderabad",rating:5,text:"The team is so friendly and skilled. They made me feel special and the results speak for themselves. Will definitely book again!",service:"Wig Maintenance",image:"/api/placeholder/80/80"}];(0,en.useEffect)(()=>{let T=setInterval(()=>{S(T=>(T+1)%O.length)},5e3);return()=>clearInterval(T)},[O.length]);let P=()=>{S(T=>(T+1)%O.length)},M=()=>{S(T=>(T-1+O.length)%O.length)},L=T=>{S(T)};return ei.jsx("section",{className:"py-20 bg-white",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:N,initial:{opacity:0,y:50},animate:R?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"What Our Clients Say"}),ei.jsx("p",{className:"text-xl text-gray max-w-3xl mx-auto",children:"Don't just take our word for it. Here's what our satisfied clients have to say about their experience with Keshwala."})]}),(0,ei.jsxs)("div",{className:"relative max-w-4xl mx-auto",children:[ei.jsx("button",{onClick:M,className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 z-10 w-12 h-12 bg-maroon text-white rounded-full shadow-lg flex items-center justify-center hover:bg-pink transition-colors duration-300",children:ei.jsx(Of,{className:"w-6 h-6"})}),ei.jsx("button",{onClick:P,className:"absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 z-10 w-12 h-12 bg-maroon text-white rounded-full shadow-lg flex items-center justify-center hover:bg-pink transition-colors duration-300",children:ei.jsx(Om,{className:"w-6 h-6"})}),ei.jsx(lt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5},className:"bg-gradient-to-br from-maroon to-pink rounded-2xl p-8 text-white",children:(0,ei.jsxs)("div",{className:"text-center",children:[ei.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-6",children:ei.jsx(M7,{className:"w-8 h-8 text-white"})}),(0,ei.jsxs)("blockquote",{className:"text-xl lg:text-2xl leading-relaxed mb-8 font-medium",children:['"',O[T].text,'"']}),(0,ei.jsxs)("div",{className:"flex flex-col items-center",children:[ei.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mb-4",children:ei.jsx("span",{className:"text-2xl",children:"\uD83D\uDC69"})}),(0,ei.jsxs)("div",{className:"text-center",children:[ei.jsx("h4",{className:"text-xl font-montserrat font-semibold mb-1",children:O[T].name}),ei.jsx("p",{className:"text-white/80 mb-2",children:O[T].location}),ei.jsx("p",{className:"text-sm text-white/70 mb-3",children:O[T].service}),ei.jsx("div",{className:"flex justify-center",children:[void 0,void 0,void 0,void 0,void 0].map((T,S)=>ei.jsx(lg,{className:"w-5 h-5 text-yellow-400 fill-current"},S))})]})]})]})},T),ei.jsx("div",{className:"flex justify-center mt-8 space-x-2",children:O.map((S,N)=>ei.jsx("button",{onClick:()=>L(N),className:`w-3 h-3 rounded-full transition-colors duration-300 ${T===N?"bg-maroon":"bg-gray-300"}`},N))})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:R?{opacity:1,y:0}:{},transition:{duration:.8,delay:.4},className:"mt-16",children:ei.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:[{number:"500+",label:"Happy Clients"},{number:"4.9/5",label:"Average Rating"},{number:"1000+",label:"Services Delivered"},{number:"98%",label:"Client Satisfaction"}].map((T,S)=>(0,ei.jsxs)("div",{className:"text-center",children:[ei.jsx("div",{className:"text-3xl font-bold font-montserrat text-maroon mb-2",children:T.number}),ei.jsx("div",{className:"text-gray",children:T.label})]},S))})})]})})},Li=ep("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Ln=()=>{let[T,S]=(0,en.useState)(!1),[N,R]=(0,en.useState)(!1),[O,P]=(0,en.useState)(""),{addContactMessage:M}=Od(),[L,V]=lk({triggerOnce:!0,threshold:.1}),{register:U,handleSubmit:$,formState:{errors:W},reset:K}=PO({resolver:PF(MY({name:MD().required("Name is required"),email:MD().email("Invalid email").required("Email is required"),phone:MD().required("Phone number is required"),subject:MD().required("Subject is required"),message:MD().required("Message is required")}))}),Q=[{icon:ef,title:"Phone",details:["+91 98765 43210","+91 87654 32109"],color:"from-maroon to-pink"},{icon:em,title:"Email",details:["hello@keshwala.com","support@keshwala.com"],color:"from-pink to-maroon"},{icon:M5,title:"Service Areas",details:["Mumbai","Delhi","Bangalore","Pune","Chennai"],color:"from-maroon to-pink"},{icon:Og,title:"Working Hours",details:["Mon - Sat: 9:00 AM - 8:00 PM","Sunday: 10:00 AM - 6:00 PM"],color:"from-pink to-maroon"}],Y=async T=>{S(!0),P("");try{let S=await M({...T,status:"new",createdAt:new Date().toISOString()});S.success?(R(!0),K(),setTimeout(()=>R(!1),5e3)):P(S.error||"Failed to send message. Please try again.")}catch(T){P("An unexpected error occurred. Please try again."),console.error("Contact form submission error:",T)}finally{S(!1)}};return N?ei.jsx("section",{id:"contact",className:"py-20 bg-cream",children:ei.jsx("div",{className:"max-w-2xl mx-auto px-4 text-center",children:(0,ei.jsxs)(lt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-8",children:[ei.jsx(M4,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),ei.jsx("h3",{className:"text-2xl font-montserrat font-bold text-maroon mb-4",children:"Message Sent Successfully!"}),ei.jsx("p",{className:"text-gray mb-6",children:"Thank you for reaching out. We'll get back to you within 24 hours."}),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>R(!1),className:"btn-primary",children:"Send Another Message"})]})})}):ei.jsx("section",{id:"contact",className:"py-20 bg-cream",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,ei.jsxs)(lt.div,{ref:L,initial:{opacity:0,y:50},animate:V?{opacity:1,y:0}:{},transition:{duration:.8},className:"text-center mb-16",children:[ei.jsx("h2",{className:"text-4xl lg:text-5xl font-montserrat font-bold text-maroon mb-6",children:"Get In Touch"}),ei.jsx("p",{className:"text-xl text-gray max-w-3xl mx-auto",children:"Have questions or want to book an appointment? We'd love to hear from you. Contact us today!"})]}),(0,ei.jsxs)("div",{className:"grid lg:grid-cols-2 gap-12",children:[(0,ei.jsxs)(lt.div,{initial:{opacity:0,x:-50},animate:V?{opacity:1,x:0}:{},transition:{duration:.8,delay:.2},className:"space-y-8",children:[(0,ei.jsxs)("div",{children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold text-maroon mb-6",children:"Contact Information"}),ei.jsx("p",{className:"text-gray mb-8 leading-relaxed",children:"We're here to help you look and feel your best. Reach out to us through any of the channels below, and we'll get back to you as soon as possible."})]}),ei.jsx("div",{className:"grid gap-6",children:Q.map((T,S)=>ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.6,delay:.3+.1*S},className:`bg-gradient-to-r ${T.color} rounded-2xl p-6 text-white`,children:(0,ei.jsxs)("div",{className:"flex items-start space-x-4",children:[ei.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:ei.jsx(T.icon,{className:"w-6 h-6 text-white"})}),(0,ei.jsxs)("div",{children:[ei.jsx("h4",{className:"text-lg font-semibold mb-2",children:T.title}),ei.jsx("div",{className:"space-y-1",children:T.details.map((T,S)=>ei.jsx("p",{className:"text-white/90 text-sm",children:T},S))})]})]})},S))}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.6,delay:.7},className:"bg-green-500 rounded-2xl p-6 text-white text-center",children:[ei.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Quick Chat"}),ei.jsx("p",{className:"text-sm mb-4 opacity-90",children:"For instant support, chat with us on WhatsApp"}),(0,ei.jsxs)(lt.a,{href:"https://wa.me/919876543210",target:"_blank",rel:"noopener noreferrer",whileHover:{scale:1.05},whileTap:{scale:.95},className:"inline-flex items-center bg-white text-green-500 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors duration-300",children:[ei.jsx(M9,{className:"w-5 h-5 mr-2"}),"Chat on WhatsApp"]})]})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,x:50},animate:V?{opacity:1,x:0}:{},transition:{duration:.8,delay:.4},className:"bg-white rounded-2xl shadow-lg p-8",children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold text-maroon mb-6",children:"Send us a Message"}),(0,ei.jsxs)("form",{onSubmit:$(Y),className:"space-y-6",children:[O&&ei.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:O}),(0,ei.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,ei.jsxs)("div",{children:[ei.jsx("label",{className:"block text-sm font-medium text-maroon mb-2",children:"Full Name *"}),ei.jsx("input",{...U("name"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"Enter your full name"}),W.name&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.name.message})]}),(0,ei.jsxs)("div",{children:[ei.jsx("label",{className:"block text-sm font-medium text-maroon mb-2",children:"Email Address *"}),ei.jsx("input",{...U("email"),type:"email",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"Enter your email"}),W.email&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.email.message})]})]}),(0,ei.jsxs)("div",{children:[ei.jsx("label",{className:"block text-sm font-medium text-maroon mb-2",children:"Phone Number *"}),ei.jsx("input",{...U("phone"),type:"tel",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"Enter your phone number"}),W.phone&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.phone.message})]}),(0,ei.jsxs)("div",{children:[ei.jsx("label",{className:"block text-sm font-medium text-maroon mb-2",children:"Subject *"}),ei.jsx("input",{...U("subject"),type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors",placeholder:"What's this about?"}),W.subject&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.subject.message})]}),(0,ei.jsxs)("div",{children:[ei.jsx("label",{className:"block text-sm font-medium text-maroon mb-2",children:"Message *"}),ei.jsx("textarea",{...U("message"),rows:5,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-maroon focus:border-transparent transition-colors resize-none",placeholder:"Tell us how we can help you..."}),W.message&&ei.jsx("p",{className:"text-red-500 text-sm mt-1",children:W.message.message})]}),ei.jsx(lt.button,{type:"submit",disabled:T,whileHover:{scale:T?1:1.05},whileTap:{scale:T?1:.95},className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:T?(0,ei.jsxs)("div",{className:"flex items-center justify-center",children:[ei.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Sending..."]}):(0,ei.jsxs)("div",{className:"flex items-center justify-center",children:[ei.jsx(Li,{className:"w-5 h-5 mr-2"}),"Send Message"]})})]})]})]}),ei.jsx(lt.div,{initial:{opacity:0,y:30},animate:V?{opacity:1,y:0}:{},transition:{duration:.8,delay:.8},className:"mt-16",children:(0,ei.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[ei.jsx("h3",{className:"text-2xl font-montserrat font-bold text-maroon mb-6 text-center",children:"Our Service Areas"}),ei.jsx("div",{className:"bg-gradient-to-br from-maroon/10 to-pink/10 rounded-xl h-64 flex items-center justify-center",children:(0,ei.jsxs)("div",{className:"text-center text-gray",children:[ei.jsx(M5,{className:"w-12 h-12 mx-auto mb-4 text-maroon"}),ei.jsx("p",{className:"text-lg font-medium",children:"Interactive Map"}),ei.jsx("p",{className:"text-sm",children:"We serve across major cities in India"})]})})]})})]})})},Ls=ep("facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),La=ep("instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Lo=ep("twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),Ll=ep("youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),Lu=()=>{let[T,S]=lk({triggerOnce:!0,threshold:.1}),N=[{name:"Home",href:"#home"},{name:"Services",href:"#services"},{name:"Wigs & Hair Solutions",href:"#wigs"},{name:"Book Appointment",href:"#booking"},{name:"About Us",href:"#about"},{name:"Blog",href:"#blog"},{name:"Contact",href:"#contact"}],R=["Hair Cut & Styling","Hair Coloring","Wig Fitting & Styling","Bridal Hair & Makeup","Monthly Hair Care","Wig Maintenance"],O=[{icon:Ls,href:"#",label:"Facebook"},{icon:La,href:"#",label:"Instagram"},{icon:Lo,href:"#",label:"Twitter"},{icon:Ll,href:"#",label:"YouTube"}];return ei.jsx("footer",{className:"bg-maroon text-white",children:(0,ei.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-16",children:[(0,ei.jsxs)(lt.div,{ref:T,initial:{opacity:0,y:50},animate:S?{opacity:1,y:0}:{},transition:{duration:.8},className:"grid lg:grid-cols-4 md:grid-cols-2 gap-8 mb-12",children:[(0,ei.jsxs)("div",{className:"lg:col-span-1",children:[(0,ei.jsxs)(lt.div,{initial:{opacity:0,x:-30},animate:S?{opacity:1,x:0}:{},transition:{duration:.6,delay:.1},className:"mb-6",children:[(0,ei.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[ei.jsx("div",{className:"w-10 h-10 bg-pink rounded-full flex items-center justify-center",children:ei.jsx("span",{className:"text-maroon font-bold text-lg",children:"K"})}),ei.jsx("span",{className:"text-2xl font-montserrat font-bold",children:"Keshwala"})]}),ei.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"Professional hair and wig care services delivered to your doorstep. We make you feel confident and beautiful in the comfort of your own home."})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,x:-30},animate:S?{opacity:1,x:0}:{},transition:{duration:.6,delay:.2},className:"space-y-3",children:[(0,ei.jsxs)("div",{className:"flex items-center space-x-3",children:[ei.jsx(ef,{className:"w-5 h-5 text-pink"}),ei.jsx("span",{className:"text-white/80",children:"+91 98765 43210"})]}),(0,ei.jsxs)("div",{className:"flex items-center space-x-3",children:[ei.jsx(em,{className:"w-5 h-5 text-pink"}),ei.jsx("span",{className:"text-white/80",children:"hello@keshwala.com"})]}),(0,ei.jsxs)("div",{className:"flex items-center space-x-3",children:[ei.jsx(M5,{className:"w-5 h-5 text-pink"}),ei.jsx("span",{className:"text-white/80",children:"Mumbai, Delhi, Bangalore"})]})]})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.6,delay:.3},children:[ei.jsx("h3",{className:"text-xl font-montserrat font-semibold mb-6",children:"Quick Links"}),ei.jsx("ul",{className:"space-y-3",children:N.map((T,S)=>ei.jsx("li",{children:ei.jsx(lt.a,{href:T.href,whileHover:{x:5},className:"text-white/80 hover:text-pink transition-colors duration-300",children:T.name})},S))})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.6,delay:.4},children:[ei.jsx("h3",{className:"text-xl font-montserrat font-semibold mb-6",children:"Our Services"}),ei.jsx("ul",{className:"space-y-3",children:R.map((T,S)=>ei.jsx("li",{children:ei.jsx("span",{className:"text-white/80 hover:text-pink transition-colors duration-300 cursor-pointer",children:T})},S))})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.6,delay:.5},children:[ei.jsx("h3",{className:"text-xl font-montserrat font-semibold mb-6",children:"Stay Updated"}),(0,ei.jsxs)("div",{className:"mb-6",children:[ei.jsx("p",{className:"text-white/80 mb-4",children:"Subscribe to our newsletter for beauty tips and exclusive offers."}),(0,ei.jsxs)("div",{className:"flex",children:[ei.jsx("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-4 py-3 rounded-l-lg text-maroon placeholder-gray-500 focus:ring-2 focus:ring-pink focus:outline-none"}),ei.jsx(lt.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-pink text-maroon px-6 py-3 rounded-r-lg font-semibold hover:bg-pink/90 transition-colors duration-300",children:"Subscribe"})]})]}),(0,ei.jsxs)("div",{children:[ei.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Follow Us"}),ei.jsx("div",{className:"flex space-x-4",children:O.map((T,S)=>ei.jsx(lt.a,{href:T.href,whileHover:{scale:1.2,y:-2},whileTap:{scale:.9},className:"w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-pink transition-colors duration-300","aria-label":T.label,children:ei.jsx(T.icon,{className:"w-5 h-5 text-white"})},S))})]})]})]}),(0,ei.jsxs)(lt.div,{initial:{opacity:0,y:30},animate:S?{opacity:1,y:0}:{},transition:{duration:.6,delay:.6},className:"border-t border-white/20 pt-8",children:[(0,ei.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[ei.jsx("div",{className:"flex items-center text-white/80 text-sm mb-4 md:mb-0",children:ei.jsx("span",{children:"\xa9 2024 Keshwala. All rights reserved."})}),(0,ei.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[ei.jsx("a",{href:"#",className:"text-white/80 hover:text-pink transition-colors duration-300",children:"Privacy Policy"}),ei.jsx("a",{href:"#",className:"text-white/80 hover:text-pink transition-colors duration-300",children:"Terms of Service"}),ei.jsx("a",{href:"#",className:"text-white/80 hover:text-pink transition-colors duration-300",children:"Refund Policy"})]})]}),ei.jsx("div",{className:"text-center mt-6",children:(0,ei.jsxs)("p",{className:"text-white/60 text-sm flex items-center justify-center",children:["Made with ",ei.jsx(lO,{className:"w-4 h-4 text-pink mx-1"})," for beautiful hair"]})})]})]})})},Lc=()=>{let[T,S]=(0,en.useState)(!1),[N,R]=(0,en.useState)(!1);(0,en.useEffect)(()=>{let T=()=>{S(window.scrollY>300)};return window.addEventListener("scroll",T),()=>window.removeEventListener("scroll",T)},[]);let O=[{icon:lP,label:"Book Appointment",action:()=>{document.getElementById("booking")?.scrollIntoView({behavior:"smooth"}),R(!1)},color:"bg-maroon hover:bg-maroon/90"},{icon:ef,label:"Call Now",action:()=>{window.location.href="tel:+919876543210",R(!1)},color:"bg-green-500 hover:bg-green-600"},{icon:M9,label:"WhatsApp",action:()=>{window.open("https://wa.me/919876543210","_blank"),R(!1)},color:"bg-green-600 hover:bg-green-700"}];return ei.jsx(lp,{children:T&&(0,ei.jsxs)(lt.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},className:"fixed bottom-6 right-6 z-50",children:[ei.jsx(lp,{children:N&&ei.jsx(lt.div,{initial:{opacity:0,y:20,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.8},className:"mb-4 space-y-3",children:O.map((T,S)=>(0,ei.jsxs)(lt.button,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{delay:.1*S},onClick:T.action,className:`${T.color} text-white px-4 py-3 rounded-full shadow-lg flex items-center space-x-3 hover:shadow-xl transition-all duration-300 group`,children:[ei.jsx(T.icon,{className:"w-5 h-5"}),ei.jsx("span",{className:"font-medium whitespace-nowrap",children:T.label})]},S))})}),ei.jsx(lt.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>R(!N),className:"w-16 h-16 bg-gradient-to-r from-maroon to-pink text-white rounded-full shadow-lg flex items-center justify-center hover:shadow-xl transition-all duration-300",children:ei.jsx(lt.div,{animate:{rotate:N?45:0},transition:{duration:.3},children:N?ei.jsx(eg,{className:"w-6 h-6"}):ei.jsx(lP,{className:"w-6 h-6"})})}),ei.jsx(lt.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 bg-gradient-to-r from-maroon to-pink rounded-full opacity-30"})]})})};function Ld(){let[T,S]=(0,en.useState)(!0);return((0,en.useEffect)(()=>{let T=setTimeout(()=>{S(!1)},1e3);return()=>clearTimeout(T)},[]),T)?ei.jsx("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:(0,ei.jsxs)("div",{className:"text-center",children:[ei.jsx("div",{className:"w-16 h-16 border-4 border-maroon border-t-transparent rounded-full animate-spin mx-auto mb-4"}),ei.jsx("h2",{className:"text-2xl font-montserrat font-semibold text-maroon",children:"Keshwala"}),ei.jsx("p",{className:"text-gray mt-2",children:"Loading your beauty experience..."})]})}):(0,ei.jsxs)("main",{className:"min-h-screen bg-cream",children:[ei.jsx(lf,{}),ei.jsx(lN,{}),ei.jsx(Oh,{}),ei.jsx(Ov,{}),ei.jsx(OT,{}),ei.jsx(M8,{}),ei.jsx(Le,{}),ei.jsx(Lt,{}),ei.jsx(Lr,{}),ei.jsx(Ln,{}),ei.jsx(Lu,{}),ei.jsx(Lc,{})]})}},1342:(T,S,N)=>{"use strict";N.r(S),N.d(S,{default:()=>W,metadata:()=>$});var R=N(5036),O=N(6925),P=N.n(O),M=N(3765),L=N.n(M),V=N(4643),U=N.n(V);N(5023);let $={title:"Keshwala - At-Home Hair, Wig & Grooming Services",description:"Personalized Hair & Wig Care Delivered at Your Doorstep. Professional styling, wig solutions, and grooming services in the comfort of your home.",keywords:"hair services, wig care, at-home grooming, hair styling, beauty services",authors:[{name:"Keshwala Team"}],viewport:"width=device-width, initial-scale=1"};function W({children:T}){return R.jsx("html",{lang:"en",className:`${P().variable} ${L().variable} ${U().variable}`,children:R.jsx("body",{className:"font-lato bg-cream text-brown",children:T})})}},1136:(T,S,N)=>{"use strict";N.r(S),N.d(S,{$$typeof:()=>P,__esModule:()=>O,default:()=>M});let R=(0,N(6843).createProxy)(String.raw`C:\Users\singh\Keshwala\src\app\page.tsx`),{__esModule:O,$$typeof:P}=R,M=R.default},5023:()=>{},1468:function(T,S){var N;!function(R,O){function P(T){return T.default||T}void 0!==(N=(function(){var T={};return O(T),P(T)}).apply(S,[]))&&(T.exports=N)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(T){"use strict";Object.defineProperty(T,"__esModule",{value:!0}),T.default=void 0;/**
     * @license
     * Copyright 2009 The Closure Library Authors
     * Copyright 2020 Daniel Wirtz / The long.js Authors.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     *
     * SPDX-License-Identifier: Apache-2.0
     */var S=null;try{S=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function N(T,S,N){this.low=0|T,this.high=0|S,this.unsigned=!!N}function R(T){return!0===(T&&T.__isLong__)}function O(T){var S=Math.clz32(T&-T);return T?31-S:S}N.prototype.__isLong__,Object.defineProperty(N.prototype,"__isLong__",{value:!0}),N.isLong=R;var P={},M={};function L(T,S){var N,R,O;return S?(T>>>=0,(O=0<=T&&T<256)&&(R=M[T]))?R:(N=U(T,0,!0),O&&(M[T]=N),N):(T|=0,(O=-128<=T&&T<128)&&(R=P[T]))?R:(N=U(T,T<0?-1:0,!1),O&&(P[T]=N),N)}function V(T,S){if(isNaN(T))return S?er:et;if(S){if(T<0)return er;if(T>=Y)return eo}else{if(T<=-Z)return eu;if(T+1>=Z)return ea}return T<0?V(-T,S).neg():U(T%Q|0,T/Q|0,S)}function U(T,S,R){return new N(T,S,R)}N.fromInt=L,N.fromNumber=V,N.fromBits=U;var $=Math.pow;function W(T,S,N){if(0===T.length)throw Error("empty string");if("number"==typeof S?(N=S,S=!1):S=!!S,"NaN"===T||"Infinity"===T||"+Infinity"===T||"-Infinity"===T)return S?er:et;if((N=N||10)<2||36<N)throw RangeError("radix");if((R=T.indexOf("-"))>0)throw Error("interior hyphen");if(0===R)return W(T.substring(1),S,N).neg();for(var R,O=V($(N,8)),P=et,M=0;M<T.length;M+=8){var L=Math.min(8,T.length-M),U=parseInt(T.substring(M,M+L),N);if(L<8){var K=V($(N,L));P=P.mul(K).add(V(U))}else P=(P=P.mul(O)).add(V(U))}return P.unsigned=S,P}function K(T,S){return"number"==typeof T?V(T,S):"string"==typeof T?W(T,S):U(T.low,T.high,"boolean"==typeof S?S:T.unsigned)}N.fromString=W,N.fromValue=K;var Q=4294967296,Y=18446744073709552e3,Z=0x7fffffffffffffff,ee=L(16777216),et=L(0);N.ZERO=et;var er=L(0,!0);N.UZERO=er;var ei=L(1);N.ONE=ei;var en=L(1,!0);N.UONE=en;var es=L(-1);N.NEG_ONE=es;var ea=U(-1,2147483647,!1);N.MAX_VALUE=ea;var eo=U(-1,-1,!0);N.MAX_UNSIGNED_VALUE=eo;var eu=U(0,-2147483648,!1);N.MIN_VALUE=eu;var ec=N.prototype;ec.toInt=function(){return this.unsigned?this.low>>>0:this.low},ec.toNumber=function(){return this.unsigned?(this.high>>>0)*Q+(this.low>>>0):this.high*Q+(this.low>>>0)},ec.toString=function(T){if((T=T||10)<2||36<T)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(eu))return"-"+this.neg().toString(T);var S=V(T),N=this.div(S),R=N.mul(S).sub(this);return N.toString(T)+R.toInt().toString(T)}for(var O=V($(T,6),this.unsigned),P=this,M="";;){var L=P.div(O),U=(P.sub(L.mul(O)).toInt()>>>0).toString(T);if((P=L).isZero())return U+M;for(;U.length<6;)U="0"+U;M=""+U+M}},ec.getHighBits=function(){return this.high},ec.getHighBitsUnsigned=function(){return this.high>>>0},ec.getLowBits=function(){return this.low},ec.getLowBitsUnsigned=function(){return this.low>>>0},ec.getNumBitsAbs=function(){if(this.isNegative())return this.eq(eu)?64:this.neg().getNumBitsAbs();for(var T=0!=this.high?this.high:this.low,S=31;S>0&&(T&1<<S)==0;S--);return 0!=this.high?S+33:S+1},ec.isSafeInteger=function(){var T=this.high>>21;return!T||!this.unsigned&&-1===T&&!(0===this.low&&-2097152===this.high)},ec.isZero=function(){return 0===this.high&&0===this.low},ec.eqz=ec.isZero,ec.isNegative=function(){return!this.unsigned&&this.high<0},ec.isPositive=function(){return this.unsigned||this.high>=0},ec.isOdd=function(){return(1&this.low)==1},ec.isEven=function(){return(1&this.low)==0},ec.equals=function(T){return R(T)||(T=K(T)),(this.unsigned===T.unsigned||this.high>>>31!=1||T.high>>>31!=1)&&this.high===T.high&&this.low===T.low},ec.eq=ec.equals,ec.notEquals=function(T){return!this.eq(T)},ec.neq=ec.notEquals,ec.ne=ec.notEquals,ec.lessThan=function(T){return 0>this.comp(T)},ec.lt=ec.lessThan,ec.lessThanOrEqual=function(T){return 0>=this.comp(T)},ec.lte=ec.lessThanOrEqual,ec.le=ec.lessThanOrEqual,ec.greaterThan=function(T){return this.comp(T)>0},ec.gt=ec.greaterThan,ec.greaterThanOrEqual=function(T){return this.comp(T)>=0},ec.gte=ec.greaterThanOrEqual,ec.ge=ec.greaterThanOrEqual,ec.compare=function(T){if(R(T)||(T=K(T)),this.eq(T))return 0;var S=this.isNegative(),N=T.isNegative();return S&&!N?-1:!S&&N?1:this.unsigned?T.high>>>0>this.high>>>0||T.high===this.high&&T.low>>>0>this.low>>>0?-1:1:this.sub(T).isNegative()?-1:1},ec.comp=ec.compare,ec.negate=function(){return!this.unsigned&&this.eq(eu)?eu:this.not().add(ei)},ec.neg=ec.negate,ec.add=function(T){R(T)||(T=K(T));var S,N,O=this.high>>>16,P=65535&this.high,M=this.low>>>16,L=65535&this.low,V=T.high>>>16,$=65535&T.high,W=T.low>>>16,Q=65535&T.low,Y=0,Z=0;return S=0+((N=0+(L+Q))>>>16),N&=65535,S+=M+W,Z+=S>>>16,S&=65535,Z+=P+$,Y+=Z>>>16,Z&=65535,Y+=O+V,U(S<<16|N,(Y&=65535)<<16|Z,this.unsigned)},ec.subtract=function(T){return R(T)||(T=K(T)),this.add(T.neg())},ec.sub=ec.subtract,ec.multiply=function(T){if(this.isZero())return this;if(R(T)||(T=K(T)),S)return U(S.mul(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned);if(T.isZero())return this.unsigned?er:et;if(this.eq(eu))return T.isOdd()?eu:et;if(T.eq(eu))return this.isOdd()?eu:et;if(this.isNegative())return T.isNegative()?this.neg().mul(T.neg()):this.neg().mul(T).neg();if(T.isNegative())return this.mul(T.neg()).neg();if(this.lt(ee)&&T.lt(ee))return V(this.toNumber()*T.toNumber(),this.unsigned);var N,O,P=this.high>>>16,M=65535&this.high,L=this.low>>>16,$=65535&this.low,W=T.high>>>16,Q=65535&T.high,Y=T.low>>>16,Z=65535&T.low,ei=0,en=0;return N=0+((O=0+$*Z)>>>16),O&=65535,N+=L*Z,en+=N>>>16,N&=65535,N+=$*Y,en+=N>>>16,N&=65535,en+=M*Z,ei+=en>>>16,en&=65535,en+=L*Y,ei+=en>>>16,en&=65535,en+=$*Q,ei+=en>>>16,en&=65535,ei+=P*Z+M*Y+L*Q+$*W,U(N<<16|O,(ei&=65535)<<16|en,this.unsigned)},ec.mul=ec.multiply,ec.divide=function(T){if(R(T)||(T=K(T)),T.isZero())throw Error("division by zero");if(S){var N,O,P;return this.unsigned||-2147483648!==this.high||-1!==T.low||-1!==T.high?U((this.unsigned?S.div_u:S.div_s)(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?er:et;if(this.unsigned){if(T.unsigned||(T=T.toUnsigned()),T.gt(this))return er;if(T.gt(this.shru(1)))return en;P=er}else{if(this.eq(eu))return T.eq(ei)||T.eq(es)?eu:T.eq(eu)?ei:(N=this.shr(1).div(T).shl(1)).eq(et)?T.isNegative()?ei:es:(O=this.sub(T.mul(N)),P=N.add(O.div(T)));if(T.eq(eu))return this.unsigned?er:et;if(this.isNegative())return T.isNegative()?this.neg().div(T.neg()):this.neg().div(T).neg();if(T.isNegative())return this.div(T.neg()).neg();P=et}for(O=this;O.gte(T);){for(var M=Math.ceil(Math.log(N=Math.max(1,Math.floor(O.toNumber()/T.toNumber())))/Math.LN2),L=M<=48?1:$(2,M-48),W=V(N),Q=W.mul(T);Q.isNegative()||Q.gt(O);)N-=L,Q=(W=V(N,this.unsigned)).mul(T);W.isZero()&&(W=ei),P=P.add(W),O=O.sub(Q)}return P},ec.div=ec.divide,ec.modulo=function(T){return(R(T)||(T=K(T)),S)?U((this.unsigned?S.rem_u:S.rem_s)(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned):this.sub(this.div(T).mul(T))},ec.mod=ec.modulo,ec.rem=ec.modulo,ec.not=function(){return U(~this.low,~this.high,this.unsigned)},ec.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},ec.clz=ec.countLeadingZeros,ec.countTrailingZeros=function(){return this.low?O(this.low):O(this.high)+32},ec.ctz=ec.countTrailingZeros,ec.and=function(T){return R(T)||(T=K(T)),U(this.low&T.low,this.high&T.high,this.unsigned)},ec.or=function(T){return R(T)||(T=K(T)),U(this.low|T.low,this.high|T.high,this.unsigned)},ec.xor=function(T){return R(T)||(T=K(T)),U(this.low^T.low,this.high^T.high,this.unsigned)},ec.shiftLeft=function(T){return(R(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?U(this.low<<T,this.high<<T|this.low>>>32-T,this.unsigned):U(0,this.low<<T-32,this.unsigned)},ec.shl=ec.shiftLeft,ec.shiftRight=function(T){return(R(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?U(this.low>>>T|this.high<<32-T,this.high>>T,this.unsigned):U(this.high>>T-32,this.high>=0?0:-1,this.unsigned)},ec.shr=ec.shiftRight,ec.shiftRightUnsigned=function(T){return(R(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?U(this.low>>>T|this.high<<32-T,this.high>>>T,this.unsigned):32===T?U(this.high,0,this.unsigned):U(this.high>>>T-32,0,this.unsigned)},ec.shru=ec.shiftRightUnsigned,ec.shr_u=ec.shiftRightUnsigned,ec.rotateLeft=function(T){var S;return(R(T)&&(T=T.toInt()),0==(T&=63))?this:32===T?U(this.high,this.low,this.unsigned):T<32?(S=32-T,U(this.low<<T|this.high>>>S,this.high<<T|this.low>>>S,this.unsigned)):(T-=32,S=32-T,U(this.high<<T|this.low>>>S,this.low<<T|this.high>>>S,this.unsigned))},ec.rotl=ec.rotateLeft,ec.rotateRight=function(T){var S;return(R(T)&&(T=T.toInt()),0==(T&=63))?this:32===T?U(this.high,this.low,this.unsigned):T<32?(S=32-T,U(this.high<<S|this.low>>>T,this.low<<S|this.high>>>T,this.unsigned)):(T-=32,S=32-T,U(this.low<<S|this.high>>>T,this.high<<S|this.low>>>T,this.unsigned))},ec.rotr=ec.rotateRight,ec.toSigned=function(){return this.unsigned?U(this.low,this.high,!1):this},ec.toUnsigned=function(){return this.unsigned?this:U(this.low,this.high,!0)},ec.toBytes=function(T){return T?this.toBytesLE():this.toBytesBE()},ec.toBytesLE=function(){var T=this.high,S=this.low;return[255&S,S>>>8&255,S>>>16&255,S>>>24,255&T,T>>>8&255,T>>>16&255,T>>>24]},ec.toBytesBE=function(){var T=this.high,S=this.low;return[T>>>24,T>>>16&255,T>>>8&255,255&T,S>>>24,S>>>16&255,S>>>8&255,255&S]},N.fromBytes=function(T,S,R){return R?N.fromBytesLE(T,S):N.fromBytesBE(T,S)},N.fromBytesLE=function(T,S){return new N(T[0]|T[1]<<8|T[2]<<16|T[3]<<24,T[4]|T[5]<<8|T[6]<<16|T[7]<<24,S)},N.fromBytesBE=function(T,S){return new N(T[4]<<24|T[5]<<16|T[6]<<8|T[7],T[0]<<24|T[1]<<16|T[2]<<8|T[3],S)},"function"==typeof BigInt&&(N.fromBigInt=function(T,S){return U(Number(BigInt.asIntN(32,T)),Number(BigInt.asIntN(32,T>>BigInt(32))),S)},N.fromValue=function(T,S){return"bigint"==typeof T?N.fromBigInt(T,S):K(T,S)},ec.toBigInt=function(){var T=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|T}),T.default=N})},1513:T=>{"use strict";T.exports={i8:"1.9.15"}},6541:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},9987:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"options":{"go_package":"google.golang.org/protobuf/types/descriptorpb","java_package":"com.google.protobuf","java_outer_classname":"DescriptorProtos","csharp_namespace":"Google.Protobuf.Reflection","objc_class_prefix":"GPB","cc_enable_arenas":true,"optimize_for":"SPEED"},"nested":{"FileDescriptorSet":{"edition":"proto2","fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}},"extensions":[[536000000,536000000]]},"Edition":{"edition":"proto2","values":{"EDITION_UNKNOWN":0,"EDITION_LEGACY":900,"EDITION_PROTO2":998,"EDITION_PROTO3":999,"EDITION_2023":1000,"EDITION_2024":1001,"EDITION_1_TEST_ONLY":1,"EDITION_2_TEST_ONLY":2,"EDITION_99997_TEST_ONLY":99997,"EDITION_99998_TEST_ONLY":99998,"EDITION_99999_TEST_ONLY":99999,"EDITION_MAX":2147483647}},"FileDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10},"weakDependency":{"rule":"repeated","type":"int32","id":11},"optionDependency":{"rule":"repeated","type":"string","id":15},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12},"edition":{"type":"Edition","id":14}}},"DescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10},"visibility":{"type":"SymbolVisibility","id":11}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2},"options":{"type":"ExtensionRangeOptions","id":3}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"ExtensionRangeOptions":{"edition":"proto2","fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999},"declaration":{"rule":"repeated","type":"Declaration","id":2,"options":{"retention":"RETENTION_SOURCE"}},"features":{"type":"FeatureSet","id":50},"verification":{"type":"VerificationState","id":3,"options":{"default":"UNVERIFIED","retention":"RETENTION_SOURCE"}}},"extensions":[[1000,536870911]],"nested":{"Declaration":{"fields":{"number":{"type":"int32","id":1},"fullName":{"type":"string","id":2},"type":{"type":"string","id":3},"reserved":{"type":"bool","id":5},"repeated":{"type":"bool","id":6}},"reserved":[[4,4]]},"VerificationState":{"values":{"DECLARATION":0,"UNVERIFIED":1}}}},"FieldDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8},"proto3Optional":{"type":"bool","id":17}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REPEATED":3,"LABEL_REQUIRED":2}}}},"OneofDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3},"reservedRange":{"rule":"repeated","type":"EnumReservedRange","id":4},"reservedName":{"rule":"repeated","type":"string","id":5},"visibility":{"type":"SymbolVisibility","id":6}},"nested":{"EnumReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"EnumValueDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"edition":"proto2","fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31,"options":{"default":true}},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"swiftPrefix":{"type":"string","id":39},"phpClassPrefix":{"type":"string","id":40},"phpNamespace":{"type":"string","id":41},"phpMetadataNamespace":{"type":"string","id":44},"rubyPackage":{"type":"string","id":45},"features":{"type":"FeatureSet","id":50},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[42,42],[38,38],"php_generic_services"],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"edition":"proto2","fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":11,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":12},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[5,5],[6,6],[8,8],[9,9]]},"FieldOptions":{"edition":"proto2","fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"unverifiedLazy":{"type":"bool","id":15},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10,"options":{"deprecated":true}},"debugRedact":{"type":"bool","id":16},"retention":{"type":"OptionRetention","id":17},"targets":{"rule":"repeated","type":"OptionTargetType","id":19},"editionDefaults":{"rule":"repeated","type":"EditionDefault","id":20},"features":{"type":"FeatureSet","id":21},"featureSupport":{"type":"FeatureSupport","id":22},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[18,18]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}},"OptionRetention":{"values":{"RETENTION_UNKNOWN":0,"RETENTION_RUNTIME":1,"RETENTION_SOURCE":2}},"OptionTargetType":{"values":{"TARGET_TYPE_UNKNOWN":0,"TARGET_TYPE_FILE":1,"TARGET_TYPE_EXTENSION_RANGE":2,"TARGET_TYPE_MESSAGE":3,"TARGET_TYPE_FIELD":4,"TARGET_TYPE_ONEOF":5,"TARGET_TYPE_ENUM":6,"TARGET_TYPE_ENUM_ENTRY":7,"TARGET_TYPE_SERVICE":8,"TARGET_TYPE_METHOD":9}},"EditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"value":{"type":"string","id":2}}},"FeatureSupport":{"fields":{"editionIntroduced":{"type":"Edition","id":1},"editionDeprecated":{"type":"Edition","id":2},"deprecationWarning":{"type":"string","id":3},"editionRemoved":{"type":"Edition","id":4}}}}},"OneofOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"edition":"proto2","fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":6,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[5,5]]},"EnumValueOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":1},"features":{"type":"FeatureSet","id":2},"debugRedact":{"type":"bool","id":3},"featureSupport":{"type":"FieldOptions.FeatureSupport","id":4},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":34},"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":33},"idempotencyLevel":{"type":"IdempotencyLevel","id":34,"options":{"default":"IDEMPOTENCY_UNKNOWN"}},"features":{"type":"FeatureSet","id":35},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"nested":{"IdempotencyLevel":{"values":{"IDEMPOTENCY_UNKNOWN":0,"NO_SIDE_EFFECTS":1,"IDEMPOTENT":2}}}},"UninterpretedOption":{"edition":"proto2","fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"FeatureSet":{"edition":"proto2","fields":{"fieldPresence":{"type":"FieldPresence","id":1,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},"enumType":{"type":"EnumType","id":2,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},"repeatedFieldEncoding":{"type":"RepeatedFieldEncoding","id":3,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},"utf8Validation":{"type":"Utf8Validation","id":4,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},"messageEncoding":{"type":"MessageEncoding","id":5,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},"jsonFormat":{"type":"JsonFormat","id":6,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},"enforceNamingStyle":{"type":"EnforceNamingStyle","id":7,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},"defaultSymbolVisibility":{"type":"VisibilityFeature.DefaultSymbolVisibility","id":8,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},"extensions":[[1000,9994],[9995,9999],[10000,10000]],"reserved":[[999,999]],"nested":{"FieldPresence":{"values":{"FIELD_PRESENCE_UNKNOWN":0,"EXPLICIT":1,"IMPLICIT":2,"LEGACY_REQUIRED":3}},"EnumType":{"values":{"ENUM_TYPE_UNKNOWN":0,"OPEN":1,"CLOSED":2}},"RepeatedFieldEncoding":{"values":{"REPEATED_FIELD_ENCODING_UNKNOWN":0,"PACKED":1,"EXPANDED":2}},"Utf8Validation":{"values":{"UTF8_VALIDATION_UNKNOWN":0,"VERIFY":2,"NONE":3}},"MessageEncoding":{"values":{"MESSAGE_ENCODING_UNKNOWN":0,"LENGTH_PREFIXED":1,"DELIMITED":2}},"JsonFormat":{"values":{"JSON_FORMAT_UNKNOWN":0,"ALLOW":1,"LEGACY_BEST_EFFORT":2}},"EnforceNamingStyle":{"values":{"ENFORCE_NAMING_STYLE_UNKNOWN":0,"STYLE2024":1,"STYLE_LEGACY":2}},"VisibilityFeature":{"fields":{},"reserved":[[1,536870911]],"nested":{"DefaultSymbolVisibility":{"values":{"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN":0,"EXPORT_ALL":1,"EXPORT_TOP_LEVEL":2,"LOCAL_ALL":3,"STRICT":4}}}}}},"FeatureSetDefaults":{"edition":"proto2","fields":{"defaults":{"rule":"repeated","type":"FeatureSetEditionDefault","id":1},"minimumEdition":{"type":"Edition","id":4},"maximumEdition":{"type":"Edition","id":5}},"nested":{"FeatureSetEditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"overridableFeatures":{"type":"FeatureSet","id":4},"fixedFeatures":{"type":"FeatureSet","id":5}},"reserved":[[1,1],[2,2],"features"]}}},"SourceCodeInfo":{"edition":"proto2","fields":{"location":{"rule":"repeated","type":"Location","id":1}},"extensions":[[536000000,536000000]],"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"span":{"rule":"repeated","type":"int32","id":2,"options":{"packed":true}},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"edition":"proto2","fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4},"semantic":{"type":"Semantic","id":5}},"nested":{"Semantic":{"values":{"NONE":0,"SET":1,"ALIAS":2}}}}}},"SymbolVisibility":{"edition":"proto2","values":{"VISIBILITY_UNSET":0,"VISIBILITY_LOCAL":1,"VISIBILITY_EXPORT":2}}}}}}}}')},7674:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},3795:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')}};var __webpack_require__=require("../webpack-runtime.js");__webpack_require__.C(exports);var __webpack_exec__=T=>__webpack_require__(__webpack_require__.s=T),__webpack_exports__=__webpack_require__.X(0,[655],()=>__webpack_exec__(8655));module.exports=__webpack_exports__})();